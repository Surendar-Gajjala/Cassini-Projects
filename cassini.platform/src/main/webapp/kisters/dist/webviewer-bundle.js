this["__ws_debug"] =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 80);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var app_settings_1 = __webpack_require__(9);
var index_1 = __webpack_require__(100);
var app_states_1 = __webpack_require__(4);
var appPanes = __webpack_require__(57);
var native_loading_modal_1 = __webpack_require__(87);
var pane_stack_1 = __webpack_require__(74);
var canvas_stack_1 = __webpack_require__(72);
var minimized_pane_stack_1 = __webpack_require__(73);
var widget_1 = __webpack_require__(10);
var progress_container_1 = __webpack_require__(96);
var paneState = [0, 0, 0, 0];
var leftVerticalDividerDelta = 0;
var rightVerticalDividerDelta = 0;
var lastLeftVerticalDividerDelta = 0;
var lastRightVerticalDividerDelta = 0;
var leftHorizontalDividerDelta = 0;
var lastLeftHorizontalDividerDelta = 0;
var lastRightHorizontalDividerDelta = 0;
var dividerInMouseDrag = false;
var dividerInTouchDrag = false;
var leftPaneWidth = 20;
var rightPaneWidth = 20;
var leftPaneHeight = 50;
var rightPaneHeight = 50;
function setDraggedPane(id) {
    exports.draggedPane = id;
}
exports.setDraggedPane = setDraggedPane;
function paneStackIncrement(pos) {
    var paneCount = paneState[pos];
    var resizeClient = false;
    if (paneCount === 0) {
        switch (pos) {
            case 0:
                resizeClient = paneState[1] === 0;
                break;
            case 1:
                resizeClient = paneState[0] === 0;
                break;
            case 2:
                resizeClient = paneState[3] === 0;
                break;
            case 3:
                resizeClient = paneState[2] === 0;
                break;
        }
    }
    paneResize(resizeClient);
    paneState[pos]++;
}
exports.paneStackIncrement = paneStackIncrement;
function paneStackDecrement(pos) {
    var paneCount = paneState[pos];
    var resizeClient = false;
    if (paneCount === 1) {
        switch (pos) {
            case 0:
                resizeClient = paneState[1] === 0;
                break;
            case 1:
                resizeClient = paneState[0] === 0;
                break;
            case 2:
                resizeClient = paneState[3] === 0;
                break;
            case 3:
                resizeClient = paneState[2] === 0;
                break;
        }
    }
    paneResize(resizeClient);
    paneState[pos]--;
}
exports.paneStackDecrement = paneStackDecrement;
var uiBlocker;
var uiBlockerText;
function initProgressContainer(anchorEl) {
    exports.progressContainer = new progress_container_1.ProgressContainer(anchorEl, vsClient);
}
exports.initProgressContainer = initProgressContainer;
var wvApp;
var wvRibbon;
var statusBox;
exports.paneConfigs = {};
var wvCanvas;
var wvDock;
var nativeLoadingModal;
var nativeLoadingModalWindow;
function translate(langKey) {
    var lang = app_settings_1.settings.lang;
    if (_lang_data[langKey] && _lang_data[langKey][lang]) {
        return _lang_data[langKey][lang];
    }
    else if (_custom_lang_data[langKey] && _custom_lang_data[langKey][lang]) {
        return _custom_lang_data[langKey][lang];
    }
    else if (_lang_data[langKey] && _lang_data[langKey]['ENU']) {
        return _lang_data[langKey]['ENU'];
    }
    else if (_custom_lang_data[langKey] && _custom_lang_data[langKey]['ENU']) {
        return _custom_lang_data[langKey]['ENU'];
    }
    return langKey;
}
exports.translate = translate;
function serializedLoad(fileList, init) {
    var isNative;
    if (init) {
        isNative = fileOpen(fileList.shift());
    }
    else {
        isNative = importFile(fileList.shift());
    }
    if (isNative && fileList.length > 0) {
        vsClient.once('@NativeLoad', function (res) {
            serializedLoad(fileList, false);
        });
    }
    else if (fileList.length > 0) {
        serializedLoad(fileList, false);
    }
}
exports.serializedLoad = serializedLoad;
function openNativeLoadingModal(filename, cb, hideRememberMe) {
    if (hideRememberMe === void 0) { hideRememberMe = false; }
    try {
        if (_NativeLoadingModal) {
            nativeLoadingModal = _NativeLoadingModal;
        }
    }
    catch (e) {
        nativeLoadingModal = false;
    }
    var fileNameParts = filename.toLowerCase().split('.');
    var nativeLoadingSettings = localStorage.getItem('nativeLoadingSettings');
    var nativeLoadingSettingsObject = { rememberMe: false };
    if (nativeLoadingSettings !== null) {
        nativeLoadingSettingsObject = JSON.parse(nativeLoadingSettings);
    }
    var excludedFileFormats = ['3dvs', 'vsxml', 'dxf', 'dwf', 'dwg', 'mil', 'txt', 'xml', 'cg4',
        'catdrawing', 'cgm', 'drw', 'ger', ' tiff', 'bmp', 'webp', '906', '907',
        'gbr', 'cs-ger', 'ss-ger', 'phd', 'gif', 'plt', 'jpeg', 'jpg', 'jp2', 'xls', 'xlsx',
        'ppt', 'pptx', 'doc', 'docx', 'dgn', 'odg', 'odp', 'ods', 'odt', 'png', 'dft', 'slddrw', 'tif'];
    if (excludedFileFormats.indexOf(fileNameParts[fileNameParts.length - 1]) === -1
        && (nativeLoadingSettingsObject && (nativeLoadingSettingsObject.rememberMe !== true || hideRememberMe)) && nativeLoadingModal === true) {
        if (!nativeLoadingModalWindow) {
            nativeLoadingModalWindow = new native_loading_modal_1.NativeLoadingModal(vsClient, filename, cb, hideRememberMe);
        }
        else {
            nativeLoadingModalWindow.setFile(filename);
            nativeLoadingModalWindow.setCallback(cb);
        }
        nativeLoadingModalWindow.show();
        return true;
    }
    else {
        return false;
    }
}
exports.openNativeLoadingModal = openNativeLoadingModal;
function fileOpen(filename) {
    app_states_1.appStates.fileName = filename;
    var showModal = openNativeLoadingModal(filename, vsClient.OpenFile.bind(vsClient));
    if (!showModal) {
        deactivateInteraction(vsClient);
        vsClient.OpenFile(filename);
        exports.canvasStack.setTabTitle(filename.split("/")[filename.split("/").length - 1]);
    }
    return showModal;
}
exports.fileOpen = fileOpen;
function importFile(filename) {
    var showModal = openNativeLoadingModal(filename, vsClient.ImportFile.bind(vsClient));
    if (!showModal) {
        vsClient.ImportFile(filename);
    }
    return showModal;
}
exports.importFile = importFile;
function saveFile(filename) {
    vsClient.SaveFile(filename);
}
exports.saveFile = saveFile;
function prependPane(paneId) {
    try {
        if (_DisabledPanes.indexOf(paneId) !== -1) {
            return { paneId: paneId, isVisible: false };
        }
    }
    catch (e) {
    }
    if (app_states_1.appStates.popoutPanes.indexOf(paneId) !== -1) {
        return { paneId: paneId, isVisible: false };
    }
    var panePos = 3;
    var paneConf;
    var paneArrLength = app_states_1.appStates.panes.length;
    var newPane = true;
    for (var i = 0; i < paneArrLength; i++) {
        if (app_states_1.appStates.panes[i].paneId === paneId) {
            app_states_1.appStates.panes[i].visible = true;
            paneConf = app_states_1.appStates.panes[i];
            panePos = app_states_1.appStates.panes[i].pos;
            newPane = false;
        }
    }
    if (newPane) {
        paneConf = {
            paneId: paneId,
            pos: 3,
            minimized: false,
            visible: true
        };
        app_states_1.appStates.panes.push(paneConf);
    }
    localStorage.setItem('panePositions', JSON.stringify(app_states_1.appStates.panes));
    var pane = exports.paneConfigs[paneId]['pane'];
    if (paneConf.minimized) {
        switch (panePos) {
            case 1:
                pane.setStack(exports.leftUpperStack);
                exports.leftMinimizedPaneStack.registerPane(pane, paneId);
                break;
            case 2:
                pane.setStack(exports.leftLowerStack);
                exports.leftMinimizedPaneStack.registerPane(pane, paneId);
                break;
            case 3:
                pane.setStack(exports.rightUpperStack);
                exports.rightMinimizedPaneStack.registerPane(pane, paneId);
            case 4:
                pane.setStack(exports.rightLowerStack);
                exports.rightMinimizedPaneStack.registerPane(pane, paneId);
                break;
        }
    }
    else {
        switch (panePos) {
            case 1:
                if (!exports.leftUpperStack.isVisible && exports.leftLowerStack.isVisible) {
                    exports.leftUpperStack.addPane(pane, paneId);
                    exports.leftUpperStack.resize(exports.leftUpperStack.height, false);
                    exports.leftLowerStack.resize(exports.leftLowerStack.height, false);
                }
                else if (!exports.leftLowerStack.isVisible) {
                    exports.leftUpperStack.addPane(pane, paneId);
                    exports.leftUpperStack.resize('100%', false);
                }
                else {
                    exports.leftUpperStack.addPane(pane, paneId);
                }
                break;
            case 2:
                if (!exports.leftLowerStack.isVisible && exports.leftUpperStack.isVisible) {
                    exports.leftLowerStack.addPane(pane, paneId);
                    exports.leftUpperStack.resize(exports.leftUpperStack.height, false);
                    exports.leftLowerStack.resize(exports.leftLowerStack.height, false);
                }
                else if (!exports.leftUpperStack.isVisible) {
                    exports.leftLowerStack.addPane(pane, paneId);
                    exports.leftLowerStack.resize('100%', false);
                }
                else {
                    exports.leftLowerStack.addPane(pane, paneId);
                }
                break;
            case 3:
                if (!exports.rightUpperStack.isVisible && exports.rightLowerStack.isVisible) {
                    exports.rightUpperStack.addPane(pane, paneId);
                    exports.rightUpperStack.resize(exports.rightUpperStack.height, false);
                    exports.rightLowerStack.resize(exports.rightLowerStack.height, false);
                }
                else if (!exports.rightLowerStack.isVisible) {
                    exports.rightUpperStack.addPane(pane, paneId);
                    exports.rightUpperStack.resize('100%', false);
                }
                else {
                    exports.rightUpperStack.addPane(pane, paneId);
                }
                break;
            case 4:
                if (!exports.rightLowerStack.isVisible && exports.rightUpperStack.isVisible) {
                    exports.rightLowerStack.addPane(pane, paneId);
                    exports.rightUpperStack.resize(exports.rightUpperStack.height, false);
                    exports.rightLowerStack.resize(exports.rightLowerStack.height, false);
                }
                else if (!exports.rightUpperStack.isVisible) {
                    exports.rightLowerStack.addPane(pane, paneId);
                    exports.rightLowerStack.resize('100%', false);
                }
                else {
                    exports.rightLowerStack.addPane(pane, paneId);
                }
                break;
        }
    }
}
exports.prependPane = prependPane;
function resetPanes(resetUI) {
    var s = '<Call Method="ActivateInteraction"><Interaction>Deactivate_AllInteractions</Interaction></Call>';
    vsClient.command.executeXML(s);
    exports.vsRibbon.classes['Interaction'].forEach(function (button) {
        button.applyHighlight(false);
    });
    var length = app_states_1.appStates.popoutPanes.length;
    for (var i = 0; i < length; i++) {
        app_states_1.appStates.popedOutWindows[i].close();
    }
    if (resetUI) {
        app_states_1.appStates.panes = [
            { paneId: 'wv-modeltree', pos: 1, minimized: false, visible: true },
            { paneId: 'wv-views', pos: 1, minimized: false, visible: true },
            { paneId: 'wv-properties', pos: 2, minimized: false, visible: true }
        ];
        try {
            app_states_1.appStates.panes = JSON.parse(JSON.stringify(_InitialPanes));
        }
        catch (e) { }
        localStorage.removeItem('panePositions');
        localStorage.setItem('panePositions', JSON.stringify(app_states_1.appStates.panes));
        localStorage.removeItem('WVLeftPaneStackHeight');
        localStorage.removeItem('WVLeftPaneStackWidth');
        localStorage.removeItem('WVRightPaneStackHeight');
        localStorage.removeItem('WVRightPaneStackWidth');
        localStorage.removeItem('WVleftMinimizedPaneWidth');
        localStorage.removeItem('WVrightMinimizedPaneWidth');
        exports.leftWrapper.style.width = '20%';
        exports.rightWrapper.style.width = '20%';
        leftPaneWidth = 20;
        rightPaneWidth = 20;
        leftPaneHeight = 50;
        rightPaneHeight = 50;
        lastLeftVerticalDividerDelta = 0;
        lastRightVerticalDividerDelta = 0;
        lastLeftHorizontalDividerDelta = 0;
        lastRightHorizontalDividerDelta = 0;
    }
    app_states_1.appStates.interactionMode = [];
    app_states_1.appStates.lastInteractionModes = [];
    exports.leftLowerStack.reset(resetUI);
    exports.leftUpperStack.reset(resetUI);
    exports.rightLowerStack.reset(resetUI);
    exports.rightUpperStack.reset(resetUI);
    var openPaneCount = app_states_1.appStates.panes.length;
    for (var i = 0; i < openPaneCount; i++) {
        var pane = app_states_1.appStates.panes[i];
        if (app_states_1.appStates.defaultPanes.indexOf(pane.paneId) !== -1 && pane.visible && app_states_1.appStates.popoutPanes.indexOf(pane.paneId) === -1) {
            prependPane(pane.paneId);
        }
        if (pane.paneId === 'wv-settings' && pane.visible && app_states_1.appStates.popoutPanes.indexOf(pane.paneId) === -1) {
            prependPane(pane.paneId);
        }
    }
    paneResize();
    $('#wv-modeltree-pane-tab').click();
}
exports.resetPanes = resetPanes;
function createPanes() {
    var paneId = undefined;
    exports.settingsPane = new appPanes.SettingsPane('wv-settings', 'ID_RIBBON_SETTINGS');
    exports.paneConfigs['wv-settings'] = {
        pane: exports.settingsPane,
    };
    exports.modeltreePane = new appPanes.Modeltree('wv-modeltree', 'ID_RIBBON_MODEL_TREE');
    exports.paneConfigs['wv-modeltree'] = {
        pane: exports.modeltreePane
    };
    exports.propertiesPane = new appPanes.PropertyPane('wv-properties', 'ID_RIBBON_PROPERTIES');
    exports.paneConfigs['wv-properties'] = {
        pane: exports.propertiesPane
    };
    exports.viewPane = new appPanes.ViewPane('wv-views', 'ID_RIBBON_VIEWS');
    exports.paneConfigs['wv-views'] = {
        pane: exports.viewPane
    };
    exports.selectionsPane = new appPanes.SelectionsPane('wv-selections', 'ID_SELECTIONS_WND');
    exports.paneConfigs['wv-selections'] = {
        pane: exports.selectionsPane
    };
    exports.measurementPane = new appPanes.MeasurementPane('wv-measurement', 'ID_RIBBON_MEASUREMENT');
    exports.paneConfigs['wv-measurement'] = {
        pane: exports.measurementPane
    };
    exports.transformPane = new appPanes.TransformPane('wv-transform', 'ID_RIBBON_TRANSFORM');
    exports.paneConfigs['wv-transform'] = {
        pane: exports.transformPane
    };
    exports.commandPane = new appPanes.CommandPane('wv-command', 'Commands');
    exports.paneConfigs['wv-command'] = {
        pane: exports.commandPane
    };
    exports.draftAnglePane = new appPanes.DraftAnglePane('wv-draftangle', 'ID_RIBBON_DRAFT_ANGLE');
    exports.paneConfigs['wv-draftangle'] = {
        pane: exports.draftAnglePane
    };
    exports.markupPane = new appPanes.MarkupPane('wv-markup', 'ID_RIBBON_3D_MARKUP');
    exports.paneConfigs['wv-markup'] = {
        pane: exports.markupPane
    };
    exports.markupPane_Reduced = new appPanes.MarkupPane_Reduced('wv-markup-reduced', 'ID_RIBBON_3D_MARKUP');
    exports.paneConfigs['wv-markup-reduced'] = {
        pane: exports.markupPane_Reduced
    };
    exports.sectionPane = new appPanes.SectionPane('wv-section', 'ID_RIBBON_SECTION');
    exports.paneConfigs['wv-section'] = {
        pane: exports.sectionPane
    };
    exports.quickComparePane = new appPanes.QuickComparePane('wv-quickcompare', 'ID_RIBBON_COMPARE');
    exports.paneConfigs['wv-quickcompare'] = {
        pane: exports.quickComparePane
    };
    exports.projectedAreaPane = new appPanes.ProjectedAreaPane('wv-projectedarea', 'ID_RIBBON_PROJECTED_AREA');
    exports.paneConfigs['wv-projectedarea'] = {
        pane: exports.projectedAreaPane
    };
    exports.exactComparePane = new appPanes.ExactComparePane('wv-exactcompare', 'ID_RIBBON_BREP_PART');
    exports.paneConfigs['wv-exactcompare'] = {
        pane: exports.exactComparePane
    };
    exports.mirrorPane = new appPanes.MirrorPane('wv-mirror', 'ID_RIBBON_MIRROR');
    exports.paneConfigs['wv-mirror'] = {
        pane: exports.mirrorPane
    };
    exports.filterPane = new appPanes.FilterPane('wv-filter', 'ID_RIBBON_SEARCH');
    exports.paneConfigs['wv-filter'] = {
        pane: exports.filterPane
    };
    exports.flyThroughPane = new appPanes.FlyThroughPane('wv-flythrough', 'ID_RIBBON_FLYTHROUGH');
    exports.paneConfigs['wv-flythrough'] = {
        pane: exports.flyThroughPane
    };
    exports.distortionPane = new appPanes.DistortionPane('wv-distortion', 'ID_RIBBON_DISTORT');
    exports.paneConfigs['wv-distortion'] = {
        pane: exports.distortionPane
    };
    exports.visibilityTestPane = new appPanes.VisibilityTestPane('wv-visibilitytest', 'ID_VISIBILITY_TEST');
    exports.paneConfigs['wv-visibilitytest'] = {
        pane: exports.visibilityTestPane
    };
    exports.wallthicknessPane = new appPanes.WallthicknessPane('wv-wallthickness', 'ID_RIBBON_WALL_THICKNESS');
    exports.paneConfigs['wv-wallthickness'] = {
        pane: exports.wallthicknessPane
    };
    exports.drillholePane = new appPanes.DrillholePane('wv-drillhole', 'ID_DRILLHOLE_WND');
    exports.paneConfigs['wv-drillhole'] = {
        pane: exports.drillholePane
    };
    exports.neutralAxisPane = new appPanes.NeutralAxisPane('wv-neutralaxis', 'ID_RIBBON_NEUTRAL_AXIS');
    exports.paneConfigs['wv-neutralaxis'] = {
        pane: exports.neutralAxisPane
    };
    exports.neighbourhoodSearchPane = new appPanes.NeighbourhoodSearchPane('wv-neighbourhoodsearch', 'ID_NEIGHBOURHOOD_SEARCH_WND');
    exports.paneConfigs['wv-neighbourhoodsearch'] = {
        pane: exports.neighbourhoodSearchPane
    };
    exports.bomPane = new appPanes.BOMPane('wv-bom', 'ID_RIBBON_BOM');
    exports.paneConfigs['wv-bom'] = {
        pane: exports.bomPane
    };
    exports.clashPane = new appPanes.ClashPane('wv-clash', 'ID_RIBBON_CLASH_DETECTION');
    exports.paneConfigs['wv-clash'] = {
        pane: exports.clashPane
    };
    exports.calloutPane = new appPanes.CalloutPane('wv-callout', 'ID_CALLOUTS_WND');
    exports.paneConfigs['wv-callout'] = {
        pane: exports.calloutPane
    };
    exports.textSearchPane = new appPanes.TextSearchPane('wv-textsearch', 'ID_TEXT_SEARCH_WND');
    exports.paneConfigs['wv-textsearch'] = {
        pane: exports.textSearchPane
    };
    exports.splitPane = new appPanes.SplitPane('wv-split', 'ID_RIBBON_SPLIT');
    exports.paneConfigs['wv-split'] = {
        pane: exports.splitPane
    };
    exports.explodePane = new appPanes.ExplodePane('wv-explode', 'ID_RIBBON_EXPLODE');
    exports.paneConfigs['wv-explode'] = {
        pane: exports.explodePane
    };
    exports.animationPane = new appPanes.AnimationPane('wv-animation', 'ID_RIBBON_ANIMATION');
    exports.paneConfigs['wv-animation'] = {
        pane: exports.animationPane
    };
    exports.geometryToolsPane = new appPanes.GeometryToolsPane('wv-geometry-tools', 'ID_RIBBON_GEOMETRY_TOOLS');
    exports.paneConfigs['wv-geometry-tools'] = {
        pane: exports.geometryToolsPane
    };
    exports.bandAnalysisPane = new appPanes.BandAnalysisPane('wv-bandanalysis', 'ID_BAND_ANALYSIS_WND');
    exports.paneConfigs['wv-bandanalysis'] = {
        pane: exports.bandAnalysisPane
    };
}
function resizeClient(viewportWidth, viewportHeight, callResize) {
    if (callResize === void 0) { callResize = true; }
    var layoutHeight = Math.max(viewportHeight - wvRibbon.offsetHeight, app_settings_1.settings.minHeight - wvRibbon.offsetHeight);
    if (viewportHeight === wvDock.clientHeight) {
        layoutHeight = viewportHeight;
    }
    var width = app_states_1.appStates.fullScreenMode ? wvDock.clientWidth : wvDock.clientWidth - exports.leftWrapper.clientWidth - exports.rightWrapper.clientWidth - 4;
    var height = wvDock.clientHeight;
    if (exports.leftMinimizedPaneStack.isVisible) {
        width -= 20;
    }
    if (exports.rightMinimizedPaneStack.isVisible) {
        width -= 20;
    }
    wvDock.style.height = layoutHeight + 'px';
    if (callResize) {
        vsClient.resize(width, layoutHeight - 24);
    }
    exports.leftWrapper.style.height = 'calc(100% - ' + (wvRibbon.clientHeight) + 'px)';
    exports.canvasWrapper.style.height = 'calc(100% - ' + (wvRibbon.clientHeight - 1) + 'px)';
    exports.canvasWrapper.style.width = (width + 5) + 'px';
    exports.rightWrapper.style.height = 'calc(100% - ' + (wvRibbon.clientHeight) + 'px)';
    exports.leftUpperStack.resize(undefined);
    exports.leftLowerStack.resize(undefined);
    exports.rightUpperStack.resize(undefined);
    exports.rightLowerStack.resize(undefined);
}
function resizeHandler() {
    var viewportWidth = Math.min(window.innerWidth, document.documentElement.offsetWidth);
    var viewportHeight = Math.max(window.innerHeight, document.documentElement.offsetHeight);
    app_states_1.appStates.ribbonWidth = viewportWidth;
    app_states_1.appStates.ribbonWidth = viewportWidth;
    if (app_states_1.appStates.ribbonWidth < 600) {
        app_states_1.appStates.ribbonWidth = 600;
    }
    exports.vsRibbon.render();
    setTimeout(function () { resizeClient(viewportWidth, viewportHeight, true), 100; });
}
exports.resizeHandler = resizeHandler;
function showSessionRestoreDialog(sessions) {
    var selectedSessions = [];
    var sessionRows = [];
    var overlay = document.createElement('div');
    overlay.className = 'fullscreen-loading-wrapper';
    document.body.appendChild(overlay);
    var sessionBox = document.createElement('div');
    sessionBox.className = 'session-box';
    overlay.appendChild(sessionBox);
    var title = document.createElement('div');
    title.textContent = 'Restore sessions';
    sessionBox.appendChild(title);
    var showAllRow = document.createElement('div');
    showAllRow.className = 'session-select-all-row';
    showAllRow.textContent = 'Select all';
    sessionBox.appendChild(showAllRow);
    var selectAllIcon = document.createElement('i');
    selectAllIcon.className = 'fal fa-square session-select-all-icon';
    showAllRow.onclick = function (e) {
        var iconEl = $(selectAllIcon);
        if (iconEl.hasClass('fa-square')) {
            selectedSessions = sessions.map(function (s) { return s.Id; });
        }
        else {
            selectedSessions = [];
        }
        iconEl.toggleClass('fa-square');
        iconEl.toggleClass('fa-check-square');
        sessionRows.forEach(function (row) {
            var rowEl = $(row);
            rowEl.toggleClass('fa-square');
            rowEl.toggleClass('fa-check-square');
        });
    };
    showAllRow.appendChild(selectAllIcon);
    sessions.forEach(function (session, index) {
        var row = document.createElement('div');
        row.className = 'session-row';
        session.Lifetime = parseInt(session.Lifetime) / 60000;
        var startedMinute = session.Lifetime > 1 ? Math.round(session.Lifetime) + ' minute(s)' : '< 1 minute';
        row.textContent = 'Session ' + (index + 1) + ', started ' + startedMinute + ' ago';
        row.id = session;
        var icon = document.createElement('i');
        icon.className = 'fal fa-square session-select-icon';
        row.onclick = function (e) {
            $(icon).toggleClass('fa-square');
            $(icon).toggleClass('fa-check-square');
            if (selectedSessions.indexOf(session.Id) === -1) {
                selectedSessions.push(session.Id);
            }
            else {
                selectedSessions.splice(selectedSessions.indexOf(session.Id), 1);
            }
        };
        row.appendChild(icon);
        sessionRows.push(icon);
        sessionBox.appendChild(row);
    });
    var continueButton = document.createElement('button');
    continueButton.textContent = 'OK';
    continueButton.className = 'session-continue-button';
    continueButton.onclick = function (e) {
        sessions.forEach(function (session) {
            var xml = '<Request Type="CloseSessions">';
            if (selectedSessions.indexOf(session.Id) === -1) {
                xml += '<Session>' + session.Id + '</Session>';
            }
            xml += '</Request>';
            vsClient.command.executeXML(xml);
        });
        var url = window.location.origin + window.location.pathname.replace('/index.html', '/');
        selectedSessions.forEach(function (session) {
            window.open(url + 'index.html?session=' + session, '_blank');
        });
        selectedSessions = undefined;
        sessionRows = undefined;
        vsClient.connect();
        if (app_states_1.appStates.backendToken) {
            vsClient.SessionToken(app_states_1.appStates.backendToken);
        }
        $(overlay).remove();
    };
    sessionBox.appendChild(continueButton);
}
exports.showSessionRestoreDialog = showSessionRestoreDialog;
function toast(success) {
    var toastWrapper = document.createElement('div');
    toastWrapper.className = 'toast';
    toastWrapper.style.backgroundColor = success ? 'darkgreen' : 'darkred';
    var toastIcon = document.createElement('i');
    toastIcon.className = success ? 'far fa-check' : 'far fa-exclamation';
    toastWrapper.appendChild(toastIcon);
    document.body.appendChild(toastWrapper);
    setTimeout(function () {
        toastWrapper.remove();
    }, 2000);
}
exports.toast = toast;
function openStatusBox(message) {
    var ignoredInfo = ['WARN_NO_STATE_CHANGE', 'ERR_SCENE_ID_NOT_FOUND', 'ERR_VIEW_ID_NOT_FOUND', 'ERR_ID_ALREADY_EXISTS'];
    try {
        if (_IgnoredErrors && _IgnoredErrors.length > 0) {
            ignoredInfo = ignoredInfo.concat(_IgnoredErrors);
        }
    }
    catch (e) { }
    if (ignoredInfo.indexOf(message.info) === -1) {
        var box_1 = $(statusBox);
        box_1.hide();
        box_1.empty();
        var closeIcon = document.createElement('i');
        closeIcon.className = 'fa fa-times status-box-close-icon';
        closeIcon.onclick = function (e) {
            box_1.hide();
        };
        statusBox.appendChild(closeIcon);
        var typeClass = 'status-message-wrapper';
        var messageWrapper = document.createElement('div');
        switch (message.type) {
            case 'Warning':
                typeClass += ' status-type-info';
                break;
            case 'Error':
                typeClass += ' status-type-error';
                break;
            case 'Progress':
                typeClass += ' status-type-progress';
                break;
            case 'SocketError':
                typeClass += ' status-type-error';
                break;
            default:
                typeClass += ' status-type-info';
                break;
        }
        messageWrapper.className = typeClass;
        var titleEl = document.createElement('div');
        titleEl.textContent = message.method;
        titleEl.className = 'status-box-title';
        messageWrapper.appendChild(titleEl);
        var codeEl = document.createElement('div');
        codeEl.innerHTML = translate(message.message).replace(/\\n/g, '\r');
        codeEl.className = 'status-box-code';
        messageWrapper.appendChild(codeEl);
        statusBox.appendChild(messageWrapper);
        box_1.show();
        setTimeout(function () {
            if (message.type !== 'SocketError') {
                box_1.hide();
            }
        }, 5000);
    }
}
exports.openStatusBox = openStatusBox;
function isFullscreen(el) {
    return el.webkitFullscreenElement || el.msFullscreenElement || el.mozFullScreenElement || el.fullscreenElement;
}
function init() {
    var _this = this;
    var version = localStorage.getItem('WVVersion');
    if (version !== '18') {
        localStorage.removeItem('panePositions');
        localStorage.removeItem('WVColWidth');
        localStorage.setItem('WVVersion', '18');
    }
    try {
        app_states_1.appStates.lockPanes = _PaneLock;
    }
    catch (e) { }
    $(document).on('mozfullscreenchange webkitfullscreenchange fullscreenchange', function (e) {
        var ribbonToggle = $('#wv-ribbon-toggle-ribbon');
        app_states_1.appStates.fullScreenMode = !app_states_1.appStates.fullScreenMode;
        var fullscreen = isFullscreen(document);
        if (!fullscreen) {
            exports.canvasStack.minimize();
            var ribbonVis = localStorage.getItem('WVRibbonVis');
            if (ribbonVis === 'true' && ribbonToggle.hasClass('fa-chevron-right')) {
                exports.vsRibbon.toggleVisibility(false, true);
            }
        }
        else {
            exports.canvasStack.maximize();
            if (ribbonToggle.hasClass('fa-chevron-down')) {
                exports.vsRibbon.toggleVisibility(false, true);
            }
        }
    });
    wvApp = document.getElementById('wv-app');
    wvRibbon = document.getElementById('wv-ribbon');
    this.uiBlocker = document.createElement('div');
    this.uiBlocker.className = 'fullscreen-loading-wrapper';
    this.uiBlockerText = document.createElement('span');
    this.uiBlockerText.className = 'fullscreen-loading-text';
    this.uiBlockerText.textContent = "";
    this.uiBlocker.appendChild(this.uiBlockerText);
    var spinnerIcon = document.createElement('i');
    spinnerIcon.className = 'fullscreen-loading-icon fal fa-spinner-third fa-spin';
    this.uiBlocker.appendChild(spinnerIcon);
    this.blockUI();
    vsClient.on('SendSessionReady', function (ev) {
        _this.unblockUI();
        $(statusBox).hide();
    });
    statusBox = document.createElement('div');
    statusBox.className = 'status-box-wrapper';
    $(statusBox).hide();
    wvApp.appendChild(statusBox);
    exports.vsRibbon = new index_1.VSRibbon(wvRibbon);
    exports.vsRibbon.initialize();
    wvDock = document.getElementById('wv-dock');
    wvDock.style.height = window.innerHeight - wvRibbon.offsetHeight + 'px';
    createPanes();
    window.onresize = resizeHandler;
    if (navigator.platform === 'iPad' && navigator.userAgent.match('CriOS')) {
        window.onorientationchange = function () {
            setTimeout(function (e) {
                resizeHandler();
                paneResize();
            }, 1000);
        };
    }
    try {
        var length_1 = _InitialPanes.length;
        for (var i = 0; i < length_1; i++) {
            var pane = JSON.parse(JSON.stringify(_InitialPanes[i]));
            var visibility = pane.visible;
            if (visibility && app_states_1.appStates.defaultPanes.indexOf(pane.paneId) === -1) {
                app_states_1.appStates.defaultPanes.push(pane.paneId);
            }
        }
        app_states_1.appStates.panes = JSON.parse(JSON.stringify(_InitialPanes));
    }
    catch (e) { }
    var customPanePositioning = localStorage.getItem('panePositions');
    if (customPanePositioning !== null && !app_states_1.appStates.lockPanes) {
        app_states_1.appStates.panes = JSON.parse(customPanePositioning);
    }
    var leftMinimizedPanePanel = document.createElement('div');
    leftMinimizedPanePanel.className = 'minimized-pane-panel';
    leftMinimizedPanePanel.id = 'left-minimized-pane-panel';
    leftMinimizedPanePanel.style.left = '0';
    exports.leftWrapper = document.createElement('div');
    exports.leftWrapper.className = 'pane-wrapper';
    exports.leftWrapper.style.height = 'calc(100% - ' + (wvRibbon.clientHeight + 8) + 'px)';
    exports.leftWrapper.id = 'left-pane-wrapper';
    exports.leftUpperWrapper = document.createElement('div');
    exports.leftUpperWrapper.className = 'pane-upper-wrapper';
    var leftHorizontalDivider = document.createElement('div');
    leftHorizontalDivider.className = 'horizontal-pane-divider';
    exports.leftLowerWrapper = document.createElement('div');
    exports.leftLowerWrapper.className = 'pane-lower-wrapper';
    var leftVerticalDivider = document.createElement('div');
    leftVerticalDivider.className = 'vertical-pane-divider';
    leftVerticalDivider.style.right = '-5px';
    exports.leftWrapper.appendChild(exports.leftUpperWrapper);
    exports.leftWrapper.appendChild(exports.leftLowerWrapper);
    exports.leftWrapper.appendChild(leftVerticalDivider);
    exports.canvasWrapper = document.createElement('div');
    exports.canvasWrapper.className = 'canvas-wrapper';
    exports.canvasWrapper.style.height = 'calc(100% - ' + (wvRibbon.clientHeight - 1) + 'px)';
    exports.canvasStack = new canvas_stack_1.CanvasStack(exports.canvasWrapper, vsClient);
    wvCanvas = exports.canvasStack.addScene('0');
    var rightVerticalDivider = document.createElement('div');
    rightVerticalDivider.className = 'vertical-pane-divider';
    rightVerticalDivider.style.left = '-5px';
    rightVerticalDivider.style.borderRight = '1px solid #c8c8c8';
    exports.rightWrapper = document.createElement('div');
    exports.rightWrapper.className = 'pane-wrapper';
    exports.rightWrapper.id = 'right-pane-wrapper';
    exports.rightWrapper.style.right = '0';
    exports.rightWrapper.style.height = 'calc(100% - ' + (wvRibbon.clientHeight + 8) + 'px)';
    exports.rightUpperWrapper = document.createElement('div');
    exports.rightUpperWrapper.className = 'pane-upper-wrapper';
    var rightHorizontalDivider = document.createElement('div');
    rightHorizontalDivider.className = 'horizontal-pane-divider';
    exports.rightLowerWrapper = document.createElement('div');
    exports.rightLowerWrapper.className = 'pane-lower-wrapper';
    exports.rightWrapper.appendChild(rightVerticalDivider);
    exports.rightWrapper.appendChild(exports.rightUpperWrapper);
    exports.rightWrapper.appendChild(exports.rightLowerWrapper);
    var rightMinimizedPanePanel = document.createElement('div');
    rightMinimizedPanePanel.className = 'minimized-pane-panel';
    rightMinimizedPanePanel.id = 'right-minimized-pane-panel';
    rightMinimizedPanePanel.style.right = '0';
    wvDock.appendChild(leftMinimizedPanePanel);
    wvDock.appendChild(exports.leftWrapper);
    wvDock.appendChild(exports.canvasWrapper);
    wvDock.appendChild(exports.rightWrapper);
    wvDock.appendChild(rightMinimizedPanePanel);
    exports.leftMinimizedPaneStack = new minimized_pane_stack_1.MinimizedPaneStack('left');
    exports.rightMinimizedPaneStack = new minimized_pane_stack_1.MinimizedPaneStack('right');
    exports.leftUpperStack = new pane_stack_1.PaneStack(exports.leftUpperWrapper, exports.leftMinimizedPaneStack, 0);
    exports.leftLowerStack = new pane_stack_1.PaneStack(exports.leftLowerWrapper, exports.leftMinimizedPaneStack, 1);
    exports.rightUpperStack = new pane_stack_1.PaneStack(exports.rightUpperWrapper, exports.rightMinimizedPaneStack, 2);
    exports.rightLowerStack = new pane_stack_1.PaneStack(exports.rightLowerWrapper, exports.rightMinimizedPaneStack, 3);
    exports.leftUpperWrapper.appendChild(leftHorizontalDivider);
    exports.rightUpperWrapper.appendChild(rightHorizontalDivider);
    var leftUpperDropTarget = document.createElement('div');
    leftUpperDropTarget.className = 'left-drop-target pane-drop';
    leftUpperDropTarget.textContent = '1';
    leftUpperDropTarget.style.top = '20%';
    wvDock.appendChild(leftUpperDropTarget);
    $(leftUpperDropTarget).hide();
    var leftLowerDropTarget = document.createElement('div');
    leftLowerDropTarget.className = 'left-drop-target pane-drop';
    leftLowerDropTarget.textContent = '2';
    leftLowerDropTarget.style.bottom = '20%';
    wvDock.appendChild(leftLowerDropTarget);
    $(leftLowerDropTarget).hide();
    var rightUpperDropTarget = document.createElement('div');
    rightUpperDropTarget.className = 'right-drop-target pane-drop';
    rightUpperDropTarget.textContent = '3';
    rightUpperDropTarget.style.top = '20%';
    wvDock.appendChild(rightUpperDropTarget);
    $(rightUpperDropTarget).hide();
    var rightLowerDropTarget = document.createElement('div');
    rightLowerDropTarget.className = 'right-drop-target pane-drop';
    rightLowerDropTarget.textContent = '4';
    rightLowerDropTarget.style.bottom = '20%';
    wvDock.appendChild(rightLowerDropTarget);
    $(rightLowerDropTarget).hide();
    if (!app_states_1.appStates.lockPanes) {
        leftHorizontalDivider.addEventListener('mousedown', handleLeftHorizontalDown);
        leftVerticalDivider.addEventListener('mousedown', handleLeftVerticalDown);
        rightVerticalDivider.addEventListener('mousedown', handleRightVerticalDown);
        rightHorizontalDivider.addEventListener('mousedown', handleRightHorizontalDown);
        $(leftHorizontalDivider).kendoTouch({
            dragstart: function (e) {
                if (!dividerInMouseDrag) {
                    leftHorizontalDividerDelta = e.touch.y.location;
                    dividerInTouchDrag = true;
                }
            },
            drag: function (e) {
                if (dividerInTouchDrag) {
                    var delta = e.touch.y.location - leftHorizontalDividerDelta;
                    var relativeDelta = delta / wvDock.clientHeight * 100;
                    exports.leftUpperStack.resize((leftPaneHeight + relativeDelta + lastLeftHorizontalDividerDelta) + '%', false);
                    exports.leftLowerStack.resize((100 - (leftPaneHeight + relativeDelta + lastLeftHorizontalDividerDelta)) + '%', false);
                }
            },
            dragend: function (e) {
                if (dividerInTouchDrag) {
                    var relativeDelta = (e.touch.y.location - leftHorizontalDividerDelta) / wvDock.clientHeight * 100;
                    localStorage.setItem('WVLeftPaneStackHeight', (leftPaneHeight + relativeDelta + lastLeftHorizontalDividerDelta).toString());
                    lastLeftHorizontalDividerDelta = lastLeftHorizontalDividerDelta + relativeDelta;
                    leftHorizontalDividerDelta = 0;
                    dividerInTouchDrag = false;
                }
            }
        });
        $(leftVerticalDivider).kendoTouch({
            dragstart: function (e) {
                if (!dividerInMouseDrag) {
                    leftVerticalDividerDelta = e.touch.x.location;
                    dividerInTouchDrag = true;
                }
            },
            drag: function (e) {
                if (dividerInTouchDrag) {
                    var delta = e.touch.x.location - leftVerticalDividerDelta;
                    var relativeDelta = delta / wvDock.clientWidth * 100;
                    exports.leftWrapper.style.width = (leftPaneWidth + relativeDelta + lastLeftVerticalDividerDelta) + '%';
                }
            },
            dragend: function (e) {
                if (dividerInTouchDrag) {
                    var relativeDelta = (e.touch.x.location - leftVerticalDividerDelta) / wvDock.clientWidth * 100;
                    localStorage.setItem('WVLeftPaneStackWidth', (leftPaneWidth + relativeDelta + lastLeftVerticalDividerDelta).toString());
                    lastLeftVerticalDividerDelta = lastLeftVerticalDividerDelta + relativeDelta;
                    leftVerticalDividerDelta = 0;
                    var offsetMinimizePanel = 0;
                    if (exports.leftMinimizedPaneStack.isVisible) {
                        offsetMinimizePanel += 20;
                    }
                    exports.canvasWrapper.style.left = 'calc(' + (leftPaneWidth + lastLeftVerticalDividerDelta) + '% + ' + offsetMinimizePanel + 'px)';
                    if (exports.rightMinimizedPaneStack.isVisible) {
                        offsetMinimizePanel += 20;
                    }
                    var width_1 = wvDock.clientWidth - exports.leftWrapper.clientWidth - exports.rightWrapper.clientWidth - offsetMinimizePanel;
                    var height_1 = wvDock.clientHeight;
                    resizeClient(width_1, height_1);
                    exports.canvasWrapper.style.width = width_1 + 'px';
                    dividerInTouchDrag = false;
                }
            }
        });
        $(rightVerticalDivider).kendoTouch({
            dragstart: function (e) {
                if (!dividerInMouseDrag) {
                    rightVerticalDividerDelta = e.touch.x.location;
                    dividerInTouchDrag = true;
                }
            },
            drag: function (e) {
                if (dividerInTouchDrag) {
                    var delta = rightVerticalDividerDelta - e.touch.x.location;
                    var relativeDelta = delta / wvDock.clientWidth * 100;
                    exports.rightWrapper.style.width = (rightPaneWidth + relativeDelta + lastRightVerticalDividerDelta) + '%';
                }
            },
            dragend: function (e) {
                if (dividerInTouchDrag) {
                    var relativeDelta = (rightVerticalDividerDelta - e.touch.x.location) / wvDock.clientWidth * 100;
                    localStorage.setItem('WVRightPaneStackWidth', (rightPaneWidth + relativeDelta + lastRightVerticalDividerDelta).toString());
                    lastRightVerticalDividerDelta = lastRightVerticalDividerDelta + relativeDelta;
                    rightVerticalDividerDelta = 0;
                    var offsetMinimizePanel = 0;
                    if (exports.leftMinimizedPaneStack.isVisible) {
                        offsetMinimizePanel += 20;
                    }
                    if (exports.rightMinimizedPaneStack.isVisible) {
                        offsetMinimizePanel += 20;
                    }
                    var width_2 = wvDock.clientWidth - exports.leftWrapper.clientWidth - exports.rightWrapper.clientWidth - 4 - offsetMinimizePanel;
                    var height_2 = wvDock.clientHeight;
                    resizeClient(width_2, height_2);
                    dividerInTouchDrag = false;
                }
            }
        });
        $(rightHorizontalDivider).kendoTouch({
            dragstart: function (e) {
                if (!dividerInMouseDrag) {
                    rightVerticalDividerDelta = e.touch.y.location;
                    dividerInTouchDrag = true;
                }
            },
            drag: function (e) {
                if (dividerInTouchDrag) {
                    var delta = e.touch.y.location - rightVerticalDividerDelta;
                    var relativeDelta = delta / wvDock.clientHeight * 100;
                    exports.rightUpperStack.resize((rightPaneHeight + relativeDelta + lastRightHorizontalDividerDelta) + '%', false);
                    exports.rightLowerStack.resize((100 - (rightPaneHeight + relativeDelta + lastRightHorizontalDividerDelta)) + '%', false);
                }
            },
            dragend: function (e) {
                if (dividerInTouchDrag) {
                    var relativeDelta = (e.touch.y.location - rightVerticalDividerDelta) / wvDock.clientHeight * 100;
                    localStorage.setItem('WVRightPaneStackHeight', (rightPaneHeight + relativeDelta + lastRightHorizontalDividerDelta).toString());
                    lastRightHorizontalDividerDelta = lastRightHorizontalDividerDelta + relativeDelta;
                    rightVerticalDividerDelta = 0;
                    dividerInTouchDrag = false;
                }
            }
        });
        leftUpperDropTarget.ondrop = function (e) {
            $(exports.leftWrapper).show();
            dropPane(e, 1);
        };
        leftUpperDropTarget.ondragover = function (e) {
            e.preventDefault();
            $(leftUpperDropTarget).addClass('allow-pane-drop');
        };
        leftUpperDropTarget.ondragleave = function (e) {
            e.preventDefault();
            $(leftUpperDropTarget).removeClass('allow-pane-drop');
        };
        leftLowerDropTarget.ondrop = function (e) {
            $(exports.leftWrapper).show();
            dropPane(e, 2);
        };
        leftLowerDropTarget.ondragover = function (e) {
            e.preventDefault();
            $(leftLowerDropTarget).addClass('allow-pane-drop');
        };
        leftLowerDropTarget.ondragleave = function (e) {
            e.preventDefault();
            $(leftLowerDropTarget).removeClass('allow-pane-drop');
        };
        rightUpperDropTarget.ondrop = function (e) {
            $(exports.rightWrapper).show();
            dropPane(e, 3);
        };
        rightUpperDropTarget.ondragover = function (e) {
            e.preventDefault();
            $(rightUpperDropTarget).addClass('allow-pane-drop');
        };
        rightUpperDropTarget.ondragleave = function (e) {
            e.preventDefault();
            $(rightUpperDropTarget).removeClass('allow-pane-drop');
        };
        rightLowerDropTarget.ondrop = function (e) {
            $(exports.rightWrapper).show();
            dropPane(e, 4);
        };
        rightLowerDropTarget.ondragover = function (e) {
            e.preventDefault();
            $(rightLowerDropTarget).addClass('allow-pane-drop');
        };
        rightLowerDropTarget.ondragleave = function (e) {
            e.preventDefault();
            $(rightLowerDropTarget).removeClass('allow-pane-drop');
        };
    }
    else {
        leftHorizontalDivider.style.pointerEvents = 'none';
        leftVerticalDivider.style.pointerEvents = 'none';
        rightVerticalDivider.style.pointerEvents = 'none';
        rightHorizontalDivider.style.pointerEvents = 'none';
    }
    var width = wvDock.clientWidth - exports.leftWrapper.clientWidth - exports.rightWrapper.clientWidth;
    var height = wvDock.clientHeight;
    var openPaneCount = app_states_1.appStates.panes.length;
    for (var i = 0; i < openPaneCount; i++) {
        var pane = app_states_1.appStates.panes[i];
        var button = widget_1.findPaneButton(pane.paneId);
        if (app_states_1.appStates.defaultPanes.indexOf(pane.paneId) !== -1 && pane.visible && app_states_1.appStates.popoutPanes.indexOf(pane.paneId) === -1) {
            prependPane(pane.paneId);
            if (button) {
                button.applyHighlight(true);
            }
        }
        else if (pane.paneId === 'wv-settings' && pane.visible && app_states_1.appStates.popoutPanes.indexOf(pane.paneId) === -1) {
            prependPane(pane.paneId);
            if (button) {
                button.applyHighlight(true);
            }
        }
        else {
            app_states_1.appStates.panes[i].visible = false;
        }
    }
    localStorage.setItem('panePositions', JSON.stringify(app_states_1.appStates.panes));
    if (localStorage.getItem('WVLeftPaneStackWidth') !== null) {
        leftPaneWidth = parseFloat(localStorage.getItem('WVLeftPaneStackWidth'));
        exports.leftWrapper.style.width = leftPaneWidth + '%';
    }
    if (localStorage.getItem('WVRightPaneStackWidth') !== null) {
        rightPaneWidth = parseFloat(localStorage.getItem('WVRightPaneStackWidth'));
        exports.rightWrapper.style.width = rightPaneWidth + '%';
    }
    if (localStorage.getItem('WVLeftPaneStackHeight') !== null) {
        var newHeight = parseFloat(localStorage.getItem('WVLeftPaneStackHeight'));
        leftPaneHeight = newHeight;
        exports.leftUpperStack.resize(newHeight + '%');
        exports.leftLowerStack.resize((100 - newHeight) + '%');
    }
    if (localStorage.getItem('WVRightPaneStackHeight') !== null) {
        var newHeight = parseFloat(localStorage.getItem('WVRightPaneStackHeight'));
        rightPaneHeight = newHeight;
        exports.rightUpperStack.resize(newHeight + '%');
        exports.rightLowerStack.resize((100 - newHeight) + '%');
    }
    paneResize();
    $('#wv-modeltree-pane-tab').click();
    $(wvCanvas).kendoTouch({
        minHold: 400,
        hold: function (e) {
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') === -1) {
                vsClient.vsCanvas.rightClickTimeStamp = -1;
            }
        }
    });
    wvCanvas.addEventListener('contextmenu', function (ev) {
        ev.preventDefault();
        $('#contextMenu').remove();
        $(document).off('mousedown', vsClient.vsCanvas.closeContextMenu);
        $(document).off('keyup', vsClient.vsCanvas.closeContextMenu);
        if (vsClient.vsCanvas.rightClickTimeStamp && (ev.timeStamp - vsClient.vsCanvas.rightClickTimeStamp < 200 || vsClient.vsCanvas.rightClickTimeStamp === -1)) {
            vsClient.vsCanvas.createContextMenu(ev);
        }
    });
    vsClient.on('ShowMessageBox', function (err) {
        try {
            if (_ShowErrorAlerts) {
                var message = {
                    code: parseInt(err.ErrorCode),
                    info: err.ErrorInfo,
                    method: err.Identifier,
                    message: translate('ID_' + err.ErrorInfo),
                    type: err.Type[1]
                };
                openStatusBox(message);
            }
        }
        catch (e) { }
    });
    return wvCanvas;
}
exports.init = init;
function blockUI(descr) {
    this.uiBlockerText.textContent = descr !== undefined ? descr : '';
    if (!wvApp.contains(this.uiBlocker)) {
        wvApp.appendChild(this.uiBlocker);
    }
}
exports.blockUI = blockUI;
function unblockUI() {
    if (wvApp && wvApp.contains(this.uiBlocker)) {
        wvApp.removeChild(this.uiBlocker);
    }
}
exports.unblockUI = unblockUI;
function handleLeftHorizontalDown(e) {
    if (!dividerInTouchDrag) {
        e.preventDefault();
        leftHorizontalDividerDelta = e.pageY;
        dividerInMouseDrag = true;
        document.addEventListener('mousemove', handleLeftHorizontalMove);
        document.addEventListener('mouseup', handleLeftHorizontalUp);
    }
}
function handleLeftHorizontalMove(e) {
    if (dividerInMouseDrag) {
        var delta = e.pageY - leftHorizontalDividerDelta;
        var relativeDelta = delta / wvDock.clientHeight * 100;
        exports.leftUpperStack.resize((leftPaneHeight + relativeDelta + lastLeftHorizontalDividerDelta) + '%', false);
        exports.leftLowerStack.resize((100 - (leftPaneHeight + relativeDelta + lastLeftHorizontalDividerDelta)) + '%', false);
    }
}
function handleLeftHorizontalUp(e) {
    if (dividerInMouseDrag) {
        var relativeDelta = (e.pageY - leftHorizontalDividerDelta) / wvDock.clientHeight * 100;
        localStorage.setItem('WVLeftPaneStackHeight', (leftPaneHeight + relativeDelta + lastLeftHorizontalDividerDelta).toString());
        lastLeftHorizontalDividerDelta = lastLeftHorizontalDividerDelta + relativeDelta;
        leftHorizontalDividerDelta = 0;
        dividerInMouseDrag = false;
        document.removeEventListener('mousemove', handleLeftHorizontalMove);
        document.removeEventListener('mouseup', handleLeftHorizontalUp);
    }
}
function handleRightHorizontalDown(e) {
    if (!dividerInTouchDrag) {
        e.preventDefault();
        rightVerticalDividerDelta = e.pageY;
        dividerInMouseDrag = true;
        document.addEventListener('mousemove', handleRightHorizontalMove);
        document.addEventListener('mouseup', handleRightHorizontalUp);
    }
}
function handleRightHorizontalMove(e) {
    if (dividerInMouseDrag) {
        var delta = e.pageY - rightVerticalDividerDelta;
        var relativeDelta = delta / wvDock.clientHeight * 100;
        exports.rightUpperStack.resize((rightPaneHeight + relativeDelta + lastRightHorizontalDividerDelta) + '%', false);
        exports.rightLowerStack.resize((100 - (rightPaneHeight + relativeDelta + lastRightHorizontalDividerDelta)) + '%', false);
    }
}
function handleRightHorizontalUp(e) {
    if (dividerInMouseDrag) {
        var relativeDelta = (e.pageY - rightVerticalDividerDelta) / wvDock.clientHeight * 100;
        localStorage.setItem('WVRightPaneStackHeight', (rightPaneHeight + relativeDelta + lastRightHorizontalDividerDelta).toString());
        lastRightHorizontalDividerDelta = lastRightHorizontalDividerDelta + relativeDelta;
        rightVerticalDividerDelta = 0;
        dividerInMouseDrag = false;
        document.removeEventListener('mousemove', handleRightHorizontalMove);
        document.removeEventListener('mouseup', handleRightHorizontalUp);
    }
}
function handleLeftVerticalDown(e) {
    if (!dividerInTouchDrag) {
        e.preventDefault();
        leftVerticalDividerDelta = e.pageX;
        dividerInMouseDrag = true;
        document.addEventListener('mousemove', handleLeftVerticalMove);
        document.addEventListener('mouseup', handleLeftVerticalUp);
    }
}
function handleLeftVerticalMove(e) {
    if (dividerInMouseDrag) {
        var delta = e.pageX - leftVerticalDividerDelta;
        var relativeDelta = delta / wvDock.clientWidth * 100;
        exports.leftWrapper.style.width = (leftPaneWidth + relativeDelta + lastLeftVerticalDividerDelta) + '%';
    }
}
function handleLeftVerticalUp(e) {
    if (dividerInMouseDrag) {
        var relativeDelta = (e.pageX - leftVerticalDividerDelta) / wvDock.clientWidth * 100;
        localStorage.setItem('WVLeftPaneStackWidth', (leftPaneWidth + relativeDelta + lastLeftVerticalDividerDelta).toString());
        lastLeftVerticalDividerDelta = lastLeftVerticalDividerDelta + relativeDelta;
        leftVerticalDividerDelta = 0;
        document.removeEventListener('mousemove', handleLeftVerticalMove);
        document.removeEventListener('mouseup', handleLeftVerticalUp);
        var offsetMinimizePanel = 0;
        if (exports.leftMinimizedPaneStack.isVisible) {
            offsetMinimizePanel += 20;
        }
        exports.canvasWrapper.style.left = 'calc(' + (leftPaneWidth + lastLeftVerticalDividerDelta) + '% + ' + offsetMinimizePanel + 'px)';
        if (exports.rightMinimizedPaneStack.isVisible) {
            offsetMinimizePanel += 20;
        }
        var width = wvDock.clientWidth - exports.leftWrapper.clientWidth - exports.rightWrapper.clientWidth - offsetMinimizePanel;
        var height = wvDock.clientHeight;
        dividerInMouseDrag = false;
        resizeClient(width, height);
        exports.canvasWrapper.style.width = width + 'px';
    }
}
function handleRightVerticalDown(e) {
    if (!dividerInTouchDrag) {
        e.preventDefault();
        rightVerticalDividerDelta = e.pageX;
        dividerInMouseDrag = true;
        document.addEventListener('mousemove', handleRightVerticalMove);
        document.addEventListener('mouseup', handleRightVerticalUp);
    }
}
function handleRightVerticalMove(e) {
    if (dividerInMouseDrag) {
        var delta = rightVerticalDividerDelta - e.pageX;
        var relativeDelta = delta / wvDock.clientWidth * 100;
        exports.rightWrapper.style.width = (rightPaneWidth + relativeDelta + lastRightVerticalDividerDelta) + '%';
    }
}
function handleRightVerticalUp(e) {
    if (dividerInMouseDrag) {
        var relativeDelta = (rightVerticalDividerDelta - e.pageX) / wvDock.clientWidth * 100;
        localStorage.setItem('WVRightPaneStackWidth', (rightPaneWidth + relativeDelta + lastRightVerticalDividerDelta).toString());
        lastRightVerticalDividerDelta = lastRightVerticalDividerDelta + relativeDelta;
        rightVerticalDividerDelta = 0;
        document.removeEventListener('mousemove', handleRightVerticalMove);
        document.removeEventListener('mouseup', handleRightVerticalUp);
        var offsetMinimizePanel = 0;
        if (exports.leftMinimizedPaneStack.isVisible) {
            offsetMinimizePanel += 20;
        }
        if (exports.rightMinimizedPaneStack.isVisible) {
            offsetMinimizePanel += 20;
        }
        var width = wvDock.clientWidth - exports.leftWrapper.clientWidth - exports.rightWrapper.clientWidth - offsetMinimizePanel;
        var height = wvDock.clientHeight;
        dividerInMouseDrag = false;
        exports.canvasWrapper.style.width = width + 'px';
        resizeClient(width, height);
    }
}
function dropPane(e, pos) {
    e.preventDefault();
    var paneArrLength = app_states_1.appStates.panes.length;
    for (var i = 0; i < paneArrLength; i++) {
        if (app_states_1.appStates.panes[i].paneId === exports.draggedPane) {
            if (app_states_1.appStates.panes[i].pos === pos) {
                closePane(exports.draggedPane);
                continue;
            }
            app_states_1.appStates.panes[i].pos = pos;
        }
    }
}
function closePane(paneId, poppedOut) {
    if (poppedOut === void 0) { poppedOut = false; }
    var length = app_states_1.appStates.panes.length;
    for (var i = 0; i < length; i++) {
        if (app_states_1.appStates.panes[i].paneId === paneId) {
            var pane = app_states_1.appStates.panes[i];
            if (pane.visible) {
                switch (pane.pos) {
                    case 1:
                        exports.leftUpperStack.closePaneById(pane.paneId, pane.minimized, poppedOut);
                        break;
                    case 2:
                        exports.leftLowerStack.closePaneById(pane.paneId, pane.minimized, poppedOut);
                        break;
                    case 3:
                        exports.rightUpperStack.closePaneById(pane.paneId, pane.minimized, poppedOut);
                        break;
                    case 4:
                        exports.rightLowerStack.closePaneById(pane.paneId, pane.minimized, poppedOut);
                        break;
                }
            }
        }
    }
}
exports.closePane = closePane;
function paneResize(clientResize) {
    if (clientResize === void 0) { clientResize = false; }
    var offsetMinimizePanel = 0;
    if (exports.leftMinimizedPaneStack.isVisible) {
        offsetMinimizePanel += 20;
    }
    exports.canvasWrapper.style.left = 'calc(' + (leftPaneWidth + lastLeftVerticalDividerDelta) + '% + ' + offsetMinimizePanel + 'px)';
    if (!exports.leftUpperStack.isVisible && exports.leftLowerStack.isVisible) {
        exports.leftLowerStack.resize('100%', false);
    }
    else if (exports.leftUpperStack.isVisible && !exports.leftLowerStack.isVisible) {
        exports.leftUpperStack.resize('100%', false);
    }
    if (!exports.rightUpperStack.isVisible && exports.rightLowerStack.isVisible) {
        exports.rightLowerStack.resize('100%', false);
    }
    else if (exports.rightUpperStack.isVisible && !exports.rightLowerStack.isVisible) {
        exports.rightUpperStack.resize('100%', false);
    }
    if (!exports.leftUpperStack.isVisible && !exports.leftLowerStack.isVisible) {
        $(exports.leftWrapper).hide();
        exports.canvasWrapper.style.left = 'calc(0% + ' + offsetMinimizePanel + 'px)';
    }
    if (!exports.rightUpperStack.isVisible && !exports.rightLowerStack.isVisible) {
        $(exports.rightWrapper).hide();
    }
    if (exports.leftUpperStack.isVisible || exports.leftLowerStack.isVisible) {
        $(exports.leftWrapper).show();
    }
    if (exports.rightUpperStack.isVisible || exports.rightLowerStack.isVisible) {
        $(exports.rightWrapper).show();
    }
    if (exports.rightMinimizedPaneStack.isVisible) {
        offsetMinimizePanel += 20;
    }
    var width = wvDock.clientWidth - exports.leftWrapper.clientWidth - exports.rightWrapper.clientWidth - offsetMinimizePanel;
    var height = wvDock.clientHeight;
    exports.canvasWrapper.style.width = width + 'px';
    resizeClient(width, height, clientResize);
}
exports.paneResize = paneResize;
function activateInteraction(client, action) {
    var s = '<Call Method="ActivateInteraction"><Interaction>' + action + '</Interaction></Call>';
    client.command.executeXMLAsync(s);
}
function deactivateInteraction(client, mode) {
    if (mode === void 0) { mode = 'AllInteractions_'; }
    var modeCategory = mode.split('_')[0];
    var categoryToDeactivate = 'Deactivate_' + modeCategory;
    var s = '<Call Method="ActivateInteraction"><Interaction>' + categoryToDeactivate + '</Interaction></Call>';
    client.command.executeXMLAsync(s);
}
exports.deactivateInteraction = deactivateInteraction;
function handleActivateInteraction(client, mode, interactionArray) {
    var interaction = getInteractionForPane(mode, interactionArray);
    if (app_states_1.appStates.interactionMode.indexOf(interaction) === -1) {
        activateInteraction(client, interaction);
    }
    else {
        deactivateInteraction(client, interaction);
    }
}
function getInteractionForPane(paneId, interActionArray) {
    var interactionPrefix;
    switch (paneId) {
        case 'wv-measurement':
            interactionPrefix = 'Measurement';
            break;
        case 'wv-section':
            interactionPrefix = 'Section';
            break;
        case 'wv-transform':
            interactionPrefix = 'Transformation';
            break;
        case 'wv-draftangle':
            interactionPrefix = 'DraftAngle';
            break;
        case 'wv-markup':
        case 'wv-markup-reduced':
            interactionPrefix = 'Markup';
            break;
        case 'wv-flythrough':
            interactionPrefix = 'Flythrough';
            break;
        default:
            interactionPrefix = undefined;
            break;
    }
    var interaction = interactionPrefix;
    for (var i = 0; i < interActionArray.length; i++) {
        var modePrefix = interActionArray[i].split('_')[0];
        if (modePrefix === interactionPrefix) {
            interaction = interActionArray[i];
        }
    }
    return interaction;
}
exports.getInteractionForPane = getInteractionForPane;
function popout(paneId, langId) {
    var uid = app_states_1.appStates.sessionUID;
    app_states_1.appStates.popoutPanes.push(paneId);
    var panesArr = app_states_1.appStates.panes;
    var panesLength = panesArr.length;
    var width;
    var height;
    var leftWidth = localStorage.getItem('WVLeftPaneStackWidth') !== null ? parseFloat(localStorage.getItem('WVLeftPaneStackWidth')) : leftPaneWidth;
    var rightWidht = localStorage.getItem('WVRightPaneStackWidth') !== null ? parseFloat(localStorage.getItem('WVRightPaneStackWidth')) : rightPaneWidth;
    var leftHeight = localStorage.getItem('WVLeftPaneStackHeight') !== null ? parseFloat(localStorage.getItem('WVLeftPaneStackHeight')) : leftPaneHeight;
    var rightHeight = localStorage.getItem('WVRightPaneStackHeight') !== null ? parseFloat(localStorage.getItem('WVRightPaneStackHeight')) : rightPaneHeight;
    for (var i = 0; i < panesLength; i++) {
        if (panesArr[i].paneId === paneId) {
            var pos = panesArr[i].pos;
            switch (pos) {
                case 1:
                    width = leftWidth;
                    height = leftHeight;
                    break;
                case 2:
                    width = leftWidth;
                    height = 100 - leftHeight;
                    break;
                case 3:
                    width = rightWidht;
                    height = rightHeight;
                    break;
                case 4:
                    width = rightWidht;
                    height = 100 - rightHeight;
                    break;
            }
        }
    }
    width = document.body.offsetWidth * (width / 100);
    height = document.body.offsetHeight * (height / 100);
    if (paneId === 'wv-modeltree') {
        var newWindow_1 = window.open("popout-index.html?pane=" + paneId + "&langId=" + langId + "&uid=" + uid, "", "location=no, titlebar=no, menubar=no, status=no, left=30, height=" + height + ", width=" + width);
        newWindow_1.focus();
        app_states_1.appStates.popedOutWindows.push(newWindow_1);
        vsClient.on('GetNodeTooltip', getTreeTooltip);
        newWindow_1.onload = function (e) {
            newWindow_1.onbeforeunload = function (e) {
                var index = app_states_1.appStates.popoutPanes.indexOf(paneId);
                app_states_1.appStates.popedOutWindows.splice(index, 1);
                app_states_1.appStates.popoutPanes.splice(index, 1);
                prependPane(paneId);
                localStorage.removeItem('WVSelectedNodes' + uid);
                localStorage.removeItem('WVCommand' + uid);
                vsClient.removeListener('GetNodeTooltip', getTreeTooltip);
                localStorage.removeItem('WVTreeTooltip' + uid);
            };
        };
        localStorage.setItem('WVTreeViewUpdated' + uid, JSON.stringify(this.modeltreePane.treeItemsInfo));
    }
    else if (paneId === 'wv-views') {
        var newWindow_2 = window.open("popout-index.html?pane=" + paneId + "&langId=" + langId + "&uid=" + uid, "", "location=no, titlebar=no, menubar=no, status=no, left=30, height=" + height + ", width=" + width);
        newWindow_2.focus();
        app_states_1.appStates.popedOutWindows.push(newWindow_2);
        vsClient.on('ConfigurationViewChanged', changeViewOnPopout);
        vsClient.on('ConfigurationViewPlayStart', startViewPlayOnPopout);
        vsClient.on('ConfigurationViewPlayFinish', stopViewPlayOnPopout);
        var getConfigurationView_1 = '<Call Method="GetConfigurationViewInformation"><Image>true</Image></Call>';
        newWindow_2.onload = function (e) {
            newWindow_2.onbeforeunload = function (e) {
                var index = app_states_1.appStates.popoutPanes.indexOf(paneId);
                app_states_1.appStates.popedOutWindows.splice(index, 1);
                app_states_1.appStates.popoutPanes.splice(index, 1);
                prependPane(paneId);
                vsClient.removeListener('ConfigurationViewChanged', changeViewOnPopout);
                vsClient.removeListener('ConfigurationViewPlayStart', startViewPlayOnPopout);
                vsClient.removeListener('ConfigurationViewPlayFinish', stopViewPlayOnPopout);
                vsClient.command.executeXML(getConfigurationView_1);
                localStorage.removeItem('WVConfigurationViewInformation' + uid);
                localStorage.removeItem('WVActivateView' + uid);
                localStorage.removeItem('WVViewsData' + uid);
                localStorage.removeItem('WVConfigurationViewChanged' + uid);
                localStorage.removeItem('WVConfigurationPlayMode' + uid);
            };
        };
        vsClient.command.executeXML(getConfigurationView_1);
    }
    else if (paneId === 'wv-selections') {
        var newWindow_3 = window.open("popout-index.html?pane=" + paneId + "&langId=" + langId + "&uid=" + uid, "", "location=no, titlebar=no, menubar=no, status=no, left=30, height=" + height + ", width=" + width);
        newWindow_3.focus();
        app_states_1.appStates.popedOutWindows.push(newWindow_3);
        vsClient.on('SavedSelectionsChanged', selectionPaneChange);
        vsClient.on('GetSavedSelections', selectionPaneChange);
        vsClient.on('NewScene3D', newScene);
        vsClient.on('OpenFile', newScene);
        newWindow_3.onload = function (e) {
            var xml = '<Call Method="GetSavedSelections"></Call>';
            vsClient.command.executeXML(xml);
            newWindow_3.onbeforeunload = function (e) {
                var index = app_states_1.appStates.popoutPanes.indexOf(paneId);
                app_states_1.appStates.popedOutWindows.splice(index, 1);
                app_states_1.appStates.popoutPanes.splice(index, 1);
                prependPane(paneId);
                vsClient.removeListener('SavedSelectionsChanged', selectionPaneChange);
                vsClient.removeListener('GetSavedSelections', selectionPaneChange);
                vsClient.removeListener('NewScene3D', newScene);
                vsClient.removeListener('OpenFile', newScene);
                localStorage.removeItem('WVSaveNodes' + app_states_1.appStates.sessionUID);
                localStorage.removeItem('WVNewScene' + app_states_1.appStates.sessionUID);
            };
        };
    }
    else {
        var templateName = mapPaneIdToTemplate(paneId);
        var template = '<Call Method="GetTemplate"><Type>' + templateName + '</Type></Call>';
        vsClient.command.executeXML(template);
        vsClient.once('GetTemplate.' + templateName, function (response) {
            vsClient.command.executeXML('<Call Method="GetSceneSettings"></Call>');
            vsClient.once('GetSceneSettings', function (e) {
                var templateObj = response['Source']['Template'];
                localStorage.setItem('WV' + paneId + uid, JSON.stringify(templateObj));
                if (templateObj['Event']) {
                    if (paneId === 'wv-filter') {
                        templateObj['Event'] = 'GetAllGeometryColors';
                    }
                    vsClient.on(templateObj['Event'], registerEventForPopouts);
                }
                var newWindow = window.open("popout-index.html?pane=" + paneId + "&langId=" + langId + "&uid=" + uid, "", "location=no, titlebar=no, menubar=no, status=no, left=30, height=" + height + ", width=" + width);
                newWindow.focus();
                app_states_1.appStates.popedOutWindows.push(newWindow);
                newWindow.onload = function (e) {
                    if (paneId === 'wv-explode') {
                        var initExplodeValues = {
                            MaxDepth: exports.explodePane.maxExplodeSteps,
                            ExplodedSteps: exports.explodePane.explodeStep,
                            ExplodeDistance: exports.explodePane.explodeDistance
                        };
                        vsClient.addListener('GetMaxTreeDepth', getMaxExplodeDepth);
                        localStorage.setItem('WVInitialExplode' + app_states_1.appStates.sessionUID, JSON.stringify(initExplodeValues));
                    }
                    newWindow.onbeforeunload = function (e) {
                        var index = app_states_1.appStates.popoutPanes.indexOf(paneId);
                        app_states_1.appStates.popedOutWindows.splice(index, 1);
                        app_states_1.appStates.popoutPanes.splice(index, 1);
                        prependPane(paneId);
                        vsClient.removeListener(templateObj['Event'], registerEventForPopouts);
                        vsClient.removeListener('GetMaxTreeDepth', getMaxExplodeDepth);
                        localStorage.removeItem('WV' + paneId + uid);
                        localStorage.removeItem('WV' + e['Type'] + uid);
                        if (paneId === 'wv-bom') {
                            vsClient.removeListener('GetBillOfMaterial', getBOM);
                            localStorage.removeItem('WVBOMReceived' + uid);
                            vsClient.removeListener('GenerateBOMCalloutIds', generateBOMIds);
                            localStorage.removeItem('WVBOMIdsCreated' + uid);
                        }
                        else if (paneId === 'wv-clash') {
                            vsClient.removeListener('ClashResultUpdated', getClash);
                            localStorage.removeItem('WVClashComputed' + uid);
                        }
                    };
                };
            });
        });
        if (paneId === 'wv-bom') {
            vsClient.addListener('GetBillOfMaterial', getBOM);
            vsClient.addListener('GenerateBOMCalloutIds', generateBOMIds);
        }
        else if (paneId === 'wv-clash') {
            vsClient.addListener('ClashResultUpdated', getClash);
        }
    }
    closePane(paneId, true);
}
exports.popout = popout;
function getMaxExplodeDepth(res) {
    localStorage.setItem('WVMaxExplodeDepth' + app_states_1.appStates.sessionUID, JSON.stringify(res));
}
function getBOM(res) {
    localStorage.setItem('WVBOMReceived' + app_states_1.appStates.sessionUID, JSON.stringify(res));
}
function getClash(res) {
    localStorage.setItem('WVClashComputed' + app_states_1.appStates.sessionUID, JSON.stringify(res));
}
function generateBOMIds(res) {
    localStorage.setItem('WVBOMIdsCreated' + app_states_1.appStates.sessionUID, JSON.stringify(res));
}
function getTreeTooltip(res) {
    localStorage.setItem('WVTreeTooltip' + app_states_1.appStates.sessionUID, JSON.stringify(res));
}
function selectionPaneChange(res) {
    localStorage.setItem('WVSaveNodes' + app_states_1.appStates.sessionUID, JSON.stringify(res));
}
function changeViewOnPopout(event) {
    localStorage.setItem('WVConfigurationViewChanged' + app_states_1.appStates.sessionUID, JSON.stringify(event));
}
function startViewPlayOnPopout(event) {
    localStorage.setItem('WVConfigurationPlayMode' + app_states_1.appStates.sessionUID, JSON.stringify(event));
}
function stopViewPlayOnPopout(event) {
    var stopMode = { Stop: true };
    localStorage.setItem('WVConfigurationPlayMode' + app_states_1.appStates.sessionUID, JSON.stringify(stopMode));
}
function newScene(res) {
    localStorage.setItem('WVNewScene' + app_states_1.appStates.sessionUID, JSON.stringify(res));
}
function registerEventForPopouts(e) {
    if (e['Method'] && e['Method'] === 'GetAllGeometryColors') {
        e['Type'] = 'GetAllGeometryColors';
    }
    localStorage.setItem('WV' + e['Type'] + app_states_1.appStates.sessionUID, JSON.stringify(e));
}
function mapCountry(lang) {
    switch (lang) {
        case 'ENU':
            return 'en';
        case 'DEU':
            return 'de';
        case 'ITA':
            return 'it';
        case 'ESP':
            return 'es';
        case 'FRA':
            return 'fr';
        case 'KOR':
            return 'kor';
        case 'CHS':
            return 'zh';
        case 'JPN':
            return 'ja';
        default:
            return 'en';
    }
}
exports.mapCountry = mapCountry;
function mapPaneIdToTemplate(paneId) {
    switch (paneId) {
        case 'wv-settings':
            return 'SettingsPane';
        case 'wv-modeltree':
            return 'Custom_ModelTree';
        case 'wv-views':
            return 'Custom_Views';
        case 'wv-distortion':
            return 'DistortionPane';
        case 'wv-draftangle':
            return 'DraftAnglePane';
        case 'wv-exactcompare':
            return 'ExactComparePane';
        case 'wv-filter':
            return 'FilterPane';
        case 'wv-flythrough':
            return 'FlyThroughPane';
        case 'wv-markup':
            return 'MarkupPane';
        case 'wv-markup-reduced':
            return 'MarkupPane_Reduced';
        case 'wv-measurement':
            return 'MeasurementPane';
        case 'wv-mirror':
            return 'MirrorPane';
        case 'wv-projectedarea':
            return 'ProjectedAreaPane';
        case 'wv-properties':
            return 'PropertiesPane';
        case 'wv-quickcompare':
            return 'QuickComparePane';
        case 'wv-section':
            return 'SectionPane';
        case 'wv-textsearch':
            return 'TextSearchPane';
        case 'wv-transform':
            return 'TransformPane';
        case 'wv-visibilitytest':
            return 'VisibilityTest';
        case 'wv-wallthickness':
            return 'WallThicknessPane';
        case 'wv-drillhole':
            return 'DrillholePane';
        case 'wv-neutralaxis':
            return 'NeutralAxisPane';
        case 'wv-neighbourhoodsearch':
            return 'NeighbourhoodSearchPane';
        case 'wv-appsettings':
            return 'Custom_AppSettings';
        case 'wv-bom':
            return 'BOMPane';
        case 'wv-callout':
            return 'CalloutPane';
        case 'wv-split':
            return 'SplitPane';
        case 'wv-explode':
            return 'ExplodePane';
        case 'wv-animation':
            return 'AnimationPane';
        case 'wv-geometry-tools':
            return 'GeometryToolsPane';
        case 'wv-clash':
            return 'ClashPane';
        case 'wv-bandanalysis':
            return 'BandAnalysisPane';
    }
}
exports.mapPaneIdToTemplate = mapPaneIdToTemplate;


/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var app_states_1 = __webpack_require__(4);
var app_settings_1 = __webpack_require__(9);
var PaneTemplate = (function () {
    function PaneTemplate(paneId, langId) {
        this.lang = 'ENU';
        this.hasPresets = false;
        this.init = false;
        this.noAdapter = false;
        this.update = function (param) {
        };
        this.addEventListener = function () {
        };
        this.langId = langId;
        this.paneId = paneId;
        this.wrapperEl = document.createElement('div');
        this.wrapperEl.id = paneId;
        this.wrapperEl.classList.add('pane');
        this.wrapperEl.classList.add(paneId);
        this.wrapperEl.style.height = '100%';
        try {
            if (_PanePresets[paneId]) {
                this.hasPresets = true;
            }
        }
        catch (e) { }
    }
    PaneTemplate.prototype.setStack = function (stack) {
        this.stack = stack;
        this.wrapperEl.style.width = '100%';
    };
    PaneTemplate.prototype.registerInStack = function (contentArea, minimizedTable) {
        $(contentArea).empty();
        this.stack.checkForPresets(this.paneId, minimizedTable);
        this.mount = contentArea;
        this.mount.appendChild(this.wrapperEl);
        var prevEvent = this.searchForEvent(this.paneId);
        if (prevEvent && (this.adapter || this.noAdapter)) {
            this.update(prevEvent);
        }
        else if ((this.adapter || this.noAdapter)) {
            this.update();
        }
        if (app_states_1.appStates.clientInitialized) {
            if (((this.lang !== app_settings_1.settings.lang) || !this.init) && (this.adapter || this.noAdapter)) {
                this.changeLang(app_settings_1.settings.lang);
                var xml = '<Call Method="GetSceneSettings"></Call>';
                vsClient.command.executeXML(xml);
            }
        }
        this.addMethods();
        if (this.paneId === 'wv-modeltree') {
            this.addEventListener();
        }
        this.lang = app_settings_1.settings.lang;
        this.init = true;
    };
    PaneTemplate.prototype.searchForEvent = function (paneId) {
        var prevEvent;
        switch (paneId) {
            case 'wv-properties':
                prevEvent = localStorage.getItem('WVNodePropertiesChanged' + app_states_1.appStates.sessionUID);
                if (prevEvent !== null) {
                    return JSON.parse(prevEvent);
                }
                else {
                    return undefined;
                }
            case 'wv-measurement':
                prevEvent = localStorage.getItem('WVMeasurementChanged' + app_states_1.appStates.sessionUID);
                if (prevEvent !== null) {
                    return JSON.parse(prevEvent);
                }
                else {
                    return undefined;
                }
            case 'wv-transform':
                prevEvent = localStorage.getItem('WVTransformChanged' + app_states_1.appStates.sessionUID);
                if (prevEvent !== null) {
                    return JSON.parse(prevEvent);
                }
                else {
                    return undefined;
                }
            case 'wv-section':
                prevEvent = localStorage.getItem('WVSectionChanged' + app_states_1.appStates.sessionUID);
                if (prevEvent !== null) {
                    return JSON.parse(prevEvent);
                }
                else {
                    return undefined;
                }
            case 'wv-textsearch':
                prevEvent = localStorage.getItem('WVTextSearchChanged' + app_states_1.appStates.sessionUID);
                if (prevEvent !== null) {
                    return JSON.parse(prevEvent);
                }
                else {
                    return undefined;
                }
            case 'wv-draftangle':
                prevEvent = localStorage.getItem('WVDraftAngleChanged' + app_states_1.appStates.sessionUID);
                if (prevEvent !== null) {
                    return JSON.parse(prevEvent);
                }
                else {
                    return undefined;
                }
            case 'wv-neighbourhoodsearch':
                prevEvent = localStorage.getItem('WVNeighbourhoodSearchChanged' + app_states_1.appStates.sessionUID);
                if (prevEvent !== null) {
                    return JSON.parse(prevEvent);
                }
                else {
                    return undefined;
                }
            case 'wv-projectedarea':
                prevEvent = localStorage.getItem('WVProjectedAreaChanged' + app_states_1.appStates.sessionUID);
                if (prevEvent !== null) {
                    return JSON.parse(prevEvent);
                }
                else {
                    return undefined;
                }
            case 'wv-wallthickness':
                prevEvent = localStorage.getItem('WVWallthicknessValuesChanged' + app_states_1.appStates.sessionUID);
                if (prevEvent !== null) {
                    return JSON.parse(prevEvent);
                }
                else {
                    return undefined;
                }
            default:
                return undefined;
        }
    };
    return PaneTemplate;
}());
exports.PaneTemplate = PaneTemplate;


/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var item_1 = __webpack_require__(98);
exports.Item = item_1.Item;
var adapter_1 = __webpack_require__(97);
exports.PaneAdapter = adapter_1.PaneAdapter;
var widgets_1 = __webpack_require__(11);
exports.Visual = widgets_1.Visual;
exports.Folder = widgets_1.Folder;
exports.Entry = widgets_1.Entry;
exports.TextBox = widgets_1.TextBox;
exports.Input = widgets_1.Input;
exports.Checkbox = widgets_1.Checkbox;
exports.Flag = widgets_1.Flag;
exports.Button = widgets_1.Button;
exports.PropertyAttributes = widgets_1.PropertyAttributes;
exports.Select = widgets_1.Select;
exports.ColorPicker = widgets_1.ColorPicker;
exports.Slider = widgets_1.Slider;
exports.KeyValue = widgets_1.KeyValue;
function modifySettings(settings, path, value) {
    var current = settings;
    for (var i = 0; i < path.length - 1; i++) {
        current = current[path[i]];
    }
    current[path[i]] = value;
}
exports.modifySettings = modifySettings;


/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
function parseXML(str) {
    var parser = new DOMParser();
    var doc = parser.parseFromString(str, 'application/xml');
    var result = {
        '__text__': '',
        '__ordinal__': []
    };
    var root = doc.documentElement;
    function traverse(e, parentObj) {
        var childObj = undefined;
        childObj = {
            '__text__': '',
            '__ordinal__': []
        };
        for (var i = 0; i < e.attributes.length; i++) {
            var key = e.attributes[i].name;
            childObj[key] = e.attributes[i].value;
            childObj['__ordinal__'].push(key);
        }
        if (e.childNodes.length == 1 && e.childNodes[0].nodeType === 3) {
            var textContent = (e.textContent).trim();
            if (e.attributes.length > 0) {
                childObj['__text__'] = textContent;
            }
            else {
                childObj = textContent;
            }
        }
        else if (e.childNodes.length == 0 && e.attributes.length == 0) {
            childObj = '';
        }
        if (parentObj) {
            if (parentObj[e.nodeName]) {
                if (Array.isArray(parentObj[e.nodeName])) {
                    parentObj[e.nodeName].push(childObj);
                    parentObj['__ordinal__'].push(e.nodeName);
                }
                else {
                    var lastObj = parentObj[e.nodeName];
                    parentObj[e.nodeName] = [];
                    parentObj[e.nodeName].push(lastObj);
                    parentObj[e.nodeName].push(childObj);
                    parentObj['__ordinal__'].push(e.nodeName);
                }
            }
            else {
                if (typeof parentObj === "string") {
                    parentObj = childObj;
                }
                else {
                    if (e.nodeName === 'Option') {
                        parentObj[e.nodeName] = [];
                        parentObj[e.nodeName].push(childObj);
                    }
                    else {
                        parentObj[e.nodeName] = childObj;
                    }
                    parentObj['__ordinal__'].push(e.nodeName);
                }
            }
        }
        for (var i = 0; i < e.childNodes.length; i++) {
            var children = e.childNodes;
            var childNode = children.item(i);
            if (childNode instanceof Element) {
                traverse(childNode, childObj);
            }
        }
    }
    traverse(root, result);
    return result;
}
exports.parseXML = parseXML;
function createXMLNode(path, attrs) {
    var doc = document.implementation.createDocument(null, '', null);
    var parentElement = doc;
    var currentElement;
    for (var _i = 0, path_1 = path; _i < path_1.length; _i++) {
        var pathName = path_1[_i];
        currentElement = doc.createElement(pathName);
        parentElement.appendChild(currentElement);
        parentElement = currentElement;
    }
    if (attrs.length > 0) {
        for (var i = 0; i < attrs.length; i++) {
            var name_val = attrs[i].split('=');
            var name_1 = name_val[0];
            var value = name_val[1];
            doc.firstElementChild.setAttribute(name_1, value);
        }
    }
    return doc;
}
function serializeWithValue(settingsPath, value, attrs) {
    if (attrs === void 0) { attrs = []; }
    var doc = createXMLNode(settingsPath, attrs);
    var q = settingsPath.join(' ');
    var element = doc.querySelector(q);
    element.textContent = value;
    var serializer = new XMLSerializer();
    return serializer.serializeToString(doc);
}
exports.serializeWithValue = serializeWithValue;


/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var AppStates = (function () {
    function AppStates() {
        this.VisShareSpec = "";
        this.ribbonWidth = 0;
        this.ribbonAvailable = 0;
        this.ribbonVis = true;
        this.fullScreenMode = false;
        this.mainColor = 'rgb(214, 124, 28)';
        this.clientInitialized = false;
        this.fileLoaded = false;
        this.nodesSelected = false;
        this.selectionMode = 'Select';
        this.interactionMode = [];
        this.lastInteractionModes = [];
        this.renderingModes = [];
        this.pageCount = '';
        this.mouseActive = false;
        this.mouseLeftButtonDown = false;
        this.mouseLeftButtonMode = 'RectZoom';
        this.mouseRightButtonMode = 'Rotate';
        this.mouseMiddleButtonMode = 'Pan';
        this.drawRect = true;
        this.touchActive = false;
        this.touchGestureActive = false;
        this.touchStatus = 'cancel';
        this.ongoingTouches = [];
        this.touchDist = -1;
        this.touchMid = [];
        this.lastGestureDistance = 0;
        this.lastGestureDelta = 0;
        this.lastGestureCenterX = 0;
        this.lastGestureCenterY = 0;
        this.lastMouseX = 0;
        this.lastMouseY = 0;
        this.activePath = '';
        this.panes = [
            { paneId: 'wv-modeltree', pos: 1, minimized: false, visible: true },
            { paneId: 'wv-views', pos: 1, minimized: false, visible: true },
            { paneId: 'wv-properties', pos: 2, minimized: false, visible: true }
        ];
        this.defaultPanes = [];
        this.containersChanged = false;
        this.commandPaneOpened = false;
        this.lockPanes = false;
        this.popoutPanes = [];
        this.popedOutWindows = [];
        this.preventGlobalKeyEvents = false;
        this.qsMode = false;
        this.aboutLinks = [
            "https://viewer.kisters.de/en/kisters-products/3dviewstation-webviewer.html",
            "https://viewer.kisters.de/help/webviewer",
            "http://viewer.kisters.de/en/news/news.html",
            "https://viewer.kisters.de/en/blog.html",
            "https://www.youtube.com/user/KistersViewer",
            "https://twitter.com/KistersViewer",
            "https://www.facebook.com/KistersViewer"
        ];
        this.version = '';
        this.paneHelpLinks = {
            'wv-views': '3dvs_wv_tut_functions_views.php',
            'wv-draftangle': '3dvs_wv_tut_functions_draft.php',
            'wv-exactcompare': '3dvs_wv_tut_functions_comparison.php',
            'wv-filter': '3dvs_wv_tut_functions_filter.php',
            'wv-flythrough': '3dvs_wv_tut_functions_flythroughmode.php',
            'wv-markup': '3dvs_wv_tut_functions_annotations.php',
            'wv-markup-reduced': '3dvs_wv_tut_functions_annotations.php',
            'wv-measurement': '3dvs_wv_tut_functions_measurement.php',
            'wv-mirror': '3dvs_wv_tut_functions_transformations.php',
            'wv-projectedarea': '3dvs_wv_tut_functions_projectedarea.php',
            'wv-properties': '3dvs_wv_tut_functions_propertiesselectedobjects.php',
            'wv-quickcompare': '3dvs_wv_tut_functions_comparison.php',
            'wv-section': '3dvs_wv_tut_functions_section.php',
            'wv-transform': '3dvs_wv_tut_functions_transformations.php',
            'wv-wallthickness': '3dvs_wv_tut_functions_wallthicknessheatmap.php',
            'wv-neutralaxis': '3dvs_wv_tut_functions_neutralaxis.php',
            'wv-neighbourhoodsearch': '3dvs_wv_tut_functions_neighborhoodsearch.php',
            'wv-bom': '3dvs_wv_tut_functions_techdocandbom_bom.php',
            'wv-callout': '3dvs_wv_tut_functions_techdocandbom_callouts.php',
            'wv-explode': '3dvs_wv_tut_functions_transformations.php',
            'wv-clash': '3dvs_wv_tut_functions_clashdetection.php',
            'wv-selections': '3dvs_wv_tut_functions_savingselections.php'
        };
    }
    AppStates.prototype.reset = function () {
        this.selectionMode = 'Select';
        this.interactionMode = [];
        this.renderingModes = [];
        this.pageCount = '';
        this.lastInteractionModes = [];
        this.preventGlobalKeyEvents = false;
        this.resetMouse();
        this.resetTouch();
    };
    AppStates.prototype.resetMouse = function () {
        this.mouseActive = false;
        this.mouseLeftButtonDown = false;
        this.mouseLeftButtonMode = 'RectZoom';
    };
    AppStates.prototype.resetTouch = function () {
        this.touchActive = false;
        this.touchGestureActive = false;
        this.touchStatus = 'cancel';
        this.ongoingTouches = [];
        this.touchDist = -1;
        this.touchMid = [];
        this.lastGestureDistance = 0;
        this.lastGestureDelta = 0;
        this.lastGestureCenterX = 0;
        this.lastGestureCenterY = 0;
    };
    return AppStates;
}());
exports.appStates = new AppStates();


/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Retrieve the Unicode code point at the specified index in the specified
 * string.
 *
 * @param {string} str The string from which to retrieve the Unicode code
 *                     point.
 * @param {number} index The specified index.
 *
 * @returns {number} The Unicode code point at the specified position.
 *
 * @private
 */
function getCodePoint(str, index) {
    var size = str.length;
    if (index < 0 || index >= size) {
        return undefined;
    }
    var first = str.charCodeAt(index);
    if (first >= 0xD800 && first <= 0xDBFF && size > index + 1) {
        var second = str.charCodeAt(index + 1);
        if (second >= 0xDC00 && second <= 0xDFFF) {
            return (first - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;
        }
    }
    return first;
}
exports.getCodePoint = getCodePoint;
/**
 * Determines whether a number is an integer.
 *
 * @param {number} value The number to check.
 *
 * @returns {boolean} Whether or not the number is an integer.
 *
 * @private
 */
function isInteger(value) {
    return typeof value === "number" &&
        isFinite(value) &&
        Math.floor(value) === value;
}
exports.isInteger = isInteger;
/**
 * Returns true if the specified value are of any of the specified types, as
 * determined by the Object.prototype.toString.call function.
 *
 * @param {*} val The specified value.
 * @param {...string[]} types The specified types.
 *
 * @returns {boolean} Whether or not the specified value are of any of the
 *                    specified types.
 *
 * @private
 */
function isType(val) {
    var types = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        types[_i - 1] = arguments[_i];
    }
    for (var _a = 0, types_1 = types; _a < types_1.length; _a++) {
        var type = types_1[_a];
        if (Object.prototype.toString.call(val) === "[object " + type + "]") {
            return true;
        }
    }
    return false;
}
exports.isType = isType;


/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var utils_1 = __webpack_require__(5);
/**
 * Represents an XML node.
 *
 * This class is the root class of the XML node hierarchy. It should not be
 * directly instantiated; one of its subclasses should be used instead.
 *
 * @protected
 */
var XmlNode = (function () {
    /**
     * Initializes a new instance of the {@link XmlNode} class.
     */
    function XmlNode() {
        this._parent = undefined;
        this._children = [];
    }
    Object.defineProperty(XmlNode.prototype, "parent", {
        /**
         * Gets the parent of this node.
         *
         * @returns {XmlNode} The parent of this node.
         */
        get: function () {
            return this._parent;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Gets this node's children.
     *
     * Throws an exception if this node cannot have any children. Consult the
     * appropriate subclass documentation for more details.
     *
     * @returns {XmlNode[]} This node's children.
     */
    XmlNode.prototype.children = function () {
        return this._children.slice();
    };
    /**
     * Inserts the specified node into this node's children at the specified
     * index. The node is not inserted if it is already present. If this node
     * already has a parent, it is removed from that parent.
     *
     * Throws an exception if this node cannot have any children, or if the
     * specified node cannot be added at the specified index. Consult the
     * appropriate subclass documentation for more details.
     *
     * @param {XmlNode} node   The node to insert.
     * @param {number} [index] The index at which to insert the node. Nodes at
     *                         or after the index are shifted to the right. If
     *                         no index is specified, the node is inserted at
     *                         the end.
     *
     * @returns {XmlNode} The node inserted into this node's children, or
     *                    undefined if no node was inserted.
     */
    XmlNode.prototype.insertChild = function (node, index) {
        if (index === void 0) { index = this._children.length; }
        if (!(node instanceof XmlNode)) {
            throw new TypeError("node should be an instance of XmlNode");
        }
        else if (!utils_1.isType(index, "Number") || !utils_1.isInteger(index)) {
            throw new TypeError("index should be an integer");
        }
        else if (index < 0 || index > this._children.length) {
            throw new RangeError("index should respect children array bounds");
        }
        if (this._children.indexOf(node) === -1) {
            if (!utils_1.isType(node.parent, "Undefined")) {
                node.parent.removeChild(node);
            }
            node._parent = this;
            this._children.splice(index, 0, node);
            return node;
        }
        return undefined;
    };
    /**
     * Gets the node that follows this one, or undefined if no such node
     * exists or if this node has no parent.
     *
     * @returns {XmlNode} The node that follows this one, or undefined if no
     *                    such node exists or if this node has no parent.
     */
    XmlNode.prototype.next = function () {
        if (utils_1.isType(this.parent, "Undefined")) {
            return undefined;
        }
        else if (this.parent._children.indexOf(this) ===
            this.parent._children.length - 1) {
            return undefined;
        }
        return this.parent._children[this.parent._children.indexOf(this) + 1];
    };
    /**
     * Gets the node that is previous to this one, or undefined if no such node
     * exists or if this node has no parent.
     *
     * @returns {XmlNode} The node that is previous to this one, or undefined
     *                    if no such node exists or if this node has no parent.
     */
    XmlNode.prototype.prev = function () {
        if (utils_1.isType(this.parent, "Undefined")) {
            return undefined;
        }
        else if (this.parent._children.indexOf(this) === 0) {
            return undefined;
        }
        return this.parent._children[this.parent._children.indexOf(this) - 1];
    };
    /**
     * Removes this node from its parent if this node has a parent.
     *
     * @returns {XmlNode} This node's parent, or undefined if it has no parent.
     */
    XmlNode.prototype.remove = function () {
        if (!utils_1.isType(this.parent, "Undefined")) {
            var parent_1 = this.parent;
            this.parent.removeChild(this);
            return parent_1;
        }
        return undefined;
    };
    /**
     * Removes the specified node from this node's children.
     *
     * Throws an exception if this node cannot have any children, or if the
     * specified node cannot be removed. Consult the appropriate subclass
     * documentation for more details.
     *
     * @param {XmlNode} node The node to remove.
     *
     * @returns {boolean} Whether a node was removed.
     */
    XmlNode.prototype.removeChild = function (node) {
        if (!(node instanceof XmlNode)) {
            throw new Error("node should be an instance of XmlNode");
        }
        var index = this._children.indexOf(node);
        if (index !== -1) {
            node._parent = undefined;
            this._children.splice(index, 1);
            return true;
        }
        return false;
    };
    /**
     * Removes the node at the specified index from this node's children.
     *
     * Throws an exception if this node cannot have any children, or if the
     * node at the specified index cannot be removed. Consult the appropriate
     * subclass documentation for more details.
     *
     * @param {number} index The index at which the node to be removed is
     *                       located.
     *
     * @returns {XmlNode} The node that was removed, or undefined if no node
     *                    was removed.
     */
    XmlNode.prototype.removeChildAtIndex = function (index) {
        if (!utils_1.isType(index, "Number") || !utils_1.isInteger(index)) {
            throw new TypeError("index should be a number");
        }
        else if (index < 0 || index >= this._children.length) {
            throw new RangeError("index should respect children array bounds");
        }
        var node = this._children[index];
        node._parent = undefined;
        this._children.splice(index, 1);
        return node;
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlNode.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        throw new Error("toString not implemented for XmlNode");
    };
    /**
     * Returns the root node of the current hierarchy. If this node has no
     * parent, this node itself is returned.
     *
     * @returns {XmlNode} The root node of the current hierarchy.
     */
    XmlNode.prototype.top = function () {
        if (utils_1.isType(this.parent, "Undefined")) {
            return this;
        }
        else {
            return this.parent.top();
        }
    };
    /**
     * Gets the parent of this node.
     *
     * @returns {XmlNode} The parent of this node.
     */
    XmlNode.prototype.up = function () {
        return this.parent;
    };
    return XmlNode;
}());
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlNode;


/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Verifies that the specified string only contains characters permitted by the
 * XML specification.
 *
 * @param {string} str The string to validate.
 *
 * @returns {boolean} Whether the specified string only contains characters
 *                    permitted by the XML specification.
 *
 * @private
 */
function validateChar(str) {
    var charRegex = "\\u0009|\\u000A|\\u000D|[\\u0020-\\uD7FF]";
    var surrogateCharRegex = "[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]";
    return new RegExp("^((" + charRegex + ")|(" + surrogateCharRegex + "))*$")
        .test(str);
}
exports.validateChar = validateChar;
/**
 * Verifies that the specified string only contains a single character, and
 * that this character is permitted by the XML specification.
 *
 * @param {string} str The string to validate.
 *
 * @returns {boolean} Whether the specified string only contains a single
 *                    character, and that this character is permitted by the
 *                    XML specification.
 *
 * @private
 */
function validateSingleChar(str) {
    if (str.length === 1) {
        return new RegExp("^\\u0009|\\u000A|\\u000D|[\\u0020-\\uD7FF]$")
            .test(str);
    }
    else if (str.length === 2) {
        return new RegExp("^[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]$").test(str);
    }
    else {
        return false;
    }
}
exports.validateSingleChar = validateSingleChar;
/**
 * Verifies that the specified string only contains characters permitted by the
 * XML specification for names.
 *
 * @param {string} str The string to validate.
 *
 * @returns {boolean} Whether the specified string only contains characters
 *                    permitted by the XML specification for names.
 *
 * @private
 */
function validateName(str) {
    if (str.length === 0) {
        return false;
    }
    var nameStartChar = ":|[A-Z]|_|[a-z]|[\\u00C0-\\u00D6]|[\\u00D8-\\u00F6]" +
        "|[\\u00F8-\\u02FF]|[\\u0370-\\u037D]|[\\u037F-\\u1FFF]"
        +
            "|[\\u200C-\\u200D]|[\\u2070-\\u218F]|[\\u2C00-\\u2FEF]"
        +
            "|[\\u3001-\\uD7FF]|[\\uF900-\\uFDCF]|[\\uFDF0-\\uFFFD]";
    var nameStartCharWithSurrogatePair = "[\\uD800-\\uDB7F][\\uDC00-\\uDFFF]";
    var nameChar = nameStartChar + "|-|\\.|[0-9]|\\u00B7|[\\u0300-\\u036F]" +
        "|[\\u203F-\\u2040]";
    var nameCharWithSurrogatePair = nameChar + "|" +
        nameStartCharWithSurrogatePair;
    if (new RegExp("^" + nameStartChar + "$").test(str.charAt(0))) {
        if (str.length === 1) {
            return true;
        }
        return new RegExp("^(" + nameCharWithSurrogatePair + ")+$")
            .test(str.substr(1));
    }
    else if (str.length >= 2) {
        if (new RegExp("^" + nameStartCharWithSurrogatePair + "$")
            .test(str.substr(0, 2))) {
            if (str.length === 2) {
                return true;
            }
            return new RegExp("^(" + nameCharWithSurrogatePair + ")+$")
                .test(str.substr(2));
        }
    }
    return false;
}
exports.validateName = validateName;


/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var WVTooltip = (function () {
    function WVTooltip(anchorEl) {
        var _this = this;
        this.attributesRow = [];
        this.attributes = [];
        this.orientation = 'top';
        this.triggerTime = 1000;
        this.isActive = false;
        this.anchorEl = anchorEl;
        this.wrapperEl = document.createElement('div');
        this.wrapperEl.className = 'webviewer-tooltip-wrapper';
        this.titleEl = document.createElement('span');
        this.titleEl.className = 'webviewer-tooltip-title';
        this.attributeWrapper = document.createElement('ul');
        this.attributeWrapper.className = 'webviewer-tooltip-attributes-wrapper';
        $(this.attributeWrapper).hide();
        this.wrapperEl.appendChild(this.titleEl);
        this.wrapperEl.appendChild(this.attributeWrapper);
        this.anchorEl.onmouseenter = function (e) {
            _this.isActive = true;
            setTimeout(function () {
                if (_this.isActive && document.getElementsByClassName('webviewer-tooltip-wrapper').length === 0) {
                    _this.show();
                }
                else if (_this.isActive) {
                    $('.webviewer-tooltip-wrapper').each(function () {
                        $(this).remove();
                    });
                    _this.show();
                }
            }, _this.triggerTime);
        };
        this.anchorEl.onmouseleave = function (e) {
            _this.isActive = false;
            _this.hide();
        };
    }
    WVTooltip.prototype.addAttribute = function (attribute) {
        if (attribute === "" || attribute === undefined) {
            return;
        }
        if (this.attributes.length === 0) {
            $(this.attributeWrapper).show();
        }
        var attributeRow = document.createElement('li');
        attributeRow.className = 'webviewer-tooltip-attribute';
        attributeRow.innerHTML = attribute.replace(/\\n/g, '\r');
        this.attributes.push(attribute);
        this.attributesRow.push(attributeRow);
        this.attributeWrapper.appendChild(attributeRow);
    };
    WVTooltip.prototype.show = function () {
        var topPos = this.anchorEl.getBoundingClientRect().top;
        if ((!this.title || this.title === "" || this.title === null) && this.attributesRow.length === 0 || topPos === 0) {
            return;
        }
        document.body.appendChild(this.wrapperEl);
        if (this.wrapperEl.offsetWidth + this.anchorEl.getBoundingClientRect().left > document.body.offsetWidth) {
            this.wrapperEl.style.left = document.body.offsetWidth - this.wrapperEl.offsetWidth + 'px';
        }
        else {
            this.wrapperEl.style.left = this.anchorEl.getBoundingClientRect().left + 'px';
        }
        var height = this.wrapperEl.offsetHeight;
        if (this.orientation === 'top') {
            if (topPos - height < 0) {
                this.wrapperEl.style.bottom = (document.body.offsetHeight - topPos - this.anchorEl.offsetHeight - 5) + 'px';
            }
            else {
                this.wrapperEl.style.bottom = (document.body.offsetHeight - topPos + 5) + 'px';
            }
        }
        else {
            if (topPos + height > document.body.offsetHeight) {
                this.wrapperEl.style.bottom = (document.body.offsetHeight - topPos + 5) + 'px';
            }
            else {
                this.wrapperEl.style.bottom = (document.body.offsetHeight - topPos - height - this.anchorEl.offsetHeight - 5) + 'px';
            }
        }
    };
    WVTooltip.prototype.hide = function () {
        $(this.wrapperEl).remove();
    };
    WVTooltip.prototype.setTitle = function (title) {
        this.title = title;
        this.titleEl.innerHTML = title ? title.replace(/\\n/g, '\r') : '';
    };
    WVTooltip.prototype.setOrientation = function (orientation) {
        this.orientation = orientation;
    };
    WVTooltip.prototype.setTriggerTime = function (triggerTime) {
        this.triggerTime = triggerTime;
    };
    WVTooltip.prototype.removeAttributes = function () {
        this.attributes = [];
        var length = this.attributesRow.length;
        for (var i = 0; i < length; i++) {
            $(this.attributesRow[i]).remove();
        }
        this.attributesRow = [];
        $(this.attributeWrapper).hide();
    };
    WVTooltip.prototype.setKey = function (key) {
        this.key = key;
    };
    return WVTooltip;
}());
exports.WVTooltip = WVTooltip;


/***/ }),
/* 9 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.settings = {
    lang: 'ENU',
    appId: 'wv-app',
    ribbonId: 'wv-ribbon',
    dockId: 'wv-dock',
    minWidth: 600,
    minHeight: 480,
    ribbon: {
        expandablesContainerId: 'wv-ribbon-expandables',
        dropdownsContainerId: 'wv-ribbon-dropdowns',
        dropdownItemHeight: 30,
        buttonWidth: 70,
        tabPageHeight: 90,
        buttonMouseHoverColor: 'rgb(132,203,234)',
        buttonHighlightColor: 'rgb(255, 198, 98)',
        buttonDefaultColor: ''
    },
};


/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var app_settings_1 = __webpack_require__(9);
var app_states_1 = __webpack_require__(4);
var tooltip_1 = __webpack_require__(8);
exports.initHightlightedButtons = [];
var WidgetType;
(function (WidgetType) {
    WidgetType[WidgetType["Button"] = 1] = "Button";
    WidgetType[WidgetType["ButtonLet"] = 2] = "ButtonLet";
    WidgetType[WidgetType["Dropdown"] = 3] = "Dropdown";
    WidgetType[WidgetType["Input"] = 4] = "Input";
    WidgetType[WidgetType["SplittedDropdown"] = 5] = "SplittedDropdown";
})(WidgetType = exports.WidgetType || (exports.WidgetType = {}));
var ribbonWidgets = {};
var paneWidgets = {};
var SVG_NS = 'http://www.w3.org/2000/svg';
var XLINK_NS = 'http://www.w3.org/1999/xlink';
function findPaneButton(paneId) {
    var widget = paneWidgets[paneId];
    if (widget && widget instanceof BaseButton) {
        return widget;
    }
    else {
        return undefined;
    }
}
exports.findPaneButton = findPaneButton;
function findButton(id) {
    var widget = ribbonWidgets[id];
    if (widget && widget instanceof BaseButton) {
        return widget;
    }
    else {
        return undefined;
    }
}
exports.findButton = findButton;
function findGroup(id) {
    var widget = ribbonWidgets[id];
    if (widget && widget instanceof Group) {
        return widget;
    }
    else {
        return null;
    }
}
exports.findGroup = findGroup;
function findDropdownItem(id) {
    var widget = ribbonWidgets[id];
    if (widget && widget instanceof DropdownItem) {
        return widget;
    }
    else {
        return null;
    }
}
exports.findDropdownItem = findDropdownItem;
function findDynamicDropdownItem(id) {
    var widget = ribbonWidgets[id];
    if (widget && widget instanceof DynamicDropdownItem) {
        return widget;
    }
    else {
        return null;
    }
}
exports.findDynamicDropdownItem = findDynamicDropdownItem;
function findInput(id) {
    var widget = ribbonWidgets[id];
    if (widget && widget instanceof Input) {
        return widget;
    }
    else {
        return null;
    }
}
exports.findInput = findInput;
function allocID(langId) {
    var lookupValue = ribbonWidgets[langId];
    var allocatedID = langId;
    var count = 0;
    while (lookupValue instanceof VisibleWidget) {
        count++;
        allocatedID = langId + "_" + count;
        lookupValue = ribbonWidgets[allocatedID];
    }
    return allocatedID;
}
var Widget = (function () {
    function Widget() {
    }
    return Widget;
}());
exports.Widget = Widget;
var VisibleWidget = (function (_super) {
    __extends(VisibleWidget, _super);
    function VisibleWidget(langId) {
        var _this = _super.call(this) || this;
        _this.visible = true;
        _this.langId = langId;
        _this.id = allocID(langId);
        ribbonWidgets[_this.id] = _this;
        try {
            if (_this.id in _functions && _functions[_this.id] === false) {
                _this.visible = false;
            }
        }
        catch (e) {
            _this.visible = true;
        }
        return _this;
    }
    Object.defineProperty(VisibleWidget.prototype, "text", {
        get: function () {
            var queryID = this.langId;
            if (_lang_data[queryID] && _lang_data[queryID][app_settings_1.settings.lang]) {
                return _lang_data[queryID][app_settings_1.settings.lang];
            }
            else if (_custom_lang_data && _custom_lang_data[queryID] && _custom_lang_data[queryID][app_settings_1.settings.lang]) {
                return _custom_lang_data[queryID][app_settings_1.settings.lang];
            }
            else if (_lang_data[queryID] && _lang_data[queryID]['ENU']) {
                return _lang_data[queryID]['ENU'];
            }
            else if (_custom_lang_data && _custom_lang_data[queryID] && _custom_lang_data[queryID]['ENU']) {
                return _custom_lang_data[queryID]['ENU'];
            }
            {
                return queryID;
            }
        },
        enumerable: true,
        configurable: true
    });
    return VisibleWidget;
}(Widget));
exports.VisibleWidget = VisibleWidget;
var BaseButton = (function (_super) {
    __extends(BaseButton, _super);
    function BaseButton(id) {
        var _this = _super.call(this, id) || this;
        _this.isHighlight = false;
        return _this;
    }
    BaseButton.prototype.setIconId = function (iconId) {
        this.iconId = iconId;
    };
    BaseButton.prototype.getIconId = function () {
        return this.iconId;
    };
    BaseButton.prototype.applyHighlight = function (isHighlight) {
        this.isHighlight = isHighlight;
        if (this.isHighlight) {
            this.el.classList.add('ribbon-button-highlighted');
        }
        else {
            this.el.classList.remove('ribbon-button-highlighted');
        }
    };
    BaseButton.prototype.flashHighlight = function () {
        var _this = this;
        $(this.el).addClass('ribbon-button-highlight-flash');
        setTimeout(function () {
            $(_this.el).removeClass('ribbon-button-highlight-flash');
        }, 150);
    };
    BaseButton.prototype.applyIcon = function () {
        if (typeof this.icon === 'undefined') {
            return;
        }
        var useEl;
        if (!this.icon.hasChildNodes()) {
            useEl = document.createElementNS(SVG_NS, 'use');
            this.icon.appendChild(useEl);
        }
        useEl = this.icon.firstChild;
        useEl.setAttributeNS(XLINK_NS, 'href', '#' + this.iconId);
    };
    return BaseButton;
}(VisibleWidget));
exports.BaseButton = BaseButton;
var Button = (function (_super) {
    __extends(Button, _super);
    function Button(id, paneId) {
        var _this = _super.call(this, id) || this;
        _this.isSmall = false;
        _this.paneId = paneId;
        _this.el = document.createElement('div');
        _this.el.id = _this.id;
        _this.el.classList.add('ribbon-button');
        _this.icon = document.createElementNS(SVG_NS, 'svg');
        _this.icon.setAttribute('class', 'ribbon-button-icon');
        _this.icon.setAttribute('width', '95%');
        _this.icon.setAttribute('height', '60%');
        _this.label = document.createElement('div');
        _this.label.classList.add('ribbon-button-text');
        _this.label.style.height = '40%';
        _this.label.style.textAlign = 'center';
        _this.label.style.lineHeight = '90%';
        _this.el.appendChild(_this.icon);
        _this.el.appendChild(_this.label);
        return _this;
    }
    Button.prototype.render = function (groupElement) {
        if (this.visible === false) {
            return;
        }
        this.applyIcon();
        this.label.textContent = this.text;
        if (this.tooltip) {
            this.tooltip.setTitle(this.text);
        }
        else {
            this.tooltip = new tooltip_1.WVTooltip(this.el);
            this.tooltip.setOrientation('bottom');
            this.tooltip.setTitle(this.text);
        }
        if (this.renderTarget !== groupElement) {
            this.renderTarget = groupElement;
            groupElement.appendChild(this.el);
        }
        if (this.paneId) {
            paneWidgets[this.paneId] = this;
        }
    };
    return Button;
}(BaseButton));
exports.Button = Button;
var Buttonlet = (function (_super) {
    __extends(Buttonlet, _super);
    function Buttonlet(id, disabled, paneId) {
        var _this = _super.call(this, id) || this;
        _this.paneId = paneId;
        _this.el = document.createElement('div');
        _this.el.id = _this.id;
        _this.el.classList.add('ribbon-buttonlet');
        _this.icon = document.createElementNS(SVG_NS, 'svg');
        _this.icon.setAttribute('class', 'ribbon-buttonlet-icon');
        _this.icon.setAttribute('width', '20px');
        _this.icon.setAttribute('height', '100%');
        _this.label = document.createElement('span');
        _this.label.classList.add('ribbon-buttonlet-text');
        _this.el.appendChild(_this.icon);
        _this.el.appendChild(_this.label);
        if (disabled) {
            _this.el.style.pointerEvents = 'none';
        }
        return _this;
    }
    Buttonlet.prototype.render = function (buttonColumn) {
        if (this.visible === false) {
            return;
        }
        this.applyIcon();
        this.label.textContent = this.text;
        if (this.tooltip) {
            this.tooltip.setTitle(this.text);
        }
        else {
            this.tooltip = new tooltip_1.WVTooltip(this.el);
            this.tooltip.setOrientation('bottom');
            this.tooltip.setTitle(this.text);
        }
        if (this.renderTarget !== buttonColumn) {
            this.renderTarget = buttonColumn;
            buttonColumn.appendChild(this.el);
        }
        if (this.paneId) {
            paneWidgets[this.paneId] = this;
        }
    };
    return Buttonlet;
}(BaseButton));
exports.Buttonlet = Buttonlet;
var Column = (function (_super) {
    __extends(Column, _super);
    function Column() {
        var _this = _super.call(this) || this;
        _this.widgets = [];
        _this.el = document.createElement('div');
        _this.el.classList.add('ribbon-column');
        return _this;
    }
    Object.defineProperty(Column.prototype, "capacity", {
        get: function () {
            return this.widgets.length;
        },
        enumerable: true,
        configurable: true
    });
    Column.prototype.addButtonLet = function (buttonlet) {
        this.widgets.push(buttonlet);
    };
    Column.prototype.estimate = function () {
        var estVal = this.el.offsetWidth;
        return estVal;
    };
    Column.prototype.render = function (groupContent) {
        for (var _i = 0, _a = this.widgets; _i < _a.length; _i++) {
            var widget = _a[_i];
            widget.render(this.el);
        }
        if (this.renderTarget !== groupContent) {
            this.renderTarget = groupContent;
            groupContent.appendChild(this.el);
        }
    };
    return Column;
}(Widget));
exports.Column = Column;
var DropdownButton = (function (_super) {
    __extends(DropdownButton, _super);
    function DropdownButton(id, paneId) {
        var _this = _super.call(this, id) || this;
        _this.items = [];
        _this.activeItem = undefined;
        _this.paneId = paneId;
        _this.el = document.createElement('div');
        _this.el.id = _this.id;
        _this.el.classList.add('ribbon-dropdown-button');
        _this.el.style.width = app_settings_1.settings.ribbon.buttonWidth + 'px';
        var xmlns = 'http://www.w3.org/2000/svg';
        _this.icon = document.createElementNS(xmlns, 'svg');
        _this.icon.setAttribute('class', 'ribbon-dropdown-button-icon');
        _this.icon.setAttribute('width', '100%');
        _this.icon.setAttribute('height', '60%');
        _this.label = document.createElement('div');
        _this.label.classList.add('ribbon-dropdown-button-text');
        _this.labelText = document.createElement('span');
        _this.labelText.classList.add('ribbon-dropdown-text');
        _this.labelExpand = document.createElement('div');
        _this.labelExpand.className = 'fa fa-sort-down ribbon-dropdown-button-expand-icon';
        _this.label.appendChild(_this.labelText);
        _this.label.appendChild(_this.labelExpand);
        _this.el.appendChild(_this.icon);
        _this.el.appendChild(_this.label);
        _this.dropdownList = document.createElement('div');
        _this.dropdownList.className = 'ribbon-dropdown-list';
        _this.dropdownList.style.display = 'none';
        _this.dropdownList.addEventListener('mouseleave', function (ev) {
            _this.dropdownList.style.display = 'none';
        });
        var container = document.getElementById(app_settings_1.settings.ribbon.dropdownsContainerId);
        container.appendChild(_this.dropdownList);
        _this.label.addEventListener('click', function () {
            if (_this.dropdownList.style.display === 'none') {
                _this.dropdownList.style.display = '';
                var boundingRect = _this.label.getBoundingClientRect();
                var top_1 = boundingRect.bottom;
                var left = boundingRect.left;
                _this.dropdownList.style.top = top_1 + 'px';
                _this.dropdownList.style.left = left + 'px';
            }
            else {
                _this.dropdownList.style.display = 'none';
            }
        });
        _this.label.addEventListener('mouseleave', function (ev) {
            var boundingRect = _this.label.getBoundingClientRect();
            if (ev.pageY < boundingRect.bottom - 1) {
                _this.dropdownList.style.display = 'none';
            }
        });
        return _this;
    }
    DropdownButton.prototype.addItems = function (itemsOptions) {
        for (var _i = 0, itemsOptions_1 = itemsOptions; _i < itemsOptions_1.length; _i++) {
            var options = itemsOptions_1[_i];
            var item = new DropdownItem(options.langId, this);
            item.setIconId(options.iconId);
            if (options.interaction) {
                item.event = options.interaction;
            }
            this.items.push(item);
        }
        this.activeItem = this.items[0];
    };
    DropdownButton.prototype.addClick = function (context, dropdownCallback) {
        var _this = this;
        this.icon.addEventListener('click', function (ev) {
            dropdownCallback(context, _this.activeItem, _this);
            _this.setIconId(_this.activeItem.getIconId());
            _this.applyIcon();
        });
        this.dropdownList.addEventListener('click', function (ev) {
            var target = ev.target;
            var dropdownItemEl;
            if (target.classList.contains('ribbon-dropdown-item')) {
                dropdownItemEl = target;
            }
            else {
                dropdownItemEl = target.parentElement;
            }
            _this.activeItem = findDropdownItem(dropdownItemEl.id);
            dropdownCallback(context, _this.activeItem, _this);
            _this.labelText.textContent = _this.activeItem.text;
            _this.el.title = _this.activeItem.text;
            _this.setIconId(_this.activeItem.getIconId());
            _this.applyIcon();
        });
    };
    DropdownButton.prototype.applyHighlight = function (val) {
        this.activeItem.isHighlight = val;
        this.isHighlight = val;
        if (this.isHighlight) {
            $(this.icon).addClass('ribbon-button-highlighted');
            $(this.label).addClass('ribbon-button-highlighted');
        }
        else {
            $(this.icon).removeClass('ribbon-button-highlighted');
            $(this.label).removeClass('ribbon-button-highlighted');
            this.activeItem.setHighlight(false);
        }
    };
    DropdownButton.prototype.flashHighlight = function () {
        var _this = this;
        $(this.icon).addClass('ribbon-button-highlighted');
        $(this.label).addClass('ribbon-button-highlighted');
        setTimeout(function () {
            $(_this.icon).removeClass('ribbon-button-highlighted');
            $(_this.label).removeClass('ribbon-button-highlighted');
        }, 150);
    };
    DropdownButton.prototype.render = function (groupElement) {
        if (this.visible === false) {
            return;
        }
        this.applyIcon();
        this.labelText.textContent = this.activeItem.text;
        if (this.tooltip) {
            this.tooltip.setTitle(this.activeItem.text);
        }
        else {
            this.tooltip = new tooltip_1.WVTooltip(this.el);
            this.tooltip.setOrientation('bottom');
            this.tooltip.setTitle(this.activeItem.text);
        }
        for (var _i = 0, _a = this.items; _i < _a.length; _i++) {
            var item = _a[_i];
            item.render(this.dropdownList);
        }
        if (this.renderTarget !== groupElement) {
            this.renderTarget = groupElement;
            groupElement.appendChild(this.el);
        }
        if (this.paneId) {
            paneWidgets[this.paneId] = this;
        }
    };
    return DropdownButton;
}(BaseButton));
exports.DropdownButton = DropdownButton;
var DropdownItem = (function (_super) {
    __extends(DropdownItem, _super);
    function DropdownItem(id, dropdownButton) {
        var _this = _super.call(this, id) || this;
        _this.dropdownButton = dropdownButton;
        _this.el = document.createElement('div');
        _this.el.id = _this.id;
        _this.el.classList.add('ribbon-dropdown-item');
        _this.el.style.height = app_settings_1.settings.ribbon.dropdownItemHeight + 'px';
        _this.el.style.display = 'flex';
        var xmlns = 'http://www.w3.org/2000/svg';
        _this.icon = document.createElementNS(xmlns, 'svg');
        _this.icon.setAttribute('class', 'ribbon-dropdown-item-icon');
        _this.icon.setAttribute('width', '16px');
        _this.icon.setAttribute('height', '100%');
        _this.label = document.createElement('span');
        _this.label.classList.add('ribbon-dropdown-item-text');
        _this.el.appendChild(_this.icon);
        _this.el.appendChild(_this.label);
        return _this;
    }
    DropdownItem.prototype.applyHighlight = function (val) {
        var _this = this;
        this.dropdownButton.items.forEach(function (item) {
            if (item !== _this) {
                item.isHighlight = false;
                item.el.style.backgroundColor = '';
            }
        });
        this.dropdownButton.applyHighlight(val);
        this.setHighlight(val);
    };
    DropdownItem.prototype.setHighlight = function (val) {
        this.isHighlight = val;
        if (this.isHighlight) {
            this.el.classList.add('ribbon-button-highlighted');
        }
        else {
            this.el.classList.remove('ribbon-button-highlighted');
        }
    };
    DropdownItem.prototype.activate = function () {
        this.dropdownButton.activeItem = this;
        this.dropdownButton.setIconId(this.iconId);
        this.setHighlight(true);
        this.dropdownButton.applyHighlight(true);
        this.dropdownButton.render(this.dropdownButton.renderTarget);
    };
    DropdownItem.prototype.render = function (dropdownList) {
        if (this.visible === false) {
            return;
        }
        this.applyIcon();
        this.label.textContent = this.text;
        if (this.renderTarget !== dropdownList) {
            this.renderTarget = dropdownList;
            dropdownList.appendChild(this.el);
        }
    };
    return DropdownItem;
}(BaseButton));
exports.DropdownItem = DropdownItem;
var Input = (function (_super) {
    __extends(Input, _super);
    function Input(id) {
        var _this = _super.call(this, id) || this;
        _this.el = document.createElement('input');
        _this.el.type = 'text';
        _this.el.id = _this.id;
        _this.el.classList.add('ribbon-input');
        return _this;
    }
    Input.prototype.addInputCallback = function (context, callback) {
        var _this = this;
        this.el.addEventListener('keydown', function (ev) {
            callback(context, _this.id, ev);
        });
    };
    Input.prototype.render = function (target) {
        if (this.visible === false) {
            return;
        }
        if (this.renderTarget !== target) {
            this.renderTarget = target;
            target.appendChild(this.el);
        }
    };
    return Input;
}(VisibleWidget));
exports.Input = Input;
var Group = (function (_super) {
    __extends(Group, _super);
    function Group(id) {
        var _this = _super.call(this, id) || this;
        _this.configuration = [];
        _this.isCompact = false;
        _this.el = document.createElement('div');
        _this.el.id = _this.id;
        _this.el.classList.add('ribbon-group');
        _this.groupContent = document.createElement('div');
        _this.groupContent.classList.add('ribbon-group-content');
        _this.groupName = document.createElement('div');
        _this.groupName.classList.add('ribbon-group-name');
        _this.el.appendChild(_this.groupContent);
        _this.el.appendChild(_this.groupName);
        _this.compactGroup = document.createElement('div');
        _this.compactGroup.classList.add('ribbon-compact-group');
        _this.compactGroup.style.width = app_settings_1.settings.ribbon.buttonWidth + 'px';
        _this.compactGroup.style.height = '100%';
        _this.compactGroup.style.display = 'inline-block';
        _this.compactGroup.id = _this.id + '_Compact';
        _this.compactIcon = document.createElementNS(SVG_NS, 'svg');
        _this.compactIcon.setAttribute('class', 'ribbon-compact-icon');
        var useEl = document.createElementNS(SVG_NS, 'use');
        _this.compactIcon.appendChild(useEl);
        _this.compactGroupName = document.createElement('div');
        _this.compactGroupName.classList.add('ribbon-compact-name');
        _this.compactExpander = document.createElement('div');
        _this.compactExpander.classList.add('ribbon-compact-expander');
        _this.compactExpander.classList.add('fa');
        _this.compactExpander.classList.add('fa-sort-down');
        _this.compactGroup.appendChild(_this.compactIcon);
        _this.compactGroup.appendChild(_this.compactGroupName);
        _this.compactGroup.appendChild(_this.compactExpander);
        _this.expandable = document.createElement('div');
        _this.expandable.classList.add('ribbon-expandable');
        _this.expandable.style.display = 'none';
        _this.expandable.tabIndex = 100;
        _this.compactGroup.addEventListener('click', function () {
            if (_this.expandable.style.display === 'none') {
                _this.expandable.style.display = 'flex';
                _this.expandable.focus();
                var boundingRect = _this.compactGroup.getBoundingClientRect();
                var top_2 = boundingRect.bottom;
                var left = boundingRect.left;
                _this.expandable.style.top = top_2 + 'px';
                if ((left + _this.expandable.offsetWidth) > document.body.offsetWidth) {
                    _this.expandable.style.left = (left + (document.body.offsetWidth - (left + _this.expandable.offsetWidth))) + 'px';
                }
                else {
                    _this.expandable.style.left = left + 'px';
                }
                _this.expandable.style.height = app_settings_1.settings.ribbon.tabPageHeight + 'px';
            }
            else {
                _this.expandable.style.display === 'none';
            }
        });
        _this.expandable.addEventListener('blur', function (ev) {
            setTimeout(function () {
                if (_this.expandable.style.display !== 'none') {
                    _this.expandable.style.display = 'none';
                }
            }, 200);
        });
        var container = document.getElementById(app_settings_1.settings.ribbon.expandablesContainerId);
        container.appendChild(_this.expandable);
        return _this;
    }
    Group.prototype.addButton = function (options) {
        var button = new Button(options.langId, options.paneId);
        button.setIconId(options.iconId);
        if (options.highlight) {
            button.isHighlight = true;
            exports.initHightlightedButtons.push(button);
        }
        this.configuration.push(button);
        return button;
    };
    Group.prototype.addButtonlet = function (options) {
        var buttonlet = new Buttonlet(options.langId, options.disabled, options.paneId);
        buttonlet.setIconId(options.iconId);
        if (options.highlight || buttonlet.isHighlight) {
            buttonlet.isHighlight = true;
            exports.initHightlightedButtons.push(buttonlet);
        }
        var last = this.configuration[this.configuration.length - 1];
        if (last === undefined || !(last instanceof Column) || last.capacity >= 3) {
            var buttonColumn = new Column();
            buttonColumn.addButtonLet(buttonlet);
            this.configuration.push(buttonColumn);
        }
        else {
            last.widgets.push(buttonlet);
        }
        return buttonlet;
    };
    Group.prototype.addDropdown = function (options) {
        var dropdown = new DropdownButton(options.langId, options.paneId);
        dropdown.setIconId(options.iconId);
        dropdown.addItems(options.dropdownItems);
        this.configuration.push(dropdown);
        return dropdown;
    };
    Group.prototype.addSplittedDropdown = function (options) {
        var dropdown = new SplittedDropdownButton(options.langId, options.paneId);
        dropdown.setIconId(options.iconId);
        dropdown.addItems(options.dynamicDropdownItems);
        this.configuration.push(dropdown);
        return dropdown;
    };
    Group.prototype.addInput = function (option) {
        var input = new Input(option.langId);
        this.configuration.push(input);
        return input;
    };
    Group.prototype.findFirstSVGId = function () {
        var svgId;
        for (var _i = 0, _a = this.configuration; _i < _a.length; _i++) {
            var widget = _a[_i];
            if (widget instanceof Button || widget instanceof DropdownButton) {
                svgId = widget.getIconId();
                return svgId;
            }
            else if (widget instanceof Column) {
                var column = widget;
                for (var _b = 0, _c = column.widgets; _b < _c.length; _b++) {
                    var columnChild = _c[_b];
                    if (columnChild instanceof BaseButton) {
                        var buttonLet = columnChild;
                        svgId = buttonLet.getIconId();
                        return svgId;
                    }
                }
                return '';
            }
        }
    };
    Group.prototype.applyCompactIcon = function () {
        var useEl = this.compactIcon.firstChild;
        var svgId = this.findFirstSVGId();
        useEl.setAttributeNS(XLINK_NS, 'href', '#' + svgId);
    };
    Object.defineProperty(Group.prototype, "compact", {
        get: function () {
            return this.isCompact;
        },
        set: function (required) {
            this.isCompact = required;
        },
        enumerable: true,
        configurable: true
    });
    Group.prototype.estimate = function () {
        if (this.compact) {
            return app_settings_1.settings.ribbon.buttonWidth + 1;
        }
        var accWidth = 16;
        for (var _i = 0, _a = this.configuration; _i < _a.length; _i++) {
            var widget = _a[_i];
            if (widget instanceof Column) {
                var buttonColumn = widget;
                accWidth += buttonColumn.estimate();
            }
            else {
                accWidth += app_settings_1.settings.ribbon.buttonWidth;
            }
        }
        return accWidth;
    };
    Group.prototype.render = function (tabPage) {
        var toAppend = false;
        if (this.renderTarget !== tabPage) {
            this.renderTarget = tabPage;
            toAppend = true;
        }
        var width = 0;
        if (this.isCompact && (this.configuration.length > 1)) {
            try {
                this.renderTarget.removeChild(this.el);
            }
            catch (error) {
            }
            this.applyCompactIcon();
            this.compactGroupName.textContent = this.text;
            for (var _i = 0, _a = this.configuration; _i < _a.length; _i++) {
                var widget = _a[_i];
                widget.render(this.expandable);
            }
            this.renderTarget.appendChild(this.compactGroup);
            return;
        }
        else {
            try {
                this.renderTarget.removeChild(this.compactGroup);
            }
            catch (error) {
            }
            this.groupName.textContent = this.text;
            this.renderTarget.appendChild(this.el);
            for (var _b = 0, _c = this.configuration; _b < _c.length; _b++) {
                var widget = _c[_b];
                widget.render(this.groupContent);
                if (widget instanceof VisibleWidget || widget instanceof Column) {
                    width += widget.el.clientWidth;
                }
            }
        }
        this.groupName.style.width = width + 'px';
        if (toAppend) {
            this.renderTarget.appendChild(this.el);
        }
    };
    Group.prototype.getWidgets = function () {
        var widgets = [];
        for (var _i = 0, _a = this.configuration; _i < _a.length; _i++) {
            var widget = _a[_i];
            if (widget instanceof Button) {
                var button = widget;
                widgets.push(button);
            }
            else if (widget instanceof Column) {
                var buttonColumn = widget;
                for (var _b = 0, _c = buttonColumn.widgets; _b < _c.length; _b++) {
                    var widget_1 = _c[_b];
                    if (widget_1 instanceof Buttonlet) {
                        var columnChild = widget_1;
                        widgets.push(columnChild);
                    }
                }
            }
            else if (widget instanceof DropdownButton) {
                var dropdown = widget;
                widgets.push(dropdown);
            }
        }
        return widgets;
    };
    Group.prototype.addClick = function (context, callback) {
        var _this = this;
        var onclick = function (ev) {
            if (ev.currentTarget) {
                var id = ev.currentTarget.id;
                callback(context, id, _this);
            }
        };
        var widgets = this.getWidgets();
        for (var _i = 0, widgets_1 = widgets; _i < widgets_1.length; _i++) {
            var widget = widgets_1[_i];
            widget.el.addEventListener('click', onclick);
        }
    };
    Group.prototype.getButtonById = function (id) {
        return findButton(id);
    };
    return Group;
}(VisibleWidget));
exports.Group = Group;
var Tab = (function (_super) {
    __extends(Tab, _super);
    function Tab(id) {
        var _this = _super.call(this, id) || this;
        _this.groups = [];
        _this.el = document.createElement('li');
        _this.el.id = _this.id;
        _this.el.classList.add('ribbon-tab');
        _this.tabName = document.createElement('span');
        _this.tabName.classList.add('ribbon-tab-name');
        _this.el.appendChild(_this.tabName);
        _this.page = document.createElement('div');
        _this.page.classList.add('ribbon-tab-page');
        return _this;
    }
    Tab.prototype.addGroup = function (group) {
        this.groups.push(group);
    };
    Tab.prototype.tryShrink = function () {
        var i = this.groups.length - 1;
        for (; i > -1; i--) {
            if (!this.groups[i].compact) {
                this.groups[i].compact = true;
                break;
            }
        }
        this.renderGroups();
        var estimatedWidth;
        estimatedWidth = this.estimate();
        if (estimatedWidth > app_states_1.appStates.ribbonWidth && i > 0) {
            this.tryShrink();
        }
        else {
            return;
        }
    };
    Tab.prototype.show = function () {
        var hasCompactChild = false;
        this.groups.forEach(function (group) {
            if (group.compact) {
                hasCompactChild = true;
            }
            group.compact = false;
        });
        if (hasCompactChild) {
            this.render(this.renderTarget);
        }
        $(this.el).addClass('ribbon-header-active-tab');
        this.page.style.display = '';
        var estimatedWidth;
        estimatedWidth = this.estimate();
        if (estimatedWidth > app_states_1.appStates.ribbonWidth) {
            this.tryShrink();
        }
        else {
            this.render(this.renderTarget);
        }
    };
    Tab.prototype.hide = function () {
        $(this.el).removeClass('ribbon-header-active-tab');
        this.page.style.display = 'none';
    };
    Tab.prototype.addToHeader = function (ribbonHeader) {
        ribbonHeader.appendChild(this.el);
        this.tabName.textContent = this.text;
        this.hide();
    };
    Tab.prototype.estimate = function () {
        var accWidth = 2 + 20;
        for (var _i = 0, _a = this.groups; _i < _a.length; _i++) {
            var group = _a[_i];
            var groupWidth = group.estimate();
            accWidth += groupWidth;
        }
        return accWidth;
    };
    Tab.prototype.renderGroups = function () {
        for (var _i = 0, _a = this.groups; _i < _a.length; _i++) {
            var group = _a[_i];
            group.render(this.page);
        }
    };
    Tab.prototype.render = function (ribbonBody) {
        var hasNewTarget = false;
        if (this.renderTarget !== ribbonBody) {
            hasNewTarget = true;
            this.renderTarget = ribbonBody;
        }
        this.renderGroups();
        if (hasNewTarget) {
            this.renderTarget.appendChild(this.page);
        }
    };
    return Tab;
}(VisibleWidget));
exports.Tab = Tab;
var SplittedDropdownButton = (function (_super) {
    __extends(SplittedDropdownButton, _super);
    function SplittedDropdownButton(id, paneId) {
        var _this = _super.call(this, id) || this;
        _this.items = [];
        _this.activeItem = undefined;
        _this.paneId = paneId;
        _this.el = document.createElement('div');
        _this.el.id = _this.id;
        _this.el.classList.add('ribbon-dropdown-button');
        _this.el.style.width = app_settings_1.settings.ribbon.buttonWidth + 'px';
        var xmlns = 'http://www.w3.org/2000/svg';
        _this.icon = document.createElementNS(xmlns, 'svg');
        _this.icon.setAttribute('class', 'ribbon-dropdown-button-icon');
        _this.icon.setAttribute('width', '100%');
        _this.icon.setAttribute('height', '60%');
        _this.label = document.createElement('div');
        _this.label.className = 'ribbon-dropdown-button-text';
        _this.labelText = document.createElement('span');
        _this.labelText.className = 'ribbon-dropdown-text';
        _this.labelExpand = document.createElement('div');
        _this.labelExpand.className = 'fa fa-sort-down ribbon-dropdown-button-expand-icon';
        _this.label.appendChild(_this.labelText);
        _this.label.appendChild(_this.labelExpand);
        _this.el.appendChild(_this.icon);
        _this.el.appendChild(_this.label);
        _this.dropdownList = document.createElement('div');
        _this.dropdownList.style.fontSize = '12px';
        _this.dropdownList.className = 'ribbon-dropdown-list splitted-dropdown-list';
        _this.dropdownList.style.display = 'none';
        _this.dropdownList.addEventListener('mouseleave', function (ev) {
            _this.dropdownList.style.display = 'none';
        });
        var container = document.getElementById(app_settings_1.settings.ribbon.dropdownsContainerId);
        container.appendChild(_this.dropdownList);
        _this.label.addEventListener('click', function () {
            if (_this.dropdownList.style.display === 'none') {
                _this.dropdownList.style.display = '';
                var boundingRect = _this.label.getBoundingClientRect();
                var top_3 = boundingRect.bottom;
                var left = boundingRect.left;
                _this.dropdownList.style.top = top_3 + 'px';
                _this.dropdownList.style.left = left + 'px';
            }
            else {
                _this.dropdownList.style.display = 'none';
            }
        });
        _this.icon.addEventListener('mouseenter', function (ev) {
            if (!_this.isHighlight) {
                _this.icon.style.backgroundColor = app_settings_1.settings.ribbon.buttonMouseHoverColor;
            }
        });
        _this.icon.addEventListener('mouseleave', function (ev) {
            if (!_this.isHighlight) {
                _this.icon.style.backgroundColor = app_settings_1.settings.ribbon.buttonDefaultColor;
            }
        });
        _this.label.addEventListener('mouseenter', function (ev) {
            if (!_this.isHighlight) {
                _this.label.style.backgroundColor = app_settings_1.settings.ribbon.buttonMouseHoverColor;
            }
        });
        _this.label.addEventListener('mouseleave', function (ev) {
            if (!_this.isHighlight) {
                _this.label.style.backgroundColor = app_settings_1.settings.ribbon.buttonDefaultColor;
            }
            var boundingRect = _this.label.getBoundingClientRect();
            if (ev.pageY < boundingRect.bottom - 1) {
                _this.dropdownList.style.display = 'none';
            }
        });
        vsClient.on('@OpenedFile', function (file) {
            _this.addItem(file);
        });
        return _this;
    }
    SplittedDropdownButton.prototype.addItem = function (langId) {
        var item = new DynamicDropdownItem(langId, this);
        if (this.items.filter(function (it) { return it.langId == langId; }).length > 0) {
            return;
        }
        this.items.push(item);
        this.render(this.renderTarget);
    };
    SplittedDropdownButton.prototype.addItems = function (itemsOptions) {
        for (var _i = 0, itemsOptions_2 = itemsOptions; _i < itemsOptions_2.length; _i++) {
            var options = itemsOptions_2[_i];
            var item = new DynamicDropdownItem(options.langId, this);
            item.setIconId(options.iconId);
            this.items.push(item);
        }
    };
    SplittedDropdownButton.prototype.addClick = function (context, dropdownCallback) {
        var _this = this;
        this.icon.addEventListener('click', function (ev) {
            dropdownCallback(context, undefined, _this);
        });
        this.dropdownList.addEventListener('click', function (ev) {
            ev.preventDefault();
            ev.stopPropagation();
            var target = ev.target;
            var dropdownItemEl;
            if (target.classList.contains('ribbon-dropdown-item')) {
                dropdownItemEl = target;
            }
            else {
                dropdownItemEl = target.parentElement;
            }
            _this.activeItem = findDynamicDropdownItem(dropdownItemEl.id);
            dropdownCallback(context, _this.activeItem, _this);
        });
    };
    SplittedDropdownButton.prototype.render = function (groupElement) {
        if (this.visible === false) {
            return;
        }
        this.applyIcon();
        this.labelText.textContent = this.text;
        if (this.tooltip) {
            this.tooltip.setTitle(this.text);
        }
        else {
            this.tooltip = new tooltip_1.WVTooltip(this.el);
            this.tooltip.setOrientation('bottom');
            this.tooltip.setTitle(this.text);
        }
        for (var _i = 0, _a = this.items; _i < _a.length; _i++) {
            var item = _a[_i];
            item.render(this.dropdownList);
        }
        if (this.renderTarget !== groupElement) {
            this.renderTarget = groupElement;
            groupElement.appendChild(this.el);
        }
        if (this.paneId) {
            paneWidgets[this.paneId] = this;
        }
    };
    return SplittedDropdownButton;
}(BaseButton));
exports.SplittedDropdownButton = SplittedDropdownButton;
var DynamicDropdownItem = (function (_super) {
    __extends(DynamicDropdownItem, _super);
    function DynamicDropdownItem(id, dropdownButton) {
        var _this = _super.call(this, id) || this;
        _this.dropdownButton = dropdownButton;
        _this.el = document.createElement('div');
        _this.el.id = _this.id;
        _this.el.classList.add('ribbon-dropdown-item');
        _this.el.style.height = app_settings_1.settings.ribbon.dropdownItemHeight + 'px';
        _this.el.style.display = 'flex';
        var xmlns = 'http://www.w3.org/2000/svg';
        _this.icon = document.createElementNS(xmlns, 'svg');
        _this.icon.setAttribute('class', 'ribbon-dropdown-item-icon');
        _this.icon.setAttribute('width', '16px');
        _this.icon.setAttribute('height', '100%');
        _this.label = document.createElement('span');
        _this.label.classList.add('ribbon-dropdown-item-text');
        _this.el.appendChild(_this.icon);
        _this.el.appendChild(_this.label);
        return _this;
    }
    DynamicDropdownItem.prototype.render = function (dropdownList) {
        if (this.visible === false) {
            return;
        }
        this.applyIcon();
        this.label.textContent = this.text;
        if (this.renderTarget !== dropdownList) {
            this.renderTarget = dropdownList;
            dropdownList.appendChild(this.el);
        }
    };
    return DynamicDropdownItem;
}(BaseButton));
exports.DynamicDropdownItem = DynamicDropdownItem;


/***/ }),
/* 11 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var _1 = __webpack_require__(2);
var custom_palette_1 = __webpack_require__(36);
var tooltip_1 = __webpack_require__(8);
var ui = __webpack_require__(0);
var app_states_1 = __webpack_require__(4);
var tinycolor = __webpack_require__(16);
;
var Visual = (function () {
    function Visual(item) {
        this.text = '';
        this.item = item;
        this.el = document.createElement('td');
        this.el.classList.add('pane-item-visual');
    }
    Visual.prototype.highlightSearchString = function (searchString) {
    };
    Visual.prototype.getText = function () {
        return this.text;
    };
    return Visual;
}());
exports.Visual = Visual;
var KeyValue = (function (_super) {
    __extends(KeyValue, _super);
    function KeyValue(item) {
        var _this = _super.call(this, item) || this;
        _this.entries = new Array();
        _this.keyEl = document.createElement('td');
        _this.keyEl.classList.add('key-value-key');
        _this.el.classList.add('key-value-value');
        return _this;
    }
    KeyValue.prototype.constructHTML = function (target) {
        this.row = target;
    };
    KeyValue.prototype.setText = function (text) {
    };
    KeyValue.prototype.setTooltip = function (text) {
    };
    KeyValue.prototype.setUIValue = function (val) {
    };
    KeyValue.prototype.addEntry = function (entry) {
        this.entries.push(entry);
        if (this.entries.length < 2) {
            applyIndent(entry.el, this.item.indent);
            this.row.appendChild(entry.el);
            entry.tooltip.setTitle(entry.key);
            entry.el.style.textOverflow = 'initial';
            $(entry.item.el).remove();
        }
        else {
            this.row.appendChild(entry.el);
            entry.el.style.textOverflow = 'initial';
            $(entry.item.el).remove();
        }
    };
    return KeyValue;
}(Visual));
exports.KeyValue = KeyValue;
var Folder = (function (_super) {
    __extends(Folder, _super);
    function Folder(item) {
        var _this = _super.call(this, item) || this;
        _this.collapse = function (alterIcon, emit) {
            if (alterIcon === void 0) { alterIcon = false; }
            if (emit === void 0) { emit = true; }
            if (alterIcon) {
                _this.expander.classList.remove(Folder.minus);
                _this.expander.classList.add(Folder.plus);
            }
            _this.item.children.forEach(function (item) {
                item.hide();
            });
            if (emit) {
                _this.item.context.emit('user-input', _this, _this.item.id ? _this.item.id + '_HIDE' : 'toggle-folder-visibility');
            }
        };
        _this.expand = function (alterIcon, emit) {
            if (alterIcon === void 0) { alterIcon = false; }
            if (emit === void 0) { emit = true; }
            if (alterIcon) {
                _this.expander.classList.remove(Folder.plus);
                _this.expander.classList.add(Folder.minus);
            }
            _this.item.children.forEach(function (item) {
                item.show(emit);
            });
            if (emit) {
                _this.item.context.emit('user-input', _this, _this.item.id ? _this.item.id + '_SHOW' : 'toggle-folder-visibility');
            }
        };
        _this.el.colSpan = 2;
        _this.expander = document.createElement('i');
        _this.expander.classList.add('far');
        _this.expander.classList.add(Folder.minus);
        _this.expander.addEventListener('click', function (ev) {
            if (_this.expander.classList.contains(Folder.minus)) {
                _this.collapse(true, true);
            }
            else if (_this.expander.classList.contains(Folder.plus)) {
                _this.expand(true, true);
            }
        });
        _this.tooltip = new tooltip_1.WVTooltip(_this.el);
        var spacing = document.createElement('span');
        spacing.textContent = ' ';
        spacing.classList.add('pane-item-spacing');
        _this.boldText = document.createElement('b');
        _this.boldText.textContent = _this.getText();
        _this.key = _this.getText();
        _this.el.appendChild(_this.expander);
        _this.el.appendChild(spacing);
        _this.el.appendChild(_this.boldText);
        _this.el.classList.add('pane-item-group');
        if (item.id) {
            _this.item.el.id = item.id;
        }
        return _this;
    }
    Folder.prototype.highlightSearchString = function (searchString) {
        if (!searchString) {
            this.boldText.innerHTML = this.key;
            return;
        }
        var length = searchString.length;
        var start = this.key.toLowerCase().indexOf(searchString);
        var titleLength = this.key.length;
        var formattedTitle = "";
        if (start !== -1) {
            for (var i = 0; i < titleLength; i++) {
                if (i >= start && i < start + length) {
                    formattedTitle += '<span class="pane-search-text-highlight">' + this.key[i] + '</span>';
                }
                else {
                    formattedTitle += this.key[i];
                }
            }
            this.boldText.innerHTML = formattedTitle;
        }
        else {
            this.boldText.innerHTML = this.key;
        }
    };
    Folder.prototype.constructHTML = function (target) {
        applyIndent(this.el, this.item.indent);
        target.appendChild(this.el);
    };
    Folder.prototype.setText = function (text) {
        this.boldText.textContent = text;
        this.key = text;
    };
    Folder.prototype.setTooltip = function (text) {
        this.tooltip.setTitle(text);
    };
    Folder.prototype.setUIValue = function (val) {
    };
    Folder.minus = 'fa-minus-square';
    Folder.plus = 'fa-plus-square';
    return Folder;
}(Visual));
exports.Folder = Folder;
var Entry = (function (_super) {
    __extends(Entry, _super);
    function Entry(item, isButton) {
        if (isButton === void 0) { isButton = false; }
        var _this = _super.call(this, item) || this;
        _this.key = _this.getText();
        _this.nameEl = document.createElement('td');
        _this.nameEl.classList.add('pane-item-entry-name');
        if (!isButton) {
            _this.nameEl.textContent = _this.getText();
        }
        if (_this.item.prefix) {
            _this.prefixEl = document.createElement('span');
            _this.prefixEl.classList.add('pane-prefix-item');
            _this.prefixEl.textContent = _this.item.prefix;
            _this.el.appendChild(_this.prefixEl);
        }
        _this.tooltip = new tooltip_1.WVTooltip(_this.nameEl);
        _this.el.style.position = 'relative';
        return _this;
    }
    Entry.prototype.highlightSearchString = function (searchString) {
        if (!searchString) {
            this.nameEl.innerHTML = this.key;
            return;
        }
        var length = searchString.length;
        var start = this.key.toLowerCase().indexOf(searchString);
        var titleLength = this.key.length;
        var formattedTitle = "";
        if (start !== -1) {
            for (var i = 0; i < titleLength; i++) {
                if (i >= start && i < start + length) {
                    formattedTitle += '<span class="pane-search-text-highlight">' + this.key[i] + '</span>';
                }
                else {
                    formattedTitle += this.key[i];
                }
            }
            this.nameEl.innerHTML = formattedTitle;
        }
        else {
            this.nameEl.innerHTML = this.key;
        }
    };
    Entry.prototype.constructHTML = function (target) {
        applyIndent(this.nameEl, this.item.indent);
        target.appendChild(this.nameEl);
        target.appendChild(this.el);
    };
    Entry.prototype.setText = function (text) {
        this.key = text;
        if (!(this.item.visual instanceof Button)) {
            this.nameEl.textContent = text;
        }
    };
    Entry.prototype.setTooltip = function (text) {
        this.tooltip.setTitle(text);
    };
    Entry.prototype.setUIValue = function (val) {
        this.el.textContent = val;
        this.item.value = val;
    };
    return Entry;
}(Visual));
exports.Entry = Entry;
var TextBox = (function (_super) {
    __extends(TextBox, _super);
    function TextBox(item) {
        var _this = _super.call(this, item) || this;
        _this.textElement = document.createElement('span');
        _this.textElement.classList.add('pane-item-entry-text');
        if (item.id) {
            _this.textElement.id = item.id;
        }
        _this.el.appendChild(_this.textElement);
        return _this;
    }
    TextBox.prototype.setUIValue = function (val) {
        this.textElement.textContent = val;
        this.item.value = val;
        if (typeof val === 'string') {
            if (this.item.suffix) {
                if (this.item.suffix === '') {
                    val = parseFloat(val) + this.item.suffix;
                }
                else {
                    val = parseFloat(val) + " " + this.item.suffix;
                }
            }
            this.textElement.textContent = val;
        }
        else {
            var text = '';
            if (val['Unit']) {
                if (val['Unit'] === '') {
                    text = "" + val['__text__'] + val['Unit'];
                }
                else {
                    text = val['__text__'] + " " + val['Unit'];
                }
            }
            this.textElement.textContent = text;
        }
    };
    return TextBox;
}(Entry));
exports.TextBox = TextBox;
var Input = (function (_super) {
    __extends(Input, _super);
    function Input(item) {
        var _this = _super.call(this, item) || this;
        _this.inputEl = document.createElement('div');
        _this.inputEl.classList.add('pane-item-entry-input');
        _this.inputEl.contentEditable = 'true';
        if (item.id) {
            _this.inputEl.id = item.id;
        }
        _this.el.appendChild(_this.inputEl);
        _this.inputEl.addEventListener('keyup', function (ev) {
            ev.preventDefault();
            ev.stopPropagation();
        });
        _this.inputEl.addEventListener('focus', function (ev) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
            if (!_this.item.triggeredByEvent && !_this.item.triggeredBySetting) {
                return;
            }
            _this.changeSubmitted = false;
            if (_this.item.suffix || _this.unit || (_this.item.inputType === 'Float' || _this.item.inputType === 'Integer')) {
                setTimeout(function () {
                    _this.inputEl.textContent = parseFloat(_this.inputEl.textContent).toString();
                    selectText(_this.inputEl);
                }, 100);
            }
            else {
                selectText(_this.inputEl);
            }
        });
        _this.inputEl.addEventListener('blur', function (ev) {
            app_states_1.appStates.preventGlobalKeyEvents = false;
            if (!_this.item.triggeredByEvent && !_this.item.triggeredBySetting || _this.changeSubmitted) {
                return;
            }
            var val = _this.inputEl.textContent;
            if (_this.item.suffix) {
                val = _this.item.suffix === '%' ? (parseFloat(_this.inputEl.textContent) / 100).toString() : parseFloat(_this.inputEl.textContent).toString();
            }
            _this.item.context.emit('user-input', _this, val);
        });
        if (_this.item.inputType !== 'Text') {
            _this.inputEl.addEventListener('keydown', function (ev) {
                if (ev.keyCode === 13) {
                    ev.preventDefault();
                    if (!_this.item.triggeredByEvent && !_this.item.triggeredBySetting) {
                        return;
                    }
                    var val = _this.inputEl.textContent;
                    if (_this.item.suffix) {
                        val = _this.item.suffix === '%' ? (parseFloat(_this.inputEl.textContent) / 100).toString() : parseFloat(_this.inputEl.textContent).toString();
                    }
                    _this.item.context.emit('user-input', _this, val);
                    _this.changeSubmitted = true;
                    _this.inputEl.blur();
                }
            });
        }
        return _this;
    }
    Input.prototype.setUIValue = function (val) {
        this.item.value = val;
        if (typeof val === 'string') {
            if (this.item.suffix) {
                if (this.item.suffix === '') {
                    val = parseFloat(val) + this.item.suffix;
                }
                else {
                    val = (this.item.suffix === '%' ? parseFloat(val) * 100 : parseFloat(val)) + " " + this.item.suffix;
                }
            }
            this.inputEl.textContent = val;
        }
        else {
            var text = '';
            this.unit = val['Unit'];
            if (val['Unit']) {
                if (val['Unit'] === '') {
                    text = "" + val['__text__'] + val['Unit'];
                }
                else {
                    text = val['__text__'] + " " + val['Unit'];
                }
            }
            this.inputEl.textContent = text;
        }
    };
    return Input;
}(Entry));
exports.Input = Input;
var MultiBox = (function (_super) {
    __extends(MultiBox, _super);
    function MultiBox(item) {
        var _this = _super.call(this, item) || this;
        _this.viewUnselectedItems = [];
        _this.viewSelectedItems = [];
        _this.unselectedItems = [];
        _this.selectedItems = [];
        _this.leftSelection = [];
        _this.rightSelection = [];
        if (item.id) {
            _this.inputEl.id = item.id;
        }
        _this.boxWrapperEl = document.createElement('span');
        _this.boxWrapperEl.className = 'pane-item-entry-box-wrapper';
        _this.inputEl = document.createElement('div');
        _this.inputEl.className = 'pane-item-entry-input';
        _this.inputEl.contentEditable = 'true';
        _this.inputEl.style.width = 'calc(100% - 20px)';
        _this.inputEl.style.whiteSpace = 'nowrap';
        _this.inputEl.style.overflow = 'hidden';
        _this.buttonEl = document.createElement('i');
        _this.buttonEl.className = 'fas fa-ellipsis-h';
        _this.buttonEl.style.marginLeft = '5px';
        _this.buttonEl.style.bottom = '2px';
        _this.buttonEl.style.position = 'relative';
        _this.buttonEl.style.cursor = 'pointer';
        _this.boxWrapperEl.appendChild(_this.inputEl);
        _this.boxWrapperEl.appendChild(_this.buttonEl);
        _this.el.appendChild(_this.boxWrapperEl);
        _this.el.appendChild(_this.boxWrapperEl);
        _this.buttonEl.onclick = function (e) {
            _this.item.context.emit('user-input', _this, 'multi-box-open');
            var modalWrapperEl = document.createElement('div');
            modalWrapperEl.className = 'pane-multi-box-modal-wrapper';
            var leftColEl = document.createElement('div');
            leftColEl.className = 'pane-multi-box-modal-col';
            modalWrapperEl.appendChild(leftColEl);
            var middleColEl = document.createElement('div');
            middleColEl.className = 'pane-multi-box-modal-icon-col';
            modalWrapperEl.appendChild(middleColEl);
            var rightColEl = document.createElement('div');
            rightColEl.className = 'pane-multi-box-modal-col';
            modalWrapperEl.appendChild(rightColEl);
            var endColEl = document.createElement('div');
            endColEl.className = 'pane-multi-box-modal-icon-col';
            modalWrapperEl.appendChild(endColEl);
            var cancelIcon = document.createElement('i');
            cancelIcon.className = 'pane-multi-box-modal-close-icon fas fa-times';
            cancelIcon.onclick = function (e) {
                modalWrapperEl.remove();
            };
            endColEl.appendChild(cancelIcon);
            var filterUnselectedEl = document.createElement('input');
            filterUnselectedEl.className = 'pane-multi-box-modal-input';
            var filterUnselectedSearchIcon = document.createElement('i');
            filterUnselectedSearchIcon.className = 'pane-multi-box-modal-input-icon fas fa-search';
            filterUnselectedSearchIcon.style.left = 'calc(40% - 12px)';
            filterUnselectedSearchIcon.onclick = function (e) {
                if (filterUnselectedEl.value && filterUnselectedEl.value !== '') {
                    _this.resetSelection(false);
                    filterUnselectedEl.value = '';
                    _this.unselectedFilterString = undefined;
                    $(filterUnselectedSearchIcon).removeClass('fa-times').addClass('fa-search');
                    filterUnselectedSearchIcon.style.cursor = '';
                    _this.filter(false);
                }
            };
            filterUnselectedEl.oninput = function (e) {
                _this.resetSelection(false);
                if (!filterUnselectedEl.value || filterUnselectedEl.value === '' || filterUnselectedEl.value === null) {
                    $(filterUnselectedSearchIcon).removeClass('fa-times').addClass('fa-search');
                    filterUnselectedSearchIcon.style.cursor = '';
                }
                else {
                    $(filterUnselectedSearchIcon).removeClass('fa-search').addClass('fa-times');
                    filterUnselectedSearchIcon.style.cursor = 'pointer';
                }
                _this.unselectedFilterString = filterUnselectedEl.value;
                _this.filter(false);
            };
            leftColEl.appendChild(filterUnselectedSearchIcon);
            leftColEl.appendChild(filterUnselectedEl);
            var filterSelectedEl = document.createElement('input');
            filterSelectedEl.className = 'pane-multi-box-modal-input';
            var filterSelectedSearchIcon = document.createElement('i');
            filterSelectedSearchIcon.className = 'pane-multi-box-modal-input-icon fas fa-search';
            filterSelectedSearchIcon.style.right = 'calc(10% + 20px)';
            filterSelectedSearchIcon.onclick = function (e) {
                if (filterSelectedEl.value && filterSelectedEl.value !== '') {
                    _this.resetSelection(true);
                    filterSelectedEl.value = '';
                    _this.selectedFilterString = undefined;
                    $(filterSelectedSearchIcon).removeClass('fa-times').addClass('fa-search');
                    filterSelectedSearchIcon.style.cursor = '';
                    _this.filter(true);
                }
            };
            filterSelectedEl.oninput = function (e) {
                _this.resetSelection(true);
                if (!filterSelectedEl.value || filterSelectedEl.value === '' || filterSelectedEl.value === null) {
                    $(filterSelectedSearchIcon).removeClass('fa-times').addClass('fa-search');
                    filterSelectedSearchIcon.style.cursor = '';
                }
                else {
                    $(filterSelectedSearchIcon).removeClass('fa-search').addClass('fa-times');
                    filterSelectedSearchIcon.style.cursor = 'pointer';
                }
                _this.selectedFilterString = filterSelectedEl.value;
                _this.filter(true);
            };
            rightColEl.appendChild(filterSelectedSearchIcon);
            rightColEl.appendChild(filterSelectedEl);
            _this.unselectedBoxEl = document.createElement('div');
            _this.unselectedBoxEl.className = 'pane-multi-box-box-wrapper';
            leftColEl.appendChild(_this.unselectedBoxEl);
            _this.selectedBoxEl = document.createElement('div');
            _this.selectedBoxEl.className = 'pane-multi-box-box-wrapper';
            rightColEl.appendChild(_this.selectedBoxEl);
            var selectAllIcon = document.createElement('i');
            selectAllIcon.className = 'pane-multi-box-modal-icon fas fa-chevron-double-right';
            selectAllIcon.onclick = function (e) {
                _this.leftSelection = _this.unselectedItems;
                _this.applySelection(true, false);
            };
            middleColEl.appendChild(selectAllIcon);
            var selectIcon = document.createElement('i');
            selectIcon.className = 'pane-multi-box-modal-icon fas fa-chevron-right';
            selectIcon.onclick = function (e) {
                _this.applySelection(true, false);
            };
            middleColEl.appendChild(selectIcon);
            var unselectIcon = document.createElement('i');
            unselectIcon.className = 'pane-multi-box-modal-icon fas fa-chevron-left';
            unselectIcon.onclick = function (e) {
                _this.applySelection(false, true);
            };
            middleColEl.appendChild(unselectIcon);
            var unselectAllIcon = document.createElement('i');
            unselectAllIcon.className = 'pane-multi-box-modal-icon fas fa-chevron-double-left';
            unselectAllIcon.onclick = function (e) {
                _this.rightSelection = _this.selectedItems;
                _this.applySelection(false, true);
            };
            middleColEl.appendChild(unselectAllIcon);
            var allUpIcon = document.createElement('i');
            allUpIcon.className = 'pane-multi-box-modal-icon fas fa-chevron-double-up';
            allUpIcon.onclick = function (e) {
                for (var i = 0; i < _this.rightSelection.length; i++) {
                    var item_1 = _this.rightSelection[i];
                    var index = _this.viewSelectedItems.indexOf(item_1);
                    var origIndex = _this.selectedItems.indexOf(item_1);
                    _this.viewSelectedItems.splice(index, 1);
                    _this.viewSelectedItems.unshift(item_1);
                    _this.selectedItems.splice(origIndex, 1);
                    _this.selectedItems.unshift(item_1);
                }
                _this.applySelection(false, false);
            };
            var upIcon = document.createElement('i');
            upIcon.className = 'pane-multi-box-modal-icon fas fa-chevron-up';
            upIcon.onclick = function (e) {
                for (var i = 0; i < _this.viewSelectedItems.length; i++) {
                    var item_2 = _this.viewSelectedItems[i];
                    var isInSelection = _this.rightSelection.indexOf(item_2) !== -1;
                    var origIndex = _this.selectedItems.indexOf(item_2);
                    if (isInSelection && i !== 0) {
                        _this.viewSelectedItems[i] = _this.viewSelectedItems[i - 1];
                        _this.viewSelectedItems[i - 1] = item_2;
                        var lowerPosInOrig = _this.selectedItems.indexOf(_this.viewSelectedItems[i]);
                        _this.selectedItems[origIndex] = _this.selectedItems[lowerPosInOrig];
                        _this.selectedItems[lowerPosInOrig] = item_2;
                    }
                }
                _this.applySelection(false, false);
            };
            var allDownIcon = document.createElement('i');
            allDownIcon.className = 'pane-multi-box-modal-icon fas fa-chevron-double-down';
            allDownIcon.onclick = function (e) {
                for (var i = 0; i < _this.rightSelection.length; i++) {
                    var item_3 = _this.rightSelection[i];
                    var index = _this.viewSelectedItems.indexOf(item_3);
                    var origIndex = _this.selectedItems.indexOf(item_3);
                    _this.viewSelectedItems.splice(index, 1);
                    _this.viewSelectedItems.push(item_3);
                    _this.selectedItems.splice(origIndex, 1);
                    _this.selectedItems.push(item_3);
                }
                _this.applySelection(false, false);
            };
            var downIcon = document.createElement('i');
            downIcon.className = 'pane-multi-box-modal-icon fas fa-chevron-down';
            downIcon.onclick = function (e) {
                for (var i = _this.viewSelectedItems.length - 1; i >= 0; i--) {
                    var item_4 = _this.viewSelectedItems[i];
                    var isInSelection = _this.rightSelection.indexOf(item_4) !== -1;
                    var origIndex = _this.selectedItems.indexOf(item_4);
                    if (isInSelection && i < _this.viewSelectedItems.length - 1) {
                        _this.viewSelectedItems[i] = _this.viewSelectedItems[i + 1];
                        _this.viewSelectedItems[i + 1] = item_4;
                        var lowerPosInOrig = _this.selectedItems.indexOf(_this.viewSelectedItems[i]);
                        _this.selectedItems[origIndex] = _this.selectedItems[lowerPosInOrig];
                        _this.selectedItems[lowerPosInOrig] = item_4;
                    }
                }
                _this.applySelection(false, false);
            };
            endColEl.appendChild(allUpIcon);
            endColEl.appendChild(upIcon);
            endColEl.appendChild(downIcon);
            endColEl.appendChild(allDownIcon);
            var submitButton = document.createElement('button');
            submitButton.textContent = 'OK';
            submitButton.className = 'pane-multi-box-modal-submit-button';
            submitButton.onclick = function (e) {
                modalWrapperEl.remove();
                var val = _this.selectedItems.join(';');
                _this.item.context.emit('user-input', _this, val);
            };
            endColEl.appendChild(submitButton);
            document.body.appendChild(modalWrapperEl);
        };
        _this.inputEl.addEventListener('keyup', function (ev) {
            ev.preventDefault();
            ev.stopPropagation();
        });
        _this.inputEl.addEventListener('focus', function (ev) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
            if (!_this.item.triggeredByEvent && !_this.item.triggeredBySetting) {
                return;
            }
            _this.changeSubmitted = false;
            selectText(_this.inputEl);
        });
        _this.inputEl.addEventListener('blur', function (ev) {
            app_states_1.appStates.preventGlobalKeyEvents = false;
            if (!_this.item.triggeredByEvent && !_this.item.triggeredBySetting || _this.changeSubmitted) {
                return;
            }
            var val = _this.inputEl.textContent;
            _this.item.context.emit('user-input', _this, val);
        });
        _this.inputEl.addEventListener('keydown', function (ev) {
            if (ev.keyCode === 13) {
                ev.preventDefault();
                if (!_this.item.triggeredByEvent && !_this.item.triggeredBySetting) {
                    return;
                }
                var val = _this.inputEl.textContent;
                if (_this.item.suffix) {
                    val = parseFloat(_this.inputEl.textContent).toString();
                }
                _this.item.context.emit('user-input', _this, val);
                _this.changeSubmitted = true;
                _this.inputEl.blur();
            }
        });
        return _this;
    }
    MultiBox.prototype.filter = function (inSelection) {
        var _this = this;
        var filterString = inSelection ? this.selectedFilterString : this.unselectedFilterString;
        var arr = inSelection ? this.selectedItems : this.unselectedItems;
        if (inSelection) {
            this.viewSelectedItems = [];
        }
        else {
            this.viewUnselectedItems = [];
        }
        if (filterString && filterString !== '' && filterString !== null) {
            arr.forEach(function (item) {
                if (item.toLowerCase().indexOf(filterString.toLowerCase()) !== -1) {
                    if (inSelection) {
                        _this.viewSelectedItems.push(item);
                    }
                    else {
                        _this.viewUnselectedItems.push(item);
                    }
                }
            });
        }
        else {
            if (inSelection) {
                this.viewSelectedItems = arr.slice();
            }
            else {
                this.viewUnselectedItems = arr.slice();
            }
        }
        this.createViewList(inSelection);
    };
    MultiBox.prototype.computeLists = function (props, attr) {
        var _this = this;
        this.selectedItems = [];
        this.unselectedItems = [];
        this.viewUnselectedItems = [];
        this.viewSelectedItems = [];
        this.selectedFilterString = "";
        this.unselectedFilterString = "";
        var options = this.item.value.split(';');
        if (!(options.length === 1 && options[0] === "")) {
            this.selectedItems = options;
        }
        var properties;
        if (props && props.Properties) {
            properties = Array.isArray(props.Properties) ? props.Properties : [props.Properties];
            properties.forEach(function (prop, index) {
                properties[index] = '@' + prop;
            });
        }
        if (attr && attr.Attribute) {
            var attributes = Array.isArray(attr.Attribute) ? attr.Attribute : [attr.Attribute];
            attributes = attributes.concat(properties);
            attributes.forEach(function (attribute) {
                if (options.indexOf(attribute) === -1) {
                    _this.unselectedItems.push(attribute);
                }
            });
        }
        this.viewSelectedItems = this.selectedItems.slice();
        this.viewUnselectedItems = this.unselectedItems.slice();
        this.applySelection(false, false);
    };
    MultiBox.prototype.resetSelection = function (inSelection) {
        if (inSelection) {
            this.rightSelection = [];
            this.selectedItems.forEach(function (item) {
                var el = document.getElementById(item);
                if (el) {
                    el.style.backgroundColor = 'white';
                }
            });
        }
        else {
            this.leftSelection = [];
            this.unselectedItems.forEach(function (item) {
                var el = document.getElementById(item);
                if (el) {
                    el.style.backgroundColor = 'white';
                }
            });
        }
    };
    MultiBox.prototype.createViewList = function (inSelection) {
        var _this = this;
        if (!inSelection) {
            $(this.unselectedBoxEl).empty();
            this.viewUnselectedItems.forEach(function (item) {
                var rowEl = document.createElement('div');
                rowEl.className = 'pane-multi-box-box-row';
                var isProp = item.startsWith('@');
                var displayVal = isProp ? item.replace('@', '') : item;
                rowEl.textContent = displayVal;
                rowEl.id = item;
                if (isProp) {
                    rowEl.style.fontStyle = 'italic';
                }
                var index = _this.leftSelection.indexOf(item);
                if (index !== -1) {
                    rowEl.style.backgroundColor = 'rgb(160, 160, 160)';
                }
                rowEl.onclick = function (e) {
                    index = _this.leftSelection.indexOf(item);
                    if (index !== -1) {
                        _this.leftSelection.splice(index, 1);
                        rowEl.style.backgroundColor = 'white';
                    }
                    else {
                        _this.leftSelection.push(item);
                        rowEl.style.backgroundColor = 'rgb(160, 160, 160)';
                    }
                };
                _this.unselectedBoxEl.appendChild(rowEl);
            });
        }
        else {
            $(this.selectedBoxEl).empty();
            this.viewSelectedItems.forEach(function (item) {
                var rowEl = document.createElement('div');
                rowEl.className = 'pane-multi-box-box-row';
                var isProp = item.startsWith('@');
                var displayVal = isProp ? item.replace('@', '') : item;
                rowEl.textContent = displayVal;
                rowEl.id = item;
                if (isProp) {
                    rowEl.style.fontStyle = 'italic';
                }
                var index = _this.rightSelection.indexOf(item);
                if (index !== -1) {
                    rowEl.style.backgroundColor = 'rgb(160, 160, 160)';
                }
                rowEl.onclick = function (e) {
                    index = _this.rightSelection.indexOf(item);
                    if (index !== -1) {
                        _this.rightSelection.splice(index, 1);
                        rowEl.style.backgroundColor = 'white';
                    }
                    else {
                        _this.rightSelection.push(item);
                        rowEl.style.backgroundColor = 'rgb(160, 160, 160)';
                    }
                };
                _this.selectedBoxEl.appendChild(rowEl);
            });
        }
    };
    MultiBox.prototype.applySelection = function (addToSelection, removeFromSelection) {
        var _this = this;
        if (addToSelection) {
            this.selectedItems = this.selectedItems.concat(this.leftSelection);
            this.unselectedItems = this.unselectedItems.filter(function (item) {
                var index = _this.leftSelection.indexOf(item);
                return index === -1;
            });
            this.leftSelection = [];
        }
        else if (removeFromSelection) {
            this.unselectedItems = this.unselectedItems.concat(this.rightSelection);
            this.selectedItems = this.selectedItems.filter(function (item) {
                var index = _this.rightSelection.indexOf(item);
                return index === -1;
            });
            this.rightSelection = [];
        }
        this.filter(true);
        this.filter(false);
    };
    MultiBox.prototype.setUIValue = function (val) {
        this.item.value = val;
        if (typeof val === 'string') {
            this.inputEl.textContent = val;
        }
        else {
            var text = '';
            this.inputEl.textContent = text;
        }
    };
    return MultiBox;
}(Entry));
exports.MultiBox = MultiBox;
var Checkbox = (function (_super) {
    __extends(Checkbox, _super);
    function Checkbox(item, isFlagOption) {
        var _this = _super.call(this, item) || this;
        _this.val = false;
        _this.isFlagOption = false;
        if (isFlagOption) {
            _this.isFlagOption = isFlagOption;
        }
        _this.wrapperEl = document.createElement('div');
        _this.wrapperEl.className = "pane-switch-wrapper";
        _this.wrapperEl.style.marginLeft = '5px';
        _this.el.appendChild(_this.wrapperEl);
        _this.hiddenCheckbox = document.createElement('input');
        _this.hiddenCheckbox.type = 'checkbox';
        _this.hiddenCheckbox.style.display = 'none';
        _this.hiddenCheckbox.value = _this.val.toString();
        if (_this.item.id) {
            _this.hiddenCheckbox.id = item.id;
        }
        _this.wrapperEl.appendChild(_this.hiddenCheckbox);
        _this.boxEl = document.createElement('div');
        _this.boxEl.className = 'switch-wrapper switch-off';
        _this.wrapperEl.appendChild(_this.boxEl);
        _this.handleEl = document.createElement('div');
        _this.handleEl.className = 'switch-handle';
        _this.boxEl.appendChild(_this.handleEl);
        _this.boxEl.onclick = function (e) {
            var val = _this.val ? 'false' : 'true';
            _this.setUIValue(val);
            if (_this.isFlagOption) {
                _this.item.context.emit('flag-option-changed', _this, _this.val);
            }
            else {
                if (!_this.item.triggeredByEvent && !_this.item.triggeredBySetting && !item.id) {
                    return;
                }
                _this.item.context.emit('user-input', _this, _this.val);
            }
        };
        return _this;
    }
    Checkbox.prototype.setUIValue = function (val) {
        this.val = (val === 'true');
        this.item.value = this.val;
        this.hiddenCheckbox.value = val;
        if (this.val) {
            $(this.boxEl).removeClass('switch-off').addClass('switch-on');
        }
        else {
            $(this.boxEl).removeClass('switch-on').addClass('switch-off');
        }
    };
    Checkbox.prototype.setKey = function (key) {
        this.key = key.toString();
    };
    return Checkbox;
}(Entry));
exports.Checkbox = Checkbox;
var Flag = (function (_super) {
    __extends(Flag, _super);
    function Flag(item) {
        var _this = _super.call(this, item) || this;
        _this.state = false;
        _this.item.context.on('flag-option-changed', function (context, value) {
            var index = _this.activatedOptionsValue.indexOf(context.item.text);
            if (value) {
                if (index === -1) {
                    _this.activatedOptionsValue.push(context.item.text);
                }
            }
            else {
                if (index != -1) {
                    _this.activatedOptionsValue.splice(index, 1);
                }
            }
            _this.item.context.emit('user-input', _this, _this.activatedOptionsValue.join(' '));
        });
        return _this;
    }
    Flag.prototype.addOptions = function (options) {
        var _this = this;
        this.options = options;
        options.forEach(function (option) {
            var item = new _1.Item(_this.item.context, option.displayName);
            _this.item.children.push(item);
            item.parent = _this.item;
            item.value = option.value;
            item.visual = new Checkbox(item, true);
        });
    };
    Flag.prototype.setUIValue = function (val) {
        this.activatedOptionsValue = val.split(' ');
        for (var _i = 0, _b = this.item.children; _i < _b.length; _i++) {
            var child = _b[_i];
            var input = child.visual;
            input.setUIValue((this.activatedOptionsValue.indexOf(child.text) !== -1) ? 'true' : 'false');
        }
    };
    return Flag;
}(Folder));
exports.Flag = Flag;
var Button = (function (_super) {
    __extends(Button, _super);
    function Button(item) {
        var _this = _super.call(this, item, true) || this;
        _this.buttonEl = document.createElement('button');
        _this.buttonEl.classList.add('pane-item-entry-button');
        _this.buttonEl.textContent = item.text;
        _this.buttonEl.id = item.id;
        _this.el.appendChild(_this.buttonEl);
        return _this;
    }
    Button.prototype.setUIValue = function (val) {
    };
    return Button;
}(Entry));
exports.Button = Button;
var PropertyAttributes = (function (_super) {
    __extends(PropertyAttributes, _super);
    function PropertyAttributes(item) {
        var _this = _super.call(this, item) || this;
        _this.listEl = document.createElement('div');
        _this.el.appendChild(_this.listEl);
        return _this;
    }
    PropertyAttributes.prototype.fill = function (list) {
        for (var _i = 0, list_1 = list; _i < list_1.length; _i++) {
            var _b = list_1[_i], k = _b[0], v = _b[1];
            var ulEl = document.createElement('div');
            ulEl.textContent = k + ': ' + v;
            this.listEl.appendChild(ulEl);
        }
    };
    PropertyAttributes.prototype.clear = function () {
        while (this.listEl.firstChild) {
            this.listEl.removeChild(this.listEl.firstChild);
        }
    };
    return PropertyAttributes;
}(Entry));
exports.PropertyAttributes = PropertyAttributes;
var Select = (function (_super) {
    __extends(Select, _super);
    function Select(item) {
        var _this = _super.call(this, item) || this;
        _this.selectEl = document.createElement('select');
        _this.selectEl.classList.add('pane-item-entry-select');
        if (item.id) {
            _this.selectEl.id = item.id;
        }
        _this.el.appendChild(_this.selectEl);
        if (!_this.item.triggeredByEvent && !_this.item.triggeredBySetting && !item.id) {
            return _this;
        }
        _this.selectEl.onchange = function () {
            _this.item.context.emit('user-input', _this, _this.selectEl.value);
        };
        return _this;
    }
    Select.prototype.setUIValue = function (val) {
        this.item.value = val;
        this.selectEl.value = val;
    };
    Select.prototype.addOptions = function (displays, optionsVals) {
        for (var i = 0; i < displays.length; i++) {
            var el = document.createElement('option');
            el.textContent = displays[i];
            el.value = optionsVals[i];
            this.selectEl.appendChild(el);
        }
    };
    return Select;
}(Entry));
exports.Select = Select;
function hexToRgba(hex) {
    var bigint, r, g, b, a;
    var aRgb;
    if (hex[0] == '#') {
        aRgb = hex.substr(1);
    }
    else {
        aRgb = hex.substr(2);
    }
    bigint = parseInt(aRgb, 16);
    r = (bigint >> 16) & 255;
    g = (bigint >> 8) & 255;
    b = bigint & 255;
    var rgb = r + "," + g + "," + b;
    a = ((bigint >> 24) & 255) / 255;
    return {
        a: a,
        r: r,
        g: g,
        b: b
    };
}
var ColorPicker = (function (_super) {
    __extends(ColorPicker, _super);
    function ColorPicker(item) {
        var _this = _super.call(this, item) || this;
        _this.isDefaultSet = false;
        _this.colorpicker = document.createElement('span');
        _this.colorpicker.classList.add('pane-item-entry-colorpicker');
        _this.el.appendChild(_this.colorpicker);
        _this.colorpicker.addEventListener('click', function (ev) {
            _this.openPalette();
        }, false);
        return _this;
    }
    ColorPicker.prototype.openPalette = function () {
        var _this = this;
        var activeColor = this.colorpicker.dataset['lastPickedColor'];
        this.palette = new custom_palette_1.CustomPalette(activeColor, this.showAlpha);
        this.palette.on('customColorChosen', function (color) { return _this.updateElementState(color); });
    };
    ColorPicker.prototype.updateElementState = function (color) {
        this.colorpicker.dataset['lastPickedColor'] = color;
        this.colorpicker.style.backgroundColor = color;
        var hashHex = tinycolor(color).toHexString();
        if (color.indexOf('rgba') !== -1) {
            var alpha = Math.round(tinycolor(color)._a * 255).toString(16);
            hashHex = hashHex.replace('#', '#' + alpha);
        }
        this.item.value = hashHex;
        if (!this.item.triggeredByEvent && !this.item.triggeredBySetting) {
            return;
        }
        this.item.context.emit('user-input', this, hashHex);
    };
    ColorPicker.prototype.html = function () {
        return this.el;
    };
    ColorPicker.prototype.setUIValue = function (hexColor) {
        var RGBAColor = hexToRgba(hexColor);
        this.item.value = hexColor;
        this.alpha = RGBAColor.a;
        var cssColor;
        if (this.showAlpha) {
            cssColor = "rgba(" + RGBAColor.r + ", " + RGBAColor.g + ", " + RGBAColor.b + ", " + this.alpha + ")";
        }
        else {
            cssColor = "rgb(" + RGBAColor.r + ", " + RGBAColor.g + ", " + RGBAColor.b + ")";
        }
        if (!this.isDefaultSet) {
            this.colorpicker.dataset['defaultColor'] = cssColor;
            this.isDefaultSet = true;
        }
        this.colorpicker.dataset['lastPickedColor'] = cssColor;
        this.colorpicker.style.backgroundColor = cssColor;
    };
    return ColorPicker;
}(Entry));
exports.ColorPicker = ColorPicker;
var Slider = (function (_super) {
    __extends(Slider, _super);
    function Slider(item) {
        var _this = _super.call(this, item) || this;
        _this.hasTouchHandler = false;
        _this.handleMouseMove = function (e) {
            var positionAbsolute;
            if (e.touches) {
                positionAbsolute = Math.min(Math.max(0, (e.touches[0].pageX - this.sliderOffset)), this.sliderWidth);
            }
            else {
                positionAbsolute = Math.min(Math.max(0, (e.pageX - this.sliderOffset)), this.sliderWidth);
            }
            var valueRelativeToHundred = 100 / (this.sliderWidth / positionAbsolute);
            var fullElementWidth = this.sliderWidth;
            var positionRelativeToFullWidth;
            if (positionAbsolute <= 5) {
                positionRelativeToFullWidth = '0px';
            }
            else {
                positionRelativeToFullWidth = 100 / (fullElementWidth / positionAbsolute) + '%';
            }
            this.handleEl.style.left = positionRelativeToFullWidth;
            this.fedBar.style.width = positionRelativeToFullWidth;
            this.setUIValue(valueRelativeToHundred / 100);
        };
        _this.handleMouseUp = function (e) {
            var positionAbsolute;
            if (e.touches) {
                positionAbsolute = Math.min(Math.max(0, (e.changedTouches[0].pageX - this.sliderOffset - 5)), this.sliderWidth);
            }
            else {
                positionAbsolute = Math.min(Math.max(0, (e.pageX - this.sliderOffset - 5)), this.sliderWidth);
            }
            var valueRelativeToHundred = 100 / (this.sliderWidth / positionAbsolute);
            this.setUIValue(valueRelativeToHundred / 100);
            this.item.context.emit('user-input', this, valueRelativeToHundred / 100);
            this.item.value = valueRelativeToHundred / 100;
            document.removeEventListener('mouseup', this.handleMouseUp);
            document.removeEventListener('mousemove', this.handleMouseMove);
            document.removeEventListener('touchmove', this.handleMouseMove);
            document.removeEventListener('touchend', this.handleMouseUp);
        };
        _this.handleMouseDown = function (e) {
            e.preventDefault();
            e.stopPropagation();
            this.sliderOffset = $(e.target).parent().offset().left;
            this.sliderWidth = $(e.target).parent().width();
            document.addEventListener('mouseup', this.handleMouseUp);
            document.addEventListener('mousemove', this.handleMouseMove);
            document.addEventListener('touchmove', this.handleMouseMove);
            document.addEventListener('touchend', this.handleMouseUp);
        };
        _this.wrapperEl = document.createElement('div');
        _this.wrapperEl.className = "pane-item-entry-wrapper";
        _this.sliderOffset = 0;
        _this.sliderWidth = 0;
        _this.handleMouseDown = _this.handleMouseDown.bind(_this);
        _this.handleMouseMove = _this.handleMouseMove.bind(_this);
        _this.handleMouseUp = _this.handleMouseUp.bind(_this);
        _this.el.appendChild(_this.wrapperEl);
        _this.inputEl = document.createElement('input');
        _this.inputEl.className = 'slider-value-input';
        _this.inputEl.min = '0';
        _this.inputEl.max = '100';
        _this.inputEl.style.width = '25px';
        _this.inputEl.onblur = function (ev) {
            _this.item.context.emit('user-input', _this, parseFloat(_this.inputEl.value) / 100);
            _this.setUIValue(parseFloat(_this.inputEl.value) / 100);
            _this.item.value = parseFloat(_this.inputEl.value) / 100;
        };
        _this.inputEl.onchange = function (ev) {
            _this.handleInputChanged(ev);
        };
        _this.wrapperEl.appendChild(_this.inputEl);
        var sliderWrapper = document.createElement('div');
        sliderWrapper.className = 'slider-wrapper';
        sliderWrapper.style.width = 'calc(100% - 50px)';
        _this.wrapperEl.appendChild(sliderWrapper);
        var sliderBar = document.createElement('div');
        sliderBar.style.position = 'relative';
        sliderBar.className = 'slider-bar';
        sliderWrapper.appendChild(sliderBar);
        _this.fedBar = document.createElement('span');
        _this.fedBar.className = 'slider-bar-filled';
        sliderBar.appendChild(_this.fedBar);
        _this.handleEl = document.createElement('div');
        _this.handleEl.style.marginLeft = '0';
        $(_this.handleEl).addClass('slider-handle draggable');
        sliderBar.appendChild(_this.handleEl);
        _this.handleEl.addEventListener('touchstart', _this.handleMouseDown);
        _this.handleEl.onmousedown = function (ev) {
            _this.handleMouseDown(ev);
        };
        sliderBar.onmousedown = function (ev) {
            _this.handleClick(ev);
        };
        var emptyBar = document.createElement('span');
        emptyBar.className = 'slider-bar-empty';
        emptyBar.style.width = '100%';
        sliderBar.appendChild(emptyBar);
        return _this;
    }
    Slider.prototype.setUIValue = function (val) {
        var initialSet = false;
        if (this.inputEl.value === '' || !this.inputEl.value || this.inputEl.value === undefined) {
            initialSet = true;
        }
        this.inputEl.value = Math.round(val * 100) + '';
        if (initialSet || parseFloat(this.handleEl.style.left.replace('%', "")) !== val) {
            var sliderWidth = $(this.inputEl).next().children().first().width();
            var positionAbsolute = sliderWidth * val;
            var fullElementWidth = sliderWidth;
            var positionRelativeToFullWidth = void 0;
            if (positionAbsolute <= 5) {
                positionRelativeToFullWidth = '0px';
            }
            else {
                positionRelativeToFullWidth = 100 / (fullElementWidth / positionAbsolute) + '%';
            }
            this.handleEl.style.left = positionRelativeToFullWidth;
            this.fedBar.style.width = positionRelativeToFullWidth;
        }
    };
    Slider.prototype.setKey = function (key) {
        this.key = key.toString();
    };
    Slider.prototype.handleInputChanged = function (e) {
        var val = e.target.value;
        var sliderWidth = $(e.target).next().children().first().width();
        var positionAbsolute = (sliderWidth / 100) * val;
        var fullElementWidth = sliderWidth;
        var positionRelativeToFullWidth;
        if (positionAbsolute <= 5) {
            positionRelativeToFullWidth = '0px';
        }
        else {
            positionRelativeToFullWidth = 100 / (fullElementWidth / positionAbsolute) + '%';
        }
        this.handleEl.style.left = positionRelativeToFullWidth;
        this.fedBar.style.width = positionRelativeToFullWidth;
        this.item.context.emit('user-input', this, val / 100);
        this.item.value = val / 100;
    };
    Slider.prototype.handleClick = function (e) {
        this.sliderWidth = $(e.target).width();
        this.sliderOffset = $(e.target).offset().left;
        var positionAbsolute = Math.min(Math.max(0, (e.pageX - this.sliderOffset)), this.sliderWidth);
        var valueRelativeToHundred = 100 / (this.sliderWidth / positionAbsolute);
        var fullElementWidth = this.sliderWidth;
        var positionRelativeToFullWidth;
        if (positionAbsolute <= 5) {
            positionRelativeToFullWidth = '0px';
        }
        else {
            positionRelativeToFullWidth = 100 / (fullElementWidth / positionAbsolute) + '%';
        }
        this.handleEl.style.left = positionRelativeToFullWidth;
        this.fedBar.style.width = positionRelativeToFullWidth;
        this.setUIValue(valueRelativeToHundred / 100);
        this.item.context.emit('user-input', this, valueRelativeToHundred / 100);
        this.item.value = valueRelativeToHundred / 100;
    };
    return Slider;
}(Entry));
exports.Slider = Slider;
var SingleSwitch = (function () {
    function SingleSwitch(parent, title, val, clickCallback) {
        var _this = this;
        this.parent = parent;
        this.wrapperEl = document.createElement('div');
        this.wrapperEl.className = "pane-inline-switch-wrapper";
        this.titleEl = document.createElement('div');
        this.parent.appendChild(this.wrapperEl);
        this.hiddenCheckbox = document.createElement('input');
        this.hiddenCheckbox.type = 'checkbox';
        this.hiddenCheckbox.value = this.val;
        this.hiddenCheckbox.style.display = 'none';
        this.wrapperEl.appendChild(this.hiddenCheckbox);
        this.titleEl.className = 'pane-inline-switch-title';
        this.setKey(title);
        this.wrapperEl.appendChild(this.titleEl);
        this.boxEl = document.createElement('div');
        this.boxEl.className = 'switch-wrapper switch-on';
        this.wrapperEl.appendChild(this.boxEl);
        this.handleEl = document.createElement('div');
        this.handleEl.className = 'switch-handle';
        this.boxEl.appendChild(this.handleEl);
        this.wrapperEl.onclick = function (e) {
            var val = _this.val === 'true' ? 'false' : 'true';
            _this.setValue(val);
            clickCallback(val);
        };
        this.setValue(val);
    }
    SingleSwitch.prototype.setValue = function (val) {
        this.val = val;
        this.hiddenCheckbox.value = this.val;
        var boolVal = this.val === 'true';
        if (boolVal) {
            $(this.boxEl).removeClass('switch-off').addClass('switch-on');
        }
        else {
            $(this.boxEl).removeClass('switch-on').addClass('switch-off');
        }
    };
    SingleSwitch.prototype.setKey = function (key) {
        this.titleEl.textContent = key;
    };
    return SingleSwitch;
}());
exports.SingleSwitch = SingleSwitch;
var PlainSwitch = (function () {
    function PlainSwitch(indent, parent, langId, tooltipId, callback, isPoppedOut) {
        if (isPoppedOut === void 0) { isPoppedOut = false; }
        var _this = this;
        this.val = 'false';
        this.langId = langId;
        this.tooltipId = tooltipId;
        this.callback = callback;
        this.wrapperEl = document.createElement('tr');
        this.wrapperEl.className = 'pane-item';
        parent.appendChild(this.wrapperEl);
        this.nameEl = document.createElement('td');
        this.nameEl.className = 'pane-item-entry-name';
        this.nameEl.textContent = ui.translate(langId);
        applyIndent(this.nameEl, indent);
        this.tooltip = new tooltip_1.WVTooltip(this.nameEl);
        this.wrapperEl.appendChild(this.nameEl);
        var buttonWrapper = document.createElement('td');
        buttonWrapper.className = 'pane-item-visual';
        buttonWrapper.style.position = 'relative';
        this.wrapperEl.appendChild(buttonWrapper);
        this.switchWrapperEl = document.createElement('div');
        this.switchWrapperEl.className = "pane-inline-switch-wrapper";
        this.switchWrapperEl.style.marginLeft = '5px';
        buttonWrapper.appendChild(this.switchWrapperEl);
        this.hiddenCheckbox = document.createElement('input');
        this.hiddenCheckbox.type = 'checkbox';
        this.hiddenCheckbox.value = this.val;
        this.hiddenCheckbox.style.display = 'none';
        this.switchWrapperEl.appendChild(this.hiddenCheckbox);
        this.boxEl = document.createElement('div');
        this.boxEl.className = 'switch-wrapper switch-on';
        this.switchWrapperEl.appendChild(this.boxEl);
        this.handleEl = document.createElement('div');
        this.handleEl.className = 'switch-handle';
        this.boxEl.appendChild(this.handleEl);
        this.switchWrapperEl.onclick = function (e) {
            _this.setVal(_this.val === 'true' ? 'false' : 'true');
            callback(_this.val === 'true');
        };
        this.setVal('false');
        if (!isPoppedOut) {
            vsClient.on('@changeLang', function (lang) {
                _this.translate();
            });
        }
    }
    PlainSwitch.prototype.setVal = function (val) {
        this.val = val;
        this.hiddenCheckbox.value = this.val;
        var boolVal = this.val === 'true';
        if (boolVal) {
            $(this.boxEl).removeClass('switch-off').addClass('switch-on');
        }
        else {
            $(this.boxEl).removeClass('switch-on').addClass('switch-off');
        }
    };
    PlainSwitch.prototype.translate = function (translationCallback) {
        this.setText(translationCallback);
        this.setTooltip(translationCallback);
    };
    PlainSwitch.prototype.setText = function (translationCallback) {
        this.nameEl.textContent = translationCallback ? translationCallback(this.langId) : ui.translate(this.langId);
    };
    PlainSwitch.prototype.setTooltip = function (translationCallback) {
        this.tooltip.setTitle(translationCallback ? translationCallback(this.langId) : this.tooltipId);
    };
    return PlainSwitch;
}());
exports.PlainSwitch = PlainSwitch;
var PlainGroup = (function () {
    function PlainGroup(indent, parent, langId, tooltipLangId, isPoppedOut) {
        if (isPoppedOut === void 0) { isPoppedOut = false; }
        var _this = this;
        this.children = [];
        this.childGroups = [];
        this.minus = 'fa-minus-square';
        this.plus = 'fa-plus-square';
        this.collapse = function (alterIcon) {
            if (alterIcon === void 0) { alterIcon = false; }
            if (alterIcon) {
                _this.expander.classList.remove(_this.minus);
                _this.expander.classList.add(_this.plus);
            }
            _this.children.forEach(function (item) {
                $(item).hide();
            });
            if (_this.childGroups.length > 0) {
                _this.childGroups.forEach(function (item) {
                    $(item.wrapperEl).hide();
                    item.collapse(false);
                });
            }
        };
        this.expand = function (alterIcon) {
            if (alterIcon === void 0) { alterIcon = false; }
            if (alterIcon) {
                _this.expander.classList.remove(_this.plus);
                _this.expander.classList.add(_this.minus);
            }
            _this.children.forEach(function (item) {
                $(item).show();
            });
            if (_this.childGroups.length > 0) {
                _this.childGroups.forEach(function (item) {
                    $(item.wrapperEl).show();
                    if ($(item.expander).hasClass(_this.minus)) {
                        item.expand(false);
                    }
                });
            }
        };
        this.langId = langId;
        this.tooltipLangId = tooltipLangId;
        this.wrapperEl = document.createElement('tr');
        this.wrapperEl.className = 'pane-item';
        parent.appendChild(this.wrapperEl);
        var el = document.createElement('td');
        el.colSpan = 2;
        el.className = 'pane-item-visual pane-item-group';
        applyIndent(el, indent);
        this.tooltip = new tooltip_1.WVTooltip(el);
        this.wrapperEl.appendChild(el);
        this.expander = document.createElement('i');
        this.expander.classList.add('far');
        this.expander.classList.add(this.minus);
        this.expander.addEventListener('click', function (ev) {
            if (_this.expander.classList.contains(_this.minus)) {
                _this.collapse(true);
            }
            else if (_this.expander.classList.contains(_this.plus)) {
                _this.expand(true);
            }
        });
        var spacing = document.createElement('span');
        spacing.textContent = ' ';
        spacing.classList.add('pane-item-spacing');
        this.boldText = document.createElement('b');
        this.boldText.textContent = ui.translate(langId);
        el.appendChild(this.expander);
        el.appendChild(spacing);
        el.appendChild(this.boldText);
        if (!isPoppedOut) {
            vsClient.on('@changeLang', function (lang) {
                _this.translate();
            });
        }
    }
    PlainGroup.prototype.translate = function (translationCallback) {
        this.setText(translationCallback);
        this.setTooltip(translationCallback);
    };
    PlainGroup.prototype.setText = function (translationCallback) {
        this.boldText.textContent = translationCallback ? translationCallback(this.langId) : ui.translate(this.langId);
    };
    PlainGroup.prototype.setTooltip = function (translationCallback) {
        this.tooltip.setTitle(translationCallback ? translationCallback(this.langId) : ui.translate(this.tooltipLangId));
    };
    return PlainGroup;
}());
exports.PlainGroup = PlainGroup;
var PlainButton = (function () {
    function PlainButton(indent, parent, langId, tooltipId, buttonLangId, callback, isPoppedOut) {
        if (isPoppedOut === void 0) { isPoppedOut = false; }
        var _this = this;
        this.langId = langId;
        this.tooltipId = tooltipId;
        this.buttonLangId = buttonLangId;
        this.callback = callback;
        this.wrapperEl = document.createElement('tr');
        this.wrapperEl.className = 'pane-item';
        parent.appendChild(this.wrapperEl);
        this.nameEl = document.createElement('td');
        this.nameEl.className = 'pane-item-entry-name';
        this.nameEl.textContent = ui.translate(langId);
        applyIndent(this.nameEl, indent);
        this.tooltip = new tooltip_1.WVTooltip(this.nameEl);
        this.wrapperEl.appendChild(this.nameEl);
        var buttonWrapper = document.createElement('td');
        buttonWrapper.className = 'pane-item-visual';
        buttonWrapper.style.position = 'relative';
        this.wrapperEl.appendChild(buttonWrapper);
        this.buttonEl = document.createElement('button');
        this.buttonEl.classList.add('pane-item-entry-button');
        this.buttonEl.textContent = ui.translate(buttonLangId);
        this.buttonEl.onclick = function (ev) {
            _this.callback();
        };
        buttonWrapper.appendChild(this.buttonEl);
        if (!isPoppedOut) {
            vsClient.on('@changeLang', function (lang) {
                _this.translate();
            });
        }
    }
    PlainButton.prototype.translate = function (translationCallback) {
        this.setText(translationCallback);
        this.setTooltip(translationCallback);
    };
    PlainButton.prototype.setText = function (translationCallback) {
        this.nameEl.textContent = translationCallback ? translationCallback(this.langId) : ui.translate(this.langId);
        this.buttonEl.textContent = translationCallback ? translationCallback(this.langId) : ui.translate(this.buttonLangId);
    };
    PlainButton.prototype.setTooltip = function (translationCallback) {
        this.tooltip.setTitle(translationCallback ? translationCallback(this.langId) : this.tooltipId);
    };
    return PlainButton;
}());
exports.PlainButton = PlainButton;
;
var PlainSelect = (function () {
    function PlainSelect(indent, parent, langId, tooltipId, callback, isPoppedOut) {
        if (isPoppedOut === void 0) { isPoppedOut = false; }
        var _this = this;
        this.langId = langId;
        this.tooltipId = tooltipId;
        this.callback = callback;
        this.wrapperEl = document.createElement('tr');
        this.wrapperEl.className = 'pane-item';
        parent.appendChild(this.wrapperEl);
        this.nameEl = document.createElement('td');
        this.nameEl.className = 'pane-item-entry-name';
        this.nameEl.textContent = ui.translate(langId);
        applyIndent(this.nameEl, indent);
        this.tooltip = new tooltip_1.WVTooltip(this.nameEl);
        this.wrapperEl.appendChild(this.nameEl);
        var selectWrapper = document.createElement('td');
        selectWrapper.className = 'pane-item-visual';
        selectWrapper.style.position = 'relative';
        this.wrapperEl.appendChild(selectWrapper);
        this.selectEl = document.createElement('select');
        this.selectEl.classList.add('pane-item-entry-select');
        selectWrapper.appendChild(this.selectEl);
        this.selectEl.onchange = function () {
            _this.callback(_this.selectEl.value);
        };
        if (!isPoppedOut) {
            vsClient.on('@changeLang', function (lang) {
                _this.translate();
            });
        }
    }
    PlainSelect.prototype.translate = function (translationCallback) {
        this.setText(translationCallback);
        this.setTooltip(translationCallback);
    };
    PlainSelect.prototype.setText = function (translationCallback) {
        this.nameEl.textContent = translationCallback ? translationCallback(this.langId) : ui.translate(this.langId);
    };
    PlainSelect.prototype.setTooltip = function (translationCallback) {
        this.tooltip.setTitle(translationCallback ? translationCallback(this.langId) : this.tooltipId);
    };
    PlainSelect.prototype.clearOptions = function () {
        $(this.selectEl).empty();
    };
    PlainSelect.prototype.addOptions = function (options) {
        for (var i = 0; i < options.length; i++) {
            var el = document.createElement('option');
            el.textContent = options[i].name;
            el.value = options[i].val;
            this.selectEl.appendChild(el);
            if (options[i].isDefault) {
                el.selected = true;
            }
        }
    };
    return PlainSelect;
}());
exports.PlainSelect = PlainSelect;
var PlainSelectSingleLine = (function () {
    function PlainSelectSingleLine(indent, parent, callback) {
        var _this = this;
        this.callback = callback;
        this.wrapperEl = document.createElement('tr');
        this.wrapperEl.className = 'pane-item';
        parent.appendChild(this.wrapperEl);
        this.selectWrapperEl = document.createElement('td');
        this.selectWrapperEl.colSpan = 2;
        applyIndent(this.selectWrapperEl, indent);
        this.selectWrapperEl.className = 'pane-item-visual';
        this.selectWrapperEl.style.position = 'relative';
        this.wrapperEl.appendChild(this.selectWrapperEl);
        this.selectEl = document.createElement('select');
        this.selectEl.classList.add('pane-item-entry-select-single-line');
        this.selectWrapperEl.appendChild(this.selectEl);
        this.selectEl.onchange = function () {
            var name = _this.selectEl.options[_this.selectEl.selectedIndex].text;
            _this.setActivePreset(name);
            _this.callback(_this.selectEl.value);
        };
    }
    PlainSelectSingleLine.prototype.setActivePreset = function (name) {
        for (var i = 0; i < this.options.length; i++) {
            if (this.options[i].name === name) {
                this.options[i].isActive = true;
                this.activePreset = this.options[i];
                this.selectEl.options[i].selected = true;
            }
            else {
                this.options[i].isActive = false;
            }
        }
    };
    PlainSelectSingleLine.prototype.getActivePreset = function () {
        if (this.activePreset) {
            return this.activePreset;
        }
        var name = this.selectEl.options[this.selectEl.selectedIndex].text;
        for (var i = 0; i < this.options.length; i++) {
            if (this.options[i].name === name) {
                return this.options[i];
            }
        }
    };
    PlainSelectSingleLine.prototype.removeOption = function (option) {
        this.options.splice(this.options.indexOf(option), 1);
        this.setOptions(this.options);
    };
    PlainSelectSingleLine.prototype.removeOptionByName = function (name) {
        var index = this.options.map(function (item) { return item.name; }).indexOf(name);
        if (index !== -1) {
            this.options.splice(index, 1);
            this.setOptions(this.options);
        }
    };
    PlainSelectSingleLine.prototype.setOptions = function (options) {
        $(this.selectEl).empty();
        this.options = options;
        for (var i = 0; i < options.length; i++) {
            var el = document.createElement('option');
            el.textContent = options[i].name;
            el.value = options[i].val;
            this.selectEl.appendChild(el);
            if (options[i].isCustom) {
                el.className = 'pane-preset-option-custom';
            }
            if (options[i].isDefault) {
                $(this.selectEl).children().removeClass('pane-preset-option-default');
                $(el).addClass('pane-preset-option-default');
            }
            if ((options[i].isDefault && !this.activePreset) || options[i].isActive) {
                el.selected = true;
            }
        }
    };
    PlainSelectSingleLine.prototype.setDefault = function (option) {
        for (var i = 0; i < this.options.length; i++) {
            if (this.options[i].name === option.name) {
                this.options[i].isDefault = true;
            }
            else {
                this.options[i].isDefault = false;
            }
        }
        this.setOptions(this.options);
    };
    PlainSelectSingleLine.prototype.restoreDefault = function () {
        for (var i = 0; i < this.options.length; i++) {
            if (this.options[i].isDefault) {
                this.setActivePreset(this.options[i].name);
                return this.options[i];
            }
        }
        return undefined;
    };
    PlainSelectSingleLine.prototype.addOption = function (option) {
        var el = document.createElement('option');
        el.textContent = option.name;
        el.value = option.val;
        if (option.isCustom) {
            el.className = 'pane-preset-option-custom';
        }
        this.selectEl.appendChild(el);
        this.options.push(option);
        el.selected = true;
    };
    return PlainSelectSingleLine;
}());
exports.PlainSelectSingleLine = PlainSelectSingleLine;
var PlainInput = (function () {
    function PlainInput(indent, parent, langId, tooltipId, editable, callback, suffix, isPoppedOut) {
        if (isPoppedOut === void 0) { isPoppedOut = false; }
        var _this = this;
        this.langId = langId;
        this.tooltipId = tooltipId;
        this.callback = callback;
        if (suffix) {
            this.suffix = suffix;
        }
        this.wrapperEl = document.createElement('tr');
        this.wrapperEl.className = 'pane-item';
        parent.appendChild(this.wrapperEl);
        this.nameEl = document.createElement('td');
        this.nameEl.className = 'pane-item-entry-name';
        this.nameEl.textContent = ui.translate(langId);
        applyIndent(this.nameEl, indent);
        this.tooltip = new tooltip_1.WVTooltip(this.nameEl);
        this.wrapperEl.appendChild(this.nameEl);
        var inputWrapper = document.createElement('td');
        inputWrapper.className = 'pane-item-visual';
        inputWrapper.style.position = 'relative';
        this.wrapperEl.appendChild(inputWrapper);
        this.inputEl = document.createElement('div');
        this.inputEl.classList.add('pane-item-entry-input');
        this.inputEl.contentEditable = editable;
        inputWrapper.appendChild(this.inputEl);
        if (editable) {
            this.inputEl.addEventListener('keyup', function (ev) {
                ev.preventDefault();
                ev.stopPropagation();
            });
            this.inputEl.addEventListener('focus', function (ev) {
                app_states_1.appStates.preventGlobalKeyEvents = true;
                if (_this.suffix) {
                    setTimeout(function () {
                        _this.inputEl.textContent = parseFloat(_this.inputEl.textContent).toString();
                        selectText(_this.inputEl);
                    }, 100);
                }
                else {
                    selectText(_this.inputEl);
                }
            });
            this.inputEl.addEventListener('blur', function (ev) {
                app_states_1.appStates.preventGlobalKeyEvents = true;
                var val = _this.inputEl.textContent;
                if (_this.suffix) {
                    val = parseFloat(_this.inputEl.textContent).toString();
                }
                _this.callback(val);
            });
            this.inputEl.addEventListener('keydown', function (ev) {
                if (ev.keyCode === 13) {
                    ev.preventDefault();
                    var val = _this.inputEl.textContent;
                    if (_this.suffix) {
                        val = parseFloat(_this.inputEl.textContent).toString();
                    }
                    _this.callback(val);
                }
            });
        }
        if (!isPoppedOut) {
            vsClient.on('@changeLang', function (lang) {
                _this.translate();
            });
        }
    }
    PlainInput.prototype.setVal = function (val) {
        if (this.suffix) {
            if (this.suffix === '') {
                val = parseFloat(val) + this.suffix;
            }
            else {
                val = parseFloat(val) + " " + this.suffix;
            }
        }
        this.inputEl.textContent = val;
    };
    PlainInput.prototype.translate = function (translationCallback) {
        this.setText(translationCallback);
        this.setTooltip(translationCallback);
    };
    PlainInput.prototype.setText = function (translationCallback) {
        this.nameEl.textContent = translationCallback ? translationCallback(this.langId) : ui.translate(this.langId);
    };
    PlainInput.prototype.setTooltip = function (translationCallback) {
        this.tooltip.setTitle(translationCallback ? translationCallback(this.langId) : this.tooltipId);
    };
    return PlainInput;
}());
exports.PlainInput = PlainInput;
var PlainSlider = (function () {
    function PlainSlider(indent, parent, langId, tooltipId, callback, isPoppedOut) {
        if (isPoppedOut === void 0) { isPoppedOut = false; }
        var _this = this;
        this.handleMouseMove = function (e) {
            var positionAbsolute;
            if (e.touches) {
                positionAbsolute = Math.min(Math.max(0, (e.touches[0].pageX - this.sliderOffset)), this.sliderWidth);
            }
            else {
                positionAbsolute = Math.min(Math.max(0, (e.pageX - this.sliderOffset)), this.sliderWidth);
            }
            var valueRelativeToHundred = 100 / (this.sliderWidth / positionAbsolute);
            var fullElementWidth = this.sliderWidth;
            var positionRelativeToFullWidth;
            if (positionAbsolute <= 5) {
                positionRelativeToFullWidth = '0px';
            }
            else {
                positionRelativeToFullWidth = 100 / (fullElementWidth / positionAbsolute) + '%';
            }
            this.handleEl.style.left = positionRelativeToFullWidth;
            this.fedBar.style.width = positionRelativeToFullWidth;
            this.setVal(valueRelativeToHundred / 100);
            this.callback(valueRelativeToHundred / 100);
        };
        this.handleMouseUp = function (e) {
            var positionAbsolute;
            if (e.touches) {
                positionAbsolute = Math.min(Math.max(0, (e.changedTouches[0].pageX - this.sliderOffset - 5)), this.sliderWidth);
            }
            else {
                positionAbsolute = Math.min(Math.max(0, (e.pageX - this.sliderOffset - 5)), this.sliderWidth);
            }
            var valueRelativeToHundred = 100 / (this.sliderWidth / positionAbsolute);
            this.setVal(valueRelativeToHundred / 100);
            this.callback(valueRelativeToHundred / 100);
            document.removeEventListener('mouseup', this.handleMouseUp);
            document.removeEventListener('mousemove', this.handleMouseMove);
            document.removeEventListener('touchmove', this.handleMouseMove);
            document.removeEventListener('touchend', this.handleMouseUp);
        };
        this.handleMouseDown = function (e) {
            e.preventDefault();
            e.stopPropagation();
            this.sliderOffset = $(e.target).parent().offset().left;
            this.sliderWidth = $(e.target).parent().width();
            document.addEventListener('mouseup', this.handleMouseUp);
            document.addEventListener('mousemove', this.handleMouseMove);
            document.addEventListener('touchmove', this.handleMouseMove);
            document.addEventListener('touchend', this.handleMouseUp);
        };
        this.langId = langId;
        this.tooltipId = tooltipId;
        this.callback = callback;
        this.wrapperEl = document.createElement('tr');
        this.wrapperEl.className = 'pane-item';
        parent.appendChild(this.wrapperEl);
        this.nameEl = document.createElement('td');
        this.nameEl.className = 'pane-item-entry-name';
        this.nameEl.textContent = ui.translate(langId);
        applyIndent(this.nameEl, indent);
        this.tooltip = new tooltip_1.WVTooltip(this.nameEl);
        this.wrapperEl.appendChild(this.nameEl);
        var itemWrapper = document.createElement('td');
        itemWrapper.className = 'pane-item-visual';
        itemWrapper.style.position = 'relative';
        this.wrapperEl.appendChild(itemWrapper);
        this.sliderOffset = 0;
        this.sliderWidth = 0;
        this.handleMouseDown = this.handleMouseDown.bind(this);
        this.handleMouseMove = this.handleMouseMove.bind(this);
        this.handleMouseUp = this.handleMouseUp.bind(this);
        this.inputEl = document.createElement('input');
        this.inputEl.className = 'slider-value-input';
        this.inputEl.min = '0';
        this.inputEl.max = '100';
        this.inputEl.style.width = '25px';
        this.inputEl.onblur = function (ev) {
            _this.callback(parseFloat(_this.inputEl.value) / 100);
            _this.setVal(parseFloat(_this.inputEl.value) / 100);
        };
        this.inputEl.onchange = function (ev) {
            _this.handleInputChanged(ev);
        };
        itemWrapper.appendChild(this.inputEl);
        var sliderWrapper = document.createElement('div');
        sliderWrapper.className = 'slider-wrapper';
        sliderWrapper.style.width = 'calc(100% - 50px)';
        itemWrapper.appendChild(sliderWrapper);
        var sliderBar = document.createElement('div');
        sliderBar.style.position = 'relative';
        sliderBar.className = 'slider-bar';
        sliderWrapper.appendChild(sliderBar);
        this.fedBar = document.createElement('span');
        this.fedBar.className = 'slider-bar-filled';
        sliderBar.appendChild(this.fedBar);
        this.handleEl = document.createElement('div');
        this.handleEl.style.marginLeft = '0';
        $(this.handleEl).addClass('slider-handle draggable');
        sliderBar.appendChild(this.handleEl);
        this.handleEl.addEventListener('touchstart', this.handleMouseDown);
        this.handleEl.onmousedown = function (ev) {
            _this.handleMouseDown(ev);
        };
        sliderBar.onmousedown = function (ev) {
            _this.handleClick(ev);
        };
        var emptyBar = document.createElement('span');
        emptyBar.className = 'slider-bar-empty';
        emptyBar.style.width = '100%';
        sliderBar.appendChild(emptyBar);
        if (!isPoppedOut) {
            vsClient.on('@changeLang', function (lang) {
                _this.translate();
            });
        }
    }
    PlainSlider.prototype.show = function () {
        $(this.wrapperEl).show();
    };
    PlainSlider.prototype.hide = function () {
        $(this.wrapperEl).hide();
    };
    PlainSlider.prototype.setVal = function (val) {
        var initialSet = false;
        if (this.inputEl.value === '' || !this.inputEl.value || this.inputEl.value === undefined) {
            initialSet = true;
        }
        this.inputEl.value = Math.round(val * 100) + '';
        if (initialSet || parseFloat(this.handleEl.style.left.replace('%', "")) !== val) {
            var sliderWidth = $(this.inputEl).next().children().first().width();
            var positionAbsolute = sliderWidth * val;
            var fullElementWidth = sliderWidth;
            var positionRelativeToFullWidth = void 0;
            if (positionAbsolute <= 5) {
                positionRelativeToFullWidth = '0px';
            }
            else {
                positionRelativeToFullWidth = 100 / (fullElementWidth / positionAbsolute) + '%';
            }
            this.handleEl.style.left = positionRelativeToFullWidth;
            this.fedBar.style.width = positionRelativeToFullWidth;
        }
    };
    PlainSlider.prototype.translate = function (translationCallback) {
        this.setText(translationCallback);
        this.setTooltip(translationCallback);
    };
    PlainSlider.prototype.setText = function (translationCallback) {
        this.nameEl.textContent = translationCallback ? translationCallback(this.langId) : ui.translate(this.langId);
    };
    PlainSlider.prototype.setTooltip = function (translationCallback) {
        this.tooltip.setTitle(translationCallback ? translationCallback(this.langId) : this.tooltipId);
    };
    PlainSlider.prototype.handleInputChanged = function (e) {
        var val = e.target.value;
        var sliderWidth = $(e.target).next().children().first().width();
        var positionAbsolute = (sliderWidth / 100) * val;
        var fullElementWidth = sliderWidth;
        var positionRelativeToFullWidth;
        if (positionAbsolute <= 5) {
            positionRelativeToFullWidth = '0px';
        }
        else {
            positionRelativeToFullWidth = 100 / (fullElementWidth / positionAbsolute) + '%';
        }
        this.handleEl.style.left = positionRelativeToFullWidth;
        this.fedBar.style.width = positionRelativeToFullWidth;
        this.callback(val / 100);
    };
    PlainSlider.prototype.handleClick = function (e) {
        this.sliderWidth = $(e.target).width();
        this.sliderOffset = $(e.target).offset().left;
        var positionAbsolute = Math.min(Math.max(0, (e.pageX - this.sliderOffset)), this.sliderWidth);
        var valueRelativeToHundred = 100 / (this.sliderWidth / positionAbsolute);
        var fullElementWidth = this.sliderWidth;
        var positionRelativeToFullWidth;
        if (positionAbsolute <= 5) {
            positionRelativeToFullWidth = '0px';
        }
        else {
            positionRelativeToFullWidth = 100 / (fullElementWidth / positionAbsolute) + '%';
        }
        this.handleEl.style.left = positionRelativeToFullWidth;
        this.fedBar.style.width = positionRelativeToFullWidth;
        this.setVal(valueRelativeToHundred / 100);
        this.callback(valueRelativeToHundred / 100);
    };
    return PlainSlider;
}());
exports.PlainSlider = PlainSlider;
var PlainSteppedSlider = (function () {
    function PlainSteppedSlider(indent, parent, langId, tooltipId, callback, isPoppedOut) {
        if (isPoppedOut === void 0) { isPoppedOut = false; }
        var _this = this;
        this.step = 0;
        this.maxSteps = 1;
        this.handleMouseMove = function (e) {
            var positionAbsolute = Math.min(Math.max(0, (e.pageX - this.sliderOffset)), this.sliderWidth);
            var valueRelativeToHundred = 100 / (this.sliderWidth / positionAbsolute);
            var relativeStepDistance = 100 / this.maxSteps;
            var step = Math.round(valueRelativeToHundred / relativeStepDistance);
            if (step !== this.step) {
                this.setVal(step);
                this.callback(step);
            }
        };
        this.handleMouseUp = function (e) {
            document.removeEventListener('mouseup', this.handleMouseUp);
            document.removeEventListener('mousemove', this.handleMouseMove);
            document.removeEventListener('touchmove', this.handleMouseMove);
            document.removeEventListener('touchend', this.handleMouseUp);
        };
        this.handleMouseDown = function (e) {
            e.preventDefault();
            e.stopPropagation();
            this.sliderOffset = $(e.target).parent().offset().left;
            this.sliderWidth = $(e.target).parent().width();
            document.addEventListener('mouseup', this.handleMouseUp);
            document.addEventListener('mousemove', this.handleMouseMove);
            document.addEventListener('touchmove', this.handleMouseMove);
            document.addEventListener('touchend', this.handleMouseUp);
        };
        this.langId = langId;
        this.tooltipId = tooltipId;
        this.callback = callback;
        this.wrapperEl = document.createElement('tr');
        this.wrapperEl.className = 'pane-item';
        parent.appendChild(this.wrapperEl);
        this.nameEl = document.createElement('td');
        this.nameEl.className = 'pane-item-entry-name';
        this.nameEl.textContent = ui.translate(langId);
        applyIndent(this.nameEl, indent);
        this.tooltip = new tooltip_1.WVTooltip(this.nameEl);
        this.wrapperEl.appendChild(this.nameEl);
        var itemWrapper = document.createElement('td');
        itemWrapper.className = 'pane-item-visual';
        itemWrapper.style.position = 'relative';
        this.wrapperEl.appendChild(itemWrapper);
        this.sliderOffset = 0;
        this.sliderWidth = 0;
        this.handleMouseDown = this.handleMouseDown.bind(this);
        this.handleMouseMove = this.handleMouseMove.bind(this);
        this.handleMouseUp = this.handleMouseUp.bind(this);
        this.inputEl = document.createElement('input');
        this.inputEl.className = 'slider-value-input';
        this.inputEl.min = '0';
        this.inputEl.max = '100';
        this.inputEl.style.width = '20px';
        this.inputEl.onblur = function (ev) {
            _this.callback(parseInt(_this.inputEl.value));
            _this.setVal(parseInt(_this.inputEl.value));
        };
        this.inputEl.onchange = function (ev) {
            _this.handleInputChanged(ev);
        };
        itemWrapper.appendChild(this.inputEl);
        this.maxStepEl = document.createElement('span');
        this.maxStepEl.textContent = '/1';
        this.maxStepEl.className = 'plain-stepped-slider-max-val';
        itemWrapper.appendChild(this.maxStepEl);
        var sliderWrapper = document.createElement('div');
        sliderWrapper.className = 'slider-wrapper';
        sliderWrapper.style.width = 'calc(100% - 50px)';
        itemWrapper.appendChild(sliderWrapper);
        var sliderBar = document.createElement('div');
        sliderBar.style.position = 'relative';
        sliderBar.className = 'slider-bar';
        sliderWrapper.appendChild(sliderBar);
        this.fedBar = document.createElement('span');
        this.fedBar.className = 'slider-bar-filled';
        sliderBar.appendChild(this.fedBar);
        this.handleEl = document.createElement('div');
        this.handleEl.style.marginLeft = '0';
        $(this.handleEl).addClass('slider-handle draggable');
        sliderBar.appendChild(this.handleEl);
        this.handleEl.addEventListener('touchstart', this.handleMouseDown);
        this.handleEl.onmousedown = function (ev) {
            _this.handleMouseDown(ev);
        };
        sliderBar.onmousedown = function (ev) {
            _this.handleClick(ev);
        };
        var emptyBar = document.createElement('span');
        emptyBar.className = 'slider-bar-empty';
        emptyBar.style.width = '100%';
        sliderBar.appendChild(emptyBar);
        if (!isPoppedOut) {
            vsClient.on('@changeLang', function (lang) {
                _this.translate();
            });
        }
        this.setVal(0);
    }
    PlainSteppedSlider.prototype.show = function () {
        $(this.wrapperEl).show();
    };
    PlainSteppedSlider.prototype.hide = function () {
        $(this.wrapperEl).hide();
    };
    PlainSteppedSlider.prototype.setMaxSteps = function (maxSteps) {
        this.maxSteps = parseInt(maxSteps);
        this.maxStepEl.textContent = '/' + maxSteps;
    };
    PlainSteppedSlider.prototype.setVal = function (val) {
        if (val < 0) {
            val = 0;
        }
        else if (val > this.maxSteps) {
            val = this.maxSteps;
        }
        else if (val === NaN) {
            val = 0;
        }
        this.step = val;
        this.inputEl.value = val.toString();
        var relativeStepDistance = 100 / this.maxSteps;
        var positionRelativeToFullWidth = (val * relativeStepDistance) + '%';
        this.handleEl.style.left = positionRelativeToFullWidth;
        this.fedBar.style.width = positionRelativeToFullWidth;
    };
    PlainSteppedSlider.prototype.translate = function (translationCallback) {
        this.setText(translationCallback);
        this.setTooltip(translationCallback);
    };
    PlainSteppedSlider.prototype.setText = function (translationCallback) {
        this.nameEl.textContent = translationCallback ? translationCallback(this.langId) : ui.translate(this.langId);
    };
    PlainSteppedSlider.prototype.setTooltip = function (translationCallback) {
        this.tooltip.setTitle(translationCallback ? translationCallback(this.langId) : this.tooltipId);
    };
    PlainSteppedSlider.prototype.handleInputChanged = function (e) {
        var val = parseInt(e.target.value);
        this.setVal(val);
        this.callback(val);
    };
    PlainSteppedSlider.prototype.handleClick = function (e) {
        this.sliderWidth = $(e.target).width();
        this.sliderOffset = $(e.target).offset().left;
        var positionAbsolute = Math.min(Math.max(0, (e.pageX - this.sliderOffset)), this.sliderWidth);
        var valueRelativeToHundred = 100 / (this.sliderWidth / positionAbsolute);
        var relativeStepDistance = 100 / this.maxSteps;
        var step = Math.round(valueRelativeToHundred / relativeStepDistance);
        this.setVal(step);
        this.callback(step);
    };
    return PlainSteppedSlider;
}());
exports.PlainSteppedSlider = PlainSteppedSlider;
var PlainColorPicker = (function () {
    function PlainColorPicker(indent, parent, langId, tooltipId, callback, isPoppedOut) {
        if (isPoppedOut === void 0) { isPoppedOut = false; }
        var _this = this;
        this.isDefaultSet = false;
        this.langId = langId;
        this.tooltipId = tooltipId;
        this.callback = callback;
        this.wrapperEl = document.createElement('tr');
        this.wrapperEl.className = 'pane-item';
        parent.appendChild(this.wrapperEl);
        this.nameEl = document.createElement('td');
        this.nameEl.className = 'pane-item-entry-name';
        this.nameEl.textContent = ui.translate(langId);
        applyIndent(this.nameEl, indent);
        this.tooltip = new tooltip_1.WVTooltip(this.nameEl);
        this.wrapperEl.appendChild(this.nameEl);
        var itemWrapper = document.createElement('td');
        itemWrapper.className = 'pane-item-visual';
        itemWrapper.style.position = 'relative';
        this.wrapperEl.appendChild(itemWrapper);
        this.colorpicker = document.createElement('span');
        this.colorpicker.classList.add('pane-item-entry-colorpicker');
        itemWrapper.appendChild(this.colorpicker);
        this.colorpicker.addEventListener('click', function (ev) {
            _this.openPalette();
        }, false);
        if (!isPoppedOut) {
            vsClient.on('@changeLang', function (lang) {
                _this.translate();
            });
        }
    }
    PlainColorPicker.prototype.translate = function (translationCallback) {
        this.setText(translationCallback);
        this.setTooltip(translationCallback);
    };
    PlainColorPicker.prototype.setText = function (translationCallback) {
        this.nameEl.textContent = translationCallback ? translationCallback(this.langId) : ui.translate(this.langId);
    };
    PlainColorPicker.prototype.setTooltip = function (translationCallback) {
        this.tooltip.setTitle(translationCallback ? translationCallback(this.langId) : this.tooltipId);
    };
    PlainColorPicker.prototype.openPalette = function () {
        var _this = this;
        var activeColor = this.colorpicker.dataset['lastPickedColor'];
        this.palette = new custom_palette_1.CustomPalette(activeColor, this.showAlpha);
        this.palette.on('customColorChosen', function (color) { return _this.updateElementState(color); });
    };
    PlainColorPicker.prototype.updateElementState = function (color) {
        this.colorpicker.dataset['lastPickedColor'] = color;
        this.colorpicker.style.backgroundColor = color;
        var hashHex = tinycolor(color).toHexString();
        this.callback(hashHex);
    };
    PlainColorPicker.prototype.setVal = function (hexColor) {
        var RGBAColor = hexToRgba(hexColor);
        this.alpha = RGBAColor.a;
        var cssColor;
        if (this.showAlpha) {
            cssColor = "rgba(" + RGBAColor.r + ", " + RGBAColor.g + ", " + RGBAColor.b + ", " + this.alpha + ")";
        }
        else {
            cssColor = "rgb(" + RGBAColor.r + ", " + RGBAColor.g + ", " + RGBAColor.b + ")";
        }
        if (!this.isDefaultSet) {
            this.colorpicker.dataset['defaultColor'] = cssColor;
            this.isDefaultSet = true;
        }
        this.colorpicker.dataset['lastPickedColor'] = cssColor;
        this.colorpicker.style.backgroundColor = cssColor;
    };
    return PlainColorPicker;
}());
exports.PlainColorPicker = PlainColorPicker;
function applyIndent(el, indentLevel) {
    var indentClass;
    indentClass = 'pane-item-indent-level' + indentLevel;
    el.classList.add(indentClass);
}
function selectText(el) {
    var range = document.createRange();
    range.selectNodeContents(el);
    var sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
}
var SimplePaneInlineModal = (function () {
    function SimplePaneInlineModal(anchorEl, callback) {
        var _this = this;
        this.anchorEl = anchorEl;
        this.callback = callback;
        this.inputEl = document.createElement('input');
        this.inputEl.className = 'pane-item-entry-input pane-inline-modal-input';
        this.inputEl.addEventListener('change', function (ev) {
            var val = _this.inputEl.value;
            _this.callback(val);
            _this.hide();
        });
    }
    SimplePaneInlineModal.prototype.show = function () {
        this.anchorEl.appendChild(this.inputEl);
        this.inputEl.placeholder = 'Name...';
        this.inputEl.focus();
    };
    SimplePaneInlineModal.prototype.hide = function () {
        $(this.inputEl).remove();
    };
    return SimplePaneInlineModal;
}());
exports.SimplePaneInlineModal = SimplePaneInlineModal;


/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var utils_1 = __webpack_require__(5);
/**
 * @private
 */
var stringOptionsDefaults = {
    doubleQuotes: false,
    indent: "    ",
    newline: "\n",
    pretty: true,
};
Object.freeze(stringOptionsDefaults);
/**
 * Validates a string options object and replaces undefined values with their
 * appropriate defaults.
 *
 * @param {IStringOptions} options The string options object to validate.
 *
 * @returns {IStringOptions} The updated string options object.
 *
 * @private
 */
function validateStringOptions(options) {
    if (!utils_1.isType(options.doubleQuotes, "Boolean", "Undefined")) {
        throw new TypeError("options.doubleQuotes should be a boolean or"
            + " undefined");
    }
    if (!utils_1.isType(options.doubleQuotes, "Boolean")) {
        options.doubleQuotes = stringOptionsDefaults.doubleQuotes;
    }
    if (!utils_1.isType(options.indent, "String", "Undefined")) {
        throw new TypeError("options.indent should be a string or undefined");
    }
    if (!utils_1.isType(options.indent, "String")) {
        options.indent = stringOptionsDefaults.indent;
    }
    if (!utils_1.isType(options.newline, "String", "Undefined")) {
        throw new TypeError("options.newline should be a string or undefined");
    }
    if (!utils_1.isType(options.newline, "String")) {
        options.newline = stringOptionsDefaults.newline;
    }
    if (!utils_1.isType(options.pretty, "Boolean", "Undefined")) {
        throw new TypeError("options.pretty should be a boolean or undefined");
    }
    if (!utils_1.isType(options.pretty, "Boolean")) {
        options.pretty = stringOptionsDefaults.pretty;
    }
    return options;
}
exports.validateStringOptions = validateStringOptions;
/**
 * @private
 */
var declarationOptionsDefaults = {
    encoding: undefined,
    standalone: undefined,
    version: "1.0",
};
Object.freeze(declarationOptionsDefaults);
/**
 * Validates an XML declaration options object and replaces undefined values
 * with their appropriate defaults.
 *
 * @param {IDeclarationOptions} options The XML declaration options object to
 *                                     validate.
 *
 * @returns {IDeclarationOptions} The updated XML declaration options object.
 *
 * @private
 */
function validateDeclarationOptions(options) {
    if (!utils_1.isType(options.encoding, "String", "Undefined")) {
        throw new TypeError("options.encoding should be a string or undefined");
    }
    if (!utils_1.isType(options.standalone, "String", "Undefined")) {
        throw new TypeError("options.standalone should be a string or" +
            " undefined");
    }
    if (!utils_1.isType(options.version, "String", "Undefined")) {
        throw new TypeError("options.version should be a string or undefined");
    }
    if (!utils_1.isType(options.version, "String")) {
        options.version = declarationOptionsDefaults.version;
    }
    return options;
}
exports.validateDeclarationOptions = validateDeclarationOptions;


/***/ }),
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var app_states_1 = __webpack_require__(4);
var w = __webpack_require__(10);
var ui = __webpack_require__(0);
var clipboard_overlay_1 = __webpack_require__(37);
var file_browser_modal_1 = __webpack_require__(81);
var print_modal_1 = __webpack_require__(92);
function handlePrependingPane(paneId, mode) {
    if (app_states_1.appStates.interactionMode.indexOf(mode) === -1 && mode !== 'off') {
        ui.prependPane(paneId);
    }
    else {
        closePaneById(paneId);
    }
}
exports.handlePrependingPane = handlePrependingPane;
function activateInteraction(client, action) {
    var s = '<Call Method="ActivateInteraction"><Interaction>' + action + '</Interaction></Call>';
    client.command.executeXMLAsync(s);
}
function deactivateInteraction(client, mode) {
    if (mode === void 0) { mode = 'Deactivate_AllInteractions'; }
    var modeCategory = mode.split('_')[0];
    var categoryToDeactivate = 'Deactivate_' + modeCategory;
    var s = '<Call Method="ActivateInteraction"><Interaction>' + categoryToDeactivate + '</Interaction></Call>';
    client.command.executeXMLAsync(s);
}
function handleActivateInteraction(client, mode) {
    if (app_states_1.appStates.interactionMode.indexOf(mode) === -1) {
        activateInteraction(client, mode);
    }
    else {
        deactivateInteraction(client, mode);
    }
}
exports.handleActivateInteraction = handleActivateInteraction;
function removeAllInteractionHighlights(ribbon) {
    ribbon.classes['Interaction'].forEach(function (button) {
        button.applyHighlight(false);
    });
}
function recColorSearch(index, nodes, nodeColor) {
    var xmlPrefix = '<Call Method="SearchNodes"><SearchString>Visibility="Visible" + Type="';
    var xmlSuffix = '" + Color="' + nodeColor + '"</SearchString></Call>';
    var nodeTypes = ['Ri_BrepModel', 'Ri_PolyBrepModel', 'Ri_PolyWire', 'Plane', 'Solid', 'Wire'];
    var xml = xmlPrefix + nodeTypes[index] + xmlSuffix;
    vsClient.command.executeXML(xml);
    vsClient.once('SearchNodes', function (res) {
        var cNodeId = res.NodeId;
        if (cNodeId) {
            for (var _i = 0, cNodeId_1 = cNodeId; _i < cNodeId_1.length; _i++) {
                var node = cNodeId_1[_i];
                if (nodes.indexOf(node) === -1) {
                    nodes.push(node);
                }
            }
        }
        index++;
        if (index <= 7) {
            recColorSearch(index, nodes, nodeColor);
        }
        else {
            var nodeSearchString = '';
            for (var n = 0; n < nodes.length; n++) {
                nodeSearchString += '<NodeId>' + nodes[n] + '</NodeId>';
            }
            var selectCall = '<Call Method="SetSelectedNodes">' + nodeSearchString + '</Call>';
            vsClient.command.executeXML(selectCall);
        }
    });
}
function toggleFullscreen(ribbon) {
    if (ui.canvasStack.isMaximized) {
        GoOutFullscreen(document);
    }
    else {
        GoInFullscreen(document.body);
    }
}
exports.toggleFullscreen = toggleFullscreen;
function GoInFullscreen(element) {
    if (element.requestFullscreen)
        document.body.requestFullscreen();
    else if (element.mozRequestFullScreen)
        element.mozRequestFullScreen();
    else if (element.webkitRequestFullscreen)
        element.webkitRequestFullscreen();
    else if (element.msRequestFullscreen)
        element.msRequestFullscreen();
}
function GoOutFullscreen(element) {
    if (document.exitFullscreen)
        document.exitFullscreen();
    else if (element.webkitExitFullscreen)
        document.webkitExitFullscreen();
    else if (element.mozFullScreen) {
        element.mozCancelFullScreen();
    }
}
function closePaneById(paneId) {
    ui.closePane(paneId);
}
var XButton = {
    langId: '',
    widgets: [
        { type: w.WidgetType.Button, langId: 'ID_RIBBON_DEACTIVATE_ALL', iconId: 'deactivate_all', ribbonClass: ['DeactivateAll'] }
    ],
    groupClick: function (context, id) {
        var clickedButton = w.findButton(id);
        var client = context.client, ribbon = context.ribbon;
        clickedButton.flashHighlight();
        deactivateAll(client, ribbon);
    }
};
function deactivateAll(client, ribbon) {
    var s = '<Call Method="ActivateInteraction"><Interaction>Deactivate_AllInteractions</Interaction></Call>';
    client.command.executeXMLAsync(s);
    client.once('ActivateInteraction', function (response) {
        removeAllInteractionHighlights(ribbon);
    });
    var settings = localStorage.getItem('VSWVSettings');
    if (settings === null) {
        settings = localStorage.getItem('VSWVDefaultSettings');
    }
    var settingsObj = ui.settingsPane.defaultSettings;
    var leftMouseMode = settingsObj.Settings.Scene.Mouse.LeftButtonFunction;
    var rightMouseMode = settingsObj.Settings.Scene.Mouse.RightButtonFunction;
    var middleMouseMode = settingsObj.Settings.Scene.Mouse.MiddleButtonFunction;
    var mouseSettingsCall = '<Call Method="SetSceneSettings">';
    var settingsPrePath = '<Settings><Scene><Mouse>';
    var settingsPostPath = '</Mouse></Scene></Settings></Call>';
    mouseSettingsCall += settingsPrePath + '<LeftButtonFunction> ' + leftMouseMode + ' </LeftButtonFunction>';
    mouseSettingsCall += '<RightButtonFunction>' + rightMouseMode + '</RighButtonFunction>';
    mouseSettingsCall += '<MiddleButtonFunction>' + middleMouseMode + '</MiddleButtonFunction>' + settingsPostPath;
    vsClient.command.executeXML(mouseSettingsCall);
    var xmlSelect = '';
    app_states_1.appStates.selectionMode = 'Select';
    xmlSelect = '<Call Method="SetSelectionMode"><SelectionMode>' + app_states_1.appStates.selectionMode + '</SelectionMode></Call>';
    vsClient.command.executeXML(xmlSelect);
    vsClient.once('SetSelectionMode', function (response) {
        ui.vsRibbon.classes['LMBSelection'].forEach(function (button) {
            if (button.id !== 'ID_RIBBON_SELECT') {
                button.applyHighlight(false);
            }
            else {
                button.applyHighlight(true);
            }
        });
    });
    vsClient.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Deselect</SelectionModifier></Call>');
    var isPopout = app_states_1.appStates.popoutPanes.indexOf('wv-quickcompare') !== -1;
    ui.closePane('wv-quickcompare', isPopout);
    var xml = '<Call Method="ActivateRotation"><Activate>false</Activate></Call>';
    client.command.executeXML(xml);
    w.findButton('ID_RIBBON_SPIN').applyHighlight(false);
    xml = '<Call Method="StopPlayConfigurationViews"></Call>';
    client.command.executeXML(xml);
}
exports.deactivateAll = deactivateAll;
function getRecentFiles() {
    var recentFiles = localStorage.getItem(window.location.origin + window.location.pathname + 'VSWVRecentFiles');
    if (recentFiles === null) {
        return [{
                langId: "Recent files",
                iconId: ""
            }];
    }
    recentFiles = recentFiles.slice(0, -1);
    var fileArr = recentFiles.split(",");
    var dropdownItems = [{
            langId: "Recent files",
            iconId: ""
        }];
    for (var i = 0; i < fileArr.length; i++) {
        dropdownItems.push({
            langId: fileArr[i],
            iconId: "2_oeffnen"
        });
    }
    return dropdownItems;
}
exports.startTab = {
    langId: 'ID_RIBBON_START',
    groups: [
        {
            langId: 'ID_RIBBON_FILE',
            widgets: [{
                    type: w.WidgetType.SplittedDropdown,
                    langId: 'ID_RIBBON_OPEN',
                    iconId: '2_oeffnen',
                    dynamicDropdownItems: getRecentFiles(),
                    splittedDropdownClick: function (context, item, button) {
                        var client = context.client, ribbon = context.ribbon;
                        if (item === undefined) {
                            var fb = new file_browser_modal_1.FileBrowserModal(client, 'open', ui.fileOpen);
                        }
                        else {
                            if (item !== null) {
                                ui.fileOpen(item.langId);
                            }
                        }
                    }
                },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_IMPORT', iconId: '3_importieren' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_PRINT', iconId: '6_drucken' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_IMPORT':
                        var ib = new file_browser_modal_1.FileBrowserModal(client, 'import', ui.importFile);
                        break;
                    case 'ID_RIBBON_SAVE':
                        var sb = new file_browser_modal_1.FileBrowserModal(client, 'save', client.SaveFile.bind(client));
                        break;
                    case 'ID_RIBBON_PRINT':
                        var printModal = new print_modal_1.PrintModal(client);
                        break;
                }
            }
        },
        {
            langId: 'ID_RIBBON_VISSHARE_FILE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_VISSHARE_SAVE', iconId: '4_speichern' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_VISSHARE_SAVE_AS', iconId: '4_speichern' },
            ],
            groupClick: function (context, id, group) {
                var client = context.client, ribbon = context.ribbon;
                var clickedButton = w.findButton(id);
                var shareBackendCall = {
                    Method: clickedButton.langId === 'ID_RIBBON_VISSHARE_SAVE' ? 'ShareSave' : 'ShareSaveAs',
                    Token: client.sessionInfo.token
                };
                client.command.executeXML(JSON.stringify(shareBackendCall));
                ui.blockUI();
                client.once('SaveAs', function (res) {
                    ui.unblockUI();
                });
            }
        },
        {
            langId: 'ID_RIBBON_UNDO',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_LAST_ACTIONS', iconId: '1_letzte_aktionen' },
            ],
            groupClick: function (context, id) {
                var client = context.client, ribbon = context.ribbon;
                var clickedButton = w.findButton(id);
                var s = '<Call Method="Undo"></Call>';
                client.command.executeXML(s);
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_RIBBON_CONTROLS',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_ZOOM_RECTANGLE', iconId: '1_zoom_rahmen', ribbonClass: ['LMBFunction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_ROTATE', iconId: '2_drehen', ribbonClass: ['LMBFunction'], highlight: true },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_PAN', iconId: '3_pan', ribbonClass: ['LMBFunction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_SELECTION_FRAME', iconId: '4_auswahl_rahmen', ribbonClass: ['LMBFunction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_TURNTABLE', iconId: '3_drehen', ribbonClass: ['LMBFunction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_ZOOM', iconId: '5_zoom', ribbonClass: ['LMBFunction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_MOUSE_USE_FREE_ROTATE', iconId: 'bim_mode' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                if (clickedButton.langId === 'ID_MOUSE_USE_FREE_ROTATE') {
                    var xml = '<Call Method="SetSceneSettings"><Settings><Scene><Mouse><UseFreeRotate>';
                    xml += !clickedButton.isHighlight;
                    xml += '</UseFreeRotate></Mouse></Scene></Settings></Call>';
                    client.command.executeXML(xml);
                    clickedButton.applyHighlight(!clickedButton.isHighlight);
                    return;
                }
                if (!app_states_1.appStates.fileLoaded) {
                    return;
                }
                var mode = '';
                var deactivateCall = '<Call Method="ActivateInteraction"><Interaction>Deactivate_AllInteractions</Interaction></Call>';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_ZOOM_RECTANGLE':
                        mode = 'RectZoom';
                        vsClient.command.executeXML(deactivateCall);
                        break;
                    case 'ID_RIBBON_ROTATE':
                        mode = 'Rotate';
                        break;
                    case 'ID_RIBBON_PAN':
                        mode = 'Pan';
                        break;
                    case 'ID_RIBBON_SELECTION_FRAME':
                        mode = 'RectSelect';
                        vsClient.command.executeXML(deactivateCall);
                        break;
                    case 'ID_RIBBON_ZOOM':
                        mode = 'Zoom';
                        break;
                    case 'ID_RIBBON_TURNTABLE':
                        mode = 'Turntable';
                        break;
                    default:
                        return;
                }
                var s = "<Call Method=\"SetSceneSettings\">\n\t\t\t\t\t\t\t<Settings>\n\t\t\t\t\t\t\t\t<Scene>\n\t\t\t\t\t\t\t\t<Mouse>\n\t\t\t\t\t\t\t\t<LeftButtonFunction>\n\t\t\t\t\t\t\t\t\t" + mode + "\n\t\t\t\t\t\t\t\t</LeftButtonFunction>\n\t\t\t\t\t\t\t\t</Mouse>\n\t\t\t\t\t\t\t\t</Scene>\n\t\t\t\t\t\t\t</Settings>\n\t\t\t\t\t\t</Call>";
                client.command.executeXML(s);
            }
        },
        {
            langId: 'ID_RIBBON_SELECTION_MODE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_SELECT', iconId: '1_selektieren', ribbonClass: ['LMBSelection'], highlight: true },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_NEIGHBOURHOOD_SEARCH', iconId: '2_nachbarschaft', ribbonClass: ['LMBSelection'], paneId: 'wv-neighbourhoodsearch' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_HIDE', iconId: '3_verbergen', ribbonClass: ['LMBSelection'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_DELETE', iconId: '4_loeschen', ribbonClass: ['LMBSelection'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_GHOST', iconId: '5_ghost', ribbonClass: ['LMBSelection'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_COLOR', iconId: '10_auswahl_durch_farbe', ribbonClass: ['LMBSelection'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_INSTANCE', iconId: 'selection_mode_instance', ribbonClass: ['LMBSelection'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_ATTRIBUTES', iconId: 'selection_mode_attributes', ribbonClass: ['LMBSelection'] },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client;
                if (app_states_1.appStates.selectionMode === 'Attributes' && clickedButton.langId) {
                    var xml = '<Call Method="SetSceneSettings"><Settings><Scene><General><SelectionModeModifier>';
                    xml += app_states_1.appStates.lastSelectionModeModifier;
                    xml += '</SelecitionModeModifier></General></Scene></Settings></Call>';
                    client.command.executeXML(xml);
                }
                if (clickedButton.langId === 'ID_RIBBON_NEIGHBOURHOOD_SEARCH') {
                    if (app_states_1.appStates.selectionMode !== 'Neighbourhood') {
                        group.getWidgets().forEach(function (b) { return b.applyHighlight(false); });
                        clickedButton.applyHighlight(true);
                        handlePrependingPane('wv-neighbourhoodsearch', 'on');
                        app_states_1.appStates.selectionMode = 'Neighbourhood';
                        var s = '<Call Method="SetSelectionMode"><SelectionMode>' + app_states_1.appStates.selectionMode + '</SelectionMode></Call>';
                        client.command.executeXML(s);
                    }
                }
                else if (clickedButton.langId === 'ID_ATTRIBUTES') {
                    if (clickedButton.isHighlight) {
                        var xml = '<Call Method="SetSceneSettings"><Settings><Scene><General><SelectionModeModifier>';
                        xml += app_states_1.appStates.lastSelectionModeModifier;
                        xml += '</SelecitionModeModifier></General></Scene></Settings></Call>';
                        client.command.executeXML(xml);
                        clickedButton.applyHighlight(false);
                    }
                    else {
                        app_states_1.appStates.lastSelectionModeModifier = ui.settingsPane.sceneSettings.Settings.Scene.General.SelectionModeModifier;
                        var xml = '<Call Method="SetSceneSettings"><Settings><Scene><General><SelectionModeModifier>';
                        xml += 'SelectProductOccurence';
                        xml += '</SelecitionModeModifier></General></Scene></Settings></Call>';
                        client.command.executeXML(xml);
                        app_states_1.appStates.selectionMode = 'Attributes';
                        group.getWidgets().forEach(function (b) { return b.applyHighlight(false); });
                        clickedButton.applyHighlight(true);
                        return;
                    }
                }
                else {
                    switch (clickedButton.langId) {
                        case 'ID_RIBBON_SELECT':
                            app_states_1.appStates.selectionMode = 'Select';
                            break;
                        case 'ID_RIBBON_HIDE':
                            app_states_1.appStates.selectionMode = 'Hide';
                            break;
                        case 'ID_RIBBON_DELETE':
                            app_states_1.appStates.selectionMode = 'Delete';
                            break;
                        case 'ID_RIBBON_GHOST':
                            app_states_1.appStates.selectionMode = 'Ghost';
                            break;
                        case 'ID_RIBBON_COLOR':
                            app_states_1.appStates.selectionMode = 'Color';
                            break;
                        case 'ID_RIBBON_INSTANCE':
                            app_states_1.appStates.selectionMode = 'Instance';
                            break;
                        default:
                            return;
                    }
                    var s = '<Call Method="SetSelectionMode"><SelectionMode>' + app_states_1.appStates.selectionMode + '</SelectionMode></Call>';
                    client.command.executeXML(s);
                    client.once('SetSelectionMode', function (response) {
                        if (response.Error === 'SUCCESS') {
                            handlePrependingPane('wv-neighbourhoodsearch', 'off');
                            group.getWidgets().forEach(function (b) { return b.applyHighlight(false); });
                            clickedButton.applyHighlight(true);
                        }
                    });
                }
            }
        },
        {
            langId: 'ID_RIBBON_SELECTION',
            widgets: [
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_SELECT_ALL', iconId: '1_alles_selektieren' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_INVERT_SELECTION', iconId: '2_auswahl_umkehren' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_ISOLATE', iconId: '3_isolieren' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_SHOW_SELECTION', iconId: '4_anzeigen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_HIDE_SELECTION', iconId: '5_verbergen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_DELETE_SELECTION', iconId: '6_loeschen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_GHOST_SELECTION', iconId: '7_ghost' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_UNGHOST', iconId: '8_ghost_ausschalten' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_DESELECT', iconId: '9_auswahl_aufheben' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_COLOR', iconId: '10_auswahl_durch_farbe', highlight: false },
                { type: w.WidgetType.ButtonLet, langId: '', iconId: '', disabled: true },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_SELECT_ALL':
                        client.command.executeXML('<Call Method="SelectAllGeometries"></Call>');
                        break;
                    case 'ID_RIBBON_INVERT_SELECTION':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Invert</SelectionModifier></Call>');
                        break;
                    case 'ID_RIBBON_ISOLATE':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Isolate</SelectionModifier></Call>');
                        break;
                    case 'ID_SHOW_SELECTION':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Show</SelectionModifier></Call>');
                        break;
                    case 'ID_HIDE_SELECTION':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Hide</SelectionModifier></Call>');
                        break;
                    case 'ID_DELETE_SELECTION':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Delete</SelectionModifier></Call>');
                        break;
                    case 'ID_GHOST_SELECTION':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Ghost</SelectionModifier></Call>');
                        break;
                    case 'ID_RIBBON_UNGHOST':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>UnGhost</SelectionModifier></Call>');
                        break;
                    case 'ID_RIBBON_DESELECT':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Deselect</SelectionModifier></Call>');
                        break;
                    case 'ID_RIBBON_COLOR':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>SearchByColor</SelectionModifier></Call>');
                        break;
                    default:
                        console.log('invalid id');
                }
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_RIBBON_SHOW/HIDE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_SHOW_ALL', iconId: '1_alles_anzeigen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_UNGHOST_ALL', iconId: '2_ghost_ausschalten' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_HIDE_ALL_MARKUPS', iconId: '3_markups_verbergen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_HIDE_ALL_PMIS', iconId: '4_pmis_verbergen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_INVERT_VISIBILITY', iconId: '5_sichtbarkeit_umkehren' },
                { type: w.WidgetType.ButtonLet, langId: '', iconId: '', disabled: true },
                { type: w.WidgetType.ButtonLet, langId: '', iconId: '', disabled: true }
            ],
            groupClick: function (context, id, g) {
                var clickedButton = w.findButton(id);
                var client = context.client;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_SHOW_ALL':
                        client.command.executeXMLAsync('<Call Method="ShowAll"></Call>');
                        break;
                    case 'ID_RIBBON_UNGHOST_ALL':
                        client.command.executeXMLAsync('<Call Method="UnGhostAll"></Call>');
                        break;
                    case 'ID_RIBBON_HIDE_ALL_MARKUPS':
                        client.command.executeXMLAsync('<Call Method="HideAllMarkups"></Call>');
                        break;
                    case 'ID_RIBBON_HIDE_ALL_PMIS':
                        client.command.executeXMLAsync('<Call Method="HideAllPMIs"></Call>');
                        break;
                    case 'ID_RIBBON_INVERT_VISIBILITY':
                        client.command.executeXMLAsync('<Call Method="InvertVisibility"></Call>');
                        break;
                    default:
                        console.log('invalid id');
                }
                clickedButton.flashHighlight();
            }
        },
        XButton
    ]
};
exports.documentTab = {
    langId: 'ID_RIBBON_DOCUMENT',
    groups: [
        {
            langId: 'ID_RIBBON_CONTROLS',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_PAN', iconId: '3_pan', ribbonClass: ['LMBFunction'] },
                {
                    type: w.WidgetType.Button, langId: 'ID_RIBBON_ZOOM_RECTANGLE', iconId: '1_zoom_rahmen',
                    ribbonClass: ['LMBFunction']
                },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                var deactivateCall = '<Call Method="ActivateInteraction"><Interaction>Deactivate_AllInteractions</Interaction></Call>';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_ZOOM_RECTANGLE':
                        mode = 'RectZoom';
                        vsClient.command.executeXML(deactivateCall);
                        break;
                    case 'ID_RIBBON_PAN':
                        mode = 'Pan';
                        break;
                    default:
                        return;
                }
                var s = "<Call Method=\"SetSceneSettings\">\n                            <Settings>\n                                <Scene>\n                                <Mouse>\n                                <LeftButtonFunction>\n                                    " + mode + "\n                                </LeftButtonFunction>\n                                </Mouse>\n                                </Scene>\n                            </Settings>\n                        </Call>";
                client.command.executeXMLAsync(s);
                client.once('SetSceneSettings', function (response) {
                    if (response.Error === 'SUCCESS') {
                        ribbon.classes['LMBFunction'].forEach(function (button) {
                            button.applyHighlight(false);
                        });
                        var condition_1 = clickedButton.langId;
                        ribbon.classes['LMBFunction'].forEach(function (b) {
                            if (b.langId === condition_1) {
                                b.applyHighlight(true);
                            }
                        });
                        app_states_1.appStates.mouseLeftButtonMode = mode;
                    }
                });
            }
        },
        {
            langId: 'ID_RIBBON_PAGE',
            widgets: [
                { langId: 'ID_RIBBON_PREVIOUS', iconId: '1_vorherige' },
                {
                    type: w.WidgetType.Input,
                    langId: 'ID_RIBBON_PAGE',
                    ribbonClass: ['PageInput'],
                    inputCallback: function (context, id, ev) {
                        var client = context.client, ribbon = context.ribbon;
                        var input = w.findInput(id);
                        var inputEl = input.el;
                        var keyCode = ev.which || ev.keyCode;
                        var ENTER = 13;
                        var ESC = 27;
                        if (keyCode === ESC) {
                            inputEl.blur();
                        }
                        if (keyCode === ENTER) {
                            if (/^[0-9]{1,5}$/.test(inputEl.value)) {
                                var pageToGo_1 = inputEl.value;
                                client.command.executeXMLAsync("<Call Method=\"GotoPage\">\n                                                                                            <Page>" + pageToGo_1 + "</Page>\n                                                                                    </Call>");
                                client.once('GotoPage', function (response) {
                                    if (response.Error === 'SUCCESS') {
                                        client.command.executeXMLAsync("<Call Method=\"GetPageCount\"></Call>");
                                        client.once('GetPageCount', function (response) {
                                            inputEl.value = pageToGo_1 + ' / ' + response['Pages'];
                                        });
                                    }
                                });
                            }
                        }
                    }
                },
                { langId: 'ID_RIBBON_NEXT', iconId: '2_naechtse' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var xml;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_PREVIOUS':
                        xml = '<Call Method="PreviousPage"></Call>';
                        client.command.executeXMLAsync(xml);
                        client.once('PreviousPage', function (response) {
                            var pageInput = ribbon.classes['PageInput'][0];
                            var inputEl = pageInput.el;
                            var sepIndex = inputEl.value.lastIndexOf('/');
                            var pageCount = inputEl.value.substr(sepIndex + 1).trim();
                            inputEl.value = response['Page'] + " / " + pageCount;
                        });
                        break;
                    case 'ID_RIBBON_NEXT':
                        xml = '<Call Method="NextPage"></Call>';
                        client.command.executeXMLAsync(xml);
                        client.once('NextPage', function (response) {
                            var pageInput = ribbon.classes['PageInput'][0];
                            var inputEl = pageInput.el;
                            var sepIndex = inputEl.value.lastIndexOf('/');
                            var pageCount = inputEl.value.substr(sepIndex + 1).trim();
                            inputEl.value = response['Page'] + " / " + pageCount;
                        });
                        break;
                }
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_RIBBON_ROTATE',
            widgets: [
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_90', iconId: '1_90_Grad' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_180', iconId: '2_180_Grad' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_270', iconId: '3_270_Grad' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var xml = '<Call Method="RotatePage"></Call>';
                client.command.executeXMLAsync(xml);
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_90':
                        break;
                    case 'ID_RIBBON_180':
                        client.command.executeXMLAsync(xml);
                        break;
                    case 'ID_RIBBON_270':
                        client.command.executeXMLAsync(xml);
                        client.command.executeXMLAsync(xml);
                        break;
                }
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_RIBBON_ZOOM',
            widgets: [
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FIT_ALL', iconId: '1_anpassen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FIT_WIDTH', iconId: '2_an_fensterbreite_anpassen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FIT_HEIGHT', iconId: '3_an_fensterhoehe_anpassen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_ZOOM_IN', iconId: '4_vergroessern' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_ZOOM_OUT', iconId: '5_verkleinern' },
                { type: w.WidgetType.ButtonLet, langId: '', iconId: '', disabled: true }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var XMLCall;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_FIT_ALL':
                        XMLCall = "<Call Method=\"FitAll\"></Call>";
                        break;
                    case 'ID_RIBBON_FIT_WIDTH':
                        XMLCall = "<Call Method=\"FitWidth\"></Call>";
                        break;
                    case 'ID_RIBBON_FIT_HEIGHT':
                        XMLCall = "<Call Method=\"FitHeight\"></Call>";
                        break;
                    case 'ID_RIBBON_ZOOM_IN':
                        XMLCall = "<Call Method=\"ZoomIn\"></Call>";
                        break;
                    case 'ID_RIBBON_ZOOM_OUT':
                        XMLCall = "<Call Method=\"ZoomOut\"></Call>";
                        break;
                }
                client.command.executeXMLAsync(XMLCall);
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_RIBBON_TEXT_SEARCH',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_TEXT_SEARCH', iconId: '1_text_search', paneId: 'wv-textsearch' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client;
                if (!clickedButton.isHighlight) {
                    clickedButton.applyHighlight(true);
                    handlePrependingPane('wv-textsearch', 'on');
                }
                else {
                    clickedButton.applyHighlight(false);
                    handlePrependingPane('wv-textsearch', 'off');
                }
            }
        },
        {
            langId: 'ID_RIBBON_GRAPHIC_EFFECTS',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_ILLUSTRATION', iconId: '3_illustration' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_INVERT', iconId: '1_invertieren' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var toToggle;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_ILLUSTRATION':
                        toToggle = 'Illustration';
                        break;
                    case 'ID_RIBBON_INVERT':
                        toToggle = 'Inverse';
                        break;
                }
                var renderingModes = [];
                for (var _i = 0, _a = app_states_1.appStates.renderingModes; _i < _a.length; _i++) {
                    var mode = _a[_i];
                    if (mode != toToggle) {
                        renderingModes.push(mode);
                    }
                }
                if (app_states_1.appStates.renderingModes.every(function (e) { return e !== toToggle; })) {
                    renderingModes.push(toToggle);
                }
                if (renderingModes.length === 1 && renderingModes[0] === 'Perspective') {
                    renderingModes.push('Solid');
                }
                var s = '<Call Method="SetSceneSettings"><Settings><Scene><Visualization><RenderMode>';
                for (var i = 0; i < renderingModes.length; i++) {
                    s = s + renderingModes[i] + ' ';
                }
                s = s + '</RenderMode></Visualization></Scene></Settings></Call>';
                client.command.executeXMLAsync(s);
            }
        },
        {
            langId: 'ID_RIBBON_COMPARE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_COMPARE', iconId: '2_exakt', ribbonClass: ['Interaction'], paneId: 'wv-quickcompare' },
            ],
            groupClick: function (context, id, group) {
                var client = context.client, ribbon = context.ribbon;
                var clickedButton = w.findButton(id);
                if (!clickedButton.isHighlight) {
                    var ActivateGraphicalCompare = "<Call Method=\"ActivateGraphicalCompare\"><Activate>true</Activate></Call>";
                    client.command.executeXMLAsync(ActivateGraphicalCompare);
                    client.once('ActivateGraphicalCompare', function (response) {
                        if (response.Error === 'SUCCESS') {
                            clickedButton.applyHighlight(true);
                        }
                    });
                    handlePrependingPane('wv-quickcompare', "QuickCompare");
                }
                else {
                    var ActivateGraphicalCompare = "<Call Method=\"ActivateGraphicalCompare\"><Activate>false</Activate></Call>";
                    client.command.executeXMLAsync(ActivateGraphicalCompare);
                    client.once('ActivateGraphicalCompare', function (response) {
                        if (response.Error === 'SUCCESS') {
                            closePaneById('wv-quickcompare');
                        }
                    });
                }
            }
        },
        {
            langId: 'ID_RIBBON_3D_MARKUP',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_TEXT', iconId: '1_text', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CIRCLE', iconId: '2_kreis', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FIXED_TEXT', iconId: 'fixed_markup', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_RECTANGLE', iconId: '3_rechteck', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FREEHAND', iconId: '4_freihand', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_TEXT':
                        mode = 'Markup_Text';
                        break;
                    case 'ID_RIBBON_CIRCLE':
                        mode = 'Markup_Circle';
                        break;
                    case 'ID_RIBBON_RECTANGLE':
                        mode = 'Markup_Rectangle';
                        break;
                    case 'ID_RIBBON_FREEHAND':
                        mode = 'Markup_Freehand';
                        break;
                    case 'ID_RIBBON_FIXED_TEXT':
                        mode = 'Markup_Text_Fixed';
                        break;
                    default:
                        console.error('invalid interaction type');
                }
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        },
        XButton
    ]
};
exports.viewTab = {
    langId: 'ID_RIBBON_VIEW',
    groups: [
        {
            langId: 'ID_RIBBON_ALIGNMENT',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_ISOMETRIC', iconId: '1_isometrisch' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_TOP', iconId: '2_oben' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_LEFT', iconId: '3_links' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FRONT', iconId: '4_vorne' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BOTTOM', iconId: '5_unten' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_RIGHT', iconId: '6_rechts' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BACK', iconId: '7_hinten' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var xmlValue;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_ISOMETRIC':
                        xmlValue = 'Isometric';
                        break;
                    case 'ID_RIBBON_TOP':
                        xmlValue = 'Top';
                        break;
                    case 'ID_RIBBON_LEFT':
                        xmlValue = 'Left';
                        break;
                    case 'ID_RIBBON_FRONT':
                        xmlValue = 'Front';
                        break;
                    case 'ID_RIBBON_BOTTOM':
                        xmlValue = 'Bottom';
                        break;
                    case 'ID_RIBBON_RIGHT':
                        xmlValue = 'Right';
                        break;
                    case 'ID_RIBBON_BACK':
                        xmlValue = 'Back';
                        break;
                    default:
                        return;
                }
                var s = '<Call Method="AlignView"><Alignment>' + xmlValue + '</Alignment></Call>';
                client.command.executeXMLAsync(s);
            }
        },
        {
            langId: 'ID_RIBBON_ROTATE',
            widgets: [
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_90', iconId: '1_90_Grad' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_180', iconId: '2_180_Grad' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_270', iconId: '3_270_Grad' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var xml = '<Call Method="RotatePage"></Call>';
                client.command.executeXML(xml);
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_90':
                        break;
                    case 'ID_RIBBON_180':
                        client.command.executeXML(xml);
                        break;
                    case 'ID_RIBBON_270':
                        client.command.executeXML(xml);
                        client.command.executeXML(xml);
                        break;
                }
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_RIBBON_ZOOM',
            widgets: [
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FIT_ALL', iconId: '1_anpassen' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_ZOOM_IN', iconId: '2_vergroessern' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_ZOOM_OUT', iconId: '3_verkleinern' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FOCUS', iconId: '4_focus' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FOCUS_TRANSITION', iconId: 'focus_and_transition' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_SET_ORIGIN', iconId: 'set_origin' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_FIT_ALL':
                        client.command.executeXML('<Call Method="FitAll"></Call>');
                        break;
                    case 'ID_RIBBON_ZOOM_IN':
                        client.command.executeXML('<Call Method="ZoomIn"></Call>');
                        break;
                    case 'ID_RIBBON_ZOOM_OUT':
                        client.command.executeXML('<Call Method="ZoomOut"></Call>');
                        break;
                    case 'ID_RIBBON_FOCUS':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Focus</SelectionModifier></Call>');
                        break;
                    case 'ID_RIBBON_FOCUS_TRANSITION':
                        client.command.executeXML("<Call Method=\"Focus\">\n                        <Ghost>true</Ghost>\n                        <FadeTime>\n                          <ZoomOut>500</ZoomOut>\n                          <Translation>500</Translation>\n                          <Rotation>1000</Rotation>\n                          <ZoomIn>1000</ZoomIn>\n                        </FadeTime></Call>");
                        break;
                    case 'ID_RIBBON_SET_ORIGIN':
                        client.command.executeXML('<Call Method="SetOrigin"></Call>');
                        break;
                }
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_RIBBON_RENDERING_MODE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_SOLID', iconId: '1_koerper' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_WIRES', iconId: '2_drahtmodell' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_ILLUSTRATION', iconId: '3_illustration' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_PERSPECTIVE', iconId: '4_perspektive' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var toToggle = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_SOLID':
                        toToggle = 'Solid';
                        break;
                    case 'ID_RIBBON_WIRES':
                        toToggle = 'Wires';
                        break;
                    case 'ID_RIBBON_ILLUSTRATION':
                        toToggle = 'Illustration';
                        break;
                    case 'ID_RIBBON_PERSPECTIVE':
                        toToggle = 'Perspective';
                        break;
                    case '':
                        break;
                }
                var renderingModes = [];
                for (var _i = 0, _a = app_states_1.appStates.renderingModes; _i < _a.length; _i++) {
                    var mode = _a[_i];
                    if (mode != toToggle) {
                        renderingModes.push(mode);
                    }
                }
                if (app_states_1.appStates.renderingModes.every(function (e) { return e !== toToggle; })) {
                    renderingModes.push(toToggle);
                }
                if (renderingModes.length === 1 && renderingModes[0] === 'Perspective') {
                    renderingModes.push('Solid');
                }
                var s = '<Call Method="SetSceneSettings"><Settings><Scene><Visualization><RenderMode>';
                for (var i = 0; i < renderingModes.length; i++) {
                    s = s + renderingModes[i] + ' ';
                }
                s = s + '</RenderMode></Visualization></Scene></Settings></Call>';
                client.command.executeXMLAsync(s);
            }
        },
        {
            langId: 'ID_RIBBON_GRAPHIC_EFFECTS',
            widgets: [
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_SILHOUETTE', iconId: '1_kontur' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_OPAQUE', iconId: '5_undurchsichtig' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_SHADOW', iconId: '3_schatten' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_MATERIAL', iconId: '4_material' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var toToggle = '';
                switch (clickedButton.id) {
                    case 'ID_RIBBON_SILHOUETTE':
                        toToggle = 'Silhouette';
                        break;
                    case 'ID_RIBBON_OPAQUE':
                        toToggle = 'Opaque';
                        break;
                    case 'ID_RIBBON_SHADOW':
                        toToggle = 'Shadow';
                        break;
                    case 'ID_RIBBON_MATERIAL':
                        toToggle = 'Material';
                        break;
                    case '':
                        break;
                }
                var renderingModesGraphic = [];
                for (var _i = 0, _a = app_states_1.appStates.renderingModes; _i < _a.length; _i++) {
                    var mode = _a[_i];
                    if (mode != toToggle) {
                        renderingModesGraphic.push(mode);
                    }
                }
                if (app_states_1.appStates.renderingModes.every(function (e) { return e !== toToggle; })) {
                    renderingModesGraphic.push(toToggle);
                }
                var s = '<Call Method="SetRenderMode">';
                for (var i = 0; i < renderingModesGraphic.length; i++) {
                    s = s + '<RenderMode>' + renderingModesGraphic[i] + '</RenderMode>';
                }
                s = s + '</Call>';
                client.command.executeXMLAsync(s);
                client.once('SetRenderMode', function (response) {
                    var GetSceneSettings = "<Call Method=\"GetSceneSettings\"></Call>";
                    client.command.executeXMLAsync(GetSceneSettings);
                });
            }
        },
        {
            langId: 'ID_RIBBON_FLYTHROUGH',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_FLYTHROUGH', iconId: '1_fly_through', ribbonClass: ['Interaction'] },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = 'Flythrough';
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        },
        {
            langId: 'ID_RIBBON_ROTATE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_SPIN', iconId: '1_drehen' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                if (!clickedButton.isHighlight) {
                    clickedButton.applyHighlight(true);
                    var xml = '<Call Method="ActivateRotation"><Activate>' + true + '</Activate></Call>';
                    client.command.executeXMLAsync(xml);
                }
                else {
                    clickedButton.applyHighlight(false);
                    var xml = '<Call Method="ActivateRotation"><Activate>' + false + '</Activate></Call>';
                    client.command.executeXMLAsync(xml);
                }
            }
        },
        {
            langId: 'ID_RIBBON_SCENES',
            widgets: [
                { langId: 'ID_RIBBON_SHOW_GRID', iconId: '1_raster_darstellen' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_FULL_SCREEN', iconId: '1_vollbild' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                switch (clickedButton.id) {
                    case 'ID_RIBBON_FULL_SCREEN':
                        toggleFullscreen(ribbon);
                        break;
                    case 'ID_RIBBON_SHOW_GRID':
                        var show_1 = !(clickedButton.isHighlight);
                        var ShowGrid = "<Settings>\n\t\t\t\t\t\t\t\t\t<Scene>\n\t\t\t\t\t\t\t\t\t\t<Visualization>\n\t\t\t\t\t\t\t\t\t\t\t<ShowGrid>" + show_1 + "</ShowGrid>\n\t\t\t\t\t\t\t\t\t\t</Visualization>\n\t\t\t\t\t\t\t\t\t</Scene>\n\t\t\t\t\t\t\t\t</Settings>";
                        var XML = "<Call Method=\"SetSceneSettings\">" + ShowGrid + "</Call>";
                        client.command.executeXML(XML);
                        client.once('SetSceneSettings', function (response) {
                            if (response.Error === 'SUCCESS') {
                                clickedButton.applyHighlight(show_1);
                            }
                        });
                        break;
                }
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_ANIMATION',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_ANIMATE', iconId: 'animation_start' },
                { type: w.WidgetType.Button, langId: 'ID_CREATE_ANIMATION', iconId: 'animation_settings', paneId: 'wv-animation' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var isActive = clickedButton.isHighlight;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_ANIMATE':
                        var xml = '<Call Method="SetSceneSettings"><Settings><Scene><General><Animation>' + !isActive;
                        xml += '</Animation></General></Scene></Settings></Call>';
                        client.command.executeXML(xml);
                        break;
                    case 'ID_CREATE_ANIMATION':
                        if (isActive) {
                            handlePrependingPane('wv-animation', 'off');
                            clickedButton.applyHighlight(false);
                        }
                        else {
                            handlePrependingPane('wv-animation', 'on');
                            clickedButton.applyHighlight(true);
                        }
                        break;
                }
            }
        },
        {
            langId: 'ID_RIBBON_SHOW_PANES',
            widgets: [
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_MODEL_TREE', iconId: 'menu_modeltree', paneId: 'wv-modeltree' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_VIEWS', iconId: 'menu_views', paneId: 'wv-views' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_PROPERTIES', iconId: 'menu_properties', paneId: 'wv-properties' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_SETTINGS', iconId: 'menu_settings', paneId: 'wv-settings' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_SELECTIONS_WND', iconId: '1_selektieren', paneId: 'wv-selections' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_RESET_UI', iconId: '1_oberflaeche_zuruecksetzen' }
            ],
            groupClick: function (context, id, group) {
                var client = context.client;
                var clickedButton = w.findButton(id);
                if (clickedButton.id === 'ID_RIBBON_RESET_UI') {
                    ui.resetPanes(true);
                }
                else {
                    if (clickedButton.isHighlight) {
                        closePaneById(clickedButton.paneId);
                        var openPaneCount = app_states_1.appStates.panes.length;
                        for (var i = 0; i < openPaneCount; i++) {
                            if (app_states_1.appStates.panes[i].paneId === clickedButton.paneId) {
                                app_states_1.appStates.panes[i].visible = false;
                            }
                        }
                        localStorage.setItem('panePositions', JSON.stringify(app_states_1.appStates.panes));
                    }
                    else {
                        ui.prependPane(clickedButton.paneId);
                    }
                }
            }
        },
        XButton
    ]
};
exports.measurementTab = {
    langId: 'ID_RIBBON_MEASUREMENT',
    groups: [
        {
            langId: 'ID_RIBBON_DIMENSION_MODE',
            widgets: [
                {
                    type: w.WidgetType.ButtonLet,
                    langId: 'ID_RIBBON_MEASUREMENT',
                    iconId: '1_measurement'
                },
                {
                    type: w.WidgetType.ButtonLet,
                    langId: 'ID_RIBBON_DIMENSION',
                    iconId: '2_dimensioning',
                    highlight: true
                }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var XML;
                var SetSceneSettings;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_MEASUREMENT':
                        XML = " <Settings>\n\t\t\t\t\t\t\t\t\t  <Scene><Tools>\n\t\t\t\t\t\t\t\t\t  <Dimensioning>\n\t\t\t\t\t\t\t\t\t  <Dimensioning Type=\"bool\">false</Dimensioning>\n\t\t\t\t\t\t\t\t\t  </Dimensioning>\n\t\t\t\t\t\t\t\t\t  </Tools></Scene>\n\t\t\t\t\t\t\t\t\t  </Settings>";
                        SetSceneSettings = "<Call Method=\"SetSceneSettings\"> " + XML + " </Call>";
                        client.command.executeXMLAsync(SetSceneSettings);
                        break;
                    case 'ID_RIBBON_DIMENSION':
                        XML = " <Settings>\n\t\t\t\t\t\t\t\t\t  <Scene><Tools>\n\t\t\t\t\t\t\t\t\t  <Dimensioning>\n\t\t\t\t\t\t\t\t\t  <Dimensioning Type=\"bool\">true</Dimensioning>\n\t\t\t\t\t\t\t\t\t  </Dimensioning>\n\t\t\t\t\t\t\t\t\t  </Tools></Scene>\n\t\t\t\t\t\t\t\t\t  </Settings>";
                        SetSceneSettings = "<Call Method=\"SetSceneSettings\"> " + XML + " </Call>";
                        client.command.executeXMLAsync(SetSceneSettings);
                        break;
                }
                client.once('SetSceneSettings', function () {
                    group.getWidgets().forEach(function (button) { return button.applyHighlight(false); });
                    clickedButton.applyHighlight(true);
                });
            }
        },
        {
            langId: 'ID_RIBBON_COORDINATE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_POINT', iconId: '1_punkt', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = 'Measurement_PointCoordinate';
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        },
        {
            langId: 'ID_RIBBON_EDGE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_LENGTH', iconId: '1_laenge', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_ACCUMULATED_LENGTH', iconId: '2_kumulierte_laenge', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client;
                var mode;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_LENGTH':
                        mode = 'Measurement_EdgeLength';
                        break;
                    case 'ID_RIBBON_ACCUMULATED_LENGTH':
                        mode = 'Measurement_EdgeLengthAccumulated';
                        break;
                    default:
                        return;
                }
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        },
        {
            langId: 'ID_RIBBON_CIRCLE_MODE',
            widgets: [
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_ARC', iconId: '1_kreisbogen', highlight: true },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_3_POINTS', iconId: '2_3_punkte' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var xml = '<Call Method="SetSceneSettings"><Settings><Scene><Tools><CircleSelection><SelectCircleWith3Points>';
                xml += clickedButton.langId === 'ID_RIBBON_3_POINTS';
                xml += '</SelectCircleWith3Points></CircleSelection></Tools></Scene></Settings></Call>';
                client.command.executeXMLAsync(xml);
                client.once('SetSceneSettings', function () {
                    group.getWidgets().forEach(function (button) { return button.applyHighlight(false); });
                    clickedButton.applyHighlight(true);
                });
            }
        },
        {
            langId: 'ID_RIBBON_CIRCLE',
            widgets: [
                {
                    type: w.WidgetType.Dropdown,
                    langId: 'ID_RIBBON_RADIUS',
                    iconId: '1_1_radius',
                    ribbonClass: ['Interaction'],
                    dropdownItems: [
                        { langId: 'ID_RIBBON_RADIUS', iconId: '1_1_radius', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DIAMETER', iconId: '1_2_durchmesser', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_PERIMETER', iconId: '1_3_umfang', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_CENTER', iconId: '1_4_mittelpunkt', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_AREA', iconId: '1_5_flaeche', ribbonClass: ['Interaction'] },
                    ],
                    dropdownClick: function (context, item, button) {
                        var client = context.client;
                        var mode = '';
                        switch (item.langId) {
                            case 'ID_RIBBON_RADIUS':
                                mode = 'Measurement_CircleRadius';
                                break;
                            case 'ID_RIBBON_DIAMETER':
                                mode = 'Measurement_CircleDiameter';
                                break;
                            case 'ID_RIBBON_PERIMETER':
                                mode = 'Measurement_CirclePerimeter';
                                break;
                            case 'ID_RIBBON_CENTER':
                                mode = 'Measurement_CircleCenter';
                                break;
                            case 'ID_RIBBON_AREA':
                                mode = 'Measurement_CircleArea';
                                break;
                        }
                        item.event = mode;
                        handleActivateInteraction(client, mode);
                    }
                }
            ]
        },
        {
            langId: 'ID_RIBBON_DISTANCE',
            widgets: [
                {
                    type: w.WidgetType.Dropdown,
                    langId: 'ID_RIBBON_DISTANCE_BETWEEN_TWO_POINTS',
                    iconId: '1_1_punkt_zu_punkt',
                    ribbonClass: ['Interaction'],
                    dropdownItems: [
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_TWO_POINTS', iconId: '1_1_punkt_zu_punkt', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_POINT_AND_EDGE', iconId: '1_2_punkt_zu_kante', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_POINT_AND_CIRCLE_AXIS', iconId: '1_3_punkt_zu_kreisachse', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_POINT_AND_SOLID', iconId: '1_4_punkt_zu_koerper', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_TWO_EDGES', iconId: '1_5_kante_zu_kante', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_EDGE_AND_FACE', iconId: '1_6_kante_zu_oberflaeche', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_EDGE_AND_SOLID', iconId: '1_7_kante_zu_koerper', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_TWO_CIRCLE_AXES', iconId: '1_8_kreisachse_zu_kreisachse', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_TWO_CIRCLE_CENTERS', iconId: '1_8_kreisachse_zu_kreisachse', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_CIRCLE_AXIS_AND_EDGE', iconId: '1_9_kreismittelpunkt_zu_kante', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_TWO_FACES', iconId: '1_10_oberflaeche_zu_oberflaeche', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_FACE_AND_CENTER', iconId: '1_11_oberflaeche_zu_mittelpunkt', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_FACE_AND_SOLID', iconId: '1_12_oberflaeche_zu_koerper', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_TWO_SOLIDS', iconId: '1_13_koerper_zu_koerper', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_DISTANCE_BETWEEN_PIPE_CENTER_AND_FACE', iconId: '1_14_cylinder_center_to_face', ribbonClass: ['Interaction'] }
                    ],
                    dropdownClick: function (context, item, button) {
                        var client = context.client, ribbon = context.ribbon;
                        var mode = '';
                        switch (item.langId) {
                            case 'ID_RIBBON_DISTANCE_BETWEEN_TWO_POINTS':
                                mode = 'Measurement_DistancePointToPoint';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_POINT_AND_EDGE':
                                mode = 'Measurement_DistancePointToEdge';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_POINT_AND_CIRCLE_AXIS':
                                mode = 'Measurement_DistancePointToAxis';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_POINT_AND_SOLID':
                                mode = 'Measurement_DistancePointToSolid';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_TWO_EDGES':
                                mode = 'Measurement_DistanceEdgeToEdge';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_EDGE_AND_FACE':
                                mode = 'Measurement_DistanceEdgeToFace';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_EDGE_AND_SOLID':
                                mode = 'Measurement_DistanceEdgeToSolid';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_TWO_CIRCLE_AXES':
                                mode = 'Measurement_DistanceAxisToAxis';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_TWO_CIRCLE_CENTERS':
                                mode = 'Measurement_DistanceCenterToCenter';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_CIRCLE_AXIS_AND_EDGE':
                                mode = 'Measurement_DistanceAxisToEdge';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_TWO_FACES':
                                mode = 'Measurement_DistanceFaceToFace';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_FACE_AND_CENTER':
                                mode = 'Measurement_DistanceFaceToCenter';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_FACE_AND_SOLID':
                                mode = 'Measurement_DistanceFaceToSolid';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_TWO_SOLIDS':
                                mode = 'Measurement_DistanceSolidToSolid';
                                break;
                            case 'ID_RIBBON_DISTANCE_BETWEEN_PIPE_CENTER_AND_FACE':
                                mode = 'Measurement_DistanceCylinderCenterToFace';
                                break;
                            default:
                                break;
                        }
                        item.event = mode;
                        handleActivateInteraction(client, mode);
                    }
                }
            ]
        },
        {
            langId: 'ID_RIBBON_ANGLE',
            widgets: [
                {
                    type: w.WidgetType.Dropdown,
                    langId: 'ID_RIBBON_ANGLE_BETWEEN_TWO_AXES',
                    iconId: '1_1_kreisachse_zu_kreisachse',
                    ribbonClass: ['Interaction'],
                    dropdownItems: [
                        { langId: 'ID_RIBBON_ANGLE_BETWEEN_TWO_AXES', iconId: '1_1_kreisachse_zu_kreisachse', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_ANGLE_BETWEEN_AXIS_AND_EDGE', iconId: '1_2_kreisachse_zu_kante', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_ANGLE_BETWEEN_TWO_LINES', iconId: '1_3_linie_zu_linie', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_ANGLE_BETWEEN_TWO_PROJECTED_LINES', iconId: '1_3_linie_zu_linie', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_ANGLE_BETWEEN_TWO_PLANES', iconId: '1_4_ebene_zu_ebene', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_ANGLE_BETWEEN_PLANE_AND_DIRECTION', iconId: '1_5_ebene_zu_richtung', ribbonClass: ['Interaction'] },
                        { langId: 'ID_RIBBON_ANGLE_DEFINED_BY_THREE_POINTS', iconId: '1_6_winkel_aus_drei_punkten', ribbonClass: ['Interaction'] },
                    ],
                    dropdownClick: function (context, item, button) {
                        var client = context.client, ribbon = context.ribbon;
                        var mode = '';
                        switch (item.langId) {
                            case 'ID_RIBBON_ANGLE_BETWEEN_TWO_AXES':
                                mode = 'Measurement_AngleBetweenTwoAxes';
                                break;
                            case 'ID_RIBBON_ANGLE_BETWEEN_AXIS_AND_EDGE':
                                mode = 'Measurement_AngleBetweenAxisEdge';
                                break;
                            case 'ID_RIBBON_ANGLE_BETWEEN_TWO_LINES':
                                mode = 'Measurement_AngleBetweenTwoLines';
                                break;
                            case 'ID_RIBBON_ANGLE_BETWEEN_TWO_PLANES':
                                mode = 'Measurement_AngleBetweenTwoPlanes';
                                break;
                            case 'ID_RIBBON_ANGLE_BETWEEN_PLANE_AND_DIRECTION':
                                mode = 'Measurement_AngleBetweenPlaneDirection';
                                break;
                            case 'ID_RIBBON_ANGLE_DEFINED_BY_THREE_POINTS':
                                mode = 'Measurement_AngleFromThreePoints';
                                break;
                            case 'ID_RIBBON_ANGLE_BETWEEN_TWO_PROJECTED_LINES':
                                mode = 'Measurement_AngleBetweenTwoProjectedLines';
                                break;
                            default:
                                return;
                        }
                        item.event = mode;
                        handleActivateInteraction(client, mode);
                    }
                }
            ]
        },
        {
            langId: 'ID_RIBBON_AREA',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_FACE', iconId: 'measure_face', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_FACE':
                        mode = 'Measurement_FaceArea';
                        break;
                }
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        },
        {
            langId: 'ID_RIBBON_WALL_THICKNESS',
            widgets: [
                {
                    type: w.WidgetType.Dropdown,
                    langId: 'ID_WALLTHICKNESS_COMPUTATION_MODE_RAY',
                    iconId: 'ray_based',
                    ribbonClass: ['Interaction'],
                    dropdownItems: [
                        { langId: 'ID_WALLTHICKNESS_COMPUTATION_MODE_RAY', iconId: 'ray_based' },
                        { langId: 'ID_WALLTHICKNESS_COMPUTATION_MODE_ROLLING_BALL', iconId: 'rolling_ball' }
                    ],
                    dropdownClick: function (context, item, button) {
                        var client = context.client, ribbon = context.ribbon;
                        var mode = '';
                        switch (item.langId) {
                            case 'ID_WALLTHICKNESS_COMPUTATION_MODE_RAY':
                                mode = 'Measurement_WallThickness_RayBased';
                                break;
                            case 'ID_WALLTHICKNESS_COMPUTATION_MODE_ROLLING_BALL':
                                mode = 'Measurement_WallThickness_RollingBall';
                                break;
                        }
                        item.event = mode;
                        handleActivateInteraction(client, mode);
                    }
                }
            ]
        },
        {
            langId: 'ID_RIBBON_BOUNDING_BOX',
            widgets: [
                {
                    type: w.WidgetType.Dropdown,
                    langId: 'ID_RIBBON_WORLD',
                    iconId: '1_1_welt',
                    ribbonClass: ['Interaction'],
                    dropdownItems: [
                        { langId: 'ID_RIBBON_WORLD', iconId: '1_1_welt' },
                        { langId: 'ID_RIBBON_INDIVIDUAL', iconId: '1_2_bauteil' }
                    ],
                    dropdownClick: function (context, item, button) {
                        var client = context.client, ribbon = context.ribbon;
                        var mode = '';
                        switch (item.langId) {
                            case 'ID_RIBBON_WORLD':
                                mode = 'Measurement_BoundingBoxWorld';
                                client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>ComputeWorldBoundingBox</SelectionModifier></Call>');
                                break;
                            case 'ID_RIBBON_INDIVIDUAL':
                                mode = 'Measurement_BoundingBoxPart';
                                client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>ComputePartBoundingBox</SelectionModifier></Call>');
                                break;
                            default:
                                return;
                        }
                        item.event = mode;
                        handleActivateInteraction(client, mode);
                    }
                },
                {
                    type: w.WidgetType.Dropdown,
                    langId: 'ID_RIBBON_COMPUTE_MINIMUM',
                    iconId: 'bbox_min',
                    ribbonClass: ['Interaction'],
                    dropdownItems: [
                        { langId: 'ID_RIBBON_PRECISE', iconId: 'bbox_min' },
                        { langId: 'ID_RIBBON_QUICK', iconId: 'bbox_min_quick' }
                    ],
                    dropdownClick: function (context, item) {
                        var client = context.client;
                        switch (item.langId) {
                            case 'ID_RIBBON_PRECISE':
                                client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>ComputeMinimalBoundingBoxPrecise</SelectionModifier></Call>');
                                break;
                            case 'ID_RIBBON_QUICK':
                                client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>ComputeMinimalBoundingBoxFast</SelectionModifier></Call>');
                                break;
                            default:
                                return;
                        }
                    }
                }
            ],
            groupClick: function (context, id, group) {
            }
        },
        {
            langId: 'ID_RIBBON_DRILLHOLE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_DRILLHOLE', iconId: '2_bohrung', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var client = context.client, ribbon = context.ribbon;
                var clickedButton = w.findButton(id);
                var mode = 'Measurement_CircleForDrillhole';
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        }, XButton
    ]
};
exports.analyseTab = {
    langId: 'ID_RIBBON_ANALYZE',
    groups: [
        {
            langId: 'ID_RIBBON_SECTION',
            widgets: [
                {
                    type: w.WidgetType.Dropdown,
                    langId: 'ID_RIBBON_CUTTING_PLANE_FROM_POINT_NORMAL', iconId: '1_1_schnittebene_aus_punkt', ribbonClass: ['Interaction'],
                    dropdownItems: [
                        { langId: 'ID_RIBBON_CUTTING_PLANE_FROM_POINT_NORMAL', iconId: '1_1_schnittebene_aus_punkt' },
                        { langId: 'ID_RIBBON_CUTTING_PLANE', iconId: '1_2_schnittebene' },
                        { langId: 'ID_RIBBON_CUTTING_PLANE_FROM_3_POINTS', iconId: 'section_three_points' },
                        { langId: 'ID_RIBBON_CUTTING_PLANE_FROM_3_CIRCLE_CENTERS', iconId: 'section_three_circle_centers' }
                    ],
                    dropdownClick: function (context, item, button) {
                        var client = context.client, ribbon = context.ribbon;
                        var mode = '';
                        switch (item.langId) {
                            case 'ID_RIBBON_CUTTING_PLANE_FROM_POINT_NORMAL':
                                mode = 'Section_FromPointNormal';
                                break;
                            case 'ID_RIBBON_CUTTING_PLANE':
                                mode = 'Section';
                                break;
                            case 'ID_RIBBON_CUTTING_PLANE_FROM_3_POINTS':
                                mode = 'Section_From3Points';
                                break;
                            case 'ID_RIBBON_CUTTING_PLANE_FROM_3_CIRCLE_CENTERS':
                                mode = 'Section_From3CircleCenters';
                                break;
                            default:
                                return;
                        }
                        item.event = mode;
                        handleActivateInteraction(client, mode);
                    }
                }
            ]
        },
        {
            langId: 'ID_RIBBON_COMPARE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_COMPARE_MODEL', iconId: '1_schnell', ribbonClass: ['Interaction'], paneId: 'wv-quickcompare' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_BREP_PART', iconId: '2_exakt', paneId: 'wv-exactcompare' }
            ],
            groupClick: function (context, id, group) {
                var client = context.client;
                var clickedButton = w.findButton(id);
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_COMPARE_MODEL':
                        if (!clickedButton.isHighlight) {
                            var ActivateGraphicalCompare = "<Call Method=\"ActivateGraphicalCompare\"><Activate>true</Activate></Call>";
                            client.command.executeXMLAsync(ActivateGraphicalCompare);
                            client.once('ActivateGraphicalCompare', function (response) {
                                clickedButton.applyHighlight(true);
                            });
                            handlePrependingPane('wv-quickcompare', "QuickCompare");
                        }
                        else {
                            var ActivateGraphicalCompare = "<Call Method=\"ActivateGraphicalCompare\"><Activate>false</Activate></Call>";
                            client.command.executeXMLAsync(ActivateGraphicalCompare);
                            client.once('ActivateGraphicalCompare', function (response) {
                                closePaneById('wv-quickcompare');
                            });
                        }
                        break;
                    case 'ID_RIBBON_BREP_PART':
                        if (!clickedButton.isHighlight) {
                            handlePrependingPane('wv-exactcompare', "ExactCompare");
                        }
                        else {
                            closePaneById('wv-exactcompare');
                        }
                        break;
                }
            }
        },
        {
            langId: 'ID_RIBBON_PROJECTED_AREA',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_PROJECTED_AREA', iconId: '1_projizierte_flaeche', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                if (!clickedButton.isHighlight) {
                    clickedButton.applyHighlight(true);
                    handlePrependingPane('wv-projectedarea', 'on');
                }
                else {
                    clickedButton.applyHighlight(false);
                    handlePrependingPane('wv-projectedarea', 'off');
                }
            }
        },
        {
            langId: 'ID_RIBBON_CLASH',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CLASH_DETECTION', iconId: 'clash', paneId: 'wv-clash' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_BAND_ANALYSIS', iconId: 'clearance', paneId: 'wv-bandanalysis' },
            ],
            groupClick: function (context, id) {
                var clickedButton = w.findButton(id);
                if (!clickedButton.isHighlight) {
                    clickedButton.applyHighlight(true);
                    handlePrependingPane(clickedButton.paneId, 'on');
                }
                else {
                    clickedButton.applyHighlight(false);
                    handlePrependingPane(clickedButton.paneId, 'off');
                }
            }
        },
        {
            langId: 'ID_RIBBON_COMPUTE',
            widgets: [
                {
                    type: w.WidgetType.Button,
                    langId: 'ID_PHYSICAL_PROPERTIES',
                    iconId: 'physical-properties',
                }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                clickedButton.flashHighlight();
                var ComputePhysicalProperties = '<Call Method="ModifySelection"><SelectionModifier>ComputePhysicalProperties</SelectionModifier></Call>';
                client.command.executeXMLAsync(ComputePhysicalProperties);
            }
        },
        {
            langId: 'ID_RIBBON_FEATURE_RECOGNITION',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_NEUTRAL_AXIS', iconId: '3_neutrale_faser', paneId: 'wv-neutralaxis' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_DRILLHOLE', iconId: '2_bohrung', paneId: 'wv-drillhole' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                if (clickedButton.langId === 'ID_RIBBON_NEUTRAL_AXIS') {
                    if (!clickedButton.isHighlight) {
                        clickedButton.applyHighlight(true);
                        handlePrependingPane('wv-neutralaxis', 'on');
                    }
                    else {
                        clickedButton.applyHighlight(false);
                        handlePrependingPane('wv-neutralaxis', 'off');
                    }
                }
                else if (clickedButton.langId === 'ID_RIBBON_DRILLHOLE') {
                    if (!clickedButton.isHighlight) {
                        clickedButton.applyHighlight(true);
                        handlePrependingPane('wv-drillhole', 'on');
                    }
                    else {
                        clickedButton.applyHighlight(false);
                        handlePrependingPane('wv-drillhole', 'off');
                    }
                }
            },
        },
        {
            langId: 'ID_RIBBON_ADVANCED',
            widgets: [
                {
                    type: w.WidgetType.Button,
                    langId: 'ID_RIBBON_DRAFT_ANGLE',
                    iconId: '1_entformungsschraegen_analyse',
                    ribbonClass: ['Interaction']
                },
                {
                    type: w.WidgetType.Button,
                    langId: 'ID_RIBBON_WALL_THICKNESS',
                    iconId: '1_wandstaerke',
                    paneId: 'wv-wallthickness'
                },
                {
                    type: w.WidgetType.Button,
                    langId: 'ID_RIBBON_SPLIT',
                    iconId: 'split',
                    paneId: 'wv-split'
                }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_DRAFT_ANGLE':
                        clickedButton.event = 'DraftAngle';
                        handleActivateInteraction(client, 'DraftAngle');
                        break;
                    case 'ID_RIBBON_WALL_THICKNESS':
                        if (!clickedButton.isHighlight) {
                            clickedButton.applyHighlight(true);
                            handlePrependingPane('wv-wallthickness', 'on');
                        }
                        else {
                            clickedButton.applyHighlight(false);
                            handlePrependingPane('wv-wallthickness', 'off');
                        }
                        break;
                    case 'ID_RIBBON_SPLIT':
                        clickedButton.event = 'Split_SelectDirection';
                        if (!clickedButton.isHighlight) {
                            clickedButton.applyHighlight(true);
                            activateInteraction(client, 'Split_SelectDirection');
                            var mouseButtonCall = '<Call Method="SetSceneSettings"><Settings><Scene><Mouse><LeftButtonFunction>Rotate</LeftButtonFunction></Mouse></Scene></Settings></Call>';
                            client.command.executeXML(mouseButtonCall);
                            handlePrependingPane('wv-split', 'on');
                        }
                        else {
                            clickedButton.applyHighlight(false);
                            deactivateInteraction(client, 'Split_SelectDirection');
                            handlePrependingPane('wv-split', 'off');
                        }
                        break;
                }
            }
        },
        XButton
    ]
};
exports.transformTab = {
    langId: 'ID_RIBBON_TRANSFORMATION',
    groups: [
        {
            langId: 'ID_RIBBON_TRANSFORMATION',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_FREE_DRAG', iconId: '1_freies_verschieben', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_MOVE', iconId: '2_verschieben', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_ROTATE', iconId: '3_drehen', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_SCALE', iconId: 'scale', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_MIRROR', iconId: '4_spiegeln', paneId: 'wv-mirror' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_EXPLODE', iconId: '5_explodieren' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_RESET_TRANSFORMATION', iconId: '6_position_zuruecksetzen' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_FREE_DRAG':
                        mode = 'Transformation_FreeDrag';
                        break;
                    case 'ID_RIBBON_MOVE':
                        mode = 'Transformation_Move';
                        break;
                    case 'ID_RIBBON_ROTATE':
                        mode = 'Transformation_Rotate';
                        break;
                    case 'ID_RIBBON_SCALE':
                        mode = 'Transformation_Scale';
                        break;
                    case 'ID_RIBBON_RESET_TRANSFORMATION':
                        var ResetTransformation = '<Call Method="ModifySelection"><SelectionModifier>ResetTransformation</SelectionModifier></Call>';
                        client.command.executeXMLAsync(ResetTransformation);
                        clickedButton.flashHighlight();
                        break;
                    case 'ID_RIBBON_MIRROR':
                        if (!clickedButton.isHighlight) {
                            clickedButton.applyHighlight(true);
                            handlePrependingPane('wv-mirror', 'on');
                        }
                        else {
                            clickedButton.applyHighlight(false);
                            handlePrependingPane('wv-mirror', 'off');
                        }
                        break;
                    case 'ID_RIBBON_EXPLODE':
                        if (!clickedButton.isHighlight) {
                            clickedButton.applyHighlight(true);
                            handlePrependingPane('wv-explode', 'on');
                        }
                        else {
                            clickedButton.applyHighlight(false);
                            handlePrependingPane('wv-explode', 'off');
                        }
                        break;
                    default:
                        console.error('invalid interaction type');
                }
                ;
                if (mode !== '') {
                    clickedButton.event = mode;
                    handleActivateInteraction(client, mode);
                }
            }
        },
        {
            langId: 'ID_RIBBON_BOUNDARY_CONDITION',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_ACTIVATE', iconId: 'activate_axis', ribbonClass: ['Interaction'] },
                {
                    langId: 'ID_RIBBON_BOUNDARY_CONDITION_AXIS',
                    type: w.WidgetType.Dropdown,
                    iconId: 'condition_axis_by_circle',
                    ribbonClass: ['interaction'],
                    dropdownItems: [
                        { langId: 'ID_RIBBON_BOUNDARY_CONDITION_BY_CIRCLE', iconId: 'condition_axis_by_circle' },
                        { langId: 'ID_RIBBON_BOUNDARY_CONDITION_BY_LINE', iconId: 'condition_axis_by_line' }
                    ],
                    dropdownClick: function (context, item, button) {
                        var client = context.client;
                        var mode = '';
                        switch (item.langId) {
                            case 'ID_RIBBON_BOUNDARY_CONDITION_BY_CIRCLE':
                                mode = 'BoundaryCondition_AxisByCircle';
                                break;
                            case 'ID_RIBBON_BOUNDARY_CONDITION_BY_LINE':
                                mode = 'BoundaryCondition_AxisByLine';
                                break;
                        }
                        item.event = mode;
                        handleActivateInteraction(client, mode);
                    }
                },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                var activateButton = w.findButton('ID_RIBBON_ACTIVATE');
                activateButton.event = 'BoundaryCondition_Axis';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_ACTIVATE':
                        mode = 'BoundaryCondition_Axis';
                        clickedButton.event = mode;
                        handleActivateInteraction(client, mode);
                        break;
                }
            }
        },
        {
            langId: 'ID_RIBBON_ALIGNING_MOVE',
            widgets: [
                { type: w.WidgetType.ButtonLet, 'langId': 'ID_RIBBON_POINT_TO_POINT', iconId: 'align_move_point_point', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, 'langId': 'ID_RIBBON_PLANE_TO_PLANE', iconId: 'align_move_plane_plane', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, 'langId': 'ID_RIBBON_CIRCLE_CENTER_TO_CIRCLE_CENTER', iconId: 'align_move_center_center', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_POINT_TO_POINT':
                        mode = 'Transformation_Align_Move_PointToPoint';
                        break;
                    case 'ID_RIBBON_PLANE_TO_PLANE':
                        mode = 'Transformation_Align_Move_PlaneToPlane';
                        break;
                    case 'ID_RIBBON_CIRCLE_CENTER_TO_CIRCLE_CENTER':
                        mode = 'Transformation_Align_Move_CircleCenterToCircleCenter';
                        break;
                }
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        },
        {
            langId: 'ID_RIBBON_ALIGNING_ROTATE',
            widgets: [
                { type: w.WidgetType.ButtonLet, 'langId': 'ID_RIBBON_NORMAL_TO_NORMAL', iconId: '1_normal_zu_normal', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, 'langId': 'ID_RIBBON_POINT_TO_POINT', iconId: '2_punkt_zu_punkt', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, 'langId': 'ID_RIBBON_CIRCLE_CENTER_TO_CIRCLE_CENTER', iconId: '3_kreisachse_zu_kreisachse', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_NORMAL_TO_NORMAL':
                        mode = 'Transformation_Align_Rotate_NormalToNormal';
                        break;
                    case 'ID_RIBBON_POINT_TO_POINT':
                        mode = 'Transformation_Align_Rotate_PointToPoint';
                        break;
                    case 'ID_RIBBON_CIRCLE_CENTER_TO_CIRCLE_CENTER':
                        mode = 'Transformation_Align_Rotate_CircleCenterToCircleCenter';
                        break;
                }
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        },
        {
            langId: 'ID_RIBBON_ALIGNING_MOVE_ROTATE',
            widgets: [
                { type: w.WidgetType.ButtonLet, 'langId': 'ID_RIBBON_COORDINATE_SYSTEM_TO_COORDINATE_SYSTEM', iconId: '1_koordinatensystem_zu_koordinatensystem', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, 'langId': 'ID_RIBBON_CIRCLE_AXIS_TO_CIRCLE_AXIS', iconId: '2_kreisachse_zu_kreisachse', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, 'langId': 'ID_RIBBON_PLANE_TO_PLANE', iconId: '3_oberflaeche_zu_oberflaeche', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_COORDINATE_SYSTEM_TO_COORDINATE_SYSTEM':
                        mode = 'Transformation_Align_CoordinateSystemToCoordinateSystem';
                        break;
                    case 'ID_RIBBON_CIRCLE_AXIS_TO_CIRCLE_AXIS':
                        mode = 'Transformation_Align_CircleAxisToCircleAxis';
                        break;
                    case 'ID_RIBBON_PLANE_TO_PLANE':
                        mode = 'Transformation_Align_PlaneToPlane';
                        break;
                }
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        },
        {
            langId: 'ID_RIBBON_MODEL_ALIGNING',
            widgets: [
                { type: w.WidgetType.Button, 'langId': 'ID_RIBBON_LINE', iconId: '1_linie' },
                { type: w.WidgetType.Button, 'langId': 'ID_RIBBON_PLANE', iconId: '2_ebene' }
            ]
        },
        XButton
    ]
};
exports.toolTab = {
    langId: 'ID_RIBBON_TOOLS',
    groups: [
        {
            langId: 'ID_RIBBON_SCREENSHOT',
            widgets: [
                { langId: 'ID_RIBBON_CLIPBOARD', iconId: '5_zwischenablage' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var xml = '<Call Method="GetImage">';
                xml += '<ExportFormat2D>PNG</ExportFormat2D>';
                xml += '</Call>';
                client.command.executeXMLAsync(xml);
                client.once('GetImage', function (response) {
                    if (response.Error === 'SUCCESS') {
                        var src = response.Image;
                        var overlay = new clipboard_overlay_1.ClipboardModal(src, vsClient.vsCanvas.width, vsClient.vsCanvas.height);
                    }
                });
            }
        },
        {
            langId: 'ID_RIBBON_VECTOR_EXPORT',
            widgets: [
                { langId: 'ID_RIBBON_SVG', iconId: '1_svg' },
                { langId: 'ID_RIBBON_DXF', iconId: '2_dxf' },
            ]
        },
        {
            langId: 'ID_RIBBON_SEARCH',
            widgets: [
                { langId: 'ID_RIBBON_SEARCH', iconId: '1_filter', paneId: 'wv-filter' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                if (!clickedButton.isHighlight) {
                    clickedButton.applyHighlight(true);
                    handlePrependingPane('wv-filter', 'on');
                }
                else {
                    clickedButton.applyHighlight(false);
                    handlePrependingPane('wv-filter', 'off');
                }
            }
        },
        {
            langId: 'ID_RIBBON_GEOMETRY_TOOLS',
            widgets: [
                { langId: 'ID_RIBBON_GEOMETRY_TOOLS', iconId: 'number_of_triangles' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client;
                if (!clickedButton.isHighlight) {
                    clickedButton.applyHighlight(true);
                    handlePrependingPane('wv-geometry-tools', 'on');
                }
                else {
                    handlePrependingPane('wv-geometry-tools', 'off');
                    clickedButton.applyHighlight(false);
                }
            }
        },
        {
            langId: 'ID_RIBBON_IP_PROTECTION',
            widgets: [
                { langId: 'ID_RIBBON_DISTORT', iconId: 'distortion', paneId: 'wv-distortion' },
                { langId: 'ID_VISIBILITY_TEST', iconId: 'visibility_test', paneId: 'wv-visibilitytest' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                if (!clickedButton.isHighlight) {
                    clickedButton.applyHighlight(true);
                    switch (clickedButton.langId) {
                        case 'ID_RIBBON_DISTORT':
                            handlePrependingPane('wv-distortion', 'on');
                            break;
                        case 'ID_VISIBILITY_TEST':
                            handlePrependingPane('wv-visibilitytest', 'on');
                            break;
                    }
                }
                else {
                    switch (clickedButton.langId) {
                        case 'ID_RIBBON_DISTORT':
                            handlePrependingPane('wv-distortion', 'off');
                            break;
                        case 'ID_VISIBILITY_TEST':
                            handlePrependingPane('wv-visibilitytest', 'off');
                            break;
                    }
                    clickedButton.applyHighlight(false);
                }
            }
        },
        {
            langId: 'Extras',
            widgets: [
                { langId: 'Command', iconId: 'terminal', paneId: 'wv-command' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                if (!clickedButton.isHighlight) {
                    handlePrependingPane('wv-command', 'on');
                    clickedButton.applyHighlight(true);
                }
                else {
                    handlePrependingPane('wv-command', 'off');
                    clickedButton.applyHighlight(false);
                }
            }
        },
        XButton
    ]
};
exports.modelTab = {
    langId: 'ID_RIBBON_MODEL',
    groups: [
        {
            langId: 'ID_RIBBON_NODE',
            widgets: [
                { langId: 'ID_RIBBON_CREATE', iconId: '1_erstellen' },
                { langId: 'ID_RIBBON_COPY', iconId: '2_kopieren' },
                { langId: 'ID_RIBBON_PASTE', iconId: '3_einfuegen' },
                { langId: 'ID_RIBBON_RELOAD', iconId: '4_nachladen' }
            ]
        },
        {
            langId: 'ID_RIBBON_RETESSELATE',
            widgets: [
                {
                    type: w.WidgetType.Dropdown,
                    langId: 'ID_RIBBON_RETESSELATE',
                    iconId: '1_retessellieren',
                    dropdownItems: [
                        { langId: 'ID_RIBBON_EXTRALOW', iconId: 'extra_low_tesselation' },
                        { langId: 'ID_RIBBON_LOW', iconId: 'low_tesselation' },
                        { langId: 'ID_RIBBON_MEDIUM', iconId: 'medium_tesselation' },
                        { langId: 'ID_RIBBON_HIGH', iconId: 'high_tesselation' },
                        { langId: 'ID_RIBBON_EXTRAHIGH', iconId: 'extra_high_tesselation' },
                        { langId: 'ID_RIBBON_USER_DEFINED', iconId: 'custom_tesselation' },
                    ],
                    dropdownClick: function (context, item, button) {
                        var client = context.client;
                        var tesselation = '';
                        switch (item.langId) {
                            case 'ID_RIBBON_EXTRALOW':
                                tesselation = 'ExtraLow';
                                break;
                            case 'ID_RIBBON_LOW':
                                tesselation = 'Low';
                                break;
                            case 'ID_RIBBON_MEDIUM':
                                tesselation = 'Medium';
                                break;
                            case 'ID_RIBBON_HIGH':
                                tesselation = 'High';
                                break;
                            case 'ID_RIBBON_EXTRAHIGH':
                                tesselation = 'ExtraHigh';
                                break;
                            case 'ID_RIBBON_USER_DEFINED':
                                tesselation = 'Userdefined ';
                                break;
                            default:
                                console.error('invalid interaction type');
                        }
                        var xml = '<Call Method="Retesselate"><Level>' + tesselation + '</Level></Call>';
                        client.command.executeXML(xml);
                        button.flashHighlight();
                    }
                }
            ]
        },
        {
            langId: 'ID_RIBBON_COORDINATE_SYSTEM',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_BY_CIRCLE_CENTER', iconId: '1_kreismittelpunkt', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BY_CYLINDER_AXIS', iconId: '1_kreisachse', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BY_3_PLANES', iconId: '2_3_ebenen_im_rechten_winkel', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BY_3_POINTS', iconId: '3_3_punkte_im_rechten_winkel', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BY_EDGES', iconId: '4_senkrechte_linien', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BY_NORMAL', iconId: '5_normale', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BY_EDGE_AND_POINT', iconId: '6_linie_und_punkt', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BY_BOUNDING_BOX', iconId: '7_begrenzungsrahmen', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BY_CURRENT_GLOBAL', iconId: 'coordinate_system_world' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_BY_SELECTED_PART', iconId: 'coordinate_system_part' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_ACTIVATE_COORDINATESYSTEM', iconId: '8_aktivieren' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RESET_COORDINATESYSTEM', iconId: '9_zuruecksetzen' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_BY_CIRCLE_CENTER':
                        mode = 'EntityCreation_CoordinateSystemByCircleCenter';
                        break;
                    case 'ID_RIBBON_BY_3_PLANES':
                        mode = 'EntityCreation_CoordinateSystemBy3Planes';
                        break;
                    case 'ID_RIBBON_BY_3_POINTS':
                        mode = 'EntityCreation_CoordinateSystemBy3Points';
                        break;
                    case 'ID_RIBBON_BY_EDGES':
                        mode = 'EntityCreation_CoordinateSystemByLines';
                        break;
                    case 'ID_RIBBON_BY_NORMAL':
                        mode = 'EntityCreation_CoordinateSystemByNormal';
                        break;
                    case 'ID_RIBBON_BY_EDGE_AND_POINT':
                        mode = 'EntityCreation_CoordinateSystemByLineAndPoint';
                        break;
                    case 'ID_RIBBON_BY_BOUNDING_BOX':
                        mode = 'EntityCreation_CoordinateSystemByBoundingBox';
                        break;
                    case 'ID_RIBBON_BY_CYLINDER_AXIS':
                        mode = 'EntityCreation_CoordinateSystemByCylinderAxis';
                        break;
                    case 'ID_RIBBON_BY_CURRENT_GLOBAL':
                        mode = 'EntityCreation_CoordinateSystemGlobal';
                        removeAllInteractionHighlights(ribbon);
                        clickedButton.flashHighlight();
                        break;
                    case 'ID_RIBBON_BY_SELECTED_PART':
                        mode = 'EntityCreation_CoordinateSystemPart';
                        removeAllInteractionHighlights(ribbon);
                        clickedButton.flashHighlight();
                        break;
                    case 'ID_RIBBON_ACTIVATE_COORDINATESYSTEM':
                        client.command.executeXMLAsync('<Call Method="ActivateSelectedCoordinateSystem"></Call>');
                        removeAllInteractionHighlights(ribbon);
                        clickedButton.flashHighlight();
                        break;
                    case 'ID_RESET_COORDINATESYSTEM':
                        client.command.executeXMLAsync('<Call Method="ResetCoordinateSystem"></Call>');
                        removeAllInteractionHighlights(ribbon);
                        clickedButton.flashHighlight();
                        break;
                    default:
                        console.error('invalid interaction type');
                }
                if (mode) {
                    client.once('ActivateInteraction', function (response) {
                        if (response.Error === 'SUCCESS') {
                            removeAllInteractionHighlights(ribbon);
                            var condition_2 = clickedButton.id;
                            ribbon.classes['Interaction'].forEach(function (b) {
                                if (b.id === condition_2) {
                                    b.applyHighlight(true);
                                }
                            });
                        }
                    });
                    clickedButton.event = mode;
                    handleActivateInteraction(client, mode);
                }
            }
        },
        {
            langId: 'ID_RIBBON_CREATE_POINT',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CIRCLE_CENTER', iconId: '1_kreismittelpunkt', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_POINT', iconId: '2_punkt', ribbonClass: ['Interaction'] },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_CIRCLE_CENTER':
                        mode = 'EntityCreation_PointByCircleCenter';
                        break;
                    case 'ID_RIBBON_POINT':
                        mode = 'EntityCreation_PointByPickPosition';
                        break;
                    default:
                        console.error('invalid interaction type');
                }
                client.once('ActivateInteraction', function (response) {
                    if (response.Error === 'SUCCESS') {
                        removeAllInteractionHighlights(ribbon);
                        var condition_3 = clickedButton.id;
                        ribbon.classes['Interaction'].forEach(function (b) {
                            if (b.id === condition_3) {
                                b.applyHighlight(true);
                            }
                        });
                    }
                });
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            },
        },
        {
            langId: 'ID_RIBBON_CREATE_WIRE',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CIRCLE_AXIS', iconId: '1_kreisachse', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_POINT_TO_POINT', iconId: '2_punkt_zu_punkt', ribbonClass: ['Interaction'] },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_CIRCLE_AXIS':
                        mode = 'EntityCreation_WireByCircleCenter';
                        break;
                    case 'ID_RIBBON_POINT_TO_POINT':
                        mode = 'EntityCreation_WirePointToPoint';
                        break;
                    default:
                        console.error('invalid interaction type');
                }
                client.once('ActivateInteraction', function (response) {
                    if (response.Error === 'SUCCESS') {
                        removeAllInteractionHighlights(ribbon);
                        var condition_4 = clickedButton.langId;
                        ribbon.classes['Interaction'].forEach(function (b) {
                            if (b.langId === condition_4) {
                                b.applyHighlight(true);
                            }
                        });
                    }
                });
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            },
        },
        {
            langId: 'ID_RIBBON_MODIFY_SOLIDS',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_EXTRACT_FACES', iconId: '1_flaeche_extrahieren' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_MERGE_OBJECTS', iconId: 'merge_objects' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_MERGE_OBJECTS_HIERARCHICAL', iconId: 'merge_objects_rec' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CONVEX_HULL', iconId: '2_huellgeometrie' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_EXTRACT_FACES':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>ExtractFaces</SelectionModifier></Call>');
                        break;
                    case 'ID_RIBBON_MERGE_OBJECTS':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>MergeObjects</SelectionModifier></Call>');
                        break;
                    case 'ID_RIBBON_MERGE_OBJECTS_HIERARCHICAL':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>MergeObjectsHierarchically</SelectionModifier></Call>');
                        break;
                    case 'ID_RIBBON_CONVEX_HULL':
                        client.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>ComputeHullGeometry</SelectionModifier></Call>');
                        break;
                    default:
                        return;
                }
                clickedButton.flashHighlight();
            },
        },
        XButton
    ]
};
exports.techDocTab = {
    langId: 'ID_RIBBON_TECH_DOC',
    groups: [
        {
            langId: 'ID_RIBBON_3D_MARKUP',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_TEXT', iconId: '1_text', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CIRCLE', iconId: '2_kreis', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FIXED_TEXT', iconId: 'fixed_markup', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_RECTANGLE', iconId: '3_rechteck', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_FREEHAND', iconId: '4_freihand', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var mode = '';
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_TEXT':
                        mode = 'Markup_Text';
                        break;
                    case 'ID_RIBBON_CIRCLE':
                        mode = 'Markup_Circle';
                        break;
                    case 'ID_RIBBON_RECTANGLE':
                        mode = 'Markup_Rectangle';
                        break;
                    case 'ID_RIBBON_FREEHAND':
                        mode = 'Markup_Freehand';
                        break;
                    case 'ID_RIBBON_FIXED_TEXT':
                        mode = 'Markup_Text_Fixed';
                        break;
                    default:
                        console.error('invalid interaction type');
                }
                clickedButton.event = mode;
                handleActivateInteraction(client, mode);
            }
        },
        {
            langId: 'ID_RIBBON_CALLOUTS_GENERAL_PANEL',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_BOM', iconId: '1_BOM', paneId: 'wv-bom' }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                if (!clickedButton.isHighlight) {
                    clickedButton.applyHighlight(true);
                    handlePrependingPane(clickedButton.paneId, 'on');
                    ui.bomPane.addMethods();
                }
                else {
                    clickedButton.applyHighlight(false);
                    handlePrependingPane(clickedButton.paneId, 'off');
                }
            }
        },
        {
            langId: 'ID_RIBBON_CALLOUTS_ALIGNMENT_PANEL',
            widgets: [
                {
                    type: w.WidgetType.Dropdown,
                    langId: 'ID_RIBBON_CALLOUTS_ALIGN_TOP',
                    iconId: 'callout_mode_square',
                    dropdownItems: [
                        { langId: 'ID_RIBBON_CALLOUTS_ALIGN_RECTANGLE', iconId: 'callout_mode_square' },
                        { langId: 'ID_RIBBON_CALLOUTS_ALIGN_CIRCLE', iconId: 'callout_mode_circle' },
                        { langId: 'ID_RIBBON_CALLOUTS_ALIGN_TOP_AND_BOTTOM', iconId: 'callout_mode_top_bottom' },
                        { langId: 'ID_RIBBON_CALLOUTS_ALIGN_LEFT_AND_RIGHT', iconId: 'callout_mode_left_right' },
                        { langId: 'ID_RIBBON_CALLOUTS_ALIGN_BOTTOM', iconId: 'callout_mode_align_bottom' },
                        { langId: 'ID_RIBBON_CALLOUTS_ALIGN_TOP', iconId: 'callout_mode_align_top' },
                        { langId: 'ID_RIBBON_CALLOUTS_ALIGN_LEFT', iconId: 'callout_mode_align_left' },
                        { langId: 'ID_RIBBON_CALLOUTS_ALIGN_RIGHT', iconId: 'callout_mode_align_right' },
                        { langId: 'ID_RIBBON_CALLOUTS_ALIGN_NEAR_TO_SOLID', iconId: 'callout_mode_near_to_solid' },
                        { langId: 'ID_MARKUP_ALIGNMENT_NONE', iconId: 'callout_mode_none' },
                    ],
                    dropdownClick: function (context, item, button) {
                        var client = context.client;
                        var mode = '';
                        switch (item.langId) {
                            case 'ID_RIBBON_CALLOUTS_ALIGN_BOTTOM':
                                mode = 'Bottom';
                                break;
                            case 'ID_RIBBON_CALLOUTS_ALIGN_TOP':
                                mode = 'Top';
                                break;
                            case 'ID_RIBBON_CALLOUTS_ALIGN_LEFT':
                                mode = 'Left';
                                break;
                            case 'ID_RIBBON_CALLOUTS_ALIGN_RIGHT':
                                mode = 'Right';
                                break;
                            case 'ID_RIBBON_CALLOUTS_ALIGN_TOP_AND_BOTTOM':
                                mode = 'TopBottom';
                                break;
                            case 'ID_RIBBON_CALLOUTS_ALIGN_LEFT_AND_RIGHT':
                                mode = 'LeftRight';
                                break;
                            case 'ID_RIBBON_CALLOUTS_ALIGN_RECTANGLE':
                                mode = 'Rectangle';
                                break;
                            case 'ID_RIBBON_CALLOUTS_ALIGN_CIRCLE':
                                mode = 'Circle';
                                break;
                            case 'ID_RIBBON_CALLOUTS_ALIGN_NEAR_TO_SOLID':
                                mode = 'NearToSolid';
                                break;
                            case 'ID_MARKUP_ALIGNMENT_NONE':
                                mode = 'None';
                                break;
                            default:
                                console.error('invalid interaction type');
                        }
                        var xml = '<Call Method="SetCalloutAlignment"><Alignment>' + mode + '</Alignment></Call>';
                        client.command.executeXML(xml);
                        button.flashHighlight();
                    }
                },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CALLOUTS_AUTO_ALIGNMENT', iconId: 'callout_auto_alignment' }
            ],
            groupClick: function (context, id) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var xml;
                if (clickedButton.langId === 'ID_RIBBON_CALLOUTS_AUTO_ALIGNMENT') {
                    if (!clickedButton.isHighlight) {
                        xml = '<Call Method="EnableAutoCalloutAlignment"></Call>';
                        client.command.executeXML(xml);
                        xml = '<Call Method="AlignCallouts"></Call>';
                        client.command.executeXML(xml);
                    }
                    else {
                        xml = '<Call Method="DisableAutoCalloutAlignment"></Call>';
                        client.command.executeXML(xml);
                    }
                }
            }
        },
        {
            langId: 'ID_RIBBON_CALLOUTS_PANEL',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CREATE', iconId: 'create_callouts', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CALLOUTS_FOR_SELECTION', iconId: 'callout_group' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_SETTINGS', iconId: 'callout', paneId: 'wv-callout' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_CALLOUTS_SHOW_ALL', iconId: 'callout_show_all' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_LOCK_CALLOUTS', iconId: 'callout_lock' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_UNLOCK_CALLOUTS', iconId: 'callout_unlock' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_CALLOUTS_SELECT_ASSOCIATED_NODES', iconId: 'select_associated_solid' },
                { type: w.WidgetType.ButtonLet, langId: 'ID_RIBBON_CALLOUTS_MULTIPLE_CONNECTIONS', iconId: 'callout_multiple_anchor' }
            ],
            groupClick: function (context, id, group) {
                var client = context.client, ribbon = context.ribbon;
                var clickedButton = w.findButton(id);
                var xml;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_SETTINGS':
                        if (!clickedButton.isHighlight) {
                            clickedButton.applyHighlight(true);
                            handlePrependingPane(clickedButton.paneId, 'on');
                            if (clickedButton.paneId === 'wv-bom') {
                                ui.bomPane.addMethods();
                            }
                        }
                        else {
                            clickedButton.applyHighlight(false);
                            handlePrependingPane(clickedButton.paneId, 'off');
                        }
                        break;
                    case 'ID_RIBBON_CALLOUTS_SHOW_ALL':
                        xml = '<Call Method="ShowAllCallouts"></Call>';
                        break;
                    case 'ID_RIBBON_LOCK_CALLOUTS':
                        xml = '<Call Method="LockCallouts"></Call>';
                        break;
                    case 'ID_RIBBON_UNLOCK_CALLOUTS':
                        xml = '<Call Method="UnlockCallouts"></Call>';
                        break;
                    case 'ID_RIBBON_CALLOUTS_FOR_SELECTION':
                        xml = '<Call Method="CreateCalloutGroup"></Call>';
                        break;
                    case 'ID_RIBBON_CALLOUTS_SELECT_ASSOCIATED_NODES':
                        xml = '<Call Method="SetSceneSettings"><Settings><Scene><Tools><Callout><SelectAssociatedNodes>';
                        xml += !clickedButton.isHighlight;
                        xml += '</SelectAssociatedNodes></Callout></Tools></Scene></Settings></Call>';
                        break;
                    case 'ID_RIBBON_CALLOUTS_MULTIPLE_CONNECTIONS':
                        xml = '<Call Method="SetSceneSettings"><Settings><Scene><Tools><Callout><MultiAnchorGroups>';
                        xml += !clickedButton.isHighlight;
                        xml += '</MultiAnchorGroups></Callout></Tools></Scene></Settings></Call>';
                        break;
                    case 'ID_RIBBON_CREATE':
                        clickedButton.event = 'Callout_Creation';
                        handleActivateInteraction(client, 'Callout_Creation');
                        break;
                }
                client.command.executeXML(xml);
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_RIBBON_CALLOUTS_CONNECTIONS_PANEL',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_EDIT', iconId: 'move_anchor', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_DELETE', iconId: 'delete_anchor', ribbonClass: ['Interaction'] },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_INVERT_VISIBILITY', iconId: '5_sichtbarkeit_umkehren', ribbonClass: ['Interaction'] }
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var xml;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_EDIT':
                        clickedButton.event = 'Callout_Modification';
                        handleActivateInteraction(client, 'Callout_Modification');
                        break;
                    case 'ID_RIBBON_DELETE':
                        clickedButton.event = 'Callout_Deletion';
                        handleActivateInteraction(client, 'Callout_Deletion');
                        break;
                    case 'ID_RIBBON_INVERT_VISIBILITY':
                        clickedButton.event = 'Callout_Visibility';
                        handleActivateInteraction(client, 'Callout_Visibility');
                        break;
                }
                client.command.executeXML(xml);
                clickedButton.flashHighlight();
            }
        },
        {
            langId: 'ID_RIBBON_VISIBLE_CALLOUTS_PANEL',
            widgets: [
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CALLOUTS_SELECT_VISIBLE', iconId: 'callout_select_visible' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CALLOUTS_HIDE_VISIBLE', iconId: 'callout_hide' },
                { type: w.WidgetType.Button, langId: 'ID_RIBBON_CALLOUTS_DELETE_VISIBLE', iconId: 'callout_delete' },
            ],
            groupClick: function (context, id, group) {
                var clickedButton = w.findButton(id);
                var client = context.client, ribbon = context.ribbon;
                var xml;
                switch (clickedButton.langId) {
                    case 'ID_RIBBON_CALLOUTS_DELETE_VISIBLE':
                        xml = '<Call Method="DeleteVisibleCallouts"></Call>';
                        break;
                    case 'ID_RIBBON_CALLOUTS_HIDE_VISIBLE':
                        xml = '<Call Method="HideVisibleCallouts"></Call>';
                        break;
                    case 'ID_RIBBON_CALLOUTS_SELECT_VISIBLE':
                        xml = '<Call Method="SelectVisibleCallouts"></Call>';
                        break;
                }
                client.command.executeXML(xml);
                clickedButton.flashHighlight();
            }
        },
        XButton
    ]
};


/***/ }),
/* 14 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML comment.
 *
 * An XML character reference is structured as follows, where `{content}` is
 * the text of the comment.
 *
 * ```xml
 * <!--{content}-->
 * ```
 *
 * The `{content}` value is a property of this node.
 *
 * XmlComment nodes cannot have any children.
 */
var XmlComment = (function (_super) {
    __extends(XmlComment, _super);
    /**
     * Initializes a new instance of the {@link XmlComment} class.
     *
     * @param {string} content The content of the comment.
     */
    function XmlComment(content) {
        _super.call(this);
        this.content = content;
    }
    Object.defineProperty(XmlComment.prototype, "content", {
        /**
         * Gets the content of the comment.
         *
         * @returns {string} The content of the comment.
         */
        get: function () {
            return this._content;
        },
        /**
         * Sets the content of the comment.
         *
         * @param {string} content The content of the comment.
         */
        set: function (content) {
            if (!utils_1.isType(content, "String")) {
                throw new TypeError("content should be a string");
            }
            else if (!validate_1.validateChar(content)) {
                throw new Error("content should not contain characters" +
                    " not allowed in XML");
            }
            else if (!/^([^-]|-[^-])*$/.test(content)) {
                throw new Error("content should not contain the string '--' or" +
                    " end with '-'");
            }
            this._content = content;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlComment} nodes cannot have any
     * children.
     */
    XmlComment.prototype.children = function () {
        throw new Error("XmlComment nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlComment} nodes cannot have any
     * children.
     */
    XmlComment.prototype.insertChild = function (node, index) {
        throw new Error("XmlComment nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlComment} nodes cannot have any
     * children.
     */
    XmlComment.prototype.removeChild = function (node) {
        throw new Error("XmlComment nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlComment} nodes cannot have any
     * children.
     */
    XmlComment.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlComment nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlComment.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        return "<!--" + this.content + "-->";
    };
    return XmlComment;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlComment;


/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML processing instruction.
 *
 * An XML processing instruction is structured as follows, where `{target}`
 * and `{content}` are the target and content of the processing instruction
 * respectively.
 *
 * ```xml
 * <?{target} {content}?>
 * ```
 *
 * The `{target}` and `{content}` values are properties of this node.
 *
 * XmlProcInst nodes cannot have any children.
 */
var XmlProcInst = (function (_super) {
    __extends(XmlProcInst, _super);
    /**
     * Initializes a new instance of the {@link XmlProcInst} class.
     *
     * @param {string} target    The target of the processing instruction.
     * @param {string} [content] The data of the processing instruction, or
     *                           undefined if there is no target.
     */
    function XmlProcInst(target, content) {
        _super.call(this);
        this.target = target;
        this.content = content;
    }
    Object.defineProperty(XmlProcInst.prototype, "target", {
        /**
         * Gets the target of the processing instruction.
         *
         * @returns {string} The target of the processing instruction.
         */
        get: function () {
            return this._target;
        },
        /**
         * Sets the target of the processing instruction.
         *
         * @param {string} target The target of the processing instruction.
         */
        set: function (target) {
            if (!utils_1.isType(target, "String")) {
                throw new TypeError("target should be a string");
            }
            else if (!validate_1.validateChar(target)) {
                throw new Error("target should not contain characters" +
                    " not allowed in XML");
            }
            else if (target === "xml") {
                throw new Error("target should not be the string 'xml'");
            }
            this._target = target;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XmlProcInst.prototype, "content", {
        /**
         * Gets the data of the processing instruction.
         *
         * @returns {string} The data of the processing instruction. This value
         *                   may be undefined.
         */
        get: function () {
            return this._content;
        },
        /**
         * Sets the data of the processing instruction.
         *
         * @param {string} content The data of the processing instruction. This
         *                         value may be undefined.
         */
        set: function (content) {
            if (!utils_1.isType(content, "String", "Undefined")) {
                throw new TypeError("data should be a string or undefined");
            }
            if (utils_1.isType(content, "String")) {
                if (!validate_1.validateChar(content)) {
                    throw new Error("data should not contain characters" +
                        " not allowed in XML");
                }
                else if (/\?>/.test(content)) {
                    throw new Error("data should not contain the string '?>'");
                }
            }
            this._content = content;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlProcInst} nodes cannot have any
     * children.
     */
    XmlProcInst.prototype.children = function () {
        throw new Error("XmlProcInst nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlProcInst} nodes cannot have any
     * children.
     */
    XmlProcInst.prototype.insertChild = function (node, index) {
        throw new Error("XmlProcInst nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlProcInst} nodes cannot have any
     * children.
     */
    XmlProcInst.prototype.removeChild = function (node) {
        throw new Error("XmlProcInst nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlProcInst} nodes cannot have any
     * children.
     */
    XmlProcInst.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlProcInst nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlProcInst.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        if (this.content === undefined) {
            return "<?" + this.target + "?>";
        }
        else {
            return "<?" + this.target + " " + this.content + "?>";
        }
    };
    return XmlProcInst;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlProcInst;


/***/ }),
/* 16 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_RESULT__;// TinyColor v1.4.1
// https://github.com/bgrins/TinyColor
// Brian Grinstead, MIT License

(function(Math) {

var trimLeft = /^\s+/,
    trimRight = /\s+$/,
    tinyCounter = 0,
    mathRound = Math.round,
    mathMin = Math.min,
    mathMax = Math.max,
    mathRandom = Math.random;

function tinycolor (color, opts) {

    color = (color) ? color : '';
    opts = opts || { };

    // If input is already a tinycolor, return itself
    if (color instanceof tinycolor) {
       return color;
    }
    // If we are called as a function, call using new instead
    if (!(this instanceof tinycolor)) {
        return new tinycolor(color, opts);
    }

    var rgb = inputToRGB(color);
    this._originalInput = color,
    this._r = rgb.r,
    this._g = rgb.g,
    this._b = rgb.b,
    this._a = rgb.a,
    this._roundA = mathRound(100*this._a) / 100,
    this._format = opts.format || rgb.format;
    this._gradientType = opts.gradientType;

    // Don't let the range of [0,255] come back in [0,1].
    // Potentially lose a little bit of precision here, but will fix issues where
    // .5 gets interpreted as half of the total, instead of half of 1
    // If it was supposed to be 128, this was already taken care of by `inputToRgb`
    if (this._r < 1) { this._r = mathRound(this._r); }
    if (this._g < 1) { this._g = mathRound(this._g); }
    if (this._b < 1) { this._b = mathRound(this._b); }

    this._ok = rgb.ok;
    this._tc_id = tinyCounter++;
}

tinycolor.prototype = {
    isDark: function() {
        return this.getBrightness() < 128;
    },
    isLight: function() {
        return !this.isDark();
    },
    isValid: function() {
        return this._ok;
    },
    getOriginalInput: function() {
      return this._originalInput;
    },
    getFormat: function() {
        return this._format;
    },
    getAlpha: function() {
        return this._a;
    },
    getBrightness: function() {
        //http://www.w3.org/TR/AERT#color-contrast
        var rgb = this.toRgb();
        return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;
    },
    getLuminance: function() {
        //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef
        var rgb = this.toRgb();
        var RsRGB, GsRGB, BsRGB, R, G, B;
        RsRGB = rgb.r/255;
        GsRGB = rgb.g/255;
        BsRGB = rgb.b/255;

        if (RsRGB <= 0.03928) {R = RsRGB / 12.92;} else {R = Math.pow(((RsRGB + 0.055) / 1.055), 2.4);}
        if (GsRGB <= 0.03928) {G = GsRGB / 12.92;} else {G = Math.pow(((GsRGB + 0.055) / 1.055), 2.4);}
        if (BsRGB <= 0.03928) {B = BsRGB / 12.92;} else {B = Math.pow(((BsRGB + 0.055) / 1.055), 2.4);}
        return (0.2126 * R) + (0.7152 * G) + (0.0722 * B);
    },
    setAlpha: function(value) {
        this._a = boundAlpha(value);
        this._roundA = mathRound(100*this._a) / 100;
        return this;
    },
    toHsv: function() {
        var hsv = rgbToHsv(this._r, this._g, this._b);
        return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };
    },
    toHsvString: function() {
        var hsv = rgbToHsv(this._r, this._g, this._b);
        var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);
        return (this._a == 1) ?
          "hsv("  + h + ", " + s + "%, " + v + "%)" :
          "hsva(" + h + ", " + s + "%, " + v + "%, "+ this._roundA + ")";
    },
    toHsl: function() {
        var hsl = rgbToHsl(this._r, this._g, this._b);
        return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };
    },
    toHslString: function() {
        var hsl = rgbToHsl(this._r, this._g, this._b);
        var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);
        return (this._a == 1) ?
          "hsl("  + h + ", " + s + "%, " + l + "%)" :
          "hsla(" + h + ", " + s + "%, " + l + "%, "+ this._roundA + ")";
    },
    toHex: function(allow3Char) {
        return rgbToHex(this._r, this._g, this._b, allow3Char);
    },
    toHexString: function(allow3Char) {
        return '#' + this.toHex(allow3Char);
    },
    toHex8: function(allow4Char) {
        return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);
    },
    toHex8String: function(allow4Char) {
        return '#' + this.toHex8(allow4Char);
    },
    toRgb: function() {
        return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };
    },
    toRgbString: function() {
        return (this._a == 1) ?
          "rgb("  + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ")" :
          "rgba(" + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ", " + this._roundA + ")";
    },
    toPercentageRgb: function() {
        return { r: mathRound(bound01(this._r, 255) * 100) + "%", g: mathRound(bound01(this._g, 255) * 100) + "%", b: mathRound(bound01(this._b, 255) * 100) + "%", a: this._a };
    },
    toPercentageRgbString: function() {
        return (this._a == 1) ?
          "rgb("  + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%)" :
          "rgba(" + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%, " + this._roundA + ")";
    },
    toName: function() {
        if (this._a === 0) {
            return "transparent";
        }

        if (this._a < 1) {
            return false;
        }

        return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;
    },
    toFilter: function(secondColor) {
        var hex8String = '#' + rgbaToArgbHex(this._r, this._g, this._b, this._a);
        var secondHex8String = hex8String;
        var gradientType = this._gradientType ? "GradientType = 1, " : "";

        if (secondColor) {
            var s = tinycolor(secondColor);
            secondHex8String = '#' + rgbaToArgbHex(s._r, s._g, s._b, s._a);
        }

        return "progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")";
    },
    toString: function(format) {
        var formatSet = !!format;
        format = format || this._format;

        var formattedString = false;
        var hasAlpha = this._a < 1 && this._a >= 0;
        var needsAlphaFormat = !formatSet && hasAlpha && (format === "hex" || format === "hex6" || format === "hex3" || format === "hex4" || format === "hex8" || format === "name");

        if (needsAlphaFormat) {
            // Special case for "transparent", all other non-alpha formats
            // will return rgba when there is transparency.
            if (format === "name" && this._a === 0) {
                return this.toName();
            }
            return this.toRgbString();
        }
        if (format === "rgb") {
            formattedString = this.toRgbString();
        }
        if (format === "prgb") {
            formattedString = this.toPercentageRgbString();
        }
        if (format === "hex" || format === "hex6") {
            formattedString = this.toHexString();
        }
        if (format === "hex3") {
            formattedString = this.toHexString(true);
        }
        if (format === "hex4") {
            formattedString = this.toHex8String(true);
        }
        if (format === "hex8") {
            formattedString = this.toHex8String();
        }
        if (format === "name") {
            formattedString = this.toName();
        }
        if (format === "hsl") {
            formattedString = this.toHslString();
        }
        if (format === "hsv") {
            formattedString = this.toHsvString();
        }

        return formattedString || this.toHexString();
    },
    clone: function() {
        return tinycolor(this.toString());
    },

    _applyModification: function(fn, args) {
        var color = fn.apply(null, [this].concat([].slice.call(args)));
        this._r = color._r;
        this._g = color._g;
        this._b = color._b;
        this.setAlpha(color._a);
        return this;
    },
    lighten: function() {
        return this._applyModification(lighten, arguments);
    },
    brighten: function() {
        return this._applyModification(brighten, arguments);
    },
    darken: function() {
        return this._applyModification(darken, arguments);
    },
    desaturate: function() {
        return this._applyModification(desaturate, arguments);
    },
    saturate: function() {
        return this._applyModification(saturate, arguments);
    },
    greyscale: function() {
        return this._applyModification(greyscale, arguments);
    },
    spin: function() {
        return this._applyModification(spin, arguments);
    },

    _applyCombination: function(fn, args) {
        return fn.apply(null, [this].concat([].slice.call(args)));
    },
    analogous: function() {
        return this._applyCombination(analogous, arguments);
    },
    complement: function() {
        return this._applyCombination(complement, arguments);
    },
    monochromatic: function() {
        return this._applyCombination(monochromatic, arguments);
    },
    splitcomplement: function() {
        return this._applyCombination(splitcomplement, arguments);
    },
    triad: function() {
        return this._applyCombination(triad, arguments);
    },
    tetrad: function() {
        return this._applyCombination(tetrad, arguments);
    }
};

// If input is an object, force 1 into "1.0" to handle ratios properly
// String input requires "1.0" as input, so 1 will be treated as 1
tinycolor.fromRatio = function(color, opts) {
    if (typeof color == "object") {
        var newColor = {};
        for (var i in color) {
            if (color.hasOwnProperty(i)) {
                if (i === "a") {
                    newColor[i] = color[i];
                }
                else {
                    newColor[i] = convertToPercentage(color[i]);
                }
            }
        }
        color = newColor;
    }

    return tinycolor(color, opts);
};

// Given a string or object, convert that input to RGB
// Possible string inputs:
//
//     "red"
//     "#f00" or "f00"
//     "#ff0000" or "ff0000"
//     "#ff000000" or "ff000000"
//     "rgb 255 0 0" or "rgb (255, 0, 0)"
//     "rgb 1.0 0 0" or "rgb (1, 0, 0)"
//     "rgba (255, 0, 0, 1)" or "rgba 255, 0, 0, 1"
//     "rgba (1.0, 0, 0, 1)" or "rgba 1.0, 0, 0, 1"
//     "hsl(0, 100%, 50%)" or "hsl 0 100% 50%"
//     "hsla(0, 100%, 50%, 1)" or "hsla 0 100% 50%, 1"
//     "hsv(0, 100%, 100%)" or "hsv 0 100% 100%"
//
function inputToRGB(color) {

    var rgb = { r: 0, g: 0, b: 0 };
    var a = 1;
    var s = null;
    var v = null;
    var l = null;
    var ok = false;
    var format = false;

    if (typeof color == "string") {
        color = stringInputToObject(color);
    }

    if (typeof color == "object") {
        if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {
            rgb = rgbToRgb(color.r, color.g, color.b);
            ok = true;
            format = String(color.r).substr(-1) === "%" ? "prgb" : "rgb";
        }
        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {
            s = convertToPercentage(color.s);
            v = convertToPercentage(color.v);
            rgb = hsvToRgb(color.h, s, v);
            ok = true;
            format = "hsv";
        }
        else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {
            s = convertToPercentage(color.s);
            l = convertToPercentage(color.l);
            rgb = hslToRgb(color.h, s, l);
            ok = true;
            format = "hsl";
        }

        if (color.hasOwnProperty("a")) {
            a = color.a;
        }
    }

    a = boundAlpha(a);

    return {
        ok: ok,
        format: color.format || format,
        r: mathMin(255, mathMax(rgb.r, 0)),
        g: mathMin(255, mathMax(rgb.g, 0)),
        b: mathMin(255, mathMax(rgb.b, 0)),
        a: a
    };
}


// Conversion Functions
// --------------------

// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:
// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>

// `rgbToRgb`
// Handle bounds / percentage checking to conform to CSS color spec
// <http://www.w3.org/TR/css3-color/>
// *Assumes:* r, g, b in [0, 255] or [0, 1]
// *Returns:* { r, g, b } in [0, 255]
function rgbToRgb(r, g, b){
    return {
        r: bound01(r, 255) * 255,
        g: bound01(g, 255) * 255,
        b: bound01(b, 255) * 255
    };
}

// `rgbToHsl`
// Converts an RGB color value to HSL.
// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]
// *Returns:* { h, s, l } in [0,1]
function rgbToHsl(r, g, b) {

    r = bound01(r, 255);
    g = bound01(g, 255);
    b = bound01(b, 255);

    var max = mathMax(r, g, b), min = mathMin(r, g, b);
    var h, s, l = (max + min) / 2;

    if(max == min) {
        h = s = 0; // achromatic
    }
    else {
        var d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch(max) {
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
        }

        h /= 6;
    }

    return { h: h, s: s, l: l };
}

// `hslToRgb`
// Converts an HSL color value to RGB.
// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]
// *Returns:* { r, g, b } in the set [0, 255]
function hslToRgb(h, s, l) {
    var r, g, b;

    h = bound01(h, 360);
    s = bound01(s, 100);
    l = bound01(l, 100);

    function hue2rgb(p, q, t) {
        if(t < 0) t += 1;
        if(t > 1) t -= 1;
        if(t < 1/6) return p + (q - p) * 6 * t;
        if(t < 1/2) return q;
        if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;
        return p;
    }

    if(s === 0) {
        r = g = b = l; // achromatic
    }
    else {
        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        var p = 2 * l - q;
        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);
    }

    return { r: r * 255, g: g * 255, b: b * 255 };
}

// `rgbToHsv`
// Converts an RGB color value to HSV
// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]
// *Returns:* { h, s, v } in [0,1]
function rgbToHsv(r, g, b) {

    r = bound01(r, 255);
    g = bound01(g, 255);
    b = bound01(b, 255);

    var max = mathMax(r, g, b), min = mathMin(r, g, b);
    var h, s, v = max;

    var d = max - min;
    s = max === 0 ? 0 : d / max;

    if(max == min) {
        h = 0; // achromatic
    }
    else {
        switch(max) {
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
    }
    return { h: h, s: s, v: v };
}

// `hsvToRgb`
// Converts an HSV color value to RGB.
// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]
// *Returns:* { r, g, b } in the set [0, 255]
 function hsvToRgb(h, s, v) {

    h = bound01(h, 360) * 6;
    s = bound01(s, 100);
    v = bound01(v, 100);

    var i = Math.floor(h),
        f = h - i,
        p = v * (1 - s),
        q = v * (1 - f * s),
        t = v * (1 - (1 - f) * s),
        mod = i % 6,
        r = [v, q, p, p, t, v][mod],
        g = [t, v, v, q, p, p][mod],
        b = [p, p, t, v, v, q][mod];

    return { r: r * 255, g: g * 255, b: b * 255 };
}

// `rgbToHex`
// Converts an RGB color to hex
// Assumes r, g, and b are contained in the set [0, 255]
// Returns a 3 or 6 character hex
function rgbToHex(r, g, b, allow3Char) {

    var hex = [
        pad2(mathRound(r).toString(16)),
        pad2(mathRound(g).toString(16)),
        pad2(mathRound(b).toString(16))
    ];

    // Return a 3 character hex if possible
    if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {
        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);
    }

    return hex.join("");
}

// `rgbaToHex`
// Converts an RGBA color plus alpha transparency to hex
// Assumes r, g, b are contained in the set [0, 255] and
// a in [0, 1]. Returns a 4 or 8 character rgba hex
function rgbaToHex(r, g, b, a, allow4Char) {

    var hex = [
        pad2(mathRound(r).toString(16)),
        pad2(mathRound(g).toString(16)),
        pad2(mathRound(b).toString(16)),
        pad2(convertDecimalToHex(a))
    ];

    // Return a 4 character hex if possible
    if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {
        return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);
    }

    return hex.join("");
}

// `rgbaToArgbHex`
// Converts an RGBA color to an ARGB Hex8 string
// Rarely used, but required for "toFilter()"
function rgbaToArgbHex(r, g, b, a) {

    var hex = [
        pad2(convertDecimalToHex(a)),
        pad2(mathRound(r).toString(16)),
        pad2(mathRound(g).toString(16)),
        pad2(mathRound(b).toString(16))
    ];

    return hex.join("");
}

// `equals`
// Can be called with any tinycolor input
tinycolor.equals = function (color1, color2) {
    if (!color1 || !color2) { return false; }
    return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();
};

tinycolor.random = function() {
    return tinycolor.fromRatio({
        r: mathRandom(),
        g: mathRandom(),
        b: mathRandom()
    });
};


// Modification Functions
// ----------------------
// Thanks to less.js for some of the basics here
// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>

function desaturate(color, amount) {
    amount = (amount === 0) ? 0 : (amount || 10);
    var hsl = tinycolor(color).toHsl();
    hsl.s -= amount / 100;
    hsl.s = clamp01(hsl.s);
    return tinycolor(hsl);
}

function saturate(color, amount) {
    amount = (amount === 0) ? 0 : (amount || 10);
    var hsl = tinycolor(color).toHsl();
    hsl.s += amount / 100;
    hsl.s = clamp01(hsl.s);
    return tinycolor(hsl);
}

function greyscale(color) {
    return tinycolor(color).desaturate(100);
}

function lighten (color, amount) {
    amount = (amount === 0) ? 0 : (amount || 10);
    var hsl = tinycolor(color).toHsl();
    hsl.l += amount / 100;
    hsl.l = clamp01(hsl.l);
    return tinycolor(hsl);
}

function brighten(color, amount) {
    amount = (amount === 0) ? 0 : (amount || 10);
    var rgb = tinycolor(color).toRgb();
    rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));
    rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));
    rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));
    return tinycolor(rgb);
}

function darken (color, amount) {
    amount = (amount === 0) ? 0 : (amount || 10);
    var hsl = tinycolor(color).toHsl();
    hsl.l -= amount / 100;
    hsl.l = clamp01(hsl.l);
    return tinycolor(hsl);
}

// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.
// Values outside of this range will be wrapped into this range.
function spin(color, amount) {
    var hsl = tinycolor(color).toHsl();
    var hue = (hsl.h + amount) % 360;
    hsl.h = hue < 0 ? 360 + hue : hue;
    return tinycolor(hsl);
}

// Combination Functions
// ---------------------
// Thanks to jQuery xColor for some of the ideas behind these
// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>

function complement(color) {
    var hsl = tinycolor(color).toHsl();
    hsl.h = (hsl.h + 180) % 360;
    return tinycolor(hsl);
}

function triad(color) {
    var hsl = tinycolor(color).toHsl();
    var h = hsl.h;
    return [
        tinycolor(color),
        tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),
        tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })
    ];
}

function tetrad(color) {
    var hsl = tinycolor(color).toHsl();
    var h = hsl.h;
    return [
        tinycolor(color),
        tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),
        tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),
        tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })
    ];
}

function splitcomplement(color) {
    var hsl = tinycolor(color).toHsl();
    var h = hsl.h;
    return [
        tinycolor(color),
        tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),
        tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})
    ];
}

function analogous(color, results, slices) {
    results = results || 6;
    slices = slices || 30;

    var hsl = tinycolor(color).toHsl();
    var part = 360 / slices;
    var ret = [tinycolor(color)];

    for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {
        hsl.h = (hsl.h + part) % 360;
        ret.push(tinycolor(hsl));
    }
    return ret;
}

function monochromatic(color, results) {
    results = results || 6;
    var hsv = tinycolor(color).toHsv();
    var h = hsv.h, s = hsv.s, v = hsv.v;
    var ret = [];
    var modification = 1 / results;

    while (results--) {
        ret.push(tinycolor({ h: h, s: s, v: v}));
        v = (v + modification) % 1;
    }

    return ret;
}

// Utility Functions
// ---------------------

tinycolor.mix = function(color1, color2, amount) {
    amount = (amount === 0) ? 0 : (amount || 50);

    var rgb1 = tinycolor(color1).toRgb();
    var rgb2 = tinycolor(color2).toRgb();

    var p = amount / 100;

    var rgba = {
        r: ((rgb2.r - rgb1.r) * p) + rgb1.r,
        g: ((rgb2.g - rgb1.g) * p) + rgb1.g,
        b: ((rgb2.b - rgb1.b) * p) + rgb1.b,
        a: ((rgb2.a - rgb1.a) * p) + rgb1.a
    };

    return tinycolor(rgba);
};


// Readability Functions
// ---------------------
// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)

// `contrast`
// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)
tinycolor.readability = function(color1, color2) {
    var c1 = tinycolor(color1);
    var c2 = tinycolor(color2);
    return (Math.max(c1.getLuminance(),c2.getLuminance())+0.05) / (Math.min(c1.getLuminance(),c2.getLuminance())+0.05);
};

// `isReadable`
// Ensure that foreground and background color combinations meet WCAG2 guidelines.
// The third argument is an optional Object.
//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';
//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.
// If the entire object is absent, isReadable defaults to {level:"AA",size:"small"}.

// *Example*
//    tinycolor.isReadable("#000", "#111") => false
//    tinycolor.isReadable("#000", "#111",{level:"AA",size:"large"}) => false
tinycolor.isReadable = function(color1, color2, wcag2) {
    var readability = tinycolor.readability(color1, color2);
    var wcag2Parms, out;

    out = false;

    wcag2Parms = validateWCAG2Parms(wcag2);
    switch (wcag2Parms.level + wcag2Parms.size) {
        case "AAsmall":
        case "AAAlarge":
            out = readability >= 4.5;
            break;
        case "AAlarge":
            out = readability >= 3;
            break;
        case "AAAsmall":
            out = readability >= 7;
            break;
    }
    return out;

};

// `mostReadable`
// Given a base color and a list of possible foreground or background
// colors for that base, returns the most readable color.
// Optionally returns Black or White if the most readable color is unreadable.
// *Example*
//    tinycolor.mostReadable(tinycolor.mostReadable("#123", ["#124", "#125"],{includeFallbackColors:false}).toHexString(); // "#112255"
//    tinycolor.mostReadable(tinycolor.mostReadable("#123", ["#124", "#125"],{includeFallbackColors:true}).toHexString();  // "#ffffff"
//    tinycolor.mostReadable("#a8015a", ["#faf3f3"],{includeFallbackColors:true,level:"AAA",size:"large"}).toHexString(); // "#faf3f3"
//    tinycolor.mostReadable("#a8015a", ["#faf3f3"],{includeFallbackColors:true,level:"AAA",size:"small"}).toHexString(); // "#ffffff"
tinycolor.mostReadable = function(baseColor, colorList, args) {
    var bestColor = null;
    var bestScore = 0;
    var readability;
    var includeFallbackColors, level, size ;
    args = args || {};
    includeFallbackColors = args.includeFallbackColors ;
    level = args.level;
    size = args.size;

    for (var i= 0; i < colorList.length ; i++) {
        readability = tinycolor.readability(baseColor, colorList[i]);
        if (readability > bestScore) {
            bestScore = readability;
            bestColor = tinycolor(colorList[i]);
        }
    }

    if (tinycolor.isReadable(baseColor, bestColor, {"level":level,"size":size}) || !includeFallbackColors) {
        return bestColor;
    }
    else {
        args.includeFallbackColors=false;
        return tinycolor.mostReadable(baseColor,["#fff", "#000"],args);
    }
};


// Big List of Colors
// ------------------
// <http://www.w3.org/TR/css3-color/#svg-color>
var names = tinycolor.names = {
    aliceblue: "f0f8ff",
    antiquewhite: "faebd7",
    aqua: "0ff",
    aquamarine: "7fffd4",
    azure: "f0ffff",
    beige: "f5f5dc",
    bisque: "ffe4c4",
    black: "000",
    blanchedalmond: "ffebcd",
    blue: "00f",
    blueviolet: "8a2be2",
    brown: "a52a2a",
    burlywood: "deb887",
    burntsienna: "ea7e5d",
    cadetblue: "5f9ea0",
    chartreuse: "7fff00",
    chocolate: "d2691e",
    coral: "ff7f50",
    cornflowerblue: "6495ed",
    cornsilk: "fff8dc",
    crimson: "dc143c",
    cyan: "0ff",
    darkblue: "00008b",
    darkcyan: "008b8b",
    darkgoldenrod: "b8860b",
    darkgray: "a9a9a9",
    darkgreen: "006400",
    darkgrey: "a9a9a9",
    darkkhaki: "bdb76b",
    darkmagenta: "8b008b",
    darkolivegreen: "556b2f",
    darkorange: "ff8c00",
    darkorchid: "9932cc",
    darkred: "8b0000",
    darksalmon: "e9967a",
    darkseagreen: "8fbc8f",
    darkslateblue: "483d8b",
    darkslategray: "2f4f4f",
    darkslategrey: "2f4f4f",
    darkturquoise: "00ced1",
    darkviolet: "9400d3",
    deeppink: "ff1493",
    deepskyblue: "00bfff",
    dimgray: "696969",
    dimgrey: "696969",
    dodgerblue: "1e90ff",
    firebrick: "b22222",
    floralwhite: "fffaf0",
    forestgreen: "228b22",
    fuchsia: "f0f",
    gainsboro: "dcdcdc",
    ghostwhite: "f8f8ff",
    gold: "ffd700",
    goldenrod: "daa520",
    gray: "808080",
    green: "008000",
    greenyellow: "adff2f",
    grey: "808080",
    honeydew: "f0fff0",
    hotpink: "ff69b4",
    indianred: "cd5c5c",
    indigo: "4b0082",
    ivory: "fffff0",
    khaki: "f0e68c",
    lavender: "e6e6fa",
    lavenderblush: "fff0f5",
    lawngreen: "7cfc00",
    lemonchiffon: "fffacd",
    lightblue: "add8e6",
    lightcoral: "f08080",
    lightcyan: "e0ffff",
    lightgoldenrodyellow: "fafad2",
    lightgray: "d3d3d3",
    lightgreen: "90ee90",
    lightgrey: "d3d3d3",
    lightpink: "ffb6c1",
    lightsalmon: "ffa07a",
    lightseagreen: "20b2aa",
    lightskyblue: "87cefa",
    lightslategray: "789",
    lightslategrey: "789",
    lightsteelblue: "b0c4de",
    lightyellow: "ffffe0",
    lime: "0f0",
    limegreen: "32cd32",
    linen: "faf0e6",
    magenta: "f0f",
    maroon: "800000",
    mediumaquamarine: "66cdaa",
    mediumblue: "0000cd",
    mediumorchid: "ba55d3",
    mediumpurple: "9370db",
    mediumseagreen: "3cb371",
    mediumslateblue: "7b68ee",
    mediumspringgreen: "00fa9a",
    mediumturquoise: "48d1cc",
    mediumvioletred: "c71585",
    midnightblue: "191970",
    mintcream: "f5fffa",
    mistyrose: "ffe4e1",
    moccasin: "ffe4b5",
    navajowhite: "ffdead",
    navy: "000080",
    oldlace: "fdf5e6",
    olive: "808000",
    olivedrab: "6b8e23",
    orange: "ffa500",
    orangered: "ff4500",
    orchid: "da70d6",
    palegoldenrod: "eee8aa",
    palegreen: "98fb98",
    paleturquoise: "afeeee",
    palevioletred: "db7093",
    papayawhip: "ffefd5",
    peachpuff: "ffdab9",
    peru: "cd853f",
    pink: "ffc0cb",
    plum: "dda0dd",
    powderblue: "b0e0e6",
    purple: "800080",
    rebeccapurple: "663399",
    red: "f00",
    rosybrown: "bc8f8f",
    royalblue: "4169e1",
    saddlebrown: "8b4513",
    salmon: "fa8072",
    sandybrown: "f4a460",
    seagreen: "2e8b57",
    seashell: "fff5ee",
    sienna: "a0522d",
    silver: "c0c0c0",
    skyblue: "87ceeb",
    slateblue: "6a5acd",
    slategray: "708090",
    slategrey: "708090",
    snow: "fffafa",
    springgreen: "00ff7f",
    steelblue: "4682b4",
    tan: "d2b48c",
    teal: "008080",
    thistle: "d8bfd8",
    tomato: "ff6347",
    turquoise: "40e0d0",
    violet: "ee82ee",
    wheat: "f5deb3",
    white: "fff",
    whitesmoke: "f5f5f5",
    yellow: "ff0",
    yellowgreen: "9acd32"
};

// Make it easy to access colors via `hexNames[hex]`
var hexNames = tinycolor.hexNames = flip(names);


// Utilities
// ---------

// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`
function flip(o) {
    var flipped = { };
    for (var i in o) {
        if (o.hasOwnProperty(i)) {
            flipped[o[i]] = i;
        }
    }
    return flipped;
}

// Return a valid alpha value [0,1] with all invalid values being set to 1
function boundAlpha(a) {
    a = parseFloat(a);

    if (isNaN(a) || a < 0 || a > 1) {
        a = 1;
    }

    return a;
}

// Take input from [0, n] and return it as [0, 1]
function bound01(n, max) {
    if (isOnePointZero(n)) { n = "100%"; }

    var processPercent = isPercentage(n);
    n = mathMin(max, mathMax(0, parseFloat(n)));

    // Automatically convert percentage into number
    if (processPercent) {
        n = parseInt(n * max, 10) / 100;
    }

    // Handle floating point rounding errors
    if ((Math.abs(n - max) < 0.000001)) {
        return 1;
    }

    // Convert into [0, 1] range if it isn't already
    return (n % max) / parseFloat(max);
}

// Force a number between 0 and 1
function clamp01(val) {
    return mathMin(1, mathMax(0, val));
}

// Parse a base-16 hex value into a base-10 integer
function parseIntFromHex(val) {
    return parseInt(val, 16);
}

// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1
// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>
function isOnePointZero(n) {
    return typeof n == "string" && n.indexOf('.') != -1 && parseFloat(n) === 1;
}

// Check to see if string passed in is a percentage
function isPercentage(n) {
    return typeof n === "string" && n.indexOf('%') != -1;
}

// Force a hex value to have 2 characters
function pad2(c) {
    return c.length == 1 ? '0' + c : '' + c;
}

// Replace a decimal with it's percentage value
function convertToPercentage(n) {
    if (n <= 1) {
        n = (n * 100) + "%";
    }

    return n;
}

// Converts a decimal to a hex value
function convertDecimalToHex(d) {
    return Math.round(parseFloat(d) * 255).toString(16);
}
// Converts a hex value to a decimal
function convertHexToDecimal(h) {
    return (parseIntFromHex(h) / 255);
}

var matchers = (function() {

    // <http://www.w3.org/TR/css3-values/#integers>
    var CSS_INTEGER = "[-\\+]?\\d+%?";

    // <http://www.w3.org/TR/css3-values/#number-value>
    var CSS_NUMBER = "[-\\+]?\\d*\\.\\d+%?";

    // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.
    var CSS_UNIT = "(?:" + CSS_NUMBER + ")|(?:" + CSS_INTEGER + ")";

    // Actual matching.
    // Parentheses and commas are optional, but not required.
    // Whitespace can take the place of commas or opening paren
    var PERMISSIVE_MATCH3 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";
    var PERMISSIVE_MATCH4 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";

    return {
        CSS_UNIT: new RegExp(CSS_UNIT),
        rgb: new RegExp("rgb" + PERMISSIVE_MATCH3),
        rgba: new RegExp("rgba" + PERMISSIVE_MATCH4),
        hsl: new RegExp("hsl" + PERMISSIVE_MATCH3),
        hsla: new RegExp("hsla" + PERMISSIVE_MATCH4),
        hsv: new RegExp("hsv" + PERMISSIVE_MATCH3),
        hsva: new RegExp("hsva" + PERMISSIVE_MATCH4),
        hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
        hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,
        hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
        hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/
    };
})();

// `isValidCSSUnit`
// Take in a single string / number and check to see if it looks like a CSS unit
// (see `matchers` above for definition).
function isValidCSSUnit(color) {
    return !!matchers.CSS_UNIT.exec(color);
}

// `stringInputToObject`
// Permissive string parsing.  Take in a number of formats, and output an object
// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`
function stringInputToObject(color) {

    color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();
    var named = false;
    if (names[color]) {
        color = names[color];
        named = true;
    }
    else if (color == 'transparent') {
        return { r: 0, g: 0, b: 0, a: 0, format: "name" };
    }

    // Try to match string input using regular expressions.
    // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]
    // Just return an object and let the conversion functions handle that.
    // This way the result will be the same whether the tinycolor is initialized with string or object.
    var match;
    if ((match = matchers.rgb.exec(color))) {
        return { r: match[1], g: match[2], b: match[3] };
    }
    if ((match = matchers.rgba.exec(color))) {
        return { r: match[1], g: match[2], b: match[3], a: match[4] };
    }
    if ((match = matchers.hsl.exec(color))) {
        return { h: match[1], s: match[2], l: match[3] };
    }
    if ((match = matchers.hsla.exec(color))) {
        return { h: match[1], s: match[2], l: match[3], a: match[4] };
    }
    if ((match = matchers.hsv.exec(color))) {
        return { h: match[1], s: match[2], v: match[3] };
    }
    if ((match = matchers.hsva.exec(color))) {
        return { h: match[1], s: match[2], v: match[3], a: match[4] };
    }
    if ((match = matchers.hex8.exec(color))) {
        return {
            r: parseIntFromHex(match[1]),
            g: parseIntFromHex(match[2]),
            b: parseIntFromHex(match[3]),
            a: convertHexToDecimal(match[4]),
            format: named ? "name" : "hex8"
        };
    }
    if ((match = matchers.hex6.exec(color))) {
        return {
            r: parseIntFromHex(match[1]),
            g: parseIntFromHex(match[2]),
            b: parseIntFromHex(match[3]),
            format: named ? "name" : "hex"
        };
    }
    if ((match = matchers.hex4.exec(color))) {
        return {
            r: parseIntFromHex(match[1] + '' + match[1]),
            g: parseIntFromHex(match[2] + '' + match[2]),
            b: parseIntFromHex(match[3] + '' + match[3]),
            a: convertHexToDecimal(match[4] + '' + match[4]),
            format: named ? "name" : "hex8"
        };
    }
    if ((match = matchers.hex3.exec(color))) {
        return {
            r: parseIntFromHex(match[1] + '' + match[1]),
            g: parseIntFromHex(match[2] + '' + match[2]),
            b: parseIntFromHex(match[3] + '' + match[3]),
            format: named ? "name" : "hex"
        };
    }

    return false;
}

function validateWCAG2Parms(parms) {
    // return valid WCAG2 parms for isReadable.
    // If input parms are invalid, return {"level":"AA", "size":"small"}
    var level, size;
    parms = parms || {"level":"AA", "size":"small"};
    level = (parms.level || "AA").toUpperCase();
    size = (parms.size || "small").toLowerCase();
    if (level !== "AA" && level !== "AAA") {
        level = "AA";
    }
    if (size !== "small" && size !== "large") {
        size = "small";
    }
    return {"level":level, "size":size};
}

// Node: Export function
if (typeof module !== "undefined" && module.exports) {
    module.exports = tinycolor;
}
// AMD/requirejs: Define the module
else if (true) {
    !(__WEBPACK_AMD_DEFINE_RESULT__ = function () {return tinycolor;}.call(exports, __webpack_require__, exports, module),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
}
// Browser: Expose to window
else {
    window.tinycolor = tinycolor;
}

})(Math);


/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var options_1 = __webpack_require__(38);
var utils_1 = __webpack_require__(23);
var xmlcreate_1 = __webpack_require__(39);
/**
 * Parses a string into XML.
 *
 * @param {string} str                            The string to parse into XML.
 * @param {XmlAttribute|XmlElement} parentElement The XML element or attribute
 *                                                that will contain the string.
 * @param {IOptions} options                      Options for parsing the
 *                                                string into XML.
 *
 * @private
 */
function parseString(str, parentElement, options) {
    var requiresCdata = function (s) {
        return (options.cdataInvalidChars && (s.indexOf("<") !== -1
            || s.indexOf("&") !== -1))
            || options.cdataKeys.indexOf(parentElement.name) !== -1
            || options.cdataKeys.indexOf("*") !== -1;
    };
    if (parentElement instanceof xmlcreate_1.XmlElement && requiresCdata(str)) {
        var cdataStrs = str.split("]]>");
        for (var i = 0; i < cdataStrs.length; i++) {
            if (requiresCdata(cdataStrs[i])) {
                parentElement.cdata(cdataStrs[i]);
            }
            else {
                parentElement.text(cdataStrs[i]);
            }
            if (i < cdataStrs.length - 1) {
                parentElement.text("]]>");
            }
        }
    }
    else {
        parentElement.text(str);
    }
}
/**
 * Parses an attribute into XML.
 *
 * @param {string} name              The name of the attribute.
 * @param {string} value             The value of the attribute.
 * @param {XmlElement} parentElement The XML element that will contain the
 *                                   string.
 * @param {IOptions} options         Options for parsing the attribute into XML.
 *
 * @private
 */
function parseAttribute(name, value, parentElement, options) {
    var attribute = parentElement.attribute(name, "");
    if (utils_1.isType(value, "String") || utils_1.isType(value, "Number")
        || utils_1.isType(value, "Boolean") || utils_1.isType(value, "Undefined")
        || utils_1.isType(value, "Null")) {
        parseString(utils_1.stringify(value), attribute, options);
    }
    else {
        throw new Error("attribute value for name '" + name + "' should be a"
            + " primitive (string, number, boolean, null, or"
            + " undefined)");
    }
}
/**
 * Parses an object or Map entry into XML.
 *
 * @param {string} key               The key associated with the object or Map
 *                                   entry.
 * @param {*} value                  The object or map entry.
 * @param {XmlElement} parentElement The XML element that will contain the
 *                                   object or map entry.
 * @param {IOptions} options         Options for parsing the object or map
 *                                   entry into XML.
 *
 * @private
 */
function parseObjectOrMapEntry(key, value, parentElement, options) {
    // Alias key
    if (key === options.aliasString) {
        if (!utils_1.isType(value, "String")) {
            throw new Error("aliasString value for " + value
                + " should be a string");
        }
        parentElement.name = value;
        return;
    }
    // Attributes key
    if (key.indexOf(options.attributeString) === 0) {
        if (utils_1.isType(value, "Object")) {
            for (var _i = 0, _a = Object.keys(value); _i < _a.length; _i++) {
                var subkey = _a[_i];
                parseAttribute(subkey, value[subkey], parentElement, options);
            }
        }
        else {
            throw new Error("attributes object for " + key + " should be an"
                + " object");
        }
        return;
    }
    // Value key
    if (key.indexOf(options.valueString) === 0) {
        if (utils_1.isType(value, "String") || utils_1.isType(value, "Number")
            || utils_1.isType(value, "Boolean") || utils_1.isType(value, "Null")
            || utils_1.isType(value, "Undefined")) {
            parseValue(key, value, parentElement, options);
            return;
        }
        else {
            throw new Error("value " + value + " should be a primitive"
                + " (string, number, boolean, null, or undefined)");
        }
    }
    // Standard handling (create new element for entry)
    var element = parentElement;
    if (!utils_1.isType(value, "Array") && !utils_1.isType(value, "Set")) {
        element = parentElement.element(key);
    }
    parseValue(key, value, element, options);
}
/**
 * Parses an Object or Map into XML.
 *
 * @param {*} objectOrMap            The object or map to parse into XML.
 * @param {XmlElement} parentElement The XML element that will contain the
 *                                   object.
 * @param {IOptions} options         Options for parsing the object into XML.
 *
 * @private
 */
function parseObjectOrMap(objectOrMap, parentElement, options) {
    if (utils_1.isType(objectOrMap, "Map")) {
        objectOrMap.forEach(function (value, key) {
            parseObjectOrMapEntry(utils_1.stringify(key), value, parentElement, options);
        });
    }
    else {
        for (var _i = 0, _a = Object.keys(objectOrMap); _i < _a.length; _i++) {
            var key = _a[_i];
            parseObjectOrMapEntry(key, objectOrMap[key], parentElement, options);
        }
    }
}
/**
 * Parses an array or Set into XML.
 *
 * @param {string} key               The key associated with the array or set to
 *                                   parse into XML.
 * @param {*} arrayOrSet             The array or set to parse into XML.
 * @param {XmlElement} parentElement The XML element that will contain the
 *                                   function.
 * @param {IOptions} options         Options for parsing the array or set into
 *                                   XML.
 *
 * @private
 */
function parseArrayOrSet(key, arrayOrSet, parentElement, options) {
    var arrayNameFunc;
    if (options.wrapHandlers.hasOwnProperty("*")) {
        arrayNameFunc = options.wrapHandlers["*"];
    }
    if (options.wrapHandlers.hasOwnProperty(key)) {
        arrayNameFunc = options.wrapHandlers[key];
    }
    var arrayKey = key;
    var arrayElement = parentElement;
    if (!utils_1.isType(arrayNameFunc, "Undefined")) {
        var arrayNameFuncKey = arrayNameFunc(arrayKey, arrayOrSet);
        if (utils_1.isType(arrayNameFuncKey, "String")) {
            arrayKey = arrayNameFuncKey;
            arrayElement = parentElement.element(key);
        }
        else if (!utils_1.isType(arrayNameFuncKey, "Null")) {
            throw new Error("wrapHandlers function for " + arrayKey
                + " should return a string or null");
        }
    }
    arrayOrSet.forEach(function (item) {
        var element = arrayElement;
        if (!utils_1.isType(item, "Array") && !utils_1.isType(item, "Set")) {
            element = arrayElement.element(arrayKey);
        }
        parseValue(arrayKey, item, element, options);
    });
}
/**
 * Parses an arbitrary JavaScript value into XML.
 *
 * @param {string} key               The key associated with the value to parse
 *                                   into XML.
 * @param {*} value                  The value to parse into XML.
 * @param {XmlElement} parentElement The XML element that will contain the
 *                                   value.
 * @param {IOptions} options         Options for parsing the value into XML.
 *
 * @private
 */
function parseValue(key, value, parentElement, options) {
    // If a handler for a particular type is user-defined, use that handler
    // instead of the defaults
    var type = Object.prototype.toString.call(value);
    var handler;
    if (options.typeHandlers.hasOwnProperty("*")) {
        handler = options.typeHandlers["*"];
    }
    if (options.typeHandlers.hasOwnProperty(type)) {
        handler = options.typeHandlers[type];
    }
    if (!utils_1.isType(handler, "Undefined")) {
        value = handler(value);
    }
    if (utils_1.isType(value, "Object") || utils_1.isType(value, "Map")) {
        parseObjectOrMap(value, parentElement, options);
        return;
    }
    if (utils_1.isType(value, "Array") || utils_1.isType(value, "Set")) {
        parseArrayOrSet(key, value, parentElement, options);
        return;
    }
    parseString(utils_1.stringify(value), parentElement, options);
}
/**
 * Returns a XML document corresponding to the specified value.
 *
 * @param {string} root      The name of the root XML element. When the value is
 *                           converted to XML, it will be a child of this root
 *                           element.
 * @param {*} value          The value to convert to XML.
 * @param {IOptions} options Options for parsing the value into XML.
 *
 * @returns {XmlDocument} An XML document corresponding to the specified value.
 *
 * @private
 */
function parseToDocument(root, value, options) {
    var document = new xmlcreate_1.XmlDocument(root);
    if (options.declaration.include) {
        document.decl(options.declaration);
    }
    if (options.dtd.include) {
        document.dtd(options.dtd.name, options.dtd.sysId, options.dtd.pubId);
    }
    parseValue(root, value, document.root(), options);
    return document;
}
/**
 * Returns a XML string representation of the specified object.
 *
 * @param {string} root        The name of the root XML element. When the
 *                             object is converted to XML, it will be a
 *                             child of this root element.
 * @param {*} object           The object to convert to XML.
 * @param {IOptions} [options] Options for parsing the object and
 *                             formatting the resulting XML.
 *
 * @returns {string} An XML string representation of the specified object.
 */
function parse(root, object, options) {
    if (options === void 0) { options = {}; }
    options = options_1.validateOptions(options);
    var document = parseToDocument(root, object, options);
    return document.toString(options.format);
}
exports.parse = parse;


/***/ }),
/* 18 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var deselectCurrent = __webpack_require__(41);

var defaultMessage = 'Copy to clipboard: #{key}, Enter';

function format(message) {
  var copyKey = (/mac os x/i.test(navigator.userAgent) ? '' : 'Ctrl') + '+C';
  return message.replace(/#{\s*key\s*}/g, copyKey);
}

function copy(text, options) {
  var debug, message, reselectPrevious, range, selection, mark, success = false;
  if (!options) { options = {}; }
  debug = options.debug || false;
  try {
    reselectPrevious = deselectCurrent();

    range = document.createRange();
    selection = document.getSelection();

    mark = document.createElement('span');
    mark.textContent = text;
    // reset user styles for span element
    mark.style.all = 'unset';
    // prevents scrolling to the end of the page
    mark.style.position = 'fixed';
    mark.style.top = 0;
    mark.style.clip = 'rect(0, 0, 0, 0)';
    // used to preserve spaces and line breaks
    mark.style.whiteSpace = 'pre';
    // do not inherit user-select (it may be `none`)
    mark.style.webkitUserSelect = 'text';
    mark.style.MozUserSelect = 'text';
    mark.style.msUserSelect = 'text';
    mark.style.userSelect = 'text';

    document.body.appendChild(mark);

    range.selectNode(mark);
    selection.addRange(range);

    var successful = document.execCommand('copy');
    if (!successful) {
      throw new Error('copy command was unsuccessful');
    }
    success = true;
  } catch (err) {
    debug && console.error('unable to copy using execCommand: ', err);
    debug && console.warn('trying IE specific stuff');
    try {
      window.clipboardData.setData('text', text);
      success = true;
    } catch (err) {
      debug && console.error('unable to copy using clipboardData: ', err);
      debug && console.error('falling back to prompt');
      message = format('message' in options ? options.message : defaultMessage);
      window.prompt(message, text);
    }
  } finally {
    if (selection) {
      if (typeof selection.removeRange == 'function') {
        selection.removeRange(range);
      } else {
        selection.removeAllRanges();
      }
    }

    if (mark) {
      document.body.removeChild(mark);
    }
    reselectPrevious();
  }

  return success;
}

module.exports = copy;


/***/ }),
/* 19 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.



var R = typeof Reflect === 'object' ? Reflect : null
var ReflectApply = R && typeof R.apply === 'function'
  ? R.apply
  : function ReflectApply(target, receiver, args) {
    return Function.prototype.apply.call(target, receiver, args);
  }

var ReflectOwnKeys
if (R && typeof R.ownKeys === 'function') {
  ReflectOwnKeys = R.ownKeys
} else if (Object.getOwnPropertySymbols) {
  ReflectOwnKeys = function ReflectOwnKeys(target) {
    return Object.getOwnPropertyNames(target)
      .concat(Object.getOwnPropertySymbols(target));
  };
} else {
  ReflectOwnKeys = function ReflectOwnKeys(target) {
    return Object.getOwnPropertyNames(target);
  };
}

function ProcessEmitWarning(warning) {
  if (console && console.warn) console.warn(warning);
}

var NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {
  return value !== value;
}

function EventEmitter() {
  EventEmitter.init.call(this);
}
module.exports = EventEmitter;

// Backwards-compat with node 0.10.x
EventEmitter.EventEmitter = EventEmitter;

EventEmitter.prototype._events = undefined;
EventEmitter.prototype._eventsCount = 0;
EventEmitter.prototype._maxListeners = undefined;

// By default EventEmitters will print a warning if more than 10 listeners are
// added to it. This is a useful default which helps finding memory leaks.
var defaultMaxListeners = 10;

Object.defineProperty(EventEmitter, 'defaultMaxListeners', {
  enumerable: true,
  get: function() {
    return defaultMaxListeners;
  },
  set: function(arg) {
    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {
      throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + arg + '.');
    }
    defaultMaxListeners = arg;
  }
});

EventEmitter.init = function() {

  if (this._events === undefined ||
      this._events === Object.getPrototypeOf(this)._events) {
    this._events = Object.create(null);
    this._eventsCount = 0;
  }

  this._maxListeners = this._maxListeners || undefined;
};

// Obviously not all Emitters should be limited to 10. This function allows
// that to be increased. Set to zero for unlimited.
EventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {
  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {
    throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + n + '.');
  }
  this._maxListeners = n;
  return this;
};

function $getMaxListeners(that) {
  if (that._maxListeners === undefined)
    return EventEmitter.defaultMaxListeners;
  return that._maxListeners;
}

EventEmitter.prototype.getMaxListeners = function getMaxListeners() {
  return $getMaxListeners(this);
};

EventEmitter.prototype.emit = function emit(type) {
  var args = [];
  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);
  var doError = (type === 'error');

  var events = this._events;
  if (events !== undefined)
    doError = (doError && events.error === undefined);
  else if (!doError)
    return false;

  // If there is no 'error' event listener then throw.
  if (doError) {
    var er;
    if (args.length > 0)
      er = args[0];
    if (er instanceof Error) {
      // Note: The comments on the `throw` lines are intentional, they show
      // up in Node's output if this results in an unhandled exception.
      throw er; // Unhandled 'error' event
    }
    // At least give some kind of context to the user
    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));
    err.context = er;
    throw err; // Unhandled 'error' event
  }

  var handler = events[type];

  if (handler === undefined)
    return false;

  if (typeof handler === 'function') {
    ReflectApply(handler, this, args);
  } else {
    var len = handler.length;
    var listeners = arrayClone(handler, len);
    for (var i = 0; i < len; ++i)
      ReflectApply(listeners[i], this, args);
  }

  return true;
};

function _addListener(target, type, listener, prepend) {
  var m;
  var events;
  var existing;

  if (typeof listener !== 'function') {
    throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof listener);
  }

  events = target._events;
  if (events === undefined) {
    events = target._events = Object.create(null);
    target._eventsCount = 0;
  } else {
    // To avoid recursion in the case that type === "newListener"! Before
    // adding it to the listeners, first emit "newListener".
    if (events.newListener !== undefined) {
      target.emit('newListener', type,
                  listener.listener ? listener.listener : listener);

      // Re-assign `events` because a newListener handler could have caused the
      // this._events to be assigned to a new object
      events = target._events;
    }
    existing = events[type];
  }

  if (existing === undefined) {
    // Optimize the case of one listener. Don't need the extra array object.
    existing = events[type] = listener;
    ++target._eventsCount;
  } else {
    if (typeof existing === 'function') {
      // Adding the second element, need to change to array.
      existing = events[type] =
        prepend ? [listener, existing] : [existing, listener];
      // If we've already got an array, just append.
    } else if (prepend) {
      existing.unshift(listener);
    } else {
      existing.push(listener);
    }

    // Check for listener leak
    m = $getMaxListeners(target);
    if (m > 0 && existing.length > m && !existing.warned) {
      existing.warned = true;
      // No error code for this since it is a Warning
      // eslint-disable-next-line no-restricted-syntax
      var w = new Error('Possible EventEmitter memory leak detected. ' +
                          existing.length + ' ' + String(type) + ' listeners ' +
                          'added. Use emitter.setMaxListeners() to ' +
                          'increase limit');
      w.name = 'MaxListenersExceededWarning';
      w.emitter = target;
      w.type = type;
      w.count = existing.length;
      ProcessEmitWarning(w);
    }
  }

  return target;
}

EventEmitter.prototype.addListener = function addListener(type, listener) {
  return _addListener(this, type, listener, false);
};

EventEmitter.prototype.on = EventEmitter.prototype.addListener;

EventEmitter.prototype.prependListener =
    function prependListener(type, listener) {
      return _addListener(this, type, listener, true);
    };

function onceWrapper() {
  var args = [];
  for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);
  if (!this.fired) {
    this.target.removeListener(this.type, this.wrapFn);
    this.fired = true;
    ReflectApply(this.listener, this.target, args);
  }
}

function _onceWrap(target, type, listener) {
  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };
  var wrapped = onceWrapper.bind(state);
  wrapped.listener = listener;
  state.wrapFn = wrapped;
  return wrapped;
}

EventEmitter.prototype.once = function once(type, listener) {
  if (typeof listener !== 'function') {
    throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof listener);
  }
  this.on(type, _onceWrap(this, type, listener));
  return this;
};

EventEmitter.prototype.prependOnceListener =
    function prependOnceListener(type, listener) {
      if (typeof listener !== 'function') {
        throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof listener);
      }
      this.prependListener(type, _onceWrap(this, type, listener));
      return this;
    };

// Emits a 'removeListener' event if and only if the listener was removed.
EventEmitter.prototype.removeListener =
    function removeListener(type, listener) {
      var list, events, position, i, originalListener;

      if (typeof listener !== 'function') {
        throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof listener);
      }

      events = this._events;
      if (events === undefined)
        return this;

      list = events[type];
      if (list === undefined)
        return this;

      if (list === listener || list.listener === listener) {
        if (--this._eventsCount === 0)
          this._events = Object.create(null);
        else {
          delete events[type];
          if (events.removeListener)
            this.emit('removeListener', type, list.listener || listener);
        }
      } else if (typeof list !== 'function') {
        position = -1;

        for (i = list.length - 1; i >= 0; i--) {
          if (list[i] === listener || list[i].listener === listener) {
            originalListener = list[i].listener;
            position = i;
            break;
          }
        }

        if (position < 0)
          return this;

        if (position === 0)
          list.shift();
        else {
          spliceOne(list, position);
        }

        if (list.length === 1)
          events[type] = list[0];

        if (events.removeListener !== undefined)
          this.emit('removeListener', type, originalListener || listener);
      }

      return this;
    };

EventEmitter.prototype.off = EventEmitter.prototype.removeListener;

EventEmitter.prototype.removeAllListeners =
    function removeAllListeners(type) {
      var listeners, events, i;

      events = this._events;
      if (events === undefined)
        return this;

      // not listening for removeListener, no need to emit
      if (events.removeListener === undefined) {
        if (arguments.length === 0) {
          this._events = Object.create(null);
          this._eventsCount = 0;
        } else if (events[type] !== undefined) {
          if (--this._eventsCount === 0)
            this._events = Object.create(null);
          else
            delete events[type];
        }
        return this;
      }

      // emit removeListener for all listeners on all events
      if (arguments.length === 0) {
        var keys = Object.keys(events);
        var key;
        for (i = 0; i < keys.length; ++i) {
          key = keys[i];
          if (key === 'removeListener') continue;
          this.removeAllListeners(key);
        }
        this.removeAllListeners('removeListener');
        this._events = Object.create(null);
        this._eventsCount = 0;
        return this;
      }

      listeners = events[type];

      if (typeof listeners === 'function') {
        this.removeListener(type, listeners);
      } else if (listeners !== undefined) {
        // LIFO order
        for (i = listeners.length - 1; i >= 0; i--) {
          this.removeListener(type, listeners[i]);
        }
      }

      return this;
    };

function _listeners(target, type, unwrap) {
  var events = target._events;

  if (events === undefined)
    return [];

  var evlistener = events[type];
  if (evlistener === undefined)
    return [];

  if (typeof evlistener === 'function')
    return unwrap ? [evlistener.listener || evlistener] : [evlistener];

  return unwrap ?
    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);
}

EventEmitter.prototype.listeners = function listeners(type) {
  return _listeners(this, type, true);
};

EventEmitter.prototype.rawListeners = function rawListeners(type) {
  return _listeners(this, type, false);
};

EventEmitter.listenerCount = function(emitter, type) {
  if (typeof emitter.listenerCount === 'function') {
    return emitter.listenerCount(type);
  } else {
    return listenerCount.call(emitter, type);
  }
};

EventEmitter.prototype.listenerCount = listenerCount;
function listenerCount(type) {
  var events = this._events;

  if (events !== undefined) {
    var evlistener = events[type];

    if (typeof evlistener === 'function') {
      return 1;
    } else if (evlistener !== undefined) {
      return evlistener.length;
    }
  }

  return 0;
}

EventEmitter.prototype.eventNames = function eventNames() {
  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];
};

function arrayClone(arr, n) {
  var copy = new Array(n);
  for (var i = 0; i < n; ++i)
    copy[i] = arr[i];
  return copy;
}

function spliceOne(list, index) {
  for (; index + 1 < list.length; index++)
    list[index] = list[index + 1];
  list.pop();
}

function unwrapListeners(arr) {
  var ret = new Array(arr.length);
  for (var i = 0; i < ret.length; ++i) {
    ret[i] = arr[i].listener || arr[i];
  }
  return ret;
}


/***/ }),
/* 20 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML character reference.
 *
 * An XML character reference is structured as follows, where `{dec}` is the
 * decimal representation code point corresponding to a particular Unicode
 * character:
 *
 * ```xml
 * &#{dec};
 * ```
 *
 * The corresponding hexadecimal version is structured as follows, where
 * `{hex}` is the hexadecimal representation code point corresponding to a
 * particular Unicode character:
 *
 * ```xml
 * &#x{hex};
 * ```
 *
 * Unicode characters outside of the Basic Multilingual Plane are represented
 * using a surrogate pair consisting of two character references.
 *
 * The `{dec}` and `{hex}` values are defined by the `char` and `hex`
 * properties of this node; the former is the character to be represented while
 * the latter indicates whether the decimal or hexadecimal representation
 * should be used.
 *
 * XmlCharRef nodes cannot have any children.
 */
var XmlCharRef = (function (_super) {
    __extends(XmlCharRef, _super);
    /**
     * Initializes a new instance of the {@link XmlCharRef} class.
     *
     * @param {string} char   The character to represent using the reference.
     * @param {boolean} [hex] Whether to use the hexadecimal or decimal
     *                        representation for the reference. If left
     *                        undefined, decimal is the default.
     */
    function XmlCharRef(char, hex) {
        if (hex === void 0) { hex = false; }
        _super.call(this);
        this.char = char;
        this.hex = hex;
    }
    Object.defineProperty(XmlCharRef.prototype, "char", {
        /**
         * Gets the character to represent using the reference.
         *
         * @returns {string} The character to represent using the reference.
         */
        get: function () {
            return this._char;
        },
        /**
         * Sets the character to represent using the reference.
         *
         * @param {string} char The character to represent using the reference.
         */
        set: function (char) {
            if (!utils_1.isType(char, "String")) {
                throw new TypeError("char should be a string");
            }
            else if (!validate_1.validateSingleChar(char)) {
                throw new Error("char should contain a single character, and this" +
                    " character should be allowed in XML");
            }
            this._char = char;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XmlCharRef.prototype, "hex", {
        /**
         * Gets whether or not to use the hexadecimal or decimal representation for
         * the reference.
         *
         * @returns {boolean} Whether or not to use the hexadecimal or decimal
         *                    representation for the reference.
         */
        get: function () {
            return this._hex;
        },
        /**
         * Sets whether or not to use the hexadecimal or decimal representation for
         * the reference.
         *
         * @param {boolean} hex Whether or not to use the hexadecimal or decimal
         *                      representation for the reference.
         */
        set: function (hex) {
            if (!utils_1.isType(hex, "Boolean")) {
                throw new TypeError("hex should be a boolean");
            }
            this._hex = hex;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlCharRef} nodes cannot have any
     * children.
     */
    XmlCharRef.prototype.children = function () {
        throw new Error("XmlCharRef nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlCharRef} nodes cannot have any
     * children.
     */
    XmlCharRef.prototype.insertChild = function (node, index) {
        throw new Error("XmlCharRef nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlCharRef} nodes cannot have any
     * children.
     */
    XmlCharRef.prototype.removeChild = function (node) {
        throw new Error("XmlCharRef nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlCharRef} nodes cannot have any
     * children.
     */
    XmlCharRef.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlCharRef nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlCharRef.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        var char;
        if (this.char.length === 1) {
            char = this.char.charCodeAt(0);
        }
        else {
            char = utils_1.getCodePoint(this.char, 0);
        }
        if (this.hex) {
            return "&#x" + char.toString(16) + ";";
        }
        else {
            return "&#" + char + ";";
        }
    };
    return XmlCharRef;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlCharRef;


/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML entity reference.
 *
 * An XML entity reference is structured as follows, where
 * `{entity}` is name of the entity to be referenced:
 *
 * ```xml
 * &{entity};
 * ```
 *
 * The `{entity}` value is a property of this node.
 *
 * XmlEntityRef nodes cannot have any children.
 */
var XmlEntityRef = (function (_super) {
    __extends(XmlEntityRef, _super);
    /**
     * Initializes a new instance of the {@link XmlEntityRef} class.
     *
     * @param {string} entity The entity to be referenced.
     */
    function XmlEntityRef(entity) {
        _super.call(this);
        this.entity = entity;
    }
    Object.defineProperty(XmlEntityRef.prototype, "entity", {
        /**
         * Gets the entity to be referenced.
         *
         * @returns {string} The entity to be referenced.
         */
        get: function () {
            return this._entity;
        },
        /**
         * Sets the entity to be referenced.
         *
         * @param {string} entity The entity to be referenced.
         */
        set: function (entity) {
            if (!utils_1.isType(entity, "String")) {
                throw new TypeError("entity should be a string");
            }
            else if (!validate_1.validateName(entity)) {
                throw new Error("entity should not contain characters" +
                    " not allowed in XML names");
            }
            this._entity = entity;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlEntityRef} nodes cannot have any
     * children.
     */
    XmlEntityRef.prototype.children = function () {
        throw new Error("XmlEntityRef nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlEntityRef} nodes cannot have any
     * children.
     */
    XmlEntityRef.prototype.insertChild = function (node, index) {
        throw new Error("XmlEntityRef nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlEntityRef} nodes cannot have any
     * children.
     */
    XmlEntityRef.prototype.removeChild = function (node) {
        throw new Error("XmlEntityRef nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlEntityRef} nodes cannot have any
     * children.
     */
    XmlEntityRef.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlEntityRef nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlEntityRef.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        return "&" + this.entity + ";";
    };
    return XmlEntityRef;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlEntityRef;


/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var escape_1 = __webpack_require__(24);
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents text in an XML document.
 *
 * This text may only consist of character data, not markup. Restricted
 * characters, such as the ampersand (`&`) and the opening angle bracket (`<`)
 * are all automatically escaped.
 *
 * To create an character reference or entity reference, you should use
 * {@link XmlCharRef} or {@link XmlEntityRef} respectively instead.
 *
 * XmlText nodes cannot have any children.
 */
var XmlText = (function (_super) {
    __extends(XmlText, _super);
    /**
     * Initializes a new instance of the {@link XmlText} class.
     *
     * @param {string} text Arbitrary character data.
     */
    function XmlText(text) {
        _super.call(this);
        this.text = text;
    }
    Object.defineProperty(XmlText.prototype, "text", {
        /**
         * Gets the text associated with this node.
         *
         * @returns {string} The text associated with this node.
         */
        get: function () {
            return this._text;
        },
        /**
         * Sets the text associated with this node.
         *
         * @param {string} text Arbitrary character data.
         */
        set: function (text) {
            if (!utils_1.isType(text, "String")) {
                throw new TypeError("text should be a string");
            }
            else if (!validate_1.validateChar(text)) {
                throw new Error("text should not contain characters not allowed" +
                    " in XML");
            }
            this._text = text;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlText} nodes cannot have any
     * children.
     */
    XmlText.prototype.children = function () {
        throw new Error("XmlText nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlText} nodes cannot have any
     * children.
     */
    XmlText.prototype.insertChild = function (node, index) {
        throw new Error("XmlText nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlText} nodes cannot have any
     * children.
     */
    XmlText.prototype.removeChild = function (node) {
        throw new Error("XmlText nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlText} nodes cannot have any
     * children.
     */
    XmlText.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlText nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlText.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        var str = this.text;
        str = escape_1.escapeAmpersands(str);
        str = escape_1.escapeLeftAngleBrackets(str);
        return str;
    };
    return XmlText;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlText;


/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Returns true if the specified value are of any of the specified types, as
 * determined by the Object.prototype.toString.call function.
 *
 * @param {*} val The specified value.
 * @param {...string[]} types The specified types.
 *
 * @returns {boolean} Whether or not the specified value are of any of the
 *                    specified types.
 *
 * @private
 */
function isType(val) {
    var types = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        types[_i - 1] = arguments[_i];
    }
    for (var _a = 0, types_1 = types; _a < types_1.length; _a++) {
        var type = types_1[_a];
        if (Object.prototype.toString.call(val) === "[object " + type + "]") {
            return true;
        }
    }
    return false;
}
exports.isType = isType;
/**
 * Converts a value into a string.
 *
 * @param {*} value The value to convert to a string.
 *
 * @returns {String} The string representation of the specified value.
 *
 * @private
 */
function stringify(value) {
    if (!isType(value, "Undefined") && !isType(value, "Null")) {
        if (!isType(value.toString, "Function")) {
            value = value.toString();
        }
    }
    return String(value);
}
exports.stringify = stringify;


/***/ }),
/* 24 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * Replaces ampersands (&) with the appropriate XML character reference.
 *
 * @param {string} str The string to escape.
 *
 * @returns {string} A copy of the specified string with ampersands escaped.
 *
 * @private
 */
function escapeAmpersands(str) {
    return str.replace(/&/g, "&amp;");
}
exports.escapeAmpersands = escapeAmpersands;
/**
 * Replaces left angle brackets (&lt;) with the appropriate XML character
 * reference.
 *
 * @param {string} str The string to escape.
 *
 * @returns {string} A copy of the specified string with left angle brackets
 *                   escaped.
 *
 * @private
 */
function escapeLeftAngleBrackets(str) {
    return str.replace(/</g, "&lt;");
}
exports.escapeLeftAngleBrackets = escapeLeftAngleBrackets;
/**
 * Replaces single quotes (") with the appropriate XML character reference.
 *
 * @param {string} str The string to escape.
 *
 * @returns {string} A copy of the specified string with single quotes escaped.
 *
 * @private
 */
function escapeSingleQuotes(str) {
    return str.replace(/'/g, "&apos;");
}
exports.escapeSingleQuotes = escapeSingleQuotes;
/**
 * Replaces double quotes (") with the appropriate XML character reference.
 *
 * @param {string} str The string to escape.
 *
 * @returns {string} A copy of the specified string with double quotes escaped.
 *
 * @private
 */
function escapeDoubleQuotes(str) {
    return str.replace(/"/g, "&quot;");
}
exports.escapeDoubleQuotes = escapeDoubleQuotes;


/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var escape_1 = __webpack_require__(24);
var options_1 = __webpack_require__(12);
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlCharRef_1 = __webpack_require__(20);
var XmlEntityRef_1 = __webpack_require__(21);
var XmlNode_1 = __webpack_require__(6);
var XmlText_1 = __webpack_require__(22);
/**
 * Represents an XML element attribute.
 *
 * An XML element attribute is part of the start tag of an element and is
 * structured as follows, where `{name}` is the name of the attribute and
 * `{value}` is the value of the attribute:
 *
 * ```xml
 * <element {name}="{value}">
 * ```
 *
 * The `{name}` value is a property of this node, while the `{value}` property
 * consists of the children of this node.
 *
 * XmlAttribute nodes must have at least one child, and can have an unlimited
 * number of {@link XmlCharRef}, {@link XmlEntityRef}, and {@link XmlText}
 * nodes as children.
 */
var XmlAttribute = (function (_super) {
    __extends(XmlAttribute, _super);
    /**
     * Initializes a new instance of the {@link XmlAttribute} class.
     *
     * @param {string} name             The name of the XML attribute.
     * @param {XmlNode|XmlNode[]} value The initial value of the XML attribute.
     *                                  Additional children can be added later.
     *                                  Only {@link XmlCharRef},
     *                                  {@link XmlEntityRef}, and
     *                                  {@link XmlText} nodes are permitted.
     */
    function XmlAttribute(name, value) {
        _super.call(this);
        this.name = name;
        if (utils_1.isType(value, "Array")) {
            for (var _i = 0, _a = value; _i < _a.length; _i++) {
                var node = _a[_i];
                this.insertChild(node);
            }
        }
        else {
            this.insertChild(value);
        }
    }
    Object.defineProperty(XmlAttribute.prototype, "name", {
        /**
         * Gets the name of this attribute.
         *
         * @returns {string} The name of this attribute.
         */
        get: function () {
            return this._name;
        },
        /**
         * Sets the name of this attribute.
         *
         * @param {string} name The name of this attribute.
         */
        set: function (name) {
            if (!utils_1.isType(name, "String")) {
                throw new TypeError("name should be a string");
            }
            else if (!validate_1.validateName(name)) {
                throw new Error("name should not contain characters not" +
                    " allowed in XML names");
            }
            this._name = name;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Inserts a new XML character reference at the specified index.
     *
     * @param {string} char    The character to represent using the reference.
     * @param {boolean} [hex]  Whether to use the hexadecimal or decimal
     *                         representation for the reference. If left
     *                         undefined, decimal is the default.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlCharRef} The newly created XML declaration.
     */
    XmlAttribute.prototype.charRef = function (char, hex, index) {
        var charRef = new XmlCharRef_1.default(char, hex);
        this.insertChild(charRef, index);
        return charRef;
    };
    /**
     * Inserts a new XML entity reference at the specified index.
     *
     * @param {string} entity  The entity to be referenced.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlEntityRef} The newly created XML declaration.
     */
    XmlAttribute.prototype.entityRef = function (entity, index) {
        var charRef = new XmlEntityRef_1.default(entity);
        this.insertChild(charRef, index);
        return charRef;
    };
    /**
     * Inserts the specified node into this node's children at the specified
     * index. The node is not inserted if it is already present. If this node
     * already has a parent, it is removed from that parent.
     *
     * Note that only {@link XmlCharRef}, {@link XmlEntityRef}, and
     * {@link XmlText} nodes can be inserted; otherwise, an exception will be
     * thrown.
     *
     * @param {XmlNode} node   The node to insert.
     * @param {number} [index] The index at which to insert the node. Nodes at
     *                         or after the index are shifted to the right. If
     *                         no index is specified, the node is inserted at
     *                         the end.
     *
     * @returns {XmlNode} The node inserted into this node's children, or
     *                    undefined if no node was inserted.
     */
    XmlAttribute.prototype.insertChild = function (node, index) {
        if (!(node instanceof XmlCharRef_1.default || node instanceof XmlEntityRef_1.default ||
            node instanceof XmlText_1.default)) {
            throw new TypeError("node should be an instance of XmlCharRef," +
                " XmlEntityRef, or XmlText");
        }
        return _super.prototype.insertChild.call(this, node, index);
    };
    /**
     * Removes the specified node from this node's children.
     *
     * Note that this node must have at least one child. Attempts to remove
     * the last child node will result in an exception.
     *
     * @param {XmlNode} node The node to remove.
     *
     * @returns {boolean} Whether a node was removed.
     */
    XmlAttribute.prototype.removeChild = function (node) {
        if (this._children.length === 1) {
            throw new Error("XmlAttribute nodes must have at least one child");
        }
        return _super.prototype.removeChild.call(this, node);
    };
    /**
     * Removes the node at the specified index from this node's children.
     *
     * Note that this node must have at least one child. Attempts to remove
     * the last child node will result in an exception.
     *
     * @param {number} index The index at which the node to be removed is
     *                       located.
     *
     * @returns {XmlNode} The node that was removed, or undefined if no node
     *                    was removed.
     */
    XmlAttribute.prototype.removeChildAtIndex = function (index) {
        if (this._children.length === 1) {
            throw new Error("XmlAttribute nodes must have at least one child");
        }
        return _super.prototype.removeChildAtIndex.call(this, index);
    };
    /**
     * Inserts a new XML text node at the specified index.
     *
     * @param {string} text    Arbitrary character data.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlText} The newly created XML declaration.
     */
    XmlAttribute.prototype.text = function (text, index) {
        var textNode = new XmlText_1.default(text);
        this.insertChild(textNode, index);
        return textNode;
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlAttribute.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        options_1.validateStringOptions(options);
        var quote = options.doubleQuotes ? "\"" : "'";
        var str = this.name + "=" + quote;
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var child = _a[_i];
            if (options.doubleQuotes) {
                str += escape_1.escapeDoubleQuotes(child.toString(options));
            }
            else {
                str += escape_1.escapeSingleQuotes(child.toString(options));
            }
        }
        str += quote;
        return str;
    };
    return XmlAttribute;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlAttribute;


/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML CDATA section.
 *
 * An XML CDATA section is structured as follows, where `{data}` is the
 * character data of the section:
 *
 * ```xml
 * <![CDATA[{data}]]>
 * ```
 *
 * The `{data}` value is a property of this node.
 *
 * XmlCdata nodes cannot have any children.
 */
var XmlCdata = (function (_super) {
    __extends(XmlCdata, _super);
    /**
     * Initializes a new instance of the {@link XmlCdata} class.
     *
     * @param {string} data The character data of the CDATA section.
     */
    function XmlCdata(data) {
        _super.call(this);
        this.data = data;
    }
    Object.defineProperty(XmlCdata.prototype, "data", {
        /**
         * Gets the character data of the CDATA section.
         *
         * @returns {string} The character data of the CDATA section.
         */
        get: function () {
            return this._data;
        },
        /**
         * Sets the character data of the CDATA section.
         *
         * @param {string} data The character data of the CDATA section.
         */
        set: function (data) {
            if (!utils_1.isType(data, "String")) {
                throw new TypeError("character data should be a string");
            }
            else if (!validate_1.validateChar(data)) {
                throw new Error("character data should not contain characters not" +
                    " allowed in XML");
            }
            else if (/]]>/.test(data)) {
                throw new Error("data should not contain the string ']]>'");
            }
            this._data = data;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlCdata} nodes cannot have any
     * children.
     */
    XmlCdata.prototype.children = function () {
        throw new Error("XmlCdata nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlCdata} nodes cannot have any
     * children.
     */
    XmlCdata.prototype.insertChild = function (node, index) {
        throw new Error("XmlCdata nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlCdata} nodes cannot have any
     * children.
     */
    XmlCdata.prototype.removeChild = function (node) {
        throw new Error("XmlCdata nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlCdata} nodes cannot have any
     * children.
     */
    XmlCdata.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlCdata nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlCdata.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        return "<![CDATA[" + this.data + "]]>";
    };
    return XmlCdata;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlCdata;


/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var options_1 = __webpack_require__(12);
var utils_1 = __webpack_require__(5);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML declaration.
 *
 * An XML declaration is structured as follows, where `{version}` is the XML
 * version, `{encoding}` is the encoding of the document, and `{standalone}`
 * is either "yes" or "no", depending on whether the document may contain
 * external markup declarations:
 *
 * ```xml
 * <?xml version="{version}" encoding="{encoding}" standalone="{standalone}"?>
 * ```
 *
 * The `{version}`, `{encoding}`, and `{standalone}` values are properties of
 * this node.
 *
 * XmlDecl nodes cannot have any children.
 */
var XmlDecl = (function (_super) {
    __extends(XmlDecl, _super);
    /**
     * Initializes a new instance of the {@link XmlDecl} class.
     *
     * @param {IDeclarationOptions} [options] The options associated with the
     *     XML declaration.
     */
    function XmlDecl(options) {
        if (options === void 0) { options = {}; }
        _super.call(this);
        options_1.validateDeclarationOptions(options);
        this.encoding = options.encoding;
        this.standalone = options.standalone;
        this.version = options.version;
    }
    Object.defineProperty(XmlDecl.prototype, "encoding", {
        /**
         * Gets the XML encoding to be included in the declaration.
         *
         * @returns {string} The XML encoding to be included in the declaration.
         *                   This value may be undefined.
         */
        get: function () {
            return this._encoding;
        },
        /**
         * Sets the XML encoding to be included in the declaration.
         *
         * @param encoding {string} The XML encoding to be included in the
         *                          declaration. This value must be a valid
         *                          encoding. If left undefined, no encoding is
         *                          included.
         */
        set: function (encoding) {
            if (utils_1.isType(encoding, "String")) {
                if (!/^[A-Za-z][A-Za-z0-9._-]*$/.test(encoding)) {
                    throw new Error("encoding should be a valid XML encoding");
                }
            }
            else if (!utils_1.isType(encoding, "Undefined")) {
                throw new TypeError("name should be a string or undefined");
            }
            this._encoding = encoding;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XmlDecl.prototype, "standalone", {
        /**
         * Gets the XML standalone attribute to be included in the declaration.
         *
         * @returns {string} The XML standalone attribute to be included in the
         *                   declaration. This value may be undefined.
         */
        get: function () {
            return this._standalone;
        },
        /**
         * Sets the XML standalone attribute to be included in the declaration.
         *
         * @param {string} standalone The XML standalone attribute to be included.
         *                            This value must be "yes" or "no". If left
         *                            undefined, no standalone attribute is
         *                            included.
         */
        set: function (standalone) {
            if (utils_1.isType(standalone, "String")) {
                if (!/^(yes|no)$/.test(standalone)) {
                    throw new Error("standalone should be either the string" +
                        " 'yes' or the string 'no'");
                }
            }
            else if (!utils_1.isType(standalone, "Undefined")) {
                throw new TypeError("standalone should be a string or undefined");
            }
            this._standalone = standalone;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XmlDecl.prototype, "version", {
        /**
         * Gets the XML version to be included in the declaration.
         *
         * @returns {string} The XML version to tbe included in the declaration.
         */
        get: function () {
            return this._version;
        },
        /**
         * Sets the XML version to be included in the declaration.
         *
         * @param {string} version The XML version to be included in the
         *                         declaration. This value must be a valid XML
         *                         version number. If left undefined, the default
         *                         version is "1.0".
         */
        set: function (version) {
            if (!utils_1.isType(version, "String")) {
                throw new TypeError("version should be a string");
            }
            else if (!/^1\.[0-9]+$/.test(version)) {
                throw new Error("version should be a valid XML version");
            }
            this._version = version;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlDecl} nodes cannot have any
     * children.
     */
    XmlDecl.prototype.children = function () {
        throw new Error("XmlDecl nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDecl} nodes cannot have any
     * children.
     */
    XmlDecl.prototype.insertChild = function (node, index) {
        throw new Error("XmlDecl nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDecl} nodes cannot have any
     * children.
     */
    XmlDecl.prototype.removeChild = function (node) {
        throw new Error("XmlDecl nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDecl} nodes cannot have any
     * children.
     */
    XmlDecl.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlDecl nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlDecl.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        options_1.validateStringOptions(options);
        var quote = options.doubleQuotes ? '"' : "'";
        var str = "<?xml version=" + quote + this.version + quote;
        if (utils_1.isType(this.encoding, "String")) {
            str += " encoding=" + quote + this.encoding + quote;
        }
        if (utils_1.isType(this.standalone, "String")) {
            str += " standalone=" + quote + this.standalone + quote;
        }
        str += "?>";
        return str;
    };
    return XmlDecl;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlDecl;


/***/ }),
/* 28 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var options_1 = __webpack_require__(12);
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlComment_1 = __webpack_require__(14);
var XmlDtdAttlist_1 = __webpack_require__(29);
var XmlDtdElement_1 = __webpack_require__(30);
var XmlDtdEntity_1 = __webpack_require__(31);
var XmlDtdNotation_1 = __webpack_require__(32);
var XmlDtdParamEntityRef_1 = __webpack_require__(33);
var XmlNode_1 = __webpack_require__(6);
var XmlProcInst_1 = __webpack_require__(15);
/**
 * Represents an XML document type definition (DTD).
 *
 * An XML document type definition  is structured as follows, where `{name}` is
 * the name of the DTD, `{sysId}` is the system identifier of the DTD,
 * `{pubId}` is the public identifier of the DTD, and `{intSubset}` is the
 * internal subset of the DTD:
 *
 * ```xml
 * <!DOCTYPE {name} SYSTEM "{sysId}" PUBLIC "{pubId}" [
 *     {intSubset}
 * ]>
 * ```
 *
 * The `{name}`, `{pubId}`, and `{sysId}` values are properties of the node,
 * while the `{intSubset}` value consists of the children of this node.
 *
 * XmlDtd nodes can have an unlimited number of {@link XmlComment},
 * {@link XmlDtdAttlist}, {@link XmlDtdElement}, {@link XmlDtdEntity},
 * {@link XmlDtdNotation}, {@link XmlDtdParamEntityRef}, and
 * {@link XmlProcInst} nodes.
 */
var XmlDtd = (function (_super) {
    __extends(XmlDtd, _super);
    /**
     * Initializes a new instance of the {@link XmlDtd} class.
     *
     * @param {string} name    The name of the DTD.
     * @param {string} [sysId] The system identifier of the DTD, excluding
     *                         quotation marks.
     * @param {string} [pubId] The public identifier of the DTD, excluding
     *                         quotation marks. If a public identifier is
     *                         provided, a system identifier must be provided
     *                         as well.
     */
    function XmlDtd(name, sysId, pubId) {
        _super.call(this);
        this.name = name;
        this.sysId = sysId;
        this.pubId = pubId;
    }
    Object.defineProperty(XmlDtd.prototype, "name", {
        /**
         * Gets the name of the DTD.
         *
         * @returns {string} The name of the DTD.
         */
        get: function () {
            return this._name;
        },
        /**
         * Sets the name of the DTD.
         *
         * @param {string} name The name of the DTD.
         */
        set: function (name) {
            if (!utils_1.isType(name, "String")) {
                throw new TypeError("name should be a string");
            }
            else if (!validate_1.validateName(name)) {
                throw new Error("name should not contain characters not" +
                    " allowed in XML names");
            }
            this._name = name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XmlDtd.prototype, "pubId", {
        /**
         * Gets the public identifier of the DTD, excluding quotation marks.
         *
         * @returns {string} The public identifier of the DTD, excluding quotation
         *                   marks. This value may be undefined.
         */
        get: function () {
            return this._pubId;
        },
        /**
         * Sets the public identifier of the DTD, excluding quotation marks. If a
         * public identifier is provided, a system identifier must be provided as
         * well.
         *
         * @param {string} pubId The public identifier of the DTD, excluding
         *                       quotation marks. This value may be undefined.
         */
        set: function (pubId) {
            if (utils_1.isType(pubId, "String")) {
                if (!/^(\u0020|\u000D|\u000A|[a-zA-Z0-9]|[-'()+,./:=?;!*#@$_%])*$/
                    .test(pubId)) {
                    throw new Error("pubId should not contain characters not" +
                        " allowed in public identifiers");
                }
                else if (utils_1.isType(this.sysId, "Undefined")) {
                    throw new Error("pubId should not be defined if sysId is" +
                        " undefined");
                }
            }
            else if (!utils_1.isType(pubId, "Undefined")) {
                throw new TypeError("pubId should be a string or undefined");
            }
            this._pubId = pubId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XmlDtd.prototype, "sysId", {
        /**
         * Gets the system identifier of the DTD, excluding quotation marks.
         *
         * @returns {string} The system identifier of the DTD, excluding quotation
         *                   marks. This value may be undefined.
         */
        get: function () {
            return this._sysId;
        },
        /**
         * Sets the system identifier of the DTD, excluding quotation marks.
         *
         * @param {string} sysId The system identifier of the DTD, excluding
         *                       quotation marks. This value may be undefined.
         */
        set: function (sysId) {
            if (utils_1.isType(sysId, "String")) {
                if (!validate_1.validateChar(sysId)) {
                    throw new Error("sysId should not contain characters not" +
                        " allowed in XML");
                }
                else if (sysId.indexOf("'") !== -1 &&
                    sysId.indexOf("\"") !== -1) {
                    throw new Error("sysId should not contain both single quotes" +
                        " and double quotes");
                }
            }
            else if (utils_1.isType(sysId, "Undefined")) {
                if (!utils_1.isType(this.pubId, "Undefined")) {
                    throw new Error("sysId should not be undefined if pubId is" +
                        " defined");
                }
            }
            else {
                throw new TypeError("sysId should be a string or undefined");
            }
            this._sysId = sysId;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Inserts a new attribute-list declaration at the specified index. If no
     * index is specified, the node is inserted at the end of this node's
     * children.
     *
     * @param {string} text    The text of the attribute-list declaration.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlDtdAttlist} The newly created attribute-list declaration.
     */
    XmlDtd.prototype.attlist = function (text, index) {
        var attlist = new XmlDtdAttlist_1.default(text);
        this.insertChild(attlist, index);
        return attlist;
    };
    /**
     * Inserts a new comment at the specified index. If no index is specified,
     * the node is inserted at the end of this node's children.
     *
     * @param {string} content The data of the comment.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlComment} The newly created comment.
     */
    XmlDtd.prototype.comment = function (content, index) {
        var comment = new XmlComment_1.default(content);
        this.insertChild(comment, index);
        return comment;
    };
    /**
     * Inserts a new element declaration at the specified index. If no index is
     * specified, the node is inserted at the end of this node's children.
     *
     * @param {string} text    The text of the element declaration.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlDtdElement} The newly created element declaration.
     */
    XmlDtd.prototype.element = function (text, index) {
        var element = new XmlDtdElement_1.default(text);
        this.insertChild(element, index);
        return element;
    };
    /**
     * Inserts a new entity declaration at the specified index. If no index is
     * specified, the node is inserted at the end of this node's children.
     *
     * @param {string} text    The text of the entity declaration.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlDtdEntity} The newly created entity declaration.
     */
    XmlDtd.prototype.entity = function (text, index) {
        var entity = new XmlDtdEntity_1.default(text);
        this.insertChild(entity, index);
        return entity;
    };
    /**
     * Inserts the specified node into this node's children at the specified
     * index. The node is not inserted if it is already present. If this node
     * already has a parent, it is removed from that parent.
     *
     * Only {@link XmlComment}, {@link XmlDtdAttlist}, {@link XmlDtdElement},
     * {@link XmlDtdEntity}, {@link XmlDtdNotation}, and {@link XmlProcInst}
     * nodes can be inserted; otherwise an exception will be thrown.
     *
     * @param {XmlNode} node   The node to insert.
     * @param {number} [index] The index at which to insert the node. Nodes at
     *                         or after the index are shifted to the right. If
     *                         no index is specified, the node is inserted at
     *                         the end.
     *
     * @returns {XmlNode} The node inserted into this node's children, or
     *                    undefined if no node was inserted.
     */
    XmlDtd.prototype.insertChild = function (node, index) {
        if (!(node instanceof XmlComment_1.default || node instanceof XmlDtdAttlist_1.default ||
            node instanceof XmlDtdElement_1.default || node instanceof XmlDtdEntity_1.default ||
            node instanceof XmlDtdNotation_1.default ||
            node instanceof XmlDtdParamEntityRef_1.default ||
            node instanceof XmlProcInst_1.default)) {
            throw new TypeError("node should be an instance of XmlComment,"
                + " XmlDtdAttlist, XmlDtdElement, XmlDtdEntity,"
                + " XmlDtdNotation, XmlDtdParamEntityRef, or"
                + " XmlProcInst");
        }
        return _super.prototype.insertChild.call(this, node, index);
    };
    /**
     * Inserts a new notation declaration at the specified index. If no index is
     * specified, the node is inserted at the end of this node's children.
     *
     * @param {string} text    The text of the notation declaration.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlDtdNotation} The newly created notation declaration.
     */
    XmlDtd.prototype.notation = function (text, index) {
        var notation = new XmlDtdNotation_1.default(text);
        this.insertChild(notation, index);
        return notation;
    };
    /**
     * Inserts a new parameter entity reference at the specified index. If no
     * index is specified, the node is inserted at the end of this node's
     * children.
     *
     * @param {string} entity  The entity to reference.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlDtdParamEntityRef} The newly created parameter entity
     *                                 reference.
     */
    XmlDtd.prototype.paramEntityRef = function (entity, index) {
        var paramEntity = new XmlDtdParamEntityRef_1.default(entity);
        this.insertChild(paramEntity, index);
        return paramEntity;
    };
    /**
     * Inserts a new processing instruction at the specified index. If no index
     * is specified, the node is inserted at the end of this node's children.
     *
     * @param {string} target    The target of the processing instruction.
     * @param {string} [content] The data of the processing instruction, or
     *                           undefined if there is no target.
     * @param {number} [index]   The index at which the node should be inserted.
     *                           If no index is specified, the node is inserted
     *                           at the end of this node's children.
     *
     * @returns {XmlProcInst} The newly created processing instruction.
     */
    XmlDtd.prototype.procInst = function (target, content, index) {
        var procInst = new XmlProcInst_1.default(target, content);
        this.insertChild(procInst, index);
        return procInst;
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlDtd.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        options_1.validateStringOptions(options);
        var str = "<!DOCTYPE " + this.name;
        if (utils_1.isType(this.pubId, "Undefined")) {
            if (!utils_1.isType(this.sysId, "Undefined")) {
                str += " ";
                str = appendId("SYSTEM", this.sysId, str, options);
            }
        }
        else {
            str += " ";
            str = appendId("PUBLIC", this.pubId, str, options);
            str = appendId("", this.sysId, str, options);
        }
        if (this._children.length !== 0) {
            str += " [";
            for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
                var node = _a[_i];
                if (options.pretty) {
                    str += options.newline + options.indent;
                }
                str += node.toString(options);
            }
            if (options.pretty) {
                str += options.newline;
            }
            str += "]>";
        }
        else {
            str += ">";
        }
        return str;
    };
    return XmlDtd;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlDtd;
/**
 * Appends the XML string representation of a public or system identifier to
 * an existing string.
 *
 * @param {string} type           "SYSTEM", "PUBLIC", or ""
 * @param {string} value          The value of the identifier.
 * @param {string} str            The string to which the string representation
 *                                should be appended.
 * @param {IStringOptions} options Formatting options for the string
 *                                representation.
 *
 * @returns {string} The updated string.
 *
 * @private
 */
function appendId(type, value, str, options) {
    str += type + " ";
    if (options.doubleQuotes) {
        if (value.indexOf("\"") !== -1) {
            throw new Error("options.doubleQuotes inconsistent with" +
                " sysId or pubId");
        }
        str += "\"" + value + "\"";
    }
    else {
        if (value.indexOf("'") !== -1) {
            throw new Error("options.doubleQuotes inconsistent with" +
                " sysId or pubId");
        }
        str += "'" + value + "'";
    }
    return str;
}


/***/ }),
/* 29 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML attribute-list declaration in a document type definition.
 *
 * An XML attribute-list declaration is structured as follows, where `{text}`
 * is the text of the declaration:
 *
 * ```xml
 * <!ATTLIST {text}>
 * ```
 *
 * The `{text}` value is a property of this node.
 *
 * XmlDtdAttlist nodes cannot have any children.
 */
var XmlDtdAttlist = (function (_super) {
    __extends(XmlDtdAttlist, _super);
    /**
     * Initializes a new instance of the {@link XmlDtdAttlist} class.
     *
     * @param {string} text The text associated with the XML attribute-list
     *                      declaration.
     */
    function XmlDtdAttlist(text) {
        _super.call(this);
        this.text = text;
    }
    Object.defineProperty(XmlDtdAttlist.prototype, "text", {
        /**
         * Gets the text associated with the XML attribute-list declaration.
         *
         * @return {string} The text associated with the XML attribute-list
         *                  declaration.
         */
        get: function () {
            return this._text;
        },
        /**
         * Sets the text associated with the XML attribute-list declaration.
         *
         * @param {string} text The text associated with the XML attribute-list
         *                      declaration.
         */
        set: function (text) {
            if (!utils_1.isType(text, "String")) {
                throw new TypeError("text should be a string");
            }
            else if (!validate_1.validateChar(text)) {
                throw new Error("data should not contain characters" +
                    " not allowed in XML");
            }
            this._text = text;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlDtdAttlist} nodes cannot have any
     * children.
     */
    XmlDtdAttlist.prototype.children = function () {
        throw new Error("XmlDtdAttlist nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdAttlist} nodes cannot have any
     * children.
     */
    XmlDtdAttlist.prototype.insertChild = function (node, index) {
        throw new Error("XmlDtdAttlist nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdAttlist} nodes cannot have any
     * children.
     */
    XmlDtdAttlist.prototype.removeChild = function (node) {
        throw new Error("XmlDtdAttlist nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdAttlist} nodes cannot have any
     * children.
     */
    XmlDtdAttlist.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlDtdAttlist nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlDtdAttlist.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        return "<!ATTLIST " + this.text + ">";
    };
    return XmlDtdAttlist;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlDtdAttlist;


/***/ }),
/* 30 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML element declaration in a document type definition.
 *
 * An XML element declaration is structured as follows, where `{text}` is the
 * text of the declaration:
 *
 * ```xml
 * <!ELEMENT {text}>
 * ```
 *
 * The `{text}` value is a property of this node.
 *
 * XmlDtdElement nodes cannot have any children.
 */
var XmlDtdElement = (function (_super) {
    __extends(XmlDtdElement, _super);
    /**
     * Initializes a new instance of the {@link XmlDtdElement} class.
     *
     * @param {string} text The text associated with the XML element
     *                      declaration.
     */
    function XmlDtdElement(text) {
        _super.call(this);
        this.text = text;
    }
    Object.defineProperty(XmlDtdElement.prototype, "text", {
        /**
         * Gets the text associated with the XML element declaration.
         *
         * @return {string} The text associated with the XML element declaration.
         */
        get: function () {
            return this._text;
        },
        /**
         * Sets the text associated with the XML element declaration.
         *
         * @param {string} text The text associated with the XML element
         *                      declaration.
         */
        set: function (text) {
            if (!utils_1.isType(text, "String")) {
                throw new TypeError("text should be a string");
            }
            else if (!validate_1.validateChar(text)) {
                throw new Error("data should not contain characters" +
                    " not allowed in XML");
            }
            this._text = text;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlDtdElement} nodes cannot have any
     * children.
     */
    XmlDtdElement.prototype.children = function () {
        throw new Error("XmlDtdElement nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdElement} nodes cannot have any
     * children.
     */
    XmlDtdElement.prototype.insertChild = function (node, index) {
        throw new Error("XmlDtdElement nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdElement} nodes cannot have any
     * children.
     */
    XmlDtdElement.prototype.removeChild = function (node) {
        throw new Error("XmlDtdElement nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdElement} nodes cannot have any
     * children.
     */
    XmlDtdElement.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlDtdElement nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlDtdElement.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        return "<!ELEMENT " + this.text + ">";
    };
    return XmlDtdElement;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlDtdElement;


/***/ }),
/* 31 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML entity declaration in a document type definition.
 *
 * An XML entity declaration is structured as follows, where `{text}` is the
 * text of the declaration:
 *
 * ```xml
 * <!ENTITY {text}>
 * ```
 *
 * The `{text}` value is a property of this node.
 *
 * XmlDtdEntity nodes cannot have any children.
 */
var XmlDtdEntity = (function (_super) {
    __extends(XmlDtdEntity, _super);
    /**
     * Initializes a new instance of the {@link XmlDtdEntity} class.
     *
     * @param {string} text The text associated with the XML entity
     *                      declaration.
     */
    function XmlDtdEntity(text) {
        _super.call(this);
        this.text = text;
    }
    Object.defineProperty(XmlDtdEntity.prototype, "text", {
        /**
         * Gets the text associated with the XML entity declaration.
         *
         * @return {string} The text associated with the XML entity declaration.
         */
        get: function () {
            return this._text;
        },
        /**
         * Sets the text associated with the XML entity declaration.
         *
         * @param {string} text The text associated with the XML entity declaration.
         */
        set: function (text) {
            if (!utils_1.isType(text, "String")) {
                throw new TypeError("text should be a string");
            }
            else if (!validate_1.validateChar(text)) {
                throw new Error("data should not contain characters" +
                    " not allowed in XML");
            }
            this._text = text;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlDtdEntity} nodes cannot have any
     * children.
     */
    XmlDtdEntity.prototype.children = function () {
        throw new Error("XmlDtdEntity nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdEntity} nodes cannot have any
     * children.
     */
    XmlDtdEntity.prototype.insertChild = function (node, index) {
        throw new Error("XmlDtdEntity nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdEntity} nodes cannot have any
     * children.
     */
    XmlDtdEntity.prototype.removeChild = function (node) {
        throw new Error("XmlDtdEntity nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdEntity} nodes cannot have any
     * children.
     */
    XmlDtdEntity.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlDtdEntity nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlDtdEntity.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        return "<!ENTITY " + this.text + ">";
    };
    return XmlDtdEntity;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlDtdEntity;


/***/ }),
/* 32 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML notation declaration in a document type definition.
 *
 * An XML notation declaration is structured as follows, where `{text}` is the
 * text of the declaration:
 *
 * ```xml
 * <!NOTATION {text}>
 * ```
 *
 * The `{text}` value is a property of this node.
 *
 * XmlDtdNotation nodes cannot have any children.
 */
var XmlDtdNotation = (function (_super) {
    __extends(XmlDtdNotation, _super);
    /**
     * Initializes a new instance of the {@link XmlDtdNotation} class.
     *
     * @param {string} text The text associated with the XML notation
     *                      declaration.
     */
    function XmlDtdNotation(text) {
        _super.call(this);
        this.text = text;
    }
    Object.defineProperty(XmlDtdNotation.prototype, "text", {
        /**
         * Gets the text associated with the XML notation declaration.
         *
         * @return {string} The text associated with the XML notation declaration.
         */
        get: function () {
            return this._text;
        },
        /**
         * Sets the text associated with the XML notation declaration.
         *
         * @param {string} text The text associated with the XML notation
         *                      declaration.
         */
        set: function (text) {
            if (!utils_1.isType(text, "String")) {
                throw new TypeError("text should be a string");
            }
            else if (!validate_1.validateChar(text)) {
                throw new Error("data should not contain characters" +
                    " not allowed in XML");
            }
            this._text = text;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlDtdNotation} nodes cannot have any
     * children.
     */
    XmlDtdNotation.prototype.children = function () {
        throw new Error("XmlDtdNotation nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdNotation} nodes cannot have any
     * children.
     */
    XmlDtdNotation.prototype.insertChild = function (node, index) {
        throw new Error("XmlDtdNotation nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdNotation} nodes cannot have any
     * children.
     */
    XmlDtdNotation.prototype.removeChild = function (node) {
        throw new Error("XmlDtdNotation nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdNotation} nodes cannot have any
     * children.
     */
    XmlDtdNotation.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlDtdNotation nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlDtdNotation.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        return "<!NOTATION " + this.text + ">";
    };
    return XmlDtdNotation;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlDtdNotation;


/***/ }),
/* 33 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlNode_1 = __webpack_require__(6);
/**
 * Represents an XML parameter entity reference in a document type definition.
 *
 * An XML parameter entity reference is structured as follows, where `{entity}`
 * is the name of the entity:
 *
 * ```xml
 * %{entity};
 * ```
 *
 * The `{entity}` value is a property of this node.
 *
 * XmlDtdParamEntityRef nodes cannot have any children.
 */
var XmlDtdParamEntityRef = (function (_super) {
    __extends(XmlDtdParamEntityRef, _super);
    /**
     * Initializes a new instance of the {@link XmlDtdParamEntityRef} class.
     *
     * @param {string} entity The entity to be referenced.
     */
    function XmlDtdParamEntityRef(entity) {
        _super.call(this);
        this.entity = entity;
    }
    Object.defineProperty(XmlDtdParamEntityRef.prototype, "entity", {
        /**
         * Gets the entity to be referenced.
         *
         * @returns {string} The entity to be referenced.
         */
        get: function () {
            return this._entity;
        },
        /**
         * Sets the entity to be referenced.
         *
         * @param {string} entity The entity to be referenced.
         */
        set: function (entity) {
            if (!utils_1.isType(entity, "String")) {
                throw new TypeError("entity should be a string");
            }
            else if (!validate_1.validateName(entity)) {
                throw new Error("entity should not contain characters" +
                    " not allowed in XML names");
            }
            this._entity = entity;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Throws an exception since {@link XmlDtdParamEntityRef} nodes cannot have
     * any children.
     */
    XmlDtdParamEntityRef.prototype.children = function () {
        throw new Error("XmlDtdParamEntityRef nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdParamEntityRef} nodes cannot have
     * any children.
     */
    XmlDtdParamEntityRef.prototype.insertChild = function (node, index) {
        throw new Error("XmlDtdParamEntityRef nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdParamEntityRef} nodes cannot have
     * any children.
     */
    XmlDtdParamEntityRef.prototype.removeChild = function (node) {
        throw new Error("XmlDtdParamEntityRef nodes cannot have children");
    };
    /**
     * Throws an exception since {@link XmlDtdParamEntityRef} nodes cannot have
     * any children.
     */
    XmlDtdParamEntityRef.prototype.removeChildAtIndex = function (index) {
        throw new Error("XmlDtdParamEntityRef nodes cannot have children");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlDtdParamEntityRef.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        return "%" + this.entity + ";";
    };
    return XmlDtdParamEntityRef;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlDtdParamEntityRef;


/***/ }),
/* 34 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var options_1 = __webpack_require__(12);
var utils_1 = __webpack_require__(5);
var validate_1 = __webpack_require__(7);
var XmlAttribute_1 = __webpack_require__(25);
var XmlCdata_1 = __webpack_require__(26);
var XmlCharRef_1 = __webpack_require__(20);
var XmlComment_1 = __webpack_require__(14);
var XmlEntityRef_1 = __webpack_require__(21);
var XmlNode_1 = __webpack_require__(6);
var XmlProcInst_1 = __webpack_require__(15);
var XmlText_1 = __webpack_require__(22);
/**
 * Represents an XML element.
 *
 * A sample XML element is structured as follows, where `{name}` is the name
 * of the element:
 *
 * ```xml
 * <{name} attname="attvalue">
 *     <subelem/>
 *     <?pitarget picontent?>
 *     text
 * </{name}></pre>
 * ```
 *
 * The `{name}` value is a property of the node, while the attributes and
 * children of the element (such as other elements, processing instructions,
 * and text) are children of this node.
 *
 * XmlElement nodes can have an unlimited number of {@link XmlAttribute},
 * {@link XmlCdata}, {@link XmlCharRef}, {@link XmlComment},
 * {@link XmlElement}, {@link XmlEntityRef}, {@link XmlProcInst}, or
 * {@link XmlText} nodes as children.
 */
var XmlElement = (function (_super) {
    __extends(XmlElement, _super);
    /**
     * Initializes a new instance of the {@link XmlElement} class.
     *
     * @param {string} name The name of the element.
     */
    function XmlElement(name) {
        _super.call(this);
        this.name = name;
    }
    Object.defineProperty(XmlElement.prototype, "name", {
        /**
         * Gets the name of the element.
         *
         * @returns {string} The name of the element.
         */
        get: function () {
            return this._name;
        },
        /**
         * Sets the name of the element.
         *
         * @param {string} name The name of the element.
         */
        set: function (name) {
            if (!utils_1.isType(name, "String")) {
                throw new TypeError("name should be a string");
            }
            else if (!validate_1.validateName(name)) {
                throw new Error("name should not contain characters not" +
                    " allowed in XML names");
            }
            this._name = name;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Inserts an new attribute at the specified index. If no index is
     * specified, the node is inserted at the end of this node's children.
     *
     * @param {string} name
     *        The name of the attribute.
     * @param {string|XmlNode|Array.<string|XmlNode>} value
     *        The value of the attribute. Strings are converted to XmlText
     *        nodes.
     * @param {number} [index]
     *        The index at which the node should be inserted. If no index is
     *        specified, the node is inserted at the end of this node's
     *        children.
     *
     * @returns {XmlAttribute} The newly created attribute.
     */
    XmlElement.prototype.attribute = function (name, value, index) {
        if (utils_1.isType(value, "String")) {
            value = new XmlText_1.default(value);
        }
        else if (utils_1.isType(value, "Array")) {
            var arrayVal = value;
            for (var i = 0; i < arrayVal.length; i++) {
                if (utils_1.isType(arrayVal[i], "String")) {
                    var strVal = arrayVal[i];
                    arrayVal[i] = new XmlText_1.default(strVal);
                }
            }
        }
        var attribute = new XmlAttribute_1.default(name, value);
        this.insertChild(attribute, index);
        return attribute;
    };
    /**
     * Returns an array containing all of the children of this node that are
     * instances of {@link XmlAttribute}.
     *
     * @returns {XmlAttribute[]} An array containing all of the children of
     *                           this node that are instances of
     *                           {@link XmlAttribute}.
     */
    XmlElement.prototype.attributes = function () {
        return this._children.filter(function (node) { return node instanceof XmlAttribute_1.default; });
    };
    /**
     * Inserts a new CDATA section at the specified index. If no index is
     * specified, the node is inserted at the end of this node's children.
     *
     * @param {string} content The data of the CDATA section.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlCdata} The newly created CDATA section.
     */
    XmlElement.prototype.cdata = function (content, index) {
        var cdata = new XmlCdata_1.default(content);
        this.insertChild(cdata, index);
        return cdata;
    };
    /**
     * Inserts a new character reference at the specified index. If no index
     * is specified, the node is inserted at the end of this node's children.
     *
     * @param {string} char    The character to represent using the reference.
     * @param {boolean} [hex]  Whether to use the hexadecimal or decimal
     *                         representation for the reference. If left
     *                         undefined, decimal is the default.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlCharRef} The newly created character reference.
     */
    XmlElement.prototype.charRef = function (char, hex, index) {
        var charRef = new XmlCharRef_1.default(char, hex);
        this.insertChild(charRef, index);
        return charRef;
    };
    /**
     * Inserts a new comment at the specified index. If no index is specified,
     * the node is inserted at the end of this node's children.
     *
     * @param {string} content The data of the comment.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlComment} The newly created comment.
     */
    XmlElement.prototype.comment = function (content, index) {
        var comment = new XmlComment_1.default(content);
        this.insertChild(comment, index);
        return comment;
    };
    /**
     * Inserts a new element at the specified index. If no index is specified,
     * the node is inserted at the end of this node's children.
     *
     * @param {string} name    The name of the element.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlElement} The newly created element.
     */
    XmlElement.prototype.element = function (name, index) {
        var element = new XmlElement(name);
        this.insertChild(element, index);
        return element;
    };
    /**
     * Inserts a new entity reference at the specified index. If no index is
     * specified, the node is inserted at the end of this node's children.
     *
     * @param {string} entity  The entity to be referenced.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlEntityRef} The newly created entity reference.
     */
    XmlElement.prototype.entityRef = function (entity, index) {
        var entityRef = new XmlEntityRef_1.default(entity);
        this.insertChild(entityRef, index);
        return entityRef;
    };
    /**
     * Inserts the specified node into this node's children at the specified
     * index. The node is not inserted if it is already present. If this node
     * already has a parent, it is removed from that parent.
     *
     * Note that only {@link XmlAttribute}, {@link XmlCdata},
     * {@link XmlCharRef}, {@link XmlComment}, {@link XmlElement},
     * {@link XmlEntityRef}, {@link XmlProcInst}, or {@link XmlText} nodes can
     * be inserted; otherwise, an exception will be thrown.
     *
     * @param {XmlNode} node   The node to insert.
     * @param {number} [index] The index at which to insert the node. Nodes at
     *                         or after the index are shifted to the right. If
     *                         no index is specified, the node is inserted at
     *                         the end.
     *
     * @returns {XmlNode} The node inserted into this node's children, or
     *                    undefined if no node was inserted.
     */
    XmlElement.prototype.insertChild = function (node, index) {
        if (!(node instanceof XmlAttribute_1.default ||
            node instanceof XmlCdata_1.default ||
            node instanceof XmlCharRef_1.default ||
            node instanceof XmlComment_1.default ||
            node instanceof XmlElement ||
            node instanceof XmlEntityRef_1.default ||
            node instanceof XmlProcInst_1.default ||
            node instanceof XmlText_1.default)) {
            throw new TypeError("node should be an instance of XmlAttribute,"
                + " XmlCdata, XmlCharRef, XmlComment,"
                + " XmlElement, XmlEntityRef, XmlProcInst,"
                + " or XmlText");
        }
        if (node instanceof XmlAttribute_1.default) {
            var attributes = this._children.filter(function (n) { return n instanceof XmlAttribute_1.default; });
            for (var _i = 0, _a = attributes; _i < _a.length; _i++) {
                var attribute = _a[_i];
                if (attribute.name === node.name) {
                    throw new Error("element already contains an" +
                        " XmlAttribute object with name "
                        + node.name);
                }
            }
        }
        return _super.prototype.insertChild.call(this, node, index);
    };
    /**
     * Inserts a new processing instruction at the specified index. If no index
     * is specified, the node is inserted at the end of this node's children.
     *
     * @param {string} target    The target of the processing instruction.
     * @param {string} [content] The data of the processing instruction, or
     *                           undefined if there is no target.
     * @param {number} [index]   The index at which the node should be inserted.
     *                           If no index is specified, the node is inserted
     *                           at the end of this node's children.
     *
     * @returns {XmlProcInst} The newly created processing instruction.
     */
    XmlElement.prototype.procInst = function (target, content, index) {
        var procInst = new XmlProcInst_1.default(target, content);
        this.insertChild(procInst, index);
        return procInst;
    };
    /**
     * Inserts some new text at the specified index. If no index is specified,
     * the node is inserted at the end of this node's children.
     *
     * @param {string} text    Arbitrary character data.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlText} The newly created text node.
     */
    XmlElement.prototype.text = function (text, index) {
        var txt = new XmlText_1.default(text);
        this.insertChild(txt, index);
        return txt;
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlElement.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        options_1.validateStringOptions(options);
        var attributes = this.attributes();
        var nodes = this._children.filter(function (node) {
            return attributes.indexOf(node) === -1;
        });
        // Element tag start
        var str = "<" + this._name;
        // Attributes
        for (var _i = 0, attributes_1 = attributes; _i < attributes_1.length; _i++) {
            var attribute = attributes_1[_i];
            str += " " + attribute.toString(options);
        }
        // Child nodes
        if (nodes.length > 0) {
            // Element non-empty tag end
            str += ">";
            var indenter = function (line) { return options.indent + line; };
            for (var i = 0; i < nodes.length; i++) {
                var next = nodes[i];
                var nextStr = next.toString(options);
                var prev = i > 0 ? nodes[i - 1] : undefined;
                // Line break before child nodes unless all nodes, or at least
                // the most recent two, are of type XmlCharacterReference,
                // XmlEntityReference, or XmlText
                if (options.pretty) {
                    if (!allSameLineNodes(nodes)) {
                        if (!(i > 0 && onSameLine(next, prev))) {
                            str += options.newline;
                            nextStr = nextStr.split(options.newline)
                                .map(indenter)
                                .join(options.newline);
                        }
                    }
                }
                str += nextStr;
            }
            // Line break before end tag unless all nodes are of type
            // XmlCharacterReference, XmlEntityReference, or XmlText
            if (options.pretty) {
                if (!allSameLineNodes(nodes)) {
                    str += options.newline;
                }
            }
            // Element end tag
            str += "</" + this._name + ">";
        }
        else {
            // Element empty tag end
            str += "/>";
        }
        return str;
    };
    return XmlElement;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlElement;
/**
 * Returns true if the specified nodes are all of type {@link XmlCharRef},
 * {@link XmlEntityRef}, or {@link XmlText}.
 *
 * @param {XmlNode[]} nodes The specified nodes.
 *
 * @returns {boolean} Whether or not the specified nodes are all of type
 *                    {@link XmlCharRef}, {@link XmlEntityRef}, or
 *                    {@link XmlText}.
 *
 * @private
 */
function allSameLineNodes(nodes) {
    for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {
        var node = nodes_1[_i];
        if (!((node instanceof XmlCharRef_1.default ||
            node instanceof XmlEntityRef_1.default ||
            node instanceof XmlText_1.default))) {
            return false;
        }
    }
    return true;
}
/**
 * Returns true if the specified nodes are all of type {@link XmlCharRef},
 * {@link XmlEntityRef}, or {@link XmlText}.
 *
 * @param {XmlNode} prev The first specified node.
 * @param {XmlNode} next The second specified node.
 *
 * @returns {boolean} Whether or not the specified nodes are all of type
 *                    {@link XmlCharRef}, {@link XmlEntityRef}, or
 *                    {@link XmlText}.
 *
 * @private
 */
function onSameLine(prev, next) {
    return (prev instanceof XmlCharRef_1.default ||
        prev instanceof XmlEntityRef_1.default ||
        prev instanceof XmlText_1.default) &&
        (next instanceof XmlCharRef_1.default ||
            next instanceof XmlEntityRef_1.default ||
            next instanceof XmlText_1.default);
}


/***/ }),
/* 35 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var tooltip_1 = __webpack_require__(8);
var FileBrowserSwitch = (function () {
    function FileBrowserSwitch(parent, titleId, callBack, preClass, initialVal) {
        var _this = this;
        this.val = false;
        this.parent = parent;
        this.wrapperEl = document.createElement('div');
        this.wrapperEl.className = preClass + '-browser-switch-wrapper';
        this.parent.appendChild(this.wrapperEl);
        this.callBack = callBack;
        if (initialVal) {
            this.val = initialVal;
        }
        this.hiddenCheckbox = document.createElement('input');
        this.hiddenCheckbox.type = 'checkbox';
        this.hiddenCheckbox.value = this.val + '';
        this.hiddenCheckbox.style.display = 'none';
        this.wrapperEl.appendChild(this.hiddenCheckbox);
        this.titleEl = document.createElement('div');
        this.titleEl.className = preClass + '-browser-switch-title';
        this.titleEl.id = titleId;
        this.titleEl.textContent = ui.translate(titleId);
        this.wrapperEl.appendChild(this.titleEl);
        var tooltip = new tooltip_1.WVTooltip(this.titleEl);
        tooltip.setTitle(ui.translate(titleId + '_INFO'));
        this.boxEl = document.createElement('div');
        this.boxEl.className = 'switch-wrapper switch';
        var statusClass = this.val ? 'switch-on' : 'switch-off';
        $(this.boxEl).addClass(statusClass);
        this.wrapperEl.appendChild(this.boxEl);
        this.handleEl = document.createElement('div');
        this.handleEl.className = 'switch-handle';
        this.boxEl.appendChild(this.handleEl);
        $(this.boxEl).click(function (e) {
            _this.val = !_this.val;
            var val = _this.val ? 'true' : 'false';
            $(_this.hiddenCheckbox).val(val);
            $(_this.hiddenCheckbox).trigger('change');
            if (_this.val) {
                $(_this.boxEl).removeClass('switch-off').addClass('switch-on');
            }
            else {
                $(_this.boxEl).removeClass('switch-on').addClass('switch-off');
            }
            if (_this.callBack) {
                _this.callBack(_this.val);
            }
        });
        this.setVal(this.val);
    }
    FileBrowserSwitch.prototype.getTitleEl = function () {
        return this.titleEl;
    };
    FileBrowserSwitch.prototype.getClickEl = function () {
        return this.hiddenCheckbox;
    };
    FileBrowserSwitch.prototype.getVal = function () {
        return this.val;
    };
    FileBrowserSwitch.prototype.setVal = function (val) {
        var valString = val ? 'true' : 'false';
        this.val = val;
        $(this.hiddenCheckbox).val(valString);
        $(this.hiddenCheckbox).trigger('change');
        if (this.val) {
            $(this.boxEl).removeClass('switch-off').addClass('switch-on');
        }
        else {
            $(this.boxEl).removeClass('switch-on').addClass('switch-off');
        }
    };
    return FileBrowserSwitch;
}());
exports.FileBrowserSwitch = FileBrowserSwitch;


/***/ }),
/* 36 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var events_1 = __webpack_require__(19);
var tooltip_1 = __webpack_require__(8);
var app_settings_1 = __webpack_require__(9);
var tinycolor = __webpack_require__(16);
var SVG_NS = 'http://www.w3.org/2000/svg';
var XLINK_NS = 'http://www.w3.org/1999/xlink';
var paletteColorsRGBA = [
    ['rgba(0,0,0,1)', 'rgba(128,0,0,1)', 'rgba(0,128,0,1)', 'rgba(128,128,0,1)', 'rgba(0,0,128,1)'],
    ['rgba(128,0,128,1)', 'rgba(0,128,128,1)', 'rgba(192,192,192,1)', 'rgba(192,220,192,1)', 'rgba(166,202,240,1)'],
    ['rgba(255,251,240,1)', 'rgba(160,160,164,1)', 'rgba(128,128,128,1)', 'rgba(255,0,0,1)', 'rgba(0,255,0,1)'],
    ['rgba(255,255,0,1)', 'rgba(0,0,255,1)', 'rgba(255,0,255,1)', 'rgba(0,255,255,1)', 'rgba(255,255,255,1)']
];
var paletteColorsRGB = [
    ['rgb(0,0,0)', 'rgb(128,0,0)', 'rgb(0,128,0)', 'rgb(128,128,0)', 'rgb(0,0,128)'],
    ['rgb(128,0,128)', 'rgb(0,128,128)', 'rgb(192,192,192)', 'rgb(192,220,192)', 'rgb(166,202,240)'],
    ['rgb(255,251,240)', 'rgb(160,160,164)', 'rgb(128,128,128)', 'rgb(255,0,0)', 'rgb(0,255,0)'],
    ['rgb(255,255,0)', 'rgb(0,0,255)', 'rgb(255,0,255)', 'rgb(0,255,255)', 'rgb(255,255,255)']
];
var rgbPalette;
var rgbaPalette;
try {
    rgbPalette = _ColorPalette;
}
catch (e) {
    rgbPalette = paletteColorsRGB;
}
try {
    rgbaPalette = _ColorPaletteWithAlpha;
}
catch (e) {
    rgbaPalette = paletteColorsRGBA;
}
var CustomPalette = (function (_super) {
    __extends(CustomPalette, _super);
    function CustomPalette(activeColor, showAlpha) {
        var _this = _super.call(this) || this;
        _this.nodes = [];
        _this.close = function (ev) {
            if (ev.target !== _this.mount || !_this.mount.contains(ev.target)) {
                _this.mount.style.display = 'none';
                $(_this.pixelBox).remove();
                document.body.removeChild(_this.mount);
                document.removeEventListener('click', _this.close);
            }
        };
        _this.pickPixel = function (e) {
            var ctx = this.canvas.getContext('2d');
            var x = e.pageX - this.canvas.getBoundingClientRect().left;
            var y = e.pageY - this.canvas.getBoundingClientRect().top;
            this.pixelBox.style.top = (e.pageY + 22) + 'px';
            this.pixelBox.style.left = (e.pageX + 22) + 'px';
            var imageData = ctx.getImageData(x, y, 1, 1);
            var pixel = imageData.data;
            this.colorPrevField.style.backgroundColor = 'rgb(' + pixel[0] + ', ' + pixel[1] + ', ' + pixel[2] + ')';
            this.colorPrevText.textContent = 'rgb(' + pixel[0] + ', ' + pixel[1] + ', ' + pixel[2] + ')';
        };
        _this.selectPixelColor = function (e) {
            e.preventDefault();
            e.stopPropagation();
            $(this.pixelBox).hide();
            this.canvas.removeEventListener('mousemove', this.pickPixel);
            this.canvas.removeEventListener('mousedown', this.selectPixelColor);
            var rgba = this.colorPrevText.textContent.replace('rgb', 'rgba').replace(')', ' ,1)');
            this.emit('customColorChosen', rgba);
            $(this.spectrumEl).spectrum('destroy');
        };
        _this.mount = document.createElement('div');
        _this.mount.style.position = 'absolute';
        _this.activeColor = activeColor;
        _this.showAlpha = showAlpha;
        _this.pixelBox = document.createElement('div');
        _this.pixelBox.className = 'color-pipette-preview-wrapper';
        _this.colorPrevField = document.createElement('span');
        _this.colorPrevField.className = 'color-pipette-preview-field';
        _this.colorPrevText = document.createElement('span');
        _this.colorPrevText.className = 'color-pipette-preview-text';
        _this.pixelBox.appendChild(_this.colorPrevField);
        _this.pixelBox.appendChild(_this.colorPrevText);
        document.body.appendChild(_this.pixelBox);
        $(_this.pixelBox).hide();
        document.body.appendChild(_this.mount);
        setTimeout(function () {
            document.addEventListener('click', _this.close);
        });
        _this.spectrumEl = document.createElement('div');
        _this.spectrumEl.id = 'spectrum-picker-el';
        _this.mount.appendChild(_this.spectrumEl);
        var $spEl = $(_this.spectrumEl);
        $spEl.attr("alpha", _this.showAlpha);
        $(_this.spectrumEl).spectrum({
            flat: true,
            color: _this.activeColor,
            showAlpha: _this.showAlpha,
            showInput: true,
            showInitial: true,
            showPalette: true,
            showSelectionPalette: true,
            maxSelectionSize: 40,
            preferredFormat: "rgb",
            localStorageKey: 'customColorStorage',
            palette: _this.showAlpha ? rgbaPalette : rgbPalette,
            show: function (color) {
                if ($('.sp-alpha-enabled').length > 0) {
                    $('.color-palette-pipette-picker-wrapper').css('top', '274px');
                }
                if ($(this).attr("alpha") === 'false') {
                    $('.sp-input').val(computeRgb(color));
                    $('#sp-hex-input').val(computeHex(color));
                    $('.sp-input').on('keyup', function (event) {
                        if (event.keyCode === 13) {
                            $(this).val(computeRgb(this.value));
                            $('#sp-hex-input').val(computeHex(this.value));
                        }
                    });
                    $('.sp-input').blur(function (event) {
                        $(this).val(computeRgb(this.value));
                        $('#sp-hex-input').val(computeHex(this.value));
                    });
                }
                else {
                    $('#sp-hex-input').val('#' + computeHexWithAlpha(color));
                    $('.sp-input').on('keyup', function (event) {
                        if (event.keyCode === 13) {
                            $('#sp-hex-input').val(computeHexWithAlpha(this.value));
                        }
                    });
                    $('.sp-input').blur(function (event) {
                        $('#sp-hex-input').val(computeHexWithAlpha(this.value));
                    });
                }
            },
            move: function (color) {
                if ($(this).attr("alpha") === 'false') {
                    $('.sp-input').val(computeRgb(color));
                    $('#sp-hex-input').val(computeHex(color));
                }
                else {
                    $('#sp-hex-input').val(computeHexWithAlpha(color));
                }
            },
            change: function (color) {
                var rgbColor;
                if (_this.showAlpha) {
                    rgbColor = computeRgb(color);
                }
                else {
                    rgbColor = computeRgbWithAlpha(color);
                }
                _this.chosenColor = rgbColor;
            }
        });
        var viewportWidth = Math.min(window.innerWidth, document.documentElement.offsetWidth);
        var viewportHeight = Math.max(window.innerHeight, document.documentElement.offsetHeight);
        var width = 280;
        var height = 300;
        _this.mount.style.top = 0.5 * (viewportHeight - height) + 'px';
        _this.mount.style.left = 0.5 * (viewportWidth - width) + 'px';
        _this.mount.className = 'wv-color-picker-popup';
        var $mount = $(_this.mount);
        _this.hexInputEl = document.createElement('input');
        _this.hexInputEl.id = 'sp-hex-input';
        _this.hexInputEl.className = 'sp-input';
        _this.hexInputEl.style.marginTop = '5px';
        $(_this.hexInputEl).attr("alpha", _this.showAlpha);
        if (_this.showAlpha) {
            $(_this.hexInputEl).val(computeHexWithAlpha(_this.activeColor));
        }
        else {
            $(_this.hexInputEl).val(computeHex(_this.activeColor));
        }
        var pipette = document.createElement('div');
        pipette.className = 'color-palette-pipette-picker-wrapper';
        if (_this.showAlpha) {
            pipette.style.top = '274px';
        }
        var pipetteWrapper = document.createElement('span');
        pipetteWrapper.className = 'color-palette-pipette-picker-icon';
        var pipetteToolTip = new tooltip_1.WVTooltip(pipetteWrapper);
        pipetteToolTip.setTitle(_this.translateTooltip('ID_COLOR_PICKER_PALETTE_CHOOSE_FROM_PART'));
        pipetteToolTip.setOrientation('bottom');
        var pipetteIcon = document.createElementNS(SVG_NS, 'svg');
        pipetteIcon.style.width = '25px';
        pipetteIcon.style.height = '25px';
        var pipetteUseIcon = document.createElementNS(SVG_NS, 'use');
        pipetteUseIcon.setAttributeNS(XLINK_NS, 'href', '#10_auswahl_durch_farbe');
        pipetteIcon.appendChild(pipetteUseIcon);
        pipetteWrapper.appendChild(pipetteIcon);
        var paletteWrapper = document.createElement('span');
        paletteWrapper.className = 'color-palette-pipette-picker-icon';
        paletteWrapper.style.marginLeft = '5px';
        var paletteTooltip = new tooltip_1.WVTooltip(paletteWrapper);
        paletteTooltip.setTitle(_this.translateTooltip('ID_COLOR_PICKER_PALETTE_CHOOSE_FROM_PIXEL'));
        paletteTooltip.setOrientation('bottom');
        var paletteIcon = document.createElementNS(SVG_NS, 'svg');
        paletteIcon.style.width = '25px';
        paletteIcon.style.height = '25px';
        paletteIcon.style.position = 'relative';
        paletteIcon.style.top = '2px';
        var paletteUseIcon = document.createElementNS(SVG_NS, 'use');
        paletteUseIcon.setAttributeNS(XLINK_NS, 'href', '#palette_pipette');
        paletteIcon.appendChild(paletteUseIcon);
        paletteWrapper.appendChild(paletteIcon);
        pipette.appendChild(pipetteWrapper);
        pipette.appendChild(paletteWrapper);
        _this.pickPixel = _this.pickPixel.bind(_this);
        _this.selectPixelColor = _this.selectPixelColor.bind(_this);
        paletteIcon.onclick = function (e) {
            e.preventDefault();
            e.stopPropagation();
            _this.canvas = vsClient.vsCanvas.canvas2D;
            $(_this.pixelBox).show();
            $(_this.mount).hide();
            _this.canvas.addEventListener('mousemove', _this.pickPixel);
            _this.canvas.addEventListener('mousedown', _this.selectPixelColor);
        };
        pipetteIcon.onclick = function (e) {
            e.preventDefault();
            e.stopPropagation();
            $(_this.mount).hide();
            var xml = '<Call Method="GetSelectedNodes"></Call>';
            vsClient.command.executeXML(xml);
            vsClient.once('GetSelectedNodes', function (nodeRes) {
                if (Array.isArray(nodeRes.NodeId)) {
                    _this.nodes = nodeRes.NodeId;
                }
                else {
                    _this.nodes = [nodeRes.NodeId];
                }
                vsClient.once('NodePropertiesChanged', function (res) {
                    if (res.General) {
                        var rgba_1 = computeRgbWithAlpha(res.General.Color);
                        var oldSelectionCall = '<Call Method="SetSelectedNodes">';
                        var selectedNodesLength = _this.nodes.length;
                        for (var i = 0; i < selectedNodesLength; i++) {
                            oldSelectionCall += '<NodeId>' + _this.nodes[i] + '</NodeId>';
                        }
                        oldSelectionCall += '</Call>';
                        vsClient.command.executeXML(oldSelectionCall);
                        vsClient.once('SetSelectedNodes', function () {
                            _this.emit('customColorChosen', rgba_1);
                            $(_this.spectrumEl).spectrum('destroy');
                            vsClient.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Deselect</SelectionModifier></Call>');
                        });
                    }
                    else {
                        vsClient.once('NodePropertiesChanged', function (res) {
                            if (res.General) {
                                var rgba_2 = computeRgbWithAlpha(res.General.Color);
                                var oldSelectionCall = '<Call Method="SetSelectedNodes">' + _this.nodes.toString() + '</Call>';
                                vsClient.command.executeXML(oldSelectionCall);
                                vsClient.once('SetSelectedNodes', function () {
                                    _this.emit('customColorChosen', rgba_2);
                                    $(_this.spectrumEl).spectrum('destroy');
                                    vsClient.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Deselect</SelectionModifier></Call>');
                                });
                            }
                            else {
                                $(_this.spectrumEl).spectrum('destroy');
                                vsClient.command.executeXML('<Call Method="ModifySelection"><SelectionModifier>Deselect</SelectionModifier></Call>');
                            }
                        });
                    }
                });
            });
        };
        $('.sp-input-container').append(_this.hexInputEl);
        $('.sp-picker-container').append(pipette);
        $(_this.hexInputEl).blur(function (event) {
            if ($(this).attr("alpha") === 'false') {
                $('.sp-input').val(computeRgb(this.value));
                $(this).val(computeHex(this.value));
            }
            else {
                $('.sp-input').val(computeRgbWithAlpha(this.value));
                $(this).val(computeHexWithAlpha(this.value));
            }
        });
        $(_this.hexInputEl).on('keyup', function (event) {
            if (event.keyCode === 13) {
                $('#spectrum-picker-el').spectrum('set', this.value);
                if ($(this).attr("alpha") === 'false') {
                    $('.sp-input').val(computeRgb(this.value));
                    $(this).val(computeHex(this.value));
                }
                else {
                    $('.sp-input').val(computeRgbWithAlpha(this.value));
                    $(this).val(computeHexWithAlpha(this.value));
                }
            }
        });
        $mount.find('.sp-cancel').on('click', function (e) {
            $(_this.pixelBox).remove();
            $spEl.spectrum('destroy');
        });
        $mount.find('.sp-choose').on('click', function (e) {
            $(_this.pixelBox).remove();
            var colorValue = tinycolor($spEl.spectrum('get'));
            var alpha = colorValue.getAlpha();
            colorValue.setAlpha(alpha === 1 ? 1.0 : alpha);
            var RGBString = _this.showAlpha ? computeRgbWithAlpha(colorValue._originalInput) : computeRgb(colorValue._originalInput);
            _this.emit('customColorChosen', RGBString);
            $spEl.spectrum('destroy');
        });
        function computeHexWithAlpha(color) {
            var colorObj;
            if (color._originalInput) {
                colorObj = tinycolor(color._originalInput);
            }
            else {
                colorObj = tinycolor(color);
            }
            return '#' + (Math.round(colorObj.toRgb().a * 255)).toString(16).toUpperCase() + colorObj.toHex().toUpperCase();
        }
        function computeHex(color) {
            var colorObj;
            if (color._originalInput) {
                colorObj = tinycolor(color._originalInput);
            }
            else {
                colorObj = tinycolor(color);
            }
            return '#' + colorObj.toHex().toUpperCase();
        }
        function computeRgb(color) {
            var rgb;
            if (color._originalInput) {
                rgb = tinycolor(color._originalInput).toRgb();
            }
            else {
                rgb = tinycolor(color).toRgb();
            }
            return 'rgb(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ')';
        }
        function computeRgbWithAlpha(color) {
            var rgb;
            var alpha;
            if (color._originalInput) {
                rgb = tinycolor(color._originalInput).toRgb();
            }
            else {
                alpha = color.slice(1, 3);
                rgb = tinycolor('#' + color.slice(3) + alpha).toRgb();
            }
            return 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', ' + rgb.a + ')';
        }
        return _this;
    }
    CustomPalette.prototype.translateTooltip = function (langId) {
        var tooltip;
        var lang = app_settings_1.settings.lang;
        if (_lang_data[langId] && _lang_data[langId][lang]) {
            tooltip = _lang_data[langId][lang];
        }
        else if (_custom_lang_data && _custom_lang_data[langId] && _custom_lang_data[langId][lang]) {
            tooltip = _custom_lang_data[langId][lang];
        }
        else if (_lang_data[langId] && _lang_data[langId]['ENU']) {
            tooltip = _lang_data[langId]['ENU'];
        }
        else if (_custom_lang_data && _custom_lang_data[langId] && _custom_lang_data[langId]['ENU']) {
            tooltip = _custom_lang_data[langId]['ENU'];
        }
        else {
            tooltip = langId;
        }
        return tooltip;
    };
    return CustomPalette;
}(events_1.EventEmitter));
exports.CustomPalette = CustomPalette;


/***/ }),
/* 37 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var app_states_1 = __webpack_require__(4);
var ClipboardModal = (function () {
    function ClipboardModal(src, width, height, encoding) {
        var _this = this;
        this.src = src;
        this.width = width;
        this.height = height;
        this.detectOutsideClick = this.detectOutsideClick.bind(this);
        this.detectEscClick = this.detectEscClick.bind(this);
        this.encoding = encoding ? encoding : 'png';
        var imageHeader = 'data:image/' + encoding + ';base64,';
        this.windowWrapper = document.createElement('div');
        this.windowWrapper.className = 'image-overlay';
        var closeIcon = document.createElement('i');
        closeIcon.className = 'fa fa-times image-overlay-icon';
        closeIcon.onclick = function (e) {
            _this.removeWindow();
        };
        this.windowWrapper.appendChild(closeIcon);
        var downloadImageIcon = document.createElement('i');
        downloadImageIcon.className = 'image-overlay-icon fas fa-download';
        this.windowWrapper.appendChild(downloadImageIcon);
        downloadImageIcon.onclick = function (e) {
            _this.downloadImage();
        };
        document.addEventListener('click', this.detectOutsideClick);
        document.addEventListener('keydown', this.detectEscClick);
        this.titleEl = document.createElement('div');
        this.titleEl.className = 'image-overlay-header';
        this.titleEl.textContent = ui.translate('ID_WV_COPY_TO_CLIPBOARD_INFO');
        this.windowWrapper.appendChild(this.titleEl);
        var imageWrapper = document.createElement('div');
        imageWrapper.className = 'image-overlay-image-wrapper';
        imageWrapper.style.maxHeight = (this.height - this.titleEl.clientHeight - 30) + 'px';
        this.windowWrapper.appendChild(imageWrapper);
        this.imageEl = document.createElement('img');
        this.imageEl.id = 'clipboardImage';
        this.imageEl.src = imageHeader + this.src;
        this.imageEl.className = 'image-overlay-image';
        this.imageEl.style.maxHeight = (this.height - this.titleEl.clientHeight - 35) + 'px';
        imageWrapper.appendChild(this.imageEl);
        document.body.appendChild(this.windowWrapper);
        var paddingTop = document.body.offsetHeight - this.height - 23;
        paddingTop = paddingTop > 0 ? paddingTop / 2 : 0;
        var paddingLeft = document.body.offsetWidth - this.width - 23;
        paddingLeft = paddingLeft > 0 ? paddingLeft / 2 : 0;
        this.windowWrapper.style.top = paddingTop + 'px';
        this.windowWrapper.style.left = paddingLeft + 'px';
        this.windowWrapper.style.maxHeight = this.height + 'px';
        this.windowWrapper.style.maxWidth = this.width + 'px';
    }
    ClipboardModal.prototype.detectOutsideClick = function (e) {
        if (!(e.target === this.windowWrapper || this.windowWrapper.contains(e.target))) {
            this.removeWindow();
        }
    };
    ClipboardModal.prototype.detectEscClick = function (e) {
        if (e.keyCode === 27) {
            this.removeWindow();
        }
    };
    ClipboardModal.prototype.removeWindow = function () {
        document.removeEventListener('click', this.detectOutsideClick);
        document.removeEventListener('click', this.detectEscClick);
        $(this.windowWrapper).remove();
    };
    ClipboardModal.prototype.downloadImage = function () {
        var byteCharacters = atob(this.src);
        var byteNumbers = new Array(byteCharacters.length);
        for (var i = 0; i < byteCharacters.length; i++) {
            byteNumbers[i] = byteCharacters.charCodeAt(i);
        }
        var byteArray = new Uint8Array(byteNumbers);
        var blob = new Blob([byteArray], {
            type: 'image/' + this.encoding
        });
        var name = app_states_1.appStates.fileName + (this.encoding === 'svg+xml' ? '.svg' : '.png');
        if (window.navigator && window.navigator.msSaveOrOpenBlob) {
            window.navigator.msSaveOrOpenBlob(blob, name);
        }
        else {
            var link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = name;
            document.body.appendChild(link);
            link.click();
            link.remove();
        }
    };
    return ClipboardModal;
}());
exports.ClipboardModal = ClipboardModal;


/***/ }),
/* 38 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var utils_1 = __webpack_require__(23);
/**
 * @private
 */
var defaults = {
    aliasString: "=",
    attributeString: "@",
    cdataInvalidChars: false,
    cdataKeys: [],
    declaration: {
        include: true
    },
    dtd: {
        include: false
    },
    format: {},
    typeHandlers: {},
    valueString: "#",
    wrapHandlers: {}
};
Object.freeze(defaults);
/**
 * Validates the cdataKeys property of an options object.
 *
 * @param {string[]} cdataKeys The cdataKeys object.
 *
 * @returns {string[]} The updated cdataKeys object.
 *
 * @private
 */
function validateCdataKeys(cdataKeys) {
    for (var _i = 0, cdataKeys_1 = cdataKeys; _i < cdataKeys_1.length; _i++) {
        var key = cdataKeys_1[_i];
        if (!utils_1.isType(key, "String")) {
            throw new TypeError(key + " should be a string");
        }
    }
    return cdataKeys;
}
/**
 * Validates the declaration property of an options object.
 *
 * @param {IDeclarationOptions} declaration The declaration object.
 *
 * @returns {IDeclarationOptions} The updated declaration object.
 *
 * @private
 */
function validateDecl(declaration) {
    if (!utils_1.isType(declaration.include, "Boolean", "Undefined")) {
        throw new TypeError("declaration.include should be a string or" +
            " undefined");
    }
    if (!utils_1.isType(declaration.include, "Boolean")) {
        declaration.include = defaults.declaration.include;
    }
    return declaration;
}
/**
 * Validates the dtd property of an options object.
 *
 * @param {IDtdOptions} dtd The dtd object.
 *
 * @returns {IDtdOptions} The updated dtd object.
 *
 * @private
 */
function validateDtd(dtd) {
    if (!utils_1.isType(dtd.include, "Boolean", "Undefined")) {
        throw new TypeError("dtdOptions.include should be a string or" +
            " undefined");
    }
    if (!utils_1.isType(dtd.include, "Boolean")) {
        dtd.include = defaults.dtd.include;
    }
    return dtd;
}
/**
 * Validates the typeHandlers property of an options object.
 *
 * @param {ITypeHandlers} typeHandlers The typeHandlers object.
 *
 * @returns {ITypeHandlers} The updated typeHandlers object.
 *
 * @private
 */
function validateTypeHandlers(typeHandlers) {
    for (var key in typeHandlers) {
        if (typeHandlers.hasOwnProperty(key)) {
            if (!utils_1.isType(typeHandlers[key], "Function")) {
                throw new TypeError("options.typeHandlers['" + key + "']" +
                    " should be a Function");
            }
        }
    }
    return typeHandlers;
}
/**
 * Validates the wrapHandlers property of an options object.
 *
 * @param {IWrapHandlers} wrapHandlers The wrapHandlers object.
 *
 * @return {IWrapHandlers} The updated wrapHandlers object.
 *
 * @private
 */
function validateWrapHandlers(wrapHandlers) {
    for (var key in wrapHandlers) {
        if (wrapHandlers.hasOwnProperty(key)) {
            if (!utils_1.isType(wrapHandlers[key], "Function")) {
                throw new TypeError("options.wrapHandlers"
                    + "['" + key + "'] should be a Function");
            }
        }
    }
    return wrapHandlers;
}
/**
 * Validates an options object and replaces undefined values with their
 * appropriate defaults.
 *
 * @param {IOptions} options The options object to validate.
 *
 * @returns {IOptions} The updated options object.
 *
 * @private
 */
function validateOptions(options) {
    if (!utils_1.isType(options.aliasString, "String", "Undefined")) {
        throw new TypeError("options.aliasString should be a string or"
            + " undefined");
    }
    if (!utils_1.isType(options.aliasString, "String")) {
        options.aliasString = defaults.aliasString;
    }
    if (!utils_1.isType(options.attributeString, "String", "Undefined")) {
        throw new TypeError("options.attributeString should be a string or" +
            " undefined");
    }
    if (!utils_1.isType(options.attributeString, "String")) {
        options.attributeString = defaults.attributeString;
    }
    if (!utils_1.isType(options.cdataInvalidChars, "Boolean", "Undefined")) {
        throw new TypeError("options.cdataInvalidChars should be a boolean or"
            + " undefined");
    }
    if (!utils_1.isType(options.cdataInvalidChars, "Boolean")) {
        options.cdataInvalidChars = defaults.cdataInvalidChars;
    }
    if (!utils_1.isType(options.cdataKeys, "Array", "Undefined")) {
        throw new TypeError("options.cdataKeys should be an Array or" +
            " undefined");
    }
    if (!utils_1.isType(options.cdataKeys, "Array")) {
        options.cdataKeys = defaults.cdataKeys;
    }
    options.cdataKeys = validateCdataKeys(options.cdataKeys);
    if (!utils_1.isType(options.declaration, "Object", "Undefined")) {
        throw new TypeError("options.declaration should be an Object or"
            + " undefined");
    }
    if (!utils_1.isType(options.declaration, "Object")) {
        options.declaration = defaults.declaration;
    }
    options.declaration = validateDecl(options.declaration);
    if (!utils_1.isType(options.dtd, "Object", "Undefined")) {
        throw new TypeError("options.dtd should be an Object or undefined");
    }
    if (!utils_1.isType(options.dtd, "Object")) {
        options.dtd = defaults.dtd;
    }
    options.dtd = validateDtd(options.dtd);
    if (!utils_1.isType(options.format, "Object", "Undefined")) {
        throw new TypeError("options.format should be an Object or undefined");
    }
    if (!utils_1.isType(options.format, "Object")) {
        options.format = defaults.format;
    }
    if (!utils_1.isType(options.typeHandlers, "Object", "Undefined")) {
        throw new TypeError("options.typeHandlers should be an Object or" +
            " undefined");
    }
    if (!utils_1.isType(options.typeHandlers, "Object")) {
        options.typeHandlers = defaults.typeHandlers;
    }
    options.typeHandlers = validateTypeHandlers(options.typeHandlers);
    if (!utils_1.isType(options.valueString, "String", "Undefined")) {
        throw new TypeError("options.valueString should be a string or" +
            " undefined");
    }
    if (!utils_1.isType(options.valueString, "String")) {
        options.valueString = defaults.valueString;
    }
    if (!utils_1.isType(options.wrapHandlers, "Object", "Undefined")) {
        throw new TypeError("options.wrapHandlers should be an"
            + " Object or undefined");
    }
    if (!utils_1.isType(options.wrapHandlers, "Object")) {
        options.wrapHandlers = defaults.wrapHandlers;
    }
    options.wrapHandlers = validateWrapHandlers(options.wrapHandlers);
    return options;
}
exports.validateOptions = validateOptions;


/***/ }),
/* 39 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var XmlAttribute_1 = __webpack_require__(25);
exports.XmlAttribute = XmlAttribute_1.default;
var XmlCdata_1 = __webpack_require__(26);
exports.XmlCdata = XmlCdata_1.default;
var XmlCharRef_1 = __webpack_require__(20);
exports.XmlCharRef = XmlCharRef_1.default;
var XmlComment_1 = __webpack_require__(14);
exports.XmlComment = XmlComment_1.default;
var XmlDecl_1 = __webpack_require__(27);
exports.XmlDecl = XmlDecl_1.default;
var XmlDocument_1 = __webpack_require__(40);
exports.XmlDocument = XmlDocument_1.default;
var XmlDtd_1 = __webpack_require__(28);
exports.XmlDtd = XmlDtd_1.default;
var XmlDtdAttlist_1 = __webpack_require__(29);
exports.XmlDtdAttlist = XmlDtdAttlist_1.default;
var XmlDtdElement_1 = __webpack_require__(30);
exports.XmlDtdElement = XmlDtdElement_1.default;
var XmlDtdEntity_1 = __webpack_require__(31);
exports.XmlDtdEntity = XmlDtdEntity_1.default;
var XmlDtdNotation_1 = __webpack_require__(32);
exports.XmlDtdNotation = XmlDtdNotation_1.default;
var XmlDtdParamEntityRef_1 = __webpack_require__(33);
exports.XmlDtdParamEntityRef = XmlDtdParamEntityRef_1.default;
var XmlElement_1 = __webpack_require__(34);
exports.XmlElement = XmlElement_1.default;
var XmlEntityRef_1 = __webpack_require__(21);
exports.XmlEntityRef = XmlEntityRef_1.default;
var XmlNode_1 = __webpack_require__(6);
exports.XmlNode = XmlNode_1.default;
var XmlProcInst_1 = __webpack_require__(15);
exports.XmlProcInst = XmlProcInst_1.default;
var XmlText_1 = __webpack_require__(22);
exports.XmlText = XmlText_1.default;
/**
 * Creates a new XML document.
 *
 * @param {string} root The name of the root element of the document.
 *
 * @returns {XmlDocument} The new XML document.
 */
function document(root) {
    return new XmlDocument_1.default(root);
}
exports.document = document;


/***/ }),
/* 40 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (C) 2016 Michael Kourlas
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var options_1 = __webpack_require__(12);
var utils_1 = __webpack_require__(5);
var XmlComment_1 = __webpack_require__(14);
var XmlDecl_1 = __webpack_require__(27);
var XmlDtd_1 = __webpack_require__(28);
var XmlElement_1 = __webpack_require__(34);
var XmlNode_1 = __webpack_require__(6);
var XmlProcInst_1 = __webpack_require__(15);
/**
 * Represents an XML document.
 *
 * A sample XML document is structured as follows:
 *
 * ```xml
 * <?xml version="1.0" encoding="UTF-8"?>
 * <DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 *                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
 * <html>
 *     <head>
 *         <title>My page title</title>
 *     </head>
 *     <body>
 *         <h1>Welcome!</h1>
 *         <p>I hope you enjoy visiting my website.</p>
 *         <img src="picture.png"/>
 *     </body>
 * </html>
 * ```
 *
 * Each component of the document, such as the XML declaration, document type
 * definition, and root element, are children of this node.
 *
 * XmlDocument nodes must have exactly one {@link XmlElement} child, which is
 * the document's root element.
 *
 * XmlDocument nodes can have exactly one {@link XmlDecl} and {@link XmlDtd}
 * child in that order, so long as they precede the {@link XmlElement} node.
 *
 * XmlDocument nodes can have an unlimited number of {@link XmlComment} or
 * {@link XmlProcInst} nodes, so long as they follow the {@link XmlDecl} node,
 * if one exists.
 */
var XmlDocument = (function (_super) {
    __extends(XmlDocument, _super);
    /**
     * Initializes a new instance of the {@link XmlDocument} class.
     *
     * @param {string} root The name of the root element.
     */
    function XmlDocument(root) {
        _super.call(this);
        _super.prototype.insertChild.call(this, new XmlElement_1.default(root));
    }
    /**
     * Inserts a new comment at the specified index. If no index is specified,
     * the node is inserted at the end of this node's children.
     *
     * @param {string} content The data of the comment.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         at the end of this node's children.
     *
     * @returns {XmlComment} The newly created element.
     */
    XmlDocument.prototype.comment = function (content, index) {
        var comment = new XmlComment_1.default(content);
        this.insertChild(comment, index);
        return comment;
    };
    /**
     * Inserts a new XML declaration at the beginning of this node's children.
     *
     * @param {IDeclarationOptions} [options] The options associated with the
     *                                       XML declaration.
     *
     * @returns {XmlDecl} The newly created XML declaration.
     */
    XmlDocument.prototype.decl = function (options) {
        var declaration = new XmlDecl_1.default(options);
        this.insertChild(declaration, 0);
        return declaration;
    };
    /**
     * Inserts a new XML document type definition. Unless a different index is
     * specified, the node is inserted immediately after the XML declaration
     * if one exists, or at the beginning of this node's children if one does
     * not.
     *
     * @param {string} name    The name of the DTD.
     * @param {string} [sysId] The system identifier of the DTD, excluding
     *                         quotation marks.
     * @param {string} [pubId] The public identifier of the DTD, excluding
     *                         quotation marks. If a public identifier is
     *                         provided, a system identifier must be provided
     *                         as well.
     * @param {number} [index] The index at which the node should be inserted.
     *                         If no index is specified, the node is inserted
     *                         immediately after the XML declaration if one
     *                         exists, or at the beginning of this node's
     *                         children if one does not.
     *
     * @returns {XmlDtd} The newly created XML document type definition.
     */
    XmlDocument.prototype.dtd = function (name, sysId, pubId, index) {
        var dtd = new XmlDtd_1.default(name, sysId, pubId);
        if (utils_1.isType(index, "Undefined")) {
            if (this._children[0] instanceof XmlDecl_1.default) {
                index = 1;
            }
            else {
                index = 0;
            }
        }
        this.insertChild(dtd, index);
        return dtd;
    };
    /**
     * Inserts the specified node into this node's children at the specified
     * index. The node is not inserted if it is already present. If this node
     * already has a parent, it is removed from that parent.
     *
     * Only {@link XmlComment}, {@link XmlDecl}, {@link XmlDtd}, or
     * {@link XmlProcInst} nodes can be inserted. Furthermore, {@link XmlDecl}
     * and {@link XmlDtd} nodes must be inserted in that order and must
     * precede the {@link XmlElement} node. In addition, {@link XmlComment} or
     * {@link XmlProcInst} nodes must follow the {@link XmlDecl} node.
     *
     * @param {XmlNode} node   The node to insert.
     * @param {number} [index] The index at which to insert the node. Nodes at
     *                         or after the index are shifted to the right. If
     *                         no index is specified, the node is inserted at
     *                         the end.
     *
     * @returns {XmlNode} The node inserted into this node's children, or
     *                    undefined if no node was inserted.
     */
    XmlDocument.prototype.insertChild = function (node, index) {
        if (!(node instanceof XmlComment_1.default || node instanceof XmlDecl_1.default ||
            node instanceof XmlDtd_1.default || node instanceof XmlProcInst_1.default)) {
            throw new TypeError("node should be an instance of" +
                " XmlComment, XmlDecl, XmlDtd, or XmlProcInst");
        }
        if (node instanceof XmlComment_1.default || node instanceof XmlProcInst_1.default) {
            if (this._children[0] instanceof XmlDecl_1.default) {
                if (index === 0) {
                    throw new Error("XmlComment or XmlProcInst node should be" +
                        " inserted after the XmlDecl node");
                }
            }
        }
        else if (node instanceof XmlDecl_1.default) {
            if (this._children[0] instanceof XmlDecl_1.default) {
                throw new Error("XmlDocument node should only contain one" +
                    " XmlDecl node");
            }
            if (index !== 0) {
                throw new Error("XmlDecl node should be inserted at the" +
                    " beginning of an XmlDocument node");
            }
        }
        else if (node instanceof XmlDtd_1.default) {
            if (this._children[0] instanceof XmlDecl_1.default) {
                if (index === 0) {
                    throw new Error("XmlDtd node should be inserted after" +
                        " the XmlDecl node");
                }
            }
            for (var i = 0; i < index && i < this._children.length; i++) {
                if (this._children[i] instanceof XmlElement_1.default) {
                    throw new Error("XmlDtd node should be inserted before" +
                        " the XmlElement node");
                }
            }
            for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
                var child = _a[_i];
                if (child instanceof XmlDtd_1.default) {
                    throw new Error("XmlDocument node should only contain" +
                        " one XmlDtd node");
                }
            }
        }
        return _super.prototype.insertChild.call(this, node, index);
    };
    /**
     * Inserts a new processing instruction at the specified index. If no index
     * is specified, the node is inserted at the end of this node's children.
     *
     * @param {string} target    The target of the processing instruction.
     * @param {string} [content] The data of the processing instruction, or
     *                           undefined if there is no target.
     * @param {number} [index]   The index at which the node should be inserted.
     *                           If no index is specified, the node is inserted
     *                           at the end of this node's children.
     *
     * @returns {XmlProcInst} The newly created processing instruction.
     */
    XmlDocument.prototype.procInst = function (target, content, index) {
        var procInst = new XmlProcInst_1.default(target, content);
        this.insertChild(procInst, index);
        return procInst;
    };
    /**
     * Removes the specified node from this node's children.
     *
     * Note that {@link XmlElement} nodes cannot be removed from this node;
     * attempts to do so will result in an exception being thrown.
     *
     * @param {XmlNode} node The node to remove.
     *
     * @returns {boolean} Whether a node was removed.
     */
    XmlDocument.prototype.removeChild = function (node) {
        if (node instanceof XmlElement_1.default) {
            throw new Error("XmlElement nodes cannot be removed from" +
                " XmlDocument nodes");
        }
        return _super.prototype.removeChild.call(this, node);
    };
    /**
     * Removes the node at the specified index from this node's children.
     *
     * Note that {@link XmlElement} nodes cannot be removed from this node;
     * attempts to do so will result in an exception being thrown.
     *
     * @param {number} index The index at which the node to be removed is
     *                       located.
     *
     * @returns {XmlNode} The node that was removed, or undefined if no node
     *                    was removed.
     */
    XmlDocument.prototype.removeChildAtIndex = function (index) {
        if (this._children[index] instanceof XmlElement_1.default) {
            throw new Error("XmlElement nodes cannot be removed from" +
                " XmlDocument nodes");
        }
        return _super.prototype.removeChildAtIndex.call(this, index);
    };
    /**
     * Returns the root element of this document.
     *
     * @returns {XmlNode} The root element of this document.
     */
    XmlDocument.prototype.root = function () {
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var node = _a[_i];
            if (node instanceof XmlElement_1.default) {
                return node;
            }
        }
        throw new Error("XmlDocument does not contain a root node");
    };
    /**
     * Returns an XML string representation of this node.
     *
     * @param {IStringOptions} [options] Formatting options for the string
     *                                  representation.
     *
     * @returns {string} An XML string representation of this node.
     */
    XmlDocument.prototype.toString = function (options) {
        if (options === void 0) { options = {}; }
        options_1.validateStringOptions(options);
        var str = "";
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var node = _a[_i];
            str += node.toString(options);
            if (options.pretty) {
                str += options.newline;
            }
        }
        var len = str.length - options.newline.length;
        if (str.substr(len) === options.newline) {
            str = str.substr(0, len);
        }
        return str;
    };
    return XmlDocument;
}(XmlNode_1.default));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = XmlDocument;


/***/ }),
/* 41 */
/***/ (function(module, exports) {


module.exports = function () {
  var selection = document.getSelection();
  if (!selection.rangeCount) {
    return function () {};
  }
  var active = document.activeElement;

  var ranges = [];
  for (var i = 0; i < selection.rangeCount; i++) {
    ranges.push(selection.getRangeAt(i));
  }

  switch (active.tagName.toUpperCase()) { // .toUpperCase handles XHTML
    case 'INPUT':
    case 'TEXTAREA':
      active.blur();
      break;

    default:
      active = null;
      break;
  }

  selection.removeAllRanges();
  return function () {
    selection.type === 'Caret' &&
    selection.removeAllRanges();

    if (!selection.rangeCount) {
      ranges.forEach(function(range) {
        selection.addRange(range);
      });
    }

    active &&
    active.focus();
  };
};


/***/ }),
/* 42 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var XMLParser = __webpack_require__(3);
var ui = __webpack_require__(0);
var pane_template_1 = __webpack_require__(1);
var AnimationPane = (function (_super) {
    __extends(AnimationPane, _super);
    function AnimationPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    AnimationPane.prototype.addMethods = function () {
        $("#wv-animation #OnAssignAnimationNodeClicked").off('click').click(function (ev) {
            var xml = '<Call Method="ActivateInteraction"><Interaction>Animation_AssignCoordinateToNode</Interaction></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-animation #OnAnimationStartClicked").off('click').click(function (ev) {
            var xml = '<Call Method="SetSceneSettings"><Settings><Scene><General><Animation>true';
            xml += '</Animation></General></Scene></Settings></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-animation #OnAnimationStopClicked").off('click').click(function (ev) {
            var xml = '<Call Method="SetSceneSettings"><Settings><Scene><General><Animation>false';
            xml += '</Animation></General></Scene></Settings></Call>';
            vsClient.command.executeXML(xml);
        });
    };
    AnimationPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetAnimationPane = "<Call Method=\"GetTemplate\"><Type>AnimationPane</Type></Call>";
        vsClient.command.executeXML(GetAnimationPane);
        vsClient.once('GetTemplate.AnimationPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    AnimationPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            if (path[0] === 'Event') {
                value = value.toString();
                pane.modifySettings(_this.values, path, value);
                var xml = XMLParser.serializeWithValue(path, value, ['Type=' + template['Event']]);
                vsClient.command.executeXML(xml);
            }
            else {
                pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
                var xml = XMLParser.serializeWithValue(path, value);
                var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
                vsClient.command.executeXML(settings);
                if (_this.hasPresets) {
                    _this.stack.changeToCustomPreset();
                }
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return AnimationPane;
}(pane_template_1.PaneTemplate));
exports.AnimationPane = AnimationPane;


/***/ }),
/* 43 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var BandAnalysisPane = (function (_super) {
    __extends(BandAnalysisPane, _super);
    function BandAnalysisPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    BandAnalysisPane.prototype.addMethods = function () {
        $("#wv-bandanalysis #OnMinimalDistanceComputeClicked").click(function (ev) {
            var xml = '<Call Method="BandAnalysisComputeMinimalDistance"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-bandanalysis #OnBandAnalysisComputeClicked").click(function (ev) {
            var xml = '<Call Method="BandAnalysisCompute"></Call>';
            vsClient.command.executeXML(xml);
        });
    };
    BandAnalysisPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetBandAnalysisPaneTemplate = "<Call Method=\"GetTemplate\"><Type>BandAnalysisPane</Type></Call>";
        vsClient.command.executeXML(GetBandAnalysisPaneTemplate);
        vsClient.once('GetTemplate.BandAnalysisPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    BandAnalysisPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return BandAnalysisPane;
}(pane_template_1.PaneTemplate));
exports.BandAnalysisPane = BandAnalysisPane;


/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var tooltip_1 = __webpack_require__(8);
var copy = __webpack_require__(18);
var app_states_1 = __webpack_require__(4);
var BOMPane = (function (_super) {
    __extends(BOMPane, _super);
    function BOMPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.headerKeys = [];
        _this.headerNames = [];
        _this.selection = [];
        _this.calloutInputs = [];
        _this.rows = [];
        _this.defaultCols = ['Number', 'Name', 'Quantity', 'CalloutId'];
        _this.sum = 0;
        _this.scrollPosTable = 0;
        _this.startIndex = 1;
        _this.update = function (response) {
            _this.tableWrapperEl.scrollTop = _this.scrollPosTable;
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.scrollOnKey = _this.scrollOnKey.bind(_this);
        var buttonWrapper = document.createElement('div');
        buttonWrapper.className = 'pane-buttons-tab';
        _this.copyTooltip = new tooltip_1.WVTooltip(buttonWrapper);
        _this.copyTooltip.setTitle(_lang_data['ID_COPY_TO_CLIPBOARD'][_this.lang]);
        _this.wrapperEl.appendChild(buttonWrapper);
        var buttonIcon = document.createElement('i');
        buttonIcon.className = 'far fa-copy tree-header-action-icon';
        buttonWrapper.onclick = function (e) {
            var idSet = false;
            _this.rows.map(function (item) {
                if (item['CalloutId'] && item['CalloutId'] !== '' && item['CalloutId'] !== null) {
                    idSet = true;
                }
            });
            var header = _this.headerNames.filter(function (item) { return item !== 'ID' || idSet; });
            var csvText = header.join(';');
            csvText = csvText.replace('ID', 'CalloutId');
            csvText += '\n';
            for (var i = 0; i < _this.rows.length; i++) {
                for (var l = 0; l < _this.headerKeys.length; l++) {
                    if (_this.headerKeys[l] === 'CalloutId' && !idSet) {
                        continue;
                    }
                    var val = _this.rows[i][_this.headerKeys[l]];
                    if (val === undefined) {
                        for (var k = 0; k < _this.rows[i]['Attribute'].length; k++) {
                            if (_this.rows[i]['Attribute'][k].Name === _this.headerKeys[l]) {
                                val = _this.rows[i]['Attribute'][k]['__text__'];
                            }
                        }
                    }
                    csvText += val;
                    csvText += l === _this.headerKeys.length - 1 ? '\n' : ';';
                }
            }
            var skipCol = idSet ? ';;' : ';';
            csvText += skipCol + _this.sum.toString();
            copy(csvText);
        };
        buttonWrapper.appendChild(buttonIcon);
        _this.tableWrapperEl = document.createElement('div');
        _this.tableWrapperEl.className = 'bom-pane-table-wrapper';
        _this.wrapperEl.appendChild(_this.tableWrapperEl);
        _this.tableWrapperEl.onscroll = function (e) {
            _this.scrollPosTable = _this.tableWrapperEl.scrollTop;
        };
        _this.tableEl = document.createElement('table');
        _this.tableEl.className = 'bom-pane-table pane-content';
        _this.tableEl.width = '100%';
        _this.tableWrapperEl.appendChild(_this.tableEl);
        var tableHeaderEl = document.createElement('thead');
        _this.tableEl.appendChild(tableHeaderEl);
        _this.tableHeaderRowEl = document.createElement('tr');
        _this.tableHeaderRowEl.className = 'pane-item';
        tableHeaderEl.appendChild(_this.tableHeaderRowEl);
        _this.tableBodyEl = document.createElement('tbody');
        _this.tableEl.appendChild(_this.tableBodyEl);
        _this.buildDefaultHeader();
        var placeholderRow = document.createElement('tr');
        _this.tableBodyEl.appendChild(placeholderRow);
        _this.buildSumRow();
        var buttonEl = document.createElement('button');
        buttonEl.className = 'pane-item-entry-button bom-pane-compute-button';
        buttonEl.onclick = function (e) {
            var xml = '<Call Method="Compute"><Mode>BillOfMaterial</Mode></Call>';
            vsClient.command.executeXML(xml);
            vsClient.once('Compute', function (res) {
                if (res.BillOfMaterial) {
                    _this.buildHeader(res.BillOfMaterial.Template.Column);
                    _this.buildBody(Array.isArray(res.BillOfMaterial.Data.Item) ? res.BillOfMaterial.Data.Item : [res.BillOfMaterial.Data.Item]);
                }
            });
        };
        buttonEl.textContent = "Update";
        _this.wrapperEl.appendChild(buttonEl);
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        vsClient.on('GetBillOfMaterial', function (res) {
            if (res.BillOfMaterial) {
                _this.buildHeader(res.BillOfMaterial.Template.Column);
                _this.buildBody(Array.isArray(res.BillOfMaterial.Data.Item) ? res.BillOfMaterial.Data.Item : [res.BillOfMaterial.Data.Item]);
            }
        });
        vsClient.on('@OpenedFile', function (res) {
            $(_this.tableBodyEl).empty();
            _this.buildDefaultHeader();
            _this.buildSumRow();
        });
        _this.wrapperEl.addEventListener('contextmenu', function (ev) {
            ev.preventDefault();
            $('#contextMenu').remove();
            $(document).off('mousedown', vsClient.vsCanvas.closeContextMenu);
            $(document).off('keyup', vsClient.vsCanvas.closeContextMenu);
            vsClient.vsCanvas.createContextMenu(ev);
        });
        _this.wrapperEl.addEventListener('mouseenter', function (ev) {
            _this.toggleScrollEvents(true);
        });
        _this.wrapperEl.addEventListener('mouseleave', function (ev) {
            _this.toggleScrollEvents(false);
        });
        return _this;
    }
    BOMPane.prototype.toggleScrollEvents = function (state) {
        if (state) {
            $(document).off('keydown', this.scrollOnKey).on('keydown', this.scrollOnKey);
        }
        else {
            $(document).off('keydown', this.scrollOnKey);
        }
    };
    BOMPane.prototype.scrollOnKey = function (ev) {
        if (app_states_1.appStates.interactionMode.indexOf('Flythrough') === -1) {
            if (ev.keyCode !== 40 && ev.keyCode !== 38 || Date.now() - this.firstScrollHit < 200) {
                return;
            }
            ev.preventDefault();
            this.firstScrollHit = Date.now();
            if (this.selection.length === 0) {
                if (ev.keyCode === 40) {
                    this.selectBOMRow(this.rows[0]['Id']);
                }
                else if (ev.keyCode === 38) {
                    this.selectBOMRow(this.rows[this.rows.length - 1]['Id']);
                }
            }
            else {
                if (ev.keyCode === 40) {
                    var lastSelectedElement = this.selection[this.selection.length - 1];
                    var selectionInArr = this.rows.map(function (item) { return item['Id']; }).indexOf(lastSelectedElement);
                    if (selectionInArr === this.rows.length - 1) {
                        return;
                    }
                    var nextElement = this.rows[selectionInArr + 1];
                    this.selectBOMRow(nextElement['Id']);
                }
                else if (ev.keyCode === 38) {
                    var firstSelectedElement = this.selection[0];
                    var selectionInArr = this.rows.map(function (item) { return item['Id']; }).indexOf(firstSelectedElement);
                    if (selectionInArr === 0) {
                        return;
                    }
                    var prevElement = this.rows[selectionInArr - 1];
                    this.selectBOMRow(prevElement['Id']);
                }
            }
        }
    };
    BOMPane.prototype.buildHeader = function (template) {
        var _this = this;
        $(this.tableHeaderRowEl).empty();
        this.headerKeys = [];
        this.headerNames = [];
        var _loop_1 = function (h) {
            var rowHeader = document.createElement('th');
            rowHeader.style.resize = 'horizontal';
            rowHeader.style.cursor = 'pointer';
            rowHeader.textContent = template[h].DisplayName;
            rowHeader.className = 'pane-item-entry-name';
            this_1.headerKeys.push(template[h].Id);
            this_1.headerNames.push(template[h].DisplayName);
            var sortWrapper = document.createElement('span');
            rowHeader.appendChild(sortWrapper);
            var sortIcon = document.createElement('i');
            sortIcon.className = 'fas fa-sort bom-pane-sort-icon';
            sortWrapper.appendChild(sortIcon);
            rowHeader.onclick = function (e) {
                if (sortIcon.className.indexOf('fa-sort-up') !== -1) {
                    sortIcon.className = 'fas fa-sort-down bom-pane-sort-icon';
                    _this.sort(false, template[h].Id);
                }
                else {
                    sortIcon.className = 'fas fa-sort-up bom-pane-sort-icon';
                    _this.sort(true, template[h].Id);
                }
            };
            this_1.tableHeaderRowEl.appendChild(rowHeader);
        };
        var this_1 = this;
        for (var h = 0; h < template.length; h++) {
            _loop_1(h);
        }
    };
    BOMPane.prototype.buildBody = function (rows) {
        if (!rows) {
            return;
        }
        this.calloutInputs = [];
        this.rows = [];
        this.sum = 0;
        $(this.tableBodyEl).empty();
        var placeholderRow = document.createElement('tr');
        this.tableBodyEl.appendChild(placeholderRow);
        for (var r = 0; r < rows.length; r++) {
            this.buildRow(rows[r]);
        }
        this.buildSumRow();
    };
    BOMPane.prototype.buildRow = function (row) {
        var _this = this;
        this.rows.push(row);
        var rowEl = document.createElement('tr');
        rowEl.className = 'pane-item';
        rowEl.id = 'BOM_ROW_ID' + row['Id'];
        rowEl.onclick = function (e) {
            _this.selectBOMRow(row.Id, e.ctrlKey);
        };
        rowEl.oncontextmenu = function (e) {
            if (!app_states_1.appStates.nodesSelected) {
                _this.selectBOMRow(row.Id);
            }
        };
        this.tableBodyEl.appendChild(rowEl);
        var _loop_2 = function (i) {
            var cellEl = document.createElement('td');
            cellEl.className = 'pane-item-entry-name';
            if (this_2.headerKeys[i] === 'CalloutId') {
                this_2.calloutInputs.push(cellEl);
                cellEl.contentEditable = 'true';
                cellEl.onblur = function (e) {
                    if (cellEl.textContent && cellEl.textContent !== '') {
                        var xml = '<Call Method="UpdateBillOfMaterialRowCalloutId">';
                        xml += '<RowId>' + row['Id'] + '</RowId>';
                        xml += '<CalloutId>' + cellEl.textContent + '</CalloutId></Call>';
                        row.CalloutId = cellEl.textContent;
                        vsClient.command.executeXML(xml);
                    }
                    else {
                        var xml = '<Call Method="ClearBillOfMaterialCalloutId">';
                        xml += '<RowId>' + row['Id'] + '</RowId></Call>';
                        row.CalloutId = cellEl.textContent;
                        vsClient.command.executeXML(xml);
                    }
                };
                cellEl.onkeydown = function (e) {
                    if (e.keyCode === 13) {
                        cellEl.blur();
                    }
                };
            }
            cellEl.textContent = this_2.defaultCols.indexOf(this_2.headerKeys[i]) === -1 ? this_2.searchAttribute(row, this_2.headerKeys[i]) : row[this_2.headerKeys[i]];
            if (this_2.headerKeys[i] === 'Quantity') {
                this_2.sum += parseInt(row[this_2.headerKeys[i]]);
            }
            rowEl.appendChild(cellEl);
        };
        var this_2 = this;
        for (var i = 0; i < this.headerKeys.length; i++) {
            _loop_2(i);
        }
    };
    BOMPane.prototype.selectBOMRow = function (id, addToSelection) {
        if (addToSelection === void 0) { addToSelection = false; }
        var xml = '<Call Method="SelectBillOfMaterialRows">';
        xml += '<RowId>' + id + '</RowId>';
        xml += '<AddToSelection>' + addToSelection + '</AddToSelection>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
    };
    BOMPane.prototype.sort = function (asc, key) {
        var sortedRows = this.rows.sort(function (item1, item2) {
            var val1, val2;
            var preVal1 = item1[key];
            var preVal2 = item2[key];
            if (item1[key] === undefined) {
                preVal1 = "";
                for (var i = 0; i < item1['Attribute'].length; i++) {
                    if (item1['Attribute'][i]['Name'] === key) {
                        preVal1 = item1['Attribute'][i]['__text__'] ? item1['Attribute'][i]['__text__'] : "";
                    }
                }
            }
            if (item2[key] === undefined) {
                preVal2 = "";
                for (var i = 0; i < item2['Attribute'].length; i++) {
                    if (item2['Attribute'][i]['Name'] === key) {
                        preVal2 = item2['Attribute'][i]['__text__'] ? item2['Attribute'][i]['__text__'] : "";
                    }
                }
            }
            val2 = isNaN(parseFloat(preVal1)) ? preVal1.toUpperCase() : parseFloat(preVal2);
            val1 = isNaN(parseFloat(preVal1)) ? preVal2.toUpperCase() : parseFloat(preVal1);
            if (val1 > val2) {
                return asc ? 1 : -1;
            }
            else {
                return asc ? -1 : 1;
            }
        });
        this.buildBody(sortedRows);
    };
    BOMPane.prototype.searchAttribute = function (row, key) {
        if (row.Attribute) {
            var attributes = Array.isArray(row.Attribute) ? row.Attribute : [row.Attribute];
            for (var i = 0; i < attributes.length; i++) {
                if (attributes[i]['Name'] === key) {
                    return attributes[i]['__text__'];
                }
            }
            return '';
        }
    };
    BOMPane.prototype.buildSumRow = function () {
        var sumRowEl = document.createElement('tr');
        this.tableBodyEl.appendChild(sumRowEl);
        var sumPlaceholderFirstEl = document.createElement('td');
        sumPlaceholderFirstEl.className = 'pane-item';
        sumRowEl.appendChild(sumPlaceholderFirstEl);
        var sumPlaceholderSecondEl = document.createElement('td');
        sumPlaceholderSecondEl.className = 'pane-item';
        sumRowEl.appendChild(sumPlaceholderSecondEl);
        var sumCellEl = document.createElement('td');
        sumCellEl.className = 'bom-pane-sum-cell pane-item';
        sumCellEl.textContent = this.sum.toString();
        sumRowEl.appendChild(sumCellEl);
        var sumPlaceholderThirdEl = document.createElement('td');
        sumPlaceholderThirdEl.className = 'pane-item';
        sumRowEl.appendChild(sumPlaceholderThirdEl);
    };
    BOMPane.prototype.buildDefaultHeader = function () {
        $(this.tableHeaderRowEl).empty();
        var idRow = document.createElement('th');
        idRow.textContent = ui.translate('ID_BOM_COLUMN_CALLOUT_ID');
        idRow.className = 'pane-item-entry-name';
        this.tableHeaderRowEl.appendChild(idRow);
        var nameRow = document.createElement('th');
        nameRow.textContent = ui.translate('ID_BOM_PARTNAME');
        nameRow.className = 'pane-item-entry-name';
        this.tableHeaderRowEl.appendChild(nameRow);
        var quantityRow = document.createElement('th');
        quantityRow.textContent = ui.translate('ID_BOM_QUANTITY');
        quantityRow.className = 'pane-item-entry-name';
        this.tableHeaderRowEl.appendChild(quantityRow);
    };
    BOMPane.prototype.changeLang = function (lang) {
        var _this = this;
        this.copyTooltip.setTitle(_lang_data['ID_COPY_TO_CLIPBOARD'][this.lang]);
        var GetBOMPaneTemplate = "<Call Method=\"GetTemplate\"><Type>BOMPane</Type></Call>";
        vsClient.command.executeXML(GetBOMPaneTemplate);
        vsClient.once('GetTemplate.BOMPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    BOMPane.prototype.addMethods = function () {
        var _this = this;
        $("#wv-bom #OnBOMTechDocGenerateIds").off('click').click(function (ev) {
            var xml = '<Call Method="GenerateBOMCalloutIds">';
            xml += '<StartId>' + _this.startIndex + '</StartId></Call>';
            vsClient.command.executeXML(xml);
            vsClient.once('GenerateBOMCalloutIds', function (resp) {
                _this.startIndex = parseFloat(resp.StartId);
                _this.startIndexEl.textContent = resp.StartId;
                var xml = '<Call Method="GetBillOfMaterial"></Call>';
                vsClient.command.executeXML(xml);
            });
        });
        $("#wv-bom #OnBOMTechDocResetIds").off('click').click(function (ev) {
            var xml = '<Call Method="ClearBillOfMaterialCalloutIds"></Call>';
            vsClient.command.executeXML(xml);
            xml = '<Call Method="GetBillOfMaterial"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-bom #OnBOMTechDocGenerateCallouts").off('click').click(function (ev) {
            try {
                if (_PanePresets['wv-callout']) {
                    var defaultPreset = void 0;
                    var hasCalloutActivePreset = ui.calloutPane.hasPresets && ui.calloutPane.activePreset;
                    defaultPreset = ui.calloutPane.activePreset;
                    var presets = _PanePresets['wv-callout'];
                    for (var i = 0; i < presets.length; i++) {
                        if ((presets[i].isDefault && !hasCalloutActivePreset) || ui.calloutPane.activePreset === presets[i].name) {
                            defaultPreset = presets[i].settings;
                        }
                    }
                    var customPresetsString = localStorage.getItem('WVPreset_wv-callout');
                    if (customPresetsString !== null) {
                        var customPresets = JSON.parse(customPresetsString);
                        for (var i = 0; i < customPresets.length; i++) {
                            if ((customPresets[i].isDefault && !hasCalloutActivePreset) || ui.calloutPane.activePreset === customPresets[i].name) {
                                defaultPreset = customPresets[i].val;
                            }
                        }
                    }
                    if (defaultPreset) {
                        ui.deactivateInteraction(vsClient, 'Markup');
                        var regEx = new RegExp('<Alignment>.*<\/Alignment>');
                        var parsedPreset = defaultPreset.replace(regEx, '');
                        _this.stack.selectPreset(parsedPreset, false);
                    }
                }
            }
            catch (e) { }
            var xml = '<Call Method="GenerateBOMCallouts"></Call>';
            vsClient.command.executeXML(xml);
        });
        this.startIndexEl = document.getElementById('BOMTechDocStartId');
        if (this.startIndexEl) {
            if (this.startIndexEl.textContent === '') {
                this.startIndexEl.textContent = "1";
                this.startIndex = 1;
            }
            this.startIndexEl.onblur = function (e) {
                if (isNaN(parseInt(_this.startIndexEl.textContent))) {
                    _this.startIndexEl.textContent = _this.startIndex.toString();
                }
                else {
                    _this.startIndex = parseInt(_this.startIndexEl.textContent);
                    _this.startIndexEl.textContent = _this.startIndex.toString();
                }
            };
        }
    };
    BOMPane.prototype.selectCallouts = function () {
        var _this = this;
        this.selection = [];
        var xml = '<Call Method="GetSelectedBillOfMaterialRows"></Call>';
        vsClient.command.executeXML(xml);
        vsClient.once('GetSelectedBillOfMaterialRows', function (res) {
            for (var i = 0; i < _this.rows.length; i++) {
                $('#BOM_ROW_ID' + _this.rows[i]['Id']).removeClass('bom-pane-row-selected');
            }
            if (res.RowId) {
                var rows = Array.isArray(res.RowId) ? res.RowId : [res.RowId];
                for (var i = 0; i < rows.length; i++) {
                    $('#BOM_ROW_ID' + rows[i]).addClass('bom-pane-row-selected');
                    _this.selection.push(rows[i]);
                }
            }
        });
    };
    BOMPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.addMethods();
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            if (value === 'multi-box-open') {
                var multiBox_1 = src;
                vsClient.command.executeXML('<Call Method="GetBillOfMaterialNodePropertyNames"></Call>');
                vsClient.once('GetBillOfMaterialNodePropertyNames', function (props) {
                    vsClient.command.executeXML('<Call Method="GetBillOfMaterialAttributeNames"></Call>');
                    vsClient.once('GetBillOfMaterialAttributeNames', function (attr) {
                        multiBox_1.computeLists(props, attr);
                    });
                });
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return BOMPane;
}(pane_template_1.PaneTemplate));
exports.BOMPane = BOMPane;


/***/ }),
/* 45 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var SVG_NS = 'http://www.w3.org/2000/svg';
var XLINK_NS = 'http://www.w3.org/1999/xlink';
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var CalloutPane = (function (_super) {
    __extends(CalloutPane, _super);
    function CalloutPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    CalloutPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetCalloutPaneTemplate = "<Call Method=\"GetTemplate\"><Type>CalloutPane</Type></Call>";
        vsClient.command.executeXML(GetCalloutPaneTemplate);
        vsClient.once('GetTemplate.CalloutPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    CalloutPane.prototype.addMethods = function () {
    };
    CalloutPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.addMethods();
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
                ui.deactivateInteraction(vsClient, 'Markup');
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return CalloutPane;
}(pane_template_1.PaneTemplate));
exports.CalloutPane = CalloutPane;


/***/ }),
/* 46 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var tooltip_1 = __webpack_require__(8);
var copy = __webpack_require__(18);
var ClashPane = (function (_super) {
    __extends(ClashPane, _super);
    function ClashPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.headerKeys = [];
        _this.headerNames = [];
        _this.rows = [];
        _this.defaultCols = ['Id', 'Name', 'OtherName', 'Type', 'MaxDepth'];
        _this.scrollPosTable = 0;
        _this.update = function (response) {
            _this.tableWrapperEl.scrollTop = _this.scrollPosTable;
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.scrollOnKey = _this.scrollOnKey.bind(_this);
        var buttonWrapper = document.createElement('div');
        buttonWrapper.className = 'pane-buttons-tab';
        _this.copyTooltip = new tooltip_1.WVTooltip(buttonWrapper);
        _this.copyTooltip.setTitle(_lang_data['ID_COPY_TO_CLIPBOARD'][_this.lang]);
        _this.wrapperEl.appendChild(buttonWrapper);
        var buttonIcon = document.createElement('i');
        buttonIcon.className = 'far fa-copy tree-header-action-icon';
        buttonWrapper.onclick = function (e) {
            var header = _this.headerNames;
            var csvText = header.join(';');
            csvText += '\n';
            for (var i = 0; i < _this.rows.length; i++) {
                for (var l = 0; l < _this.headerKeys.length; l++) {
                    var val = _this.rows[i][_this.headerKeys[l]];
                    csvText += val;
                    csvText += l === _this.headerKeys.length - 1 ? '\n' : ';';
                }
            }
            copy(csvText);
        };
        buttonWrapper.appendChild(buttonIcon);
        _this.tableWrapperEl = document.createElement('div');
        _this.tableWrapperEl.className = 'bom-pane-table-wrapper';
        _this.tableWrapperEl.onscroll = function (e) {
            _this.scrollPosTable = _this.tableWrapperEl.scrollTop;
        };
        _this.wrapperEl.appendChild(_this.tableWrapperEl);
        _this.tableEl = document.createElement('table');
        _this.tableEl.className = 'bom-pane-table pane-content';
        _this.tableEl.width = '100%';
        _this.tableWrapperEl.appendChild(_this.tableEl);
        var tableHeaderEl = document.createElement('thead');
        _this.tableEl.appendChild(tableHeaderEl);
        _this.tableHeaderRowEl = document.createElement('tr');
        _this.tableHeaderRowEl.className = 'pane-item';
        tableHeaderEl.appendChild(_this.tableHeaderRowEl);
        _this.tableBodyEl = document.createElement('tbody');
        _this.tableEl.appendChild(_this.tableBodyEl);
        _this.buildDefaultHeader();
        var placeholderRow = document.createElement('tr');
        _this.tableBodyEl.appendChild(placeholderRow);
        var buttonEl = document.createElement('button');
        buttonEl.className = 'pane-item-entry-button bom-pane-compute-button';
        buttonEl.onclick = function (e) {
            var xml = '<Call Method="Compute"><Mode>ClashAsync</Mode></Call>';
            vsClient.command.executeXML(xml);
        };
        buttonEl.textContent = "Compute";
        _this.wrapperEl.appendChild(buttonEl);
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        vsClient.on('ClashResultUpdated', function (res) {
            _this.selectedIndex = undefined;
            if (res.ClashDetection) {
                _this.buildHeader(res.ClashDetection.Template.Column);
                var clashResults = res.ClashDetection.Data.Item;
                if (!Array.isArray(clashResults)) {
                    clashResults = [clashResults];
                }
                _this.buildBody(clashResults);
            }
        });
        vsClient.on('@OpenedFile', function (res) {
            $(_this.tableBodyEl).empty();
            _this.buildDefaultHeader();
        });
        _this.wrapperEl.addEventListener('mouseenter', function (ev) {
            _this.toggleScrollEvents(true);
        });
        _this.wrapperEl.addEventListener('mouseleave', function (ev) {
            _this.toggleScrollEvents(false);
        });
        return _this;
    }
    ClashPane.prototype.toggleScrollEvents = function (state) {
        if (state) {
            $(document).off('keydown', this.scrollOnKey).on('keydown', this.scrollOnKey);
        }
        else {
            $(document).off('keydown', this.scrollOnKey);
        }
    };
    ClashPane.prototype.scrollOnKey = function (ev) {
        if (ev.keyCode !== 40 && ev.keyCode !== 38 || Date.now() - this.firstScrollHit < 200) {
            return;
        }
        ev.preventDefault();
        this.firstScrollHit = Date.now();
        if (!this.selectedIndex) {
            if (ev.keyCode === 40) {
                this.selectClashRow(this.rows[0].Id);
            }
            else if (ev.keyCode === 38) {
                this.selectClashRow(this.rows[this.rows.length - 1].Id);
            }
        }
        else {
            var selectionInArr = this.rows.map(function (item) { return item.Id; }).indexOf(this.selectedIndex);
            if (ev.keyCode === 40) {
                if (selectionInArr === this.rows.length - 1) {
                    return;
                }
                var nextElement = this.rows[selectionInArr + 1];
                this.selectClashRow(nextElement.Id);
            }
            else if (ev.keyCode === 38) {
                if (selectionInArr === 0) {
                    return;
                }
                var prevElement = this.rows[selectionInArr - 1];
                this.selectClashRow(prevElement.Id);
            }
        }
    };
    ClashPane.prototype.buildHeader = function (template) {
        var _this = this;
        $(this.tableHeaderRowEl).empty();
        this.headerKeys = [];
        this.headerNames = [];
        var _loop_1 = function (h) {
            var rowHeader = document.createElement('th');
            rowHeader.style.resize = 'horizontal';
            rowHeader.style.cursor = 'pointer';
            rowHeader.textContent = template[h].DisplayName;
            rowHeader.className = 'pane-item-entry-name';
            this_1.headerKeys.push(template[h].Id);
            this_1.headerNames.push(template[h].DisplayName);
            var sortWrapper = document.createElement('span');
            rowHeader.appendChild(sortWrapper);
            var sortIcon = document.createElement('i');
            sortIcon.className = 'fas fa-sort bom-pane-sort-icon';
            sortWrapper.appendChild(sortIcon);
            rowHeader.onclick = function (e) {
                if (template[h].Id === 'Id' && sortIcon.className === 'fas fa-sort bom-pane-sort-icon') {
                    sortIcon.className = 'fas fa-sort-up bom-pane-sort-icon';
                    _this.sort(true, template[h].Id);
                }
                else if (sortIcon.className.indexOf('fa-sort-down') !== -1) {
                    sortIcon.className = 'fas fa-sort-up bom-pane-sort-icon';
                    _this.sort(true, template[h].Id);
                }
                else {
                    sortIcon.className = 'fas fa-sort-down bom-pane-sort-icon';
                    _this.sort(false, template[h].Id);
                }
            };
            this_1.tableHeaderRowEl.appendChild(rowHeader);
        };
        var this_1 = this;
        for (var h = 0; h < template.length; h++) {
            _loop_1(h);
        }
    };
    ClashPane.prototype.buildBody = function (rows) {
        if (!rows) {
            return;
        }
        this.rows = [];
        $(this.tableBodyEl).empty();
        var placeholderRow = document.createElement('tr');
        this.tableBodyEl.appendChild(placeholderRow);
        for (var r = 0; r < rows.length; r++) {
            this.buildRow(rows[r]);
        }
    };
    ClashPane.prototype.buildRow = function (row) {
        var _this = this;
        this.rows.push(row);
        var rowEl = document.createElement('tr');
        rowEl.className = 'pane-item';
        rowEl.id = 'CLASH_ROW_ID' + row['Id'];
        row.el = rowEl;
        rowEl.onclick = function (e) {
            _this.selectClashRow(row.Id);
        };
        this.tableBodyEl.appendChild(rowEl);
        for (var i = 0; i < this.headerKeys.length; i++) {
            var cellEl = document.createElement('td');
            cellEl.className = 'pane-item-entry-name';
            cellEl.textContent = row[this.headerKeys[i]];
            rowEl.appendChild(cellEl);
        }
    };
    ClashPane.prototype.selectClashRow = function (id) {
        var xml = '<Call Method="SelectClashIndex">';
        xml += '<Index>' + id + '</Index>';
        xml += '</Call>';
        this.selectedIndex = id;
        this.rows.forEach(function (item) {
            item.el.style.backgroundColor = item.Id === id ? 'rgb(160, 160, 160)' : 'white';
        });
        vsClient.command.executeXML(xml);
    };
    ClashPane.prototype.sort = function (asc, key) {
        var sortedRows = this.rows.sort(function (item1, item2) {
            var val1, val2;
            var preVal1 = item1[key] === '-' ? 0 : item1[key];
            var preVal2 = item2[key] === '-' ? 0 : item2[key];
            val2 = isNaN(parseFloat(preVal1)) ? preVal1.toUpperCase() : parseFloat(preVal2);
            val1 = isNaN(parseFloat(preVal1)) ? preVal2.toUpperCase() : parseFloat(preVal1);
            if (val1 > val2) {
                return asc ? 1 : -1;
            }
            else {
                return asc ? -1 : 1;
            }
        });
        this.buildBody(sortedRows);
    };
    ClashPane.prototype.buildDefaultHeader = function () {
        $(this.tableHeaderRowEl).empty();
        var idRow = document.createElement('th');
        idRow.textContent = ui.translate('ID_BOM_COLUMN_CALLOUT_ID');
        idRow.className = 'pane-item-entry-name';
        this.tableHeaderRowEl.appendChild(idRow);
        var nameRow = document.createElement('th');
        nameRow.textContent = ui.translate('ID_BOM_PARTNAME');
        nameRow.className = 'pane-item-entry-name';
        this.tableHeaderRowEl.appendChild(nameRow);
        var quantityRow = document.createElement('th');
        quantityRow.textContent = ui.translate('ID_BOM_QUANTITY');
        quantityRow.className = 'pane-item-entry-name';
        this.tableHeaderRowEl.appendChild(quantityRow);
    };
    ClashPane.prototype.changeLang = function (lang) {
        var _this = this;
        this.copyTooltip.setTitle(_lang_data['ID_COPY_TO_CLIPBOARD'][this.lang]);
        var GetClashPaneTemplate = "<Call Method=\"GetTemplate\"><Type>ClashPane</Type></Call>";
        vsClient.command.executeXML(GetClashPaneTemplate);
        vsClient.once('GetTemplate.ClashPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    ClashPane.prototype.addMethods = function () {
    };
    ClashPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.addMethods();
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.selectedIndex) {
                xml = '<Call Method="SelectClashIndex">';
                xml += '<Index>' + _this.selectedIndex + '</Index>';
                xml += '</Call>';
                vsClient.command.executeXML(xml);
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return ClashPane;
}(pane_template_1.PaneTemplate));
exports.ClashPane = ClashPane;


/***/ }),
/* 47 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var LogItem = (function () {
    function LogItem(parent, logInfo, selectCallback) {
        var _this = this;
        this.command = logInfo;
        this.handleClick = this.handleClick.bind(this);
        this.selectCallback = selectCallback;
        this.commandEl = document.createElement('div');
        this.commandEl.textContent = logInfo.msg;
        this.commandEl.className = 'command-log-item';
        this.commandEl.onclick = function (e) {
            _this.handleClick(e);
        };
        parent.appendChild(this.commandEl);
        if (logInfo.type === 'inbound') {
            $(this.commandEl).addClass('command-log-item-inbound');
        }
    }
    LogItem.prototype.handleClick = function (ev) {
        this.selectCallback(this.command, ev.ctrlKey, ev.shiftKey, this.commandEl);
    };
    return LogItem;
}());
exports.LogItem = LogItem;


/***/ }),
/* 48 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var copy = __webpack_require__(18);
var command_log_item_1 = __webpack_require__(47);
var pane_template_1 = __webpack_require__(1);
var widgets_1 = __webpack_require__(11);
var app_states_1 = __webpack_require__(4);
var CommandPane = (function (_super) {
    __extends(CommandPane, _super);
    function CommandPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.collectionInEdit = [];
        _this.log = [];
        _this.editIndex = 0;
        _this.selection = [];
        _this.dividerDelta = 0;
        _this.callDividerDelta = 0;
        _this.listTempHeight = 0;
        _this.detailsTempHeight = 0;
        _this.commandTempHeight = 0;
        _this.update = function (delta) {
            vsClient.emit('@logMousemove', (localStorage.getItem('WVLogMouseMove') !== 'false'));
            if (delta && delta !== 0) {
                var relDelta = delta / _this.boxWrapper.clientHeight * 100;
                var listDiff = relDelta > 0 ? Math.min(95 - _this.commandTempHeight, _this.listTempHeight + relDelta) : Math.max(5, _this.listTempHeight + relDelta);
                var detailDiff = relDelta > 0 ? Math.max(5, _this.detailsTempHeight - relDelta) : Math.min(95 - _this.commandTempHeight, _this.detailsTempHeight - relDelta);
                _this.listWrapper.style.height = listDiff + '%';
                _this.detailsWrapper.style.height = detailDiff + '%';
            }
        };
        _this.noAdapter = true;
        _this.state = {
            mousemove: localStorage.getItem('WVLogMouseMove') !== 'false',
            inbound: false,
            outbound: true,
            copySelection: 'copy selection',
            copyAll: 'copy all',
            stopInitialLogging: localStorage.getItem('WVStopInitialLogging') === 'true'
        };
        vsClient.emit('@logMousemove', (localStorage.getItem('WVLogMouseMove') !== 'false'));
        _this.el = document.createElement('div');
        _this.el.classList.add('pane-content');
        _this.el.style.overflow = 'hidden';
        _this.el.style.height = '100%';
        _this.wrapperEl.appendChild(_this.el);
        _this.headerButtons = document.createElement('div');
        _this.headerButtons.className = 'command-log-buttons-wrapper';
        _this.el.appendChild(_this.headerButtons);
        var respSwitch = new widgets_1.SingleSwitch(_this.headerButtons, 'Response', _this.state.inbound.toString(), _this.handleInboundCheck.bind(_this));
        var reqSwitch = new widgets_1.SingleSwitch(_this.headerButtons, 'Request', _this.state.outbound.toString(), _this.handleOutboundCheck.bind(_this));
        var logMouseSwitch = new widgets_1.SingleSwitch(_this.headerButtons, 'Log mouse', _this.state.mousemove.toString(), _this.handleLogMousemove.bind(_this));
        var initLogSwitch = new widgets_1.SingleSwitch(_this.headerButtons, 'Init log', _this.state.stopInitialLogging.toString(), _this.stopInitialLogging.bind(_this));
        _this.boxWrapper = document.createElement('div');
        _this.boxWrapper.className = 'command-pane-outter-wrapper';
        _this.el.appendChild(_this.boxWrapper);
        _this.listWrapper = document.createElement('div');
        _this.listWrapper.style.position = 'relative';
        _this.listWrapper.style.height = '35%';
        _this.listWrapper.className = 'command-log-list';
        _this.boxWrapper.appendChild(_this.listWrapper);
        _this.divider = document.createElement('div');
        _this.divider.className = 'horizontal-pane-divider';
        _this.boxWrapper.appendChild(_this.divider);
        _this.handleDividerDown = _this.handleDividerDown.bind(_this);
        _this.handleDividerMove = _this.handleDividerMove.bind(_this);
        _this.handleDividerUp = _this.handleDividerUp.bind(_this);
        _this.divider.addEventListener('mousedown', _this.handleDividerDown);
        $(_this.divider).kendoTouch({
            dragstart: function (e) {
                _this.dividerDelta = e.touch.y.location;
            },
            drag: function (e) {
                var delta = e.touch.y.location - _this.dividerDelta;
                _this.update(delta);
            },
            dragend: function (e) {
                _this.dividerDelta = 0;
            }
        });
        _this.detailsWrapper = document.createElement('div');
        _this.detailsWrapper.style.position = 'relative';
        _this.detailsWrapper.style.height = '35%';
        _this.boxWrapper.appendChild(_this.detailsWrapper);
        _this.detailsTabBar = document.createElement('div');
        _this.detailsTabBar.className = 'command-pane-details-tab-bar';
        _this.detailsWrapper.appendChild(_this.detailsTabBar);
        var detailsLabel = document.createElement('span');
        detailsLabel.textContent = 'Details';
        _this.detailsTabBar.appendChild(detailsLabel);
        _this.detailsList = document.createElement('div');
        _this.detailsList.id = 'command-pane-selection-view';
        _this.detailsList.className = 'command-log-list';
        _this.detailsList.style.height = 'calc(100% - 35px)';
        _this.detailsList.addEventListener('keydown', function (ev) {
            ev.stopPropagation();
        });
        _this.detailsList.addEventListener('focusin', function (ev) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
        });
        _this.detailsList.addEventListener('focusout', function (ev) {
            app_states_1.appStates.preventGlobalKeyEvents = false;
        });
        _this.detailsWrapper.appendChild(_this.detailsList);
        var upperButtons = document.createElement('div');
        upperButtons.className = 'command-log-buttons-wrapper';
        var requestButton = document.createElement('button');
        requestButton.textContent = 'Send';
        requestButton.className = 'command-log-footer-button';
        requestButton.onclick = function (e) {
            _this.handleSendRequests();
        };
        upperButtons.appendChild(requestButton);
        var clearButton = document.createElement('button');
        clearButton.textContent = 'Clear';
        clearButton.className = 'command-log-footer-button';
        clearButton.onclick = function (e) {
            _this.log = [];
            _this.collectionInEdit = [];
            $(_this.detailsList).empty();
            $(_this.listWrapper).empty();
            _this.editIndex = 0;
            _this.selection = [];
        };
        upperButtons.appendChild(clearButton);
        var copyButton = document.createElement('button');
        copyButton.textContent = 'Copy';
        copyButton.className = 'command-log-footer-button';
        copyButton.onclick = function (e) {
            _this.copyToClipboard();
        };
        upperButtons.appendChild(copyButton);
        var copyAllButton = document.createElement('button');
        copyAllButton.textContent = 'Copy all';
        copyAllButton.className = 'command-log-footer-button';
        copyAllButton.onclick = function (e) {
            _this.copyAll();
        };
        upperButtons.appendChild(copyAllButton);
        _this.detailsWrapper.appendChild(upperButtons);
        _this.callDivider = document.createElement('div');
        _this.callDivider.className = 'horizontal-pane-divider';
        _this.callDivider.style.position = 'relative';
        _this.callDivider.style.top = '5px';
        _this.boxWrapper.appendChild(_this.callDivider);
        _this.handleCallDividerDown = _this.handleCallDividerDown.bind(_this);
        _this.handleCallDividerMove = _this.handleCallDividerMove.bind(_this);
        _this.handleCallDividerUp = _this.handleCallDividerUp.bind(_this);
        _this.callDivider.addEventListener('mousedown', _this.handleCallDividerDown);
        $(_this.callDivider).kendoTouch({
            dragstart: function (e) {
                _this.callDividerDelta = e.touch.y.location;
            },
            drag: function (e) {
                var delta = e.touch.y.location - _this.callDividerDelta;
                _this.update(delta);
            },
            dragend: function (e) {
                _this.callDividerDelta = 0;
            }
        });
        _this.commandWrapper = document.createElement('div');
        _this.commandWrapper.style.position = 'relative';
        _this.commandWrapper.style.height = '30%';
        _this.boxWrapper.appendChild(_this.commandWrapper);
        var commandLineTabBar = document.createElement('div');
        commandLineTabBar.className = 'command-pane-details-tab-bar';
        commandLineTabBar.style.marginTop = '5px';
        _this.commandWrapper.appendChild(commandLineTabBar);
        var commandLineLabel = document.createElement('span');
        commandLineLabel.textContent = 'Custom Command';
        commandLineTabBar.appendChild(commandLineLabel);
        _this.commandInput = document.createElement('textarea');
        _this.commandInput.className = 'command-line-input';
        _this.commandInput.addEventListener('keydown', function (ev) {
            ev.stopPropagation();
        });
        _this.commandInput.addEventListener('focus', function (ev) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
        });
        _this.commandInput.addEventListener('blur', function (ev) {
            app_states_1.appStates.preventGlobalKeyEvents = false;
        });
        _this.commandWrapper.appendChild(_this.commandInput);
        var commandButtons = document.createElement('div');
        commandButtons.className = 'command-log-buttons-wrapper';
        var commandRequestButton = document.createElement('button');
        commandRequestButton.textContent = 'Send';
        commandRequestButton.className = 'command-log-footer-button';
        commandRequestButton.onclick = function (e) {
            _this.handleCommandSendRequest();
        };
        commandButtons.appendChild(commandRequestButton);
        var commandClearButton = document.createElement('button');
        commandClearButton.textContent = 'Clear';
        commandClearButton.className = 'command-log-footer-button';
        commandClearButton.onclick = function (e) {
            _this.commandInput.value = '';
        };
        commandButtons.appendChild(commandClearButton);
        _this.el.appendChild(commandButtons);
        return _this;
    }
    CommandPane.prototype.changeLang = function () {
    };
    CommandPane.prototype.addMethods = function () {
    };
    CommandPane.prototype.handleDividerDown = function (e) {
        e.preventDefault();
        this.dividerDelta = e.pageY;
        this.listTempHeight = parseFloat(this.listWrapper.style.height.replace('%', ''));
        this.detailsTempHeight = parseFloat(this.detailsWrapper.style.height.replace('%', ''));
        this.commandTempHeight = parseFloat(this.commandWrapper.style.height.replace('%', ''));
        document.addEventListener('mousemove', this.handleDividerMove);
        document.addEventListener('mouseup', this.handleDividerUp);
    };
    CommandPane.prototype.handleDividerMove = function (e) {
        var delta = e.pageY - this.dividerDelta;
        this.update(delta);
    };
    CommandPane.prototype.handleDividerUp = function (e) {
        this.dividerDelta = 0;
        document.removeEventListener('mousemove', this.handleDividerMove);
        document.removeEventListener('mouseup', this.handleDividerUp);
    };
    CommandPane.prototype.handleCallDividerDown = function (e) {
        e.preventDefault();
        this.callDividerDelta = e.pageY;
        this.listTempHeight = parseFloat(this.listWrapper.style.height.replace('%', ''));
        this.detailsTempHeight = parseFloat(this.detailsWrapper.style.height.replace('%', ''));
        this.commandTempHeight = parseFloat(this.commandWrapper.style.height.replace('%', ''));
        document.addEventListener('mousemove', this.handleCallDividerMove);
        document.addEventListener('mouseup', this.handleCallDividerUp);
    };
    CommandPane.prototype.handleCallDividerMove = function (e) {
        var delta = e.pageY - this.callDividerDelta;
        this.updateCallInput(delta);
    };
    CommandPane.prototype.handleCallDividerUp = function (e) {
        this.callDividerDelta = 0;
        document.removeEventListener('mousemove', this.handleCallDividerMove);
        document.removeEventListener('mouseup', this.handleCallDividerUp);
    };
    CommandPane.prototype.updateCallInput = function (delta) {
        if (delta !== 0) {
            var relDelta = delta / this.boxWrapper.clientHeight * 100;
            var listDiff = Math.max(5, this.listTempHeight + (relDelta / 2));
            var detailsDiff = Math.max(5, this.detailsTempHeight + (relDelta / 2));
            listDiff = detailsDiff !== 5 ? listDiff : Math.max(5, this.listTempHeight + (relDelta / 2) - Math.abs(5 + (relDelta / 2)));
            detailsDiff = listDiff !== 5 ? detailsDiff : Math.max(5, this.detailsTempHeight + (relDelta / 2) - Math.abs(5 + (relDelta / 2)));
            var diff = Math.max(100 - listDiff - detailsDiff, 5);
            if (listDiff === 5 && detailsDiff === 5 || listDiff + detailsDiff + diff > 100) {
                return;
            }
            this.commandWrapper.style.height = diff + '%';
            this.listWrapper.style.height = listDiff + '%';
            this.detailsWrapper.style.height = detailsDiff + '%';
        }
    };
    CommandPane.prototype.handleSelectItem = function (command, add, range, selectedCommand) {
        var _this = this;
        if (!add && !range) {
            this.collectionInEdit = [];
            $(this.detailsList).empty();
            this.editIndex = 0;
            this.selection = [];
        }
        ;
        var selectionEl = document.createElement('pre');
        selectionEl.contentEditable = command.type === 'outbound' ? 'true' : 'false';
        selectionEl.textContent = command.msg;
        selectionEl.style.borderBottom = '1px solid black';
        selectionEl.style.paddingBottom = '15px';
        var index = this.editIndex;
        this.selection.push(command);
        selectionEl.onblur = function (e) {
            _this.handleEditChange(index, e);
        };
        this.detailsList.appendChild(selectionEl);
        this.editIndex++;
        $('.command-log-item').each(function () {
            $(this).removeClass('command-log-item-active');
        });
        $(selectedCommand).addClass('command-log-item-active');
    };
    CommandPane.prototype.handleLogMousemove = function (ev) {
        var logMouseMove = ev === 'true';
        localStorage.setItem('WVLogMouseMove', logMouseMove.toString());
        this.state.mousemove = logMouseMove;
        vsClient.emit('@logMousemove', logMouseMove);
        this.listWrapper.scrollTop = this.listWrapper.scrollHeight;
    };
    CommandPane.prototype.handleInboundCheck = function (ev) {
        this.state.inbound = ev === 'true';
        this.updateLog();
        this.listWrapper.scrollTop = this.listWrapper.scrollHeight;
    };
    CommandPane.prototype.handleOutboundCheck = function (ev) {
        this.state.outbound = ev === 'true';
        this.updateLog();
        this.listWrapper.scrollTop = this.listWrapper.scrollHeight;
    };
    CommandPane.prototype.stopInitialLogging = function (ev) {
        var initLog = $(ev.target).parent().children().first().val() === 'true';
        localStorage.setItem('WVStopInitialLogging', initLog.toString());
        this.state.stopInitialLogging = initLog;
    };
    CommandPane.prototype.copyToClipboard = function () {
        var _this = this;
        var toCopy = this.selection.map(function (l) {
            return l.msg;
        });
        copy(toCopy.join('\n'));
        this.state.copySelection = 'copied!!!';
        setTimeout(function (_) { return _this.state.copySelection = 'copy selection'; }, 1200);
    };
    CommandPane.prototype.copyAll = function () {
        var _this = this;
        var toCopy = this.log
            .filter(function (l) {
            var show = (l.type == 'inbound' && _this.state.inbound)
                || (l.type == 'outbound' && _this.state.outbound);
            return show;
        })
            .map(function (l) {
            return l.msg;
        });
        copy(toCopy.join('\n'));
        this.state.copyAll = 'copied!!!';
        setTimeout(function (_) { return _this.state.copyAll = 'copy all'; }, 1200);
    };
    CommandPane.prototype.handleCommandSendRequest = function () {
        vsClient.command.executeXML(this.commandInput.value);
    };
    CommandPane.prototype.handleSendRequests = function () {
        var collectionCopy = JSON.parse(JSON.stringify(this.selection));
        this.collectionInEdit.forEach(function (_a) {
            var i = _a[0], content = _a[1];
            collectionCopy[i].msg = content;
        });
        var requestsToSend = collectionCopy.filter(function (l) { return l.type === 'outbound'; }).forEach(function (l) {
            vsClient.command.executeXML(l.msg);
        });
    };
    CommandPane.prototype.handleEditChange = function (collectionIdx, ev) {
        var _this = this;
        if (this.collectionInEdit.some(function (_a) {
            var i = _a[0], c = _a[1];
            return (i == collectionIdx);
        })) {
            this.collectionInEdit.forEach(function (_a, idx) {
                var i = _a[0], c = _a[1];
                if (collectionIdx == i) {
                    _this.collectionInEdit[idx][1] = ev.target.textContent;
                }
            });
        }
        else {
            this.collectionInEdit.push([collectionIdx, ev.target.textContent]);
        }
    };
    CommandPane.prototype.addCommand = function (command) {
        if (command.msg.indexOf('Method="MouseMove"') !== -1 && !this.state.mousemove) {
            return;
        }
        var startIndex = command.msg.indexOf('>');
        var endIndex = command.msg.lastIndexOf('<');
        command.msg = command.msg.substring(startIndex + 1, endIndex);
        this.log.push(command);
        if ((command.type === 'outbound' && this.state.outbound) || (command.type === 'inbound' && this.state.inbound)) {
            var newItem = new command_log_item_1.LogItem(this.listWrapper, command, this.handleSelectItem.bind(this));
        }
        this.listWrapper.scrollTop = this.listWrapper.scrollHeight;
    };
    CommandPane.prototype.updateLog = function () {
        $(this.listWrapper).empty();
        var logLength = this.log.length;
        for (var i = 0; i < logLength; i++) {
            var log = this.log[i];
            var showLog = ((log.type == 'inbound' && this.state.inbound)
                || (log.type == 'outbound' && this.state.outbound)) && (this.state.mousemove || log.msg.indexOf('MouseMove') === -1);
            if (showLog) {
                var newItem = new command_log_item_1.LogItem(this.listWrapper, log, this.handleSelectItem.bind(this));
            }
        }
    };
    return CommandPane;
}(pane_template_1.PaneTemplate));
exports.CommandPane = CommandPane;


/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var DistortionPane = (function (_super) {
    __extends(DistortionPane, _super);
    function DistortionPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    DistortionPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetDistortionPaneTemplate = "<Call Method=\"GetTemplate\"><Type>DistortionPane</Type></Call>";
        vsClient.command.executeXML(GetDistortionPaneTemplate);
        vsClient.once('GetTemplate.DistortionPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    DistortionPane.prototype.addMethods = function () {
        $("#wv-distortion #OnDistortionApplyClicked").click(function (ev) {
            var xml = '<Call Method="Compute"><Mode>Distortion</Mode></Call>';
            vsClient.command.executeXMLAsync(xml);
        });
    };
    DistortionPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.addMethods();
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return DistortionPane;
}(pane_template_1.PaneTemplate));
exports.DistortionPane = DistortionPane;


/***/ }),
/* 50 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var DraftAnglePane = (function (_super) {
    __extends(DraftAnglePane, _super);
    function DraftAnglePane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    DraftAnglePane.prototype.addMethods = function () {
        $("#wv-draftangle #OnDraftAngleAlignmentXClicked").click(function (ev) {
            var xml = '<Call Method="SetDraftVector">';
            xml += '<Direction>X</Direction>';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-draftangle #OnDraftAngleAlignmentYClicked").click(function (ev) {
            var xml = '<Call Method="SetDraftVector">';
            xml += '<Direction>Y</Direction>';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-draftangle #OnDraftAngleAlignmentZClicked").click(function (ev) {
            var xml = '<Call Method="SetDraftVector">';
            xml += '<Direction>Z</Direction>';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-draftangle #OnDraftAngleAlignmentReverseClicked").click(function (ev) {
            var xml = '<Call Method="RevertDraftVector" />';
            vsClient.command.executeXML(xml);
        });
    };
    DraftAnglePane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetDraftAnglePaneTemplate = "<Call Method=\"GetTemplate\"><Type>DraftAnglePane</Type></Call>";
        vsClient.command.executeXML(GetDraftAnglePaneTemplate);
        vsClient.once('GetTemplate.DraftAnglePane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    DraftAnglePane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            if ((path.indexOf('Angle1') !== -1 && value < 0) || (path.indexOf('Angle2') !== -1 && value > 0) || path.indexOf('Tolerance') !== -1 && value < 0) {
                value *= -1;
            }
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return DraftAnglePane;
}(pane_template_1.PaneTemplate));
exports.DraftAnglePane = DraftAnglePane;


/***/ }),
/* 51 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var DrillholePane = (function (_super) {
    __extends(DrillholePane, _super);
    function DrillholePane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    DrillholePane.prototype.addMethods = function () {
        $("#wv-drillhole #OnDrillHoleComputeClicked").click(function (ev) {
            var xml = '<Call Method="Compute"><Mode>Drillhole</Mode></Call>';
            vsClient.command.executeXML(xml);
        });
    };
    DrillholePane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetDrillholePanePaneTemplate = "<Call Method=\"GetTemplate\"><Type>DrillholePane</Type></Call>";
        vsClient.command.executeXML(GetDrillholePanePaneTemplate);
        vsClient.once('GetTemplate.DrillholePane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    DrillholePane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return DrillholePane;
}(pane_template_1.PaneTemplate));
exports.DrillholePane = DrillholePane;


/***/ }),
/* 52 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var ExactComparePane = (function (_super) {
    __extends(ExactComparePane, _super);
    function ExactComparePane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    ExactComparePane.prototype.addMethods = function () {
        $("#wv-exactcompare #OnExactCompareComputeClicked").click(function (ev) {
            var xml = '<Call Method="ComputeBrepCompare"></Call>';
            vsClient.command.executeXMLAsync(xml);
        });
    };
    ExactComparePane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetExactComparePaneTemplate = "<Call Method=\"GetTemplate\"><Type>ExactComparePane</Type></Call>";
        vsClient.command.executeXML(GetExactComparePaneTemplate);
        vsClient.once('GetTemplate.ExactComparePane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    ExactComparePane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return ExactComparePane;
}(pane_template_1.PaneTemplate));
exports.ExactComparePane = ExactComparePane;


/***/ }),
/* 53 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var widgets_1 = __webpack_require__(11);
var app_states_1 = __webpack_require__(4);
var ExplodePane = (function (_super) {
    __extends(ExplodePane, _super);
    function ExplodePane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.explodeDistance = 0;
        _this.explodeStep = 0;
        _this.maxExplodeSteps = 0;
        _this.explodeType = 'AxisAligned';
        _this.nodeLevel = 0;
        _this.isHierarchically = false;
        _this.update = function (response) {
            _this.values = {
                Event: response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        var tableEl = document.createElement('table');
        tableEl.className = 'pane-content';
        _this.wrapperEl.appendChild(tableEl);
        _this.tableBodyEl = document.createElement('tbody');
        tableEl.appendChild(_this.tableBodyEl);
        var placeholderRow = document.createElement('tr');
        _this.tableBodyEl.appendChild(placeholderRow);
        _this.wrapperEl.appendChild(tableEl);
        _this.explodeGroupEl = new widgets_1.PlainGroup(1, _this.tableBodyEl, 'ID_TRANSFORM_PANE_EXPLODE', 'ID_TRANSFORM_PANE_EXPLODE_INFO');
        _this.explodeSliderEl = new widgets_1.PlainSlider(2, _this.tableBodyEl, 'ID_TRANSFORM_PANE_EXPLODE_LEVEL', 'ID_TRANSFORM_PANE_EXPLODE_LEVEL_INFO', _this.explode.bind(_this));
        _this.explodeSteppedSliderEl = new widgets_1.PlainSteppedSlider(2, _this.tableBodyEl, 'ID_TRANSFORM_PANE_EXPLODE_LEVEL', 'ID_TRANSFORM_PANE_EXPLODE_LEVEL_INFO', _this.explodeStepped.bind(_this));
        _this.explodeSliderEl.setVal(0);
        _this.explodeSteppedSliderEl.hide();
        _this.isHierarchicallyEl = new widgets_1.PlainSwitch(2, _this.tableBodyEl, 'ID_TRANSFORM_PANE_EXPLODE_HIERARCHY', 'ID_TRANSFORM_PANE_EXPLODE_HIERARCHY_INFO', _this.setHierarchically.bind(_this));
        _this.explodeTypeEl = new widgets_1.PlainSelect(2, _this.tableBodyEl, 'ID_EXPLOSION_TYPE', 'ID_EXPLOSION_TYPE_INFO', _this.setExplodeType.bind(_this));
        _this.setTypeOptions();
        _this.explodeLevelEl = new widgets_1.PlainInput(2, _this.tableBodyEl, 'ID_EXPLOSION_NODE_LEVEL', 'ID_EXPLOSION_NODE_LEVEL_INFO', 'false', _this.setLevel.bind(_this));
        _this.nextLevelButtonEl = new widgets_1.PlainButton(2, _this.tableBodyEl, 'ID_EXPLOSION_NEXT_LEVEL', 'ID_EXPLOSION_NEXT_LEVEL_INFO', 'ID_EXPLOSION_NEXT_LEVEL', _this.nextLevel.bind(_this));
        _this.prevLevelButtonEl = new widgets_1.PlainButton(2, _this.tableBodyEl, 'ID_EXPLOSION_PREVIOUS_LEVEL', 'ID_EXPLOSION_PREVIOUS_LEVEL_INFO', 'ID_EXPLOSION_PREVIOUS_LEVEL', _this.prevLevel.bind(_this));
        _this.resetExplosionButtonEl = new widgets_1.PlainButton(2, _this.tableBodyEl, 'ID_EXPLOSION_RESET', 'ID_EXPLOSION_RESET_INFO', 'ID_EXPLOSION_RESET', _this.resetExplosion.bind(_this));
        _this.explodeGroupEl.children.push(_this.isHierarchicallyEl.wrapperEl, _this.explodeTypeEl.wrapperEl, _this.explodeLevelEl.wrapperEl, _this.explodeLevelEl.wrapperEl, _this.nextLevelButtonEl.wrapperEl, _this.prevLevelButtonEl.wrapperEl, _this.resetExplosionButtonEl.wrapperEl, _this.explodeSliderEl.wrapperEl);
        _this.wrapperEl.appendChild(_this.el);
        vsClient.on('GetSelectionNodeLevel', function (res) {
            _this.nodeLevel = res.Level;
            _this.explodeLevelEl.setVal(_this.nodeLevel);
        });
        vsClient.on('SelectionChanged', function (res) {
            if (_this.stack && _this.stack.isVisible) {
                var xml = '<Call Method="GetSelectionExplosionValue"></Call>';
                xml += '<Call Method="GetSelectionNodeLevel"></Call>';
                vsClient.command.executeXML(xml);
            }
        });
        vsClient.on('GetSelectionExplosionValue', function (res) {
            _this.explodeSliderEl.setVal(res.Result / 100);
        });
        return _this;
    }
    ExplodePane.prototype.setExplodeType = function (type) {
        this.explodeType = type;
        if (!this.isHierarchically) {
            this.explode(this.explodeDistance);
        }
        else {
            this.explodeStepped(this.explodeStep);
        }
    };
    ExplodePane.prototype.setHierarchically = function (isHierarchically) {
        this.isHierarchically = isHierarchically;
        this.explodeGroupEl.children.pop();
        if (isHierarchically) {
            this.explodeSliderEl.hide();
            this.explodeSteppedSliderEl.show();
            this.explodeGroupEl.children.push(this.explodeSteppedSliderEl.wrapperEl);
        }
        else {
            this.explodeSliderEl.show();
            this.explodeSteppedSliderEl.hide();
            this.explodeGroupEl.children.push(this.explodeSliderEl.wrapperEl);
        }
        this.explodeSliderEl.setVal(0);
        this.explodeSteppedSliderEl.setVal(0);
    };
    ExplodePane.prototype.setLevel = function () {
    };
    ExplodePane.prototype.nextLevel = function () {
        var xml = '<Call Method="SelectNextExplosionLevel"></Call>';
        vsClient.command.executeXML(xml);
        var getLevelCall = '<Call Method="GetSelectionNodeLevel"></Call>';
        vsClient.command.executeXML(getLevelCall);
    };
    ExplodePane.prototype.prevLevel = function () {
        var xml = '<Call Method="SelectPreviousExplosionLevel"></Call>';
        vsClient.command.executeXML(xml);
        var getLevelCall = '<Call Method="GetSelectionNodeLevel"></Call>';
        vsClient.command.executeXML(getLevelCall);
    };
    ExplodePane.prototype.resetExplosion = function () {
        var xml = '<Call Method="ResetExplosion"></Call>';
        vsClient.command.executeXML(xml);
        var getLevelCall = '<Call Method="GetSelectionNodeLevel"></Call>';
        vsClient.command.executeXML(getLevelCall);
    };
    ExplodePane.prototype.setTypeOptions = function () {
        this.explodeTypeEl.clearOptions();
        var coordinateAxisOption = {
            isDefault: true,
            name: ui.translate('ID_EXPLOSION_TYPE_AXES_ALIGNED'),
            val: 'AxisAligned',
        };
        var sphericalOption = {
            isDefault: false,
            name: ui.translate('ID_EXPLOSION_TYPE_SPHERICAL'),
            val: 'Spherical',
        };
        var xAxisOption = {
            isDefault: false,
            name: ui.translate('ID_EXPLOSION_TYPE_X_AXIS'),
            val: 'AxisX',
        };
        var yAxisOption = {
            isDefault: false,
            name: ui.translate('ID_EXPLOSION_TYPE_Y_AXIS'),
            val: 'AxisY',
        };
        var zAxisOption = {
            isDefault: false,
            name: ui.translate('ID_EXPLOSION_TYPE_Z_AXIS'),
            val: 'AxisZ',
        };
        var radialXYOption = {
            isDefault: false,
            name: ui.translate('ID_EXPLOSION_TYPE_RADIAL_XY'),
            val: 'RadialXY',
        };
        var radialYZOption = {
            isDefault: false,
            name: ui.translate('ID_EXPLOSION_TYPE_RADIAL_YZ'),
            val: 'RadialYZ',
        };
        var radialZXOption = {
            isDefault: false,
            name: ui.translate('ID_EXPLOSION_TYPE_RADIAL_ZX'),
            val: 'RadialZX',
        };
        this.explodeTypeEl.addOptions([coordinateAxisOption, sphericalOption, xAxisOption, yAxisOption, zAxisOption, radialXYOption, radialYZOption, radialZXOption]);
    };
    ExplodePane.prototype.explode = function (value) {
        var xml = '<Call Method="ExplodeByDistance"><Position>' + (Math.round(value * 100)) + '</Position>';
        xml += '<ExplosionType>' + this.explodeType + '</ExplosionType></Call>';
        vsClient.command.executeXML(xml);
        this.explodeDistance = value;
        this.explodeStep = 0;
        this.explodeSteppedSliderEl.setVal(0);
    };
    ExplodePane.prototype.explodeStepped = function (value) {
        var _this = this;
        var xml = '<Call Method="GetMaxTreeDepth"></Call>';
        vsClient.command.executeXML(xml);
        vsClient.once('GetMaxTreeDepth', function (res) {
            if (res && res.MaxDepth) {
                _this.explodeSteppedSliderEl.setMaxSteps(res.MaxDepth);
                _this.maxExplodeSteps = parseInt(res.MaxDepth);
                var xml_1 = '<Call Method="ExplodeHierarchically"><Level>' + value + '</Level>';
                xml_1 += '<ExplosionType>' + _this.explodeType + '</ExplosionType></Call>';
                vsClient.command.executeXML(xml_1);
                _this.explodeSliderEl.setVal(1);
                _this.explodeDistance = 1;
                _this.explodeStep = value;
            }
        });
    };
    ExplodePane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetExplodePaneTemplate = '<Call Method="GetTemplate"><Type>ExplodePane</Type></Call>';
        vsClient.command.executeXML(GetExplodePaneTemplate);
        vsClient.once('GetTemplate.ExplodePane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
            _this.setTypeOptions();
        });
    };
    ExplodePane.prototype.addMethods = function () {
        var _this = this;
        if (app_states_1.appStates.fileLoaded) {
            var xml = '<Call Method="GetMaxTreeDepth"></Call>';
            vsClient.command.executeXML(xml);
            vsClient.once('GetMaxTreeDepth', function (res) {
                if (res && res.MaxDepth) {
                    _this.explodeSteppedSliderEl.setMaxSteps(res.MaxDepth);
                    _this.maxExplodeSteps = parseInt(res.MaxDepth);
                }
            });
        }
    };
    ExplodePane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.addMethods();
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return ExplodePane;
}(pane_template_1.PaneTemplate));
exports.ExplodePane = ExplodePane;


/***/ }),
/* 54 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var pane_template_1 = __webpack_require__(1);
var tinycolor = __webpack_require__(16);
var XMLParser = __webpack_require__(3);
var FilterPane = (function (_super) {
    __extends(FilterPane, _super);
    function FilterPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.filterList = [];
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
            if (!$('#UID_SEARCH_BY_STRING_TEXT').text() || $('#UID_SEARCH_BY_STRING_TEXT').text() === '') {
                $('#UID_SEARCH_BY_STRING_TEXT').text('Name="**" + Content="" + Type="ProductOccurrence" + Color="RGB" + CustomId="" + "<AttributeName>"=""');
            }
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        _this.resultTable = document.createElement('table');
        _this.resultTable.className = 'pane-content';
        _this.wrapperEl.appendChild(_this.resultTable);
        var tableHeader = document.createElement('thead');
        _this.resultTable.appendChild(tableHeader);
        var tableHeaderRow = document.createElement('tr');
        tableHeaderRow.className = 'pane-item';
        tableHeader.appendChild(tableHeaderRow);
        var colorHeader = document.createElement('th');
        colorHeader.className = 'filter-pane-table-header';
        tableHeaderRow.appendChild(colorHeader);
        _this.colorHeaderTextEl = document.createElement('span');
        _this.colorHeaderTextEl.textContent = ui.translate('ID_COLOR');
        colorHeader.appendChild(_this.colorHeaderTextEl);
        var colorHeaderIcon = document.createElement('i');
        colorHeaderIcon.className = 'far fa-sort filter-pane-sort-icon';
        colorHeader.appendChild(colorHeaderIcon);
        var colorSortOrderAsc = false;
        colorHeader.onclick = function (e) {
            if (colorSortOrderAsc) {
                colorSortOrderAsc = false;
                colorHeaderIcon.className = 'fa fa-sort-up filter-pane-sort-icon';
            }
            else {
                colorSortOrderAsc = true;
                colorHeaderIcon.className = 'fa fa-sort-down filter-pane-sort-icon';
            }
            _this.filterList.sort(function (a, b) {
                var val1 = tinycolor(a['Color']).toHsv().h;
                var val2 = tinycolor(b['Color']).toHsv().h;
                return _this.sort(val1, val2, !colorSortOrderAsc);
            });
            _this.buildColorTable();
        };
        var countHeader = document.createElement('th');
        countHeader.className = 'filter-pane-table-header';
        tableHeaderRow.appendChild(countHeader);
        _this.countHeaderTextEl = document.createElement('span');
        _this.countHeaderTextEl.textContent = ui.translate('ID_BOM_QUANTITY');
        countHeader.appendChild(_this.countHeaderTextEl);
        var countHeaderIcon = document.createElement('i');
        countHeaderIcon.className = 'far fa-sort filter-pane-sort-icon';
        countHeader.appendChild(countHeaderIcon);
        var countSortOrderAsc = true;
        countHeader.onclick = function (e) {
            if (countSortOrderAsc) {
                countSortOrderAsc = false;
                countHeaderIcon.className = 'fa fa-sort-up filter-pane-sort-icon';
            }
            else {
                countSortOrderAsc = true;
                countHeaderIcon.className = 'fa fa-sort-down filter-pane-sort-icon';
            }
            _this.filterList.sort(function (a, b) {
                var val1 = a['Quantity'];
                var val2 = b['Quantity'];
                return _this.sort(val1, val2, !countSortOrderAsc);
            });
            _this.buildColorTable();
        };
        _this.tableBody = document.createElement('tbody');
        _this.resultTable.appendChild(_this.tableBody);
        $(_this.resultTable).hide();
        vsClient.on('@OpenedFile', function () {
            _this.removeOldResults();
        });
        vsClient.on('ComputeColorList', function () {
            var xml = '<Call Method="GetAllGeometryColors">';
            xml += '<IncludeHiddenGeometries>' + _this.values['Settings'].Scene.Tools.Search.IncludeHiddenGeometries + '</IncludeHiddenGeometries>';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
            vsClient.once('GetAllGeometryColors', function (response) {
                _this.filterList = response.Result;
                _this.buildColorTable();
            });
        });
        _this.el.addEventListener('contextmenu', function (ev) {
            _this.handleContextMenu(ev);
        });
        _this.resultTable.addEventListener('contextmenu', function (ev) {
            _this.handleContextMenu(ev);
        });
        return _this;
    }
    FilterPane.prototype.handleContextMenu = function (ev) {
        ev.preventDefault();
        $('#contextMenu').remove();
        $(document).off('mousedown', vsClient.vsCanvas.closeContextMenu);
        $(document).off('keyup', vsClient.vsCanvas.closeContextMenu);
        vsClient.vsCanvas.createContextMenu(ev);
    };
    FilterPane.prototype.sort = function (val1, val2, sortAsc) {
        return sortAsc ? (val1 >= val2 ? 1 : -1) : (val2 >= val1 ? 1 : -1);
    };
    FilterPane.prototype.buildColorTable = function () {
        var _this = this;
        $(this.resultTable).show();
        this.removeOldResults();
        this.resultHeader = document.createElement('tr');
        this.resultHeader.className = 'pane-item';
        var resultHeaderWrapper = document.createElement('td');
        resultHeaderWrapper.className = 'pane-item-visual pane-item-group pane-item-indent-level1';
        resultHeaderWrapper.colSpan = 2;
        var resultTitle = document.createElement('span');
        resultTitle.textContent = '';
        resultHeaderWrapper.appendChild(resultTitle);
        this.resultHeader.appendChild(resultHeaderWrapper);
        this.tableBody.appendChild(this.resultHeader);
        var res = this.filterList;
        for (var i = 0; i < res.length; i++) {
            var resultRow = document.createElement('tr');
            resultRow.className = 'pane-item color-search-result-row';
            resultRow.id = 'ColorSearchResult_' + res[i].Color.replace('#', "");
            var resultColorWrapper = document.createElement('td');
            resultColorWrapper.className = 'pane-item-entry-name pane-item-indent-level2';
            var resultColorDiv = document.createElement('div');
            resultColorDiv.className = 'pane-item-entry-wrapper';
            var resultColor = document.createElement('span');
            resultColor.className = 'pane-item-entry-colorpicker';
            resultColor.style.listStyle = 'none';
            var color = '#' + res[i].Color.slice(3);
            resultColor.textContent = color;
            resultColor.style.backgroundColor = color;
            resultColor.style.textAlign = 'center';
            var rgb = color.substr(1);
            var int = parseInt(rgb, 16);
            var r = ((int >> 16) & 255) / 255;
            var g = ((int >> 8) & 255) / 255;
            var b = (int & 255) / 255;
            var rgbArr = [r, g, b];
            for (var j = 0; j < rgbArr.length; j++)
                ;
            {
                if (rgbArr[j] <= 0.03928) {
                    rgbArr[j] = rgbArr[j] / 12.92;
                }
                else {
                    rgbArr[j] = Math.pow((rgbArr[j] + 0.055) / 1.055, 2.4);
                }
            }
            var luminance = 0.2126 * rgbArr[0] + 0.7152 * rgbArr[1] + 0.0722 * rgbArr[2];
            var fontColor = (luminance > 0.179) ? 'black' : 'white';
            resultColor.style.color = fontColor;
            $(resultColor).mousedown(function (e) {
                var xml = '<Call Method="SearchNodes">';
                xml += '<Color>' + e.target.textContent + '</Color>';
                xml += '<SelectionMode>Select</SelectionMode>';
                xml += '<IncludeHiddenGeometries>' + _this.values['Settings'].Scene.Tools.Search.IncludeHiddenGeometries + '</IncludeHiddenGeometries>';
                xml += '</Call>';
                vsClient.command.executeXML(xml);
            });
            resultColorDiv.appendChild(resultColor);
            resultColorWrapper.appendChild(resultColorDiv);
            resultRow.appendChild(resultColorWrapper);
            var resultCountWrapper = document.createElement('td');
            resultCountWrapper.className = 'pane-item-visual';
            var resultCountDiv = document.createElement('div');
            resultCountDiv.className = 'pane-item-entry-wrapper';
            var resultCount = document.createElement('input');
            resultCount.className = 'pane-item-entry-input';
            resultCount.disabled = true;
            resultCount.value = res[i].Quantity;
            resultCountDiv.appendChild(resultCount);
            resultCountWrapper.appendChild(resultCountDiv);
            resultRow.appendChild(resultCountWrapper);
            this.tableBody.appendChild(resultRow);
        }
    };
    FilterPane.prototype.removeOldResults = function () {
        if (this.resultHeader) {
            $(this.resultHeader).remove();
            $('.color-search-result-row').each(function () {
                $(this).remove();
            });
        }
    };
    FilterPane.prototype.searchNodesByAttribute = function (attribute, value) {
        var searchString = '"' + attribute + '"' + '="' + value + '"';
        this.searchNodes(searchString);
    };
    FilterPane.prototype.searchNodesByName = function (name) {
        var searchString = 'Name' + '="' + name + '"';
        this.searchNodes(searchString);
    };
    FilterPane.prototype.searchNodes = function (searchString) {
        var xml = '<Call Method="SearchNodes">';
        xml += '<SearchString>' + searchString + '</SearchString>';
        xml += '<SelectionMode>Select</SelectionMode>';
        xml += '<IncludeHiddenGeometries>' + this.values['Settings'].Scene.Tools.Search.IncludeHiddenGeometries + '</IncludeHiddenGeometries>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
    };
    FilterPane.prototype.addMethods = function () {
        var _this = this;
        $("#wv-filter #OnFilterSearchByNameClicked").click(function (ev) {
            var name = $('#UID_SEARCH_BY_NAME_TEXT').text();
            if (name && name !== "" && name !== null) {
                _this.searchNodesByName(name);
            }
        });
        $("#wv-filter #OnFilterSearchByAttributeClicked").click(function (ev) {
            var attribute = $('#UID_SEARCH_BY_ATTRIBUTE_NAME').text();
            var value = $('#UID_SEARCH_BY_ATTRIBUTE_VALUE').text();
            _this.searchNodesByAttribute(attribute, value);
        });
        $("#wv-filter #OnFilterSearchByStringClicked").click(function (ev) {
            var searchString = $('#UID_SEARCH_BY_STRING_TEXT').text();
            if (searchString && searchString !== "" && searchString !== null) {
                _this.searchNodes(searchString);
            }
        });
        $("#wv-filter #OnFilterColorListClicked").click(function (ev) {
            vsClient.emit('ComputeColorList');
        });
    };
    FilterPane.prototype.changeLang = function (lang) {
        var _this = this;
        this.countHeaderTextEl.textContent = ui.translate('ID_BOM_QUANTITY');
        this.colorHeaderTextEl.textContent = ui.translate('ID_COLOR');
        var GetFilterPaneTemplate = "<Call Method=\"GetTemplate\"><Type>FilterPane</Type></Call>";
        vsClient.command.executeXML(GetFilterPaneTemplate);
        vsClient.once('GetTemplate.FilterPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
        $('#UID_SEARCH_BY_STRING_TEXT').text('Name="**" + Content="" + Type="ProductOccurrence" + Color="RGB" + CustomId="" + "<AttributeName>"=""');
    };
    FilterPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
        $('#UID_SEARCH_BY_STRING_TEXT').text('Name="**" + Content="" + Type="ProductOccurrence" + Color="RGB" + CustomId="" + "<AttributeName>"=""');
    };
    return FilterPane;
}(pane_template_1.PaneTemplate));
exports.FilterPane = FilterPane;


/***/ }),
/* 55 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ribbonMenu = __webpack_require__(13);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var FlyThroughPane = (function (_super) {
    __extends(FlyThroughPane, _super);
    function FlyThroughPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    FlyThroughPane.prototype.addMethods = function () {
        $("#wv-flythrough #OnFlyThroughSetNewCameraPositionClicked").click(function (ev) {
            ribbonMenu.handleActivateInteraction(vsClient, 'Flythrough_SelectStartPositionAndDirection');
        });
    };
    FlyThroughPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetFlyThroughPaneTemplate = "<Call Method=\"GetTemplate\"><Type>FlyThroughPane</Type></Call>";
        vsClient.command.executeXML(GetFlyThroughPaneTemplate);
        vsClient.once('GetTemplate.FlyThroughPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    FlyThroughPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return FlyThroughPane;
}(pane_template_1.PaneTemplate));
exports.FlyThroughPane = FlyThroughPane;


/***/ }),
/* 56 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var GeometryToolsPane = (function (_super) {
    __extends(GeometryToolsPane, _super);
    function GeometryToolsPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    GeometryToolsPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetGeometryToolsPaneTemplate = "<Call Method=\"GetTemplate\"><Type>GeometryToolsPane</Type></Call>";
        vsClient.command.executeXML(GetGeometryToolsPaneTemplate);
        vsClient.once('GetTemplate.GeometryToolsPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    GeometryToolsPane.prototype.addMethods = function () {
        $("#wv-geometry-tools #OnOptimizeInstancesClicked").click(function (ev) {
            var xml = '<Call Method="OptimizeIdenticalInstances"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnFacesGenerationClicked").click(function (ev) {
            var xml = '<Call Method="GenerateFaces"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnFacesRemoveClicked").click(function (ev) {
            var xml = '<Call Method="RemoveFaces"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnNormalsGenerateClicked").click(function (ev) {
            var xml = '<Call Method="GenerateNormals"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnNormalsRemoveClicked").click(function (ev) {
            var xml = '<Call Method="RemoveNormals"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnWiresGenerateClicked").click(function (ev) {
            var xml = '<Call Method="GenerateWires"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnWiresRemoveClicked").click(function (ev) {
            var xml = '<Call Method="RemoveWires"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnLODReductionClicked").click(function (ev) {
            var xml = '<Call Method="GenerateLODGeometry"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnGeomDuplicatesClicked").click(function (ev) {
            var xml = '<Call Method="DetectGeometryCopies"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnRecenterToBBCenterClicked").click(function (ev) {
            var xml = '<Call Method="RecenterGeometriesToBoundingboxCenter"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnRecenterToBBMinClicked").click(function (ev) {
            var xml = '<Call Method="RecenterGeometriesToBoundingboxMinimum"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-geometry-tools #OnDetectTinyGeomsClicked").click(function (ev) {
            var xml = '<Call Method="DetectTinyGeometries"></Call>';
            vsClient.command.executeXML(xml);
        });
    };
    GeometryToolsPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.addMethods();
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return GeometryToolsPane;
}(pane_template_1.PaneTemplate));
exports.GeometryToolsPane = GeometryToolsPane;


/***/ }),
/* 57 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var modeltree_1 = __webpack_require__(62);
exports.Modeltree = modeltree_1.Modeltree;
var property_pane_1 = __webpack_require__(66);
exports.PropertyPane = property_pane_1.PropertyPane;
var view_pane_1 = __webpack_require__(77);
exports.ViewPane = view_pane_1.ViewPane;
var settings_pane_1 = __webpack_require__(70);
exports.SettingsPane = settings_pane_1.SettingsPane;
var measurement_pane_1 = __webpack_require__(60);
exports.MeasurementPane = measurement_pane_1.MeasurementPane;
var transform_pane_1 = __webpack_require__(76);
exports.TransformPane = transform_pane_1.TransformPane;
var draft_angle_pane_1 = __webpack_require__(50);
exports.DraftAnglePane = draft_angle_pane_1.DraftAnglePane;
var markup_pane_1 = __webpack_require__(59);
exports.MarkupPane = markup_pane_1.MarkupPane;
var markup_pane_reduced_1 = __webpack_require__(58);
exports.MarkupPane_Reduced = markup_pane_reduced_1.MarkupPane_Reduced;
var section_pane_1 = __webpack_require__(68);
exports.SectionPane = section_pane_1.SectionPane;
var quick_compare_pane_1 = __webpack_require__(67);
exports.QuickComparePane = quick_compare_pane_1.QuickComparePane;
var projected_area_pane_1 = __webpack_require__(65);
exports.ProjectedAreaPane = projected_area_pane_1.ProjectedAreaPane;
var exact_compare_pane_1 = __webpack_require__(52);
exports.ExactComparePane = exact_compare_pane_1.ExactComparePane;
var mirror_pane_1 = __webpack_require__(61);
exports.MirrorPane = mirror_pane_1.MirrorPane;
var filter_pane_1 = __webpack_require__(54);
exports.FilterPane = filter_pane_1.FilterPane;
var flythrough_pane_1 = __webpack_require__(55);
exports.FlyThroughPane = flythrough_pane_1.FlyThroughPane;
var distortion_pane_1 = __webpack_require__(49);
exports.DistortionPane = distortion_pane_1.DistortionPane;
var visibility_test_pane_1 = __webpack_require__(78);
exports.VisibilityTestPane = visibility_test_pane_1.VisibilityTestPane;
var wallthickness_pane_1 = __webpack_require__(79);
exports.WallthicknessPane = wallthickness_pane_1.WallthicknessPane;
var drillhole_pane_1 = __webpack_require__(51);
exports.DrillholePane = drillhole_pane_1.DrillholePane;
var text_search_pane_1 = __webpack_require__(75);
exports.TextSearchPane = text_search_pane_1.TextSearchPane;
var neutral_axis_pane_1 = __webpack_require__(64);
exports.NeutralAxisPane = neutral_axis_pane_1.NeutralAxisPane;
var neighbourhood_search_pane_1 = __webpack_require__(63);
exports.NeighbourhoodSearchPane = neighbourhood_search_pane_1.NeighbourhoodSearchPane;
var selections_pane_1 = __webpack_require__(69);
exports.SelectionsPane = selections_pane_1.SelectionsPane;
var command_1 = __webpack_require__(48);
exports.CommandPane = command_1.CommandPane;
var bom_pane_1 = __webpack_require__(44);
exports.BOMPane = bom_pane_1.BOMPane;
var callout_pane_1 = __webpack_require__(45);
exports.CalloutPane = callout_pane_1.CalloutPane;
var split_pane_1 = __webpack_require__(71);
exports.SplitPane = split_pane_1.SplitPane;
var explode_pane_1 = __webpack_require__(53);
exports.ExplodePane = explode_pane_1.ExplodePane;
var animation_pane_1 = __webpack_require__(42);
exports.AnimationPane = animation_pane_1.AnimationPane;
var geometry_tools_pane_1 = __webpack_require__(56);
exports.GeometryToolsPane = geometry_tools_pane_1.GeometryToolsPane;
var clash_pane_1 = __webpack_require__(46);
exports.ClashPane = clash_pane_1.ClashPane;
var band_analysis_pane_1 = __webpack_require__(43);
exports.BandAnalysisPane = band_analysis_pane_1.BandAnalysisPane;


/***/ }),
/* 58 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var MarkupPane_Reduced = (function (_super) {
    __extends(MarkupPane_Reduced, _super);
    function MarkupPane_Reduced(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    MarkupPane_Reduced.prototype.addMethods = function () {
    };
    MarkupPane_Reduced.prototype.changeLang = function (lang) {
        var _this = this;
        var GetMarkupPaneTemplate = "<Call Method=\"GetTemplate\"><Type>MarkupPane_Reduced</Type></Call>";
        vsClient.command.executeXML(GetMarkupPaneTemplate);
        vsClient.once('GetTemplate.MarkupPane_Reduced', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
        });
    };
    MarkupPane_Reduced.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return MarkupPane_Reduced;
}(pane_template_1.PaneTemplate));
exports.MarkupPane_Reduced = MarkupPane_Reduced;


/***/ }),
/* 59 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var MarkupPane = (function (_super) {
    __extends(MarkupPane, _super);
    function MarkupPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    MarkupPane.prototype.addMethods = function () {
    };
    MarkupPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetMarkupPaneTemplate = "<Call Method=\"GetTemplate\"><Type>MarkupPane</Type></Call>";
        vsClient.command.executeXML(GetMarkupPaneTemplate);
        vsClient.once('GetTemplate.MarkupPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
        });
    };
    MarkupPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return MarkupPane;
}(pane_template_1.PaneTemplate));
exports.MarkupPane = MarkupPane;


/***/ }),
/* 60 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var w = __webpack_require__(10);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var app_states_1 = __webpack_require__(4);
var MeasurementPane = (function (_super) {
    __extends(MeasurementPane, _super);
    function MeasurementPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            if (response && response.Type !== 'MeasurementChanged') {
                var dimensioning = response.Scene.Tools.Dimensioning.Dimensioning === "true";
                var circleSelection = response.Scene.Tools.CircleSelection.SelectCircleWith3Points === "true";
                var measureButton = w.findButton('ID_RIBBON_MEASUREMENT_1');
                if (measureButton) {
                    measureButton.applyHighlight(!dimensioning);
                }
                var dimensioningButton = w.findButton('ID_RIBBON_DIMENSION');
                if (dimensioningButton) {
                    dimensioningButton.applyHighlight(dimensioning);
                }
                var arcButton = w.findButton('ID_RIBBON_ARC');
                if (arcButton) {
                    arcButton.applyHighlight(!circleSelection);
                }
                var threePoints = w.findButton('ID_RIBBON_3_POINTS');
                if (threePoints) {
                    threePoints.applyHighlight(circleSelection);
                }
            }
            _this.adapter.updateValues(_this.values);
            _this.computeGroupVisibility();
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    MeasurementPane.prototype.addMethods = function () {
        $("#wv-measurement #OnAccumulatedLengthComplete").off('click').click(function (ev) {
            var xml = '<Call Method="FinishCurrentAction"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-measurement #OnAccumulatedLengthFromSelection").off('click').click(function (ev) {
            var xml = '<Call Method="MeasureSelectedWireLength"></Call>';
            vsClient.command.executeXML(xml);
        });
    };
    MeasurementPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetMeasurementPaneTemplate = "<Call Method=\"GetTemplate\"><Type>MeasurementPane</Type></Call>";
        vsClient.command.executeXML(GetMeasurementPaneTemplate);
        vsClient.once('GetTemplate.MeasurementPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    MeasurementPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility' || (src.item.id && value.startsWith('UID_'))) {
                _this.adapter.updateValues(_this.values);
                _this.computeGroupVisibility(true);
                return;
            }
            var path = src.item.path;
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
            if (path[0] === 'Event') {
                value = parseFloat(value).toString();
                pane.modifySettings(_this.values, path, value);
                var xml = XMLParser.serializeWithValue(path, value, ['Type=' + template['Event']]);
                vsClient.command.executeXML(xml);
            }
            else {
                pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
                var xml = XMLParser.serializeWithValue(path, value);
                var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
                vsClient.command.executeXML(settings);
                if (_this.hasPresets) {
                    _this.stack.changeToCustomPreset();
                }
                switch (path[path.length - 1]) {
                    case 'Dimensioning':
                        var measureButton = w.findButton('ID_RIBBON_MEASUREMENT_1');
                        if (measureButton) {
                            measureButton.applyHighlight(!value);
                        }
                        var dimensioningButton = w.findButton('ID_RIBBON_DIMENSION');
                        if (dimensioningButton) {
                            dimensioningButton.applyHighlight(value);
                        }
                        break;
                }
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    MeasurementPane.prototype.computeGroupVisibility = function (toggleFolder) {
        if (toggleFolder === void 0) { toggleFolder = false; }
        var wtGroup;
        var pointGroup;
        var distanceGroup;
        var planeToAxisGroup;
        var projectedLineGroup;
        for (var item in this.adapter.items) {
            switch (this.adapter.items[item].id) {
                case 'UID_MEASUREMENT_PANE_DISTANCE':
                    distanceGroup = this.adapter.items[item];
                    break;
                case 'UID_MEASUREMENT_PANE_POINT':
                    pointGroup = this.adapter.items[item];
                    break;
                case 'UID_MEASUREMENT_PANE_WALLTHICKNESS':
                    wtGroup = this.adapter.items[item];
                    break;
                case 'UID_MEASUREMENT_PANE_PLANE_TO_AXIS':
                    planeToAxisGroup = this.adapter.items[item];
                    break;
                case 'UID_MEASUREMENT_PANE_PLANE_PROJECTED_LINE':
                    projectedLineGroup = this.adapter.items[item];
                    break;
                default:
                    break;
            }
        }
        ;
        if (app_states_1.appStates.interactionMode.indexOf('Measurement_WallThickness_RayBased') !== -1
            || app_states_1.appStates.interactionMode.indexOf('Measurement_WallThickness_RollingBall') !== -1) {
            if (!toggleFolder) {
                wtGroup.expandAll();
            }
            distanceGroup.collapseAll(true);
            pointGroup.collapseAll(true);
            planeToAxisGroup.collapseAll(true);
            projectedLineGroup.collapseAll(true);
        }
        else if (app_states_1.appStates.interactionMode.indexOf('Measurement_PointCoordinate') !== -1) {
            wtGroup.collapseAll(true);
            distanceGroup.collapseAll(true);
            if (!toggleFolder) {
                pointGroup.expandAll();
            }
            planeToAxisGroup.collapseAll(true);
            projectedLineGroup.collapseAll(true);
        }
        else if (app_states_1.appStates.interactionMode.indexOf('Measurement_AngleBetweenPlaneDirection') !== -1) {
            wtGroup.collapseAll(true);
            distanceGroup.collapseAll(true);
            pointGroup.collapseAll(true);
            if (!toggleFolder) {
                planeToAxisGroup.expandAll();
            }
            projectedLineGroup.collapseAll(true);
        }
        else if (app_states_1.appStates.interactionMode.indexOf('Measurement_AngleBetweenTwoProjectedLines') !== -1) {
            wtGroup.collapseAll(true);
            distanceGroup.collapseAll(true);
            pointGroup.collapseAll(true);
            planeToAxisGroup.collapseAll(true);
            if (!toggleFolder) {
                projectedLineGroup.expandAll();
            }
        }
        else {
            var isDistance = false;
            for (var i = 0; i < app_states_1.appStates.interactionMode.length; i++) {
                if (app_states_1.appStates.interactionMode[i].indexOf('Measurement') !== -1 && app_states_1.appStates.interactionMode[i].indexOf('Distance') !== -1) {
                    isDistance = true;
                    break;
                }
            }
            wtGroup.collapseAll(true);
            pointGroup.collapseAll(true);
            planeToAxisGroup.collapseAll(true);
            projectedLineGroup.collapseAll(true);
            if (isDistance) {
                if (!toggleFolder) {
                    distanceGroup.expandAll();
                }
            }
            else {
                distanceGroup.collapseAll(true);
            }
        }
    };
    return MeasurementPane;
}(pane_template_1.PaneTemplate));
exports.MeasurementPane = MeasurementPane;


/***/ }),
/* 61 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var pane_template_1 = __webpack_require__(1);
var MirrorPane = (function (_super) {
    __extends(MirrorPane, _super);
    function MirrorPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    MirrorPane.prototype.addMethods = function () {
        $("#wv-mirror #OnMirrorClick").click(function (ev) {
            var createCopy = $('#UID_MIRROR_CREATE_COPY').val();
            var mirrorPlane = $('#UID_MIRROR_AT_PLANE').val();
            var mirrorAt = $('#UID_MIRROR_AT').val();
            var xml = '<Call Method="MirrorSelectedNodes">';
            xml += '<Copy>' + createCopy + '</Copy>';
            xml += '<Axis>' + mirrorPlane + '</Axis>';
            xml += '<Location>' + mirrorAt + '</Location>';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
    };
    MirrorPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetMirrorPaneTemplate = "<Call Method=\"GetTemplate\"><Type>MirrorPane</Type></Call>";
        vsClient.command.executeXML(GetMirrorPaneTemplate);
        vsClient.once('GetTemplate.MirrorPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    MirrorPane.prototype.fromTemplate = function (template) {
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return MirrorPane;
}(pane_template_1.PaneTemplate));
exports.MirrorPane = MirrorPane;


/***/ }),
/* 62 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var node_types_1 = __webpack_require__(91);
var pane_template_1 = __webpack_require__(1);
var ui = __webpack_require__(0);
var app_states_1 = __webpack_require__(4);
var tooltip_1 = __webpack_require__(8);
var SVG_NS = 'http://www.w3.org/2000/svg';
var XLINK_NS = 'http://www.w3.org/1999/xlink';
var TreeviewItemInfo = (function () {
    function TreeviewItemInfo(ExpanderState, Level, NodeId, NodeName, NodeType, Selection, Visibility, Parent) {
        this.ExpanderState = ExpanderState;
        this.Level = Level;
        this.NodeId = NodeId;
        this.NodeName = NodeName;
        this.NodeType = NodeType;
        this.Selection = Selection;
        this.Visibility = Visibility;
        this.Parent = Parent;
    }
    return TreeviewItemInfo;
}());
exports.TreeviewItemInfo = TreeviewItemInfo;
var Modeltree = (function (_super) {
    __extends(Modeltree, _super);
    function Modeltree(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.minBarHeight = 15;
        _this.treeItemsInfo = [];
        _this.items = [];
        _this.selectedNodeIds = [];
        _this.currentExpandedNode = 0;
        _this.firstInit = true;
        _this.tooltips = [];
        _this.tooltipKeys = [];
        _this.addEventListener = function () {
            if (_this.firstInit) {
                document.getElementById('wv-canvas').addEventListener('mouseenter', function (ev) {
                    _this.toggleScrollEvents(true);
                });
                document.getElementById('wv-canvas').addEventListener('mouseleave', function (ev) {
                    _this.toggleScrollEvents(false);
                });
                _this.firstInit = false;
            }
            $(_this.itemsContainer).kendoTouch({
                drag: function (e) {
                    if (_this.touchStart > e.touch.y.location && (_this.touchStart - e.touch.y.location) > 20) {
                        _this.touchStart = e.touch.y.location;
                        _this.touchSteps++;
                        var scrollbarFullHeight = _this.contentWrapper.offsetHeight;
                        _this.scrollPosition += 3;
                        if (_this.scrollPosition < 0) {
                            _this.scrollPosition = 0;
                        }
                        if (_this.scrollPosition > scrollbarFullHeight - _this.bar.offsetHeight) {
                            _this.scrollPosition = scrollbarFullHeight - _this.bar.offsetHeight;
                        }
                        _this.bar.style.top = _this.scrollPosition + 'px';
                    }
                    else if (_this.touchStart < e.touch.y.location && (e.touch.y.location - _this.touchStart) > 20) {
                        _this.touchStart = e.touch.y.location;
                        _this.touchSteps--;
                        var scrollbarFullHeight = _this.contentWrapper.offsetHeight;
                        _this.scrollPosition -= 3;
                        if (_this.scrollPosition < 0) {
                            _this.scrollPosition = 0;
                        }
                        if (_this.scrollPosition > scrollbarFullHeight - _this.bar.offsetHeight) {
                            _this.scrollPosition = scrollbarFullHeight - _this.bar.offsetHeight;
                        }
                        _this.bar.style.top = _this.scrollPosition + 'px';
                    }
                },
                dragstart: function (e) {
                    _this.touchSteps = 0;
                    _this.touchStart = e.touch.y.location;
                },
                dragend: function (e) {
                    _this.touchSteps *= 3;
                    var xml;
                    if (_this.touchSteps > 0) {
                        xml = '<Call Method="VirtualTreeViewScrollDown"><Steps>' + _this.touchSteps + '</Steps></Call>';
                        vsClient.command.executeXMLAsync(xml);
                    }
                    else {
                        xml = '<Call Method="VirtualTreeViewScrollUp"><Steps>' + (_this.touchSteps * -1) + '</Steps></Call>';
                        vsClient.command.executeXMLAsync(xml);
                    }
                }
            });
        };
        _this.scrollPosition = 0;
        _this.scrollTravelled = 0;
        _this.barOnclick = function (ev) {
            _this.lastPageY = ev.pageY;
            document.addEventListener('mousemove', _this.barOndrag, false);
            document.addEventListener('mouseup', _this.barOnstop, false);
        };
        _this.barOndrag = function (ev) {
            var delta = ev.pageY - _this.lastPageY;
            _this.lastPageY = ev.pageY;
            _this.scrollPosition += delta;
            _this.scrollTravelled += delta;
            if (_this.scrollPosition < 0) {
                _this.scrollPosition = 0;
            }
            if (_this.scrollPosition > _this.bar.parentElement.offsetHeight - _this.bar.offsetHeight) {
                _this.scrollPosition = _this.bar.parentElement.offsetHeight - _this.bar.offsetHeight;
            }
            _this.bar.style.top = _this.scrollPosition + 'px';
        };
        _this.barOnstop = function (ev) {
            var step = Math.floor(Math.abs(_this.scrollTravelled) / (_this.lineHeight * _this.currentMaxVisible()) * _this.currentExpandedNode);
            var s;
            if (_this.scrollTravelled > 0) {
                s = '<Call Method="VirtualTreeViewScrollDown"><Steps>' + step + '</Steps></Call>';
                vsClient.command.executeXML(s);
            }
            else if (_this.scrollTravelled < 0) {
                s = '<Call Method="VirtualTreeViewScrollUp"><Steps>' + step + '</Steps></Call>';
                vsClient.command.executeXML(s);
            }
            document.removeEventListener('mousemove', _this.barOndrag);
            document.removeEventListener('mouseup', _this.barOnstop);
            _this.scrollTravelled = 0;
        };
        _this.barOnwheel = function (ev) {
            ev.preventDefault();
            var downScale = ev.deltaY > 0 ? 1.0 : -1.0;
            var step = 3;
            var scrollbarFullHeight = _this.contentWrapper.offsetHeight;
            _this.scrollPosition += step * downScale;
            if (_this.scrollPosition < 0) {
                _this.scrollPosition = 0;
            }
            if (_this.scrollPosition > scrollbarFullHeight - _this.bar.offsetHeight) {
                _this.scrollPosition = scrollbarFullHeight - _this.bar.offsetHeight;
            }
            _this.bar.style.top = _this.scrollPosition + 'px';
            var s;
            if (downScale > 0) {
                s = '<Call Method="VirtualTreeViewScrollDown"><Steps>' + step + '</Steps></Call>';
                vsClient.command.executeXMLAsync(s);
            }
            else {
                s = '<Call Method="VirtualTreeViewScrollUp"><Steps>' + step + '</Steps></Call>';
                vsClient.command.executeXMLAsync(s);
            }
        };
        _this.barOntouchstart = function (ev) {
            _this.lastPageY = ev.touches[0].pageY;
        };
        _this.barOntouchmove = function (ev) {
            var delta = ev.touches[0].pageY - _this.lastPageY;
            _this.lastPageY = ev.touches[0].pageY;
            _this.scrollPosition += delta;
            _this.scrollTravelled += delta;
            if (_this.scrollPosition < 0) {
                _this.scrollPosition = 0;
            }
            if (_this.scrollPosition > _this.contentWrapper.offsetHeight - _this.bar.offsetHeight) {
                _this.scrollPosition = _this.contentWrapper.offsetHeight - _this.bar.offsetHeight;
            }
            _this.bar.style.top = _this.scrollPosition + 'px';
        };
        _this.update = function (treeviewInfo) {
            if (app_states_1.appStates.popoutPanes.indexOf('modeltree') !== -1) {
                return;
            }
            if (!treeviewInfo) {
                _this.contentWrapper.style.top = _this.modeltreeButtons.offsetHeight + 'px';
                _this.contentWrapper.style.height = "calc(100% - " + (_this.modeltreeButtons.offsetHeight) + 'px)';
                if (vsClient.command) {
                    var maxVisible = _this.currentMaxVisible();
                    var getTreeview = '<Call Method="VirtualTreeViewSetSize"><Size>' + maxVisible + '</Size></Call>';
                    vsClient.command.executeXML(getTreeview);
                }
                return;
            }
            _this.minBarHeight = 15;
            var positionRatio = treeviewInfo.VirtualScrollPosition / treeviewInfo.ExpandedNodes;
            var maxBarHeight = _this.contentWrapper.offsetHeight;
            var barTop = positionRatio * maxBarHeight;
            if (barTop > maxBarHeight - _this.minBarHeight) {
                barTop = maxBarHeight - _this.minBarHeight;
            }
            _this.scrollPosition = barTop;
            _this.bar.style.top = barTop + 'px';
            var heightRatio = _this.currentMaxVisible() / treeviewInfo.ExpandedNodes;
            var barHeight = heightRatio * _this.contentWrapper.offsetHeight;
            if (heightRatio >= 1) {
                _this.bar.style.height = '0px';
                _this.barRail.style.display = 'none';
            }
            else if (barHeight < _this.minBarHeight) {
                _this.bar.style.height = _this.minBarHeight + 'px';
                _this.barRail.style.display = '';
            }
            else {
                _this.bar.style.height = heightRatio * 100 + '%';
                _this.barRail.style.display = '';
            }
            _this.treeItemsInfo = treeviewInfo.Items;
            _this.currentExpandedNode = treeviewInfo.ExpandedNodes;
            _this.layout();
            if (treeviewInfo.VirtualScrollPosition === 0) {
                ui.canvasStack.setTabTitle(_this.treeItemsInfo[0].NodeName);
            }
        };
        _this.noAdapter = true;
        _this.scrollOnKey = _this.scrollOnKey.bind(_this);
        _this.modeltreeButtons = document.createElement('div');
        _this.modeltreeButtons.classList.add('modeltree-buttons');
        _this.expandAll = document.createElement('i');
        _this.expandAll.className = 'fa fa-chevron-double-right tree-header-action-icon';
        _this.expandAllTooltip = new tooltip_1.WVTooltip(_this.expandAll);
        _this.expandAllTooltip.setTitle(_lang_data['ID_EXPAND_ALL'][_this.lang]);
        _this.expandAll.addEventListener('click', function () {
            var s = '<Call Method="VirtualTreeViewExpandAll"></Call>';
            vsClient.command.executeXML(s);
        }, false);
        _this.collapseAll = document.createElement('i');
        _this.collapseAll.className = 'fa fa-chevron-double-left tree-header-action-icon';
        _this.collapseAllTooltip = new tooltip_1.WVTooltip(_this.collapseAll);
        _this.collapseAllTooltip.setTitle(_lang_data['ID_COLLAPSE_ALL'][_this.lang]);
        _this.collapseAll.addEventListener('click', function () {
            var s = '<Call Method="VirtualTreeViewCollapseAll"></Call>';
            vsClient.command.executeXML(s);
        }, false);
        _this.expandSelected = document.createElement('i');
        _this.expandSelected.className = 'fa fa-chevron-right tree-header-action-icon';
        _this.expandSelectedTooltip = new tooltip_1.WVTooltip(_this.expandSelected);
        _this.expandSelectedTooltip.setTitle(_lang_data['ID_EXPAND_SELECTED'][_this.lang]);
        _this.expandSelected.addEventListener('click', function () {
            var s = '<Call Method="VirtualTreeViewExpandSelected"></Call>';
            vsClient.command.executeXML(s);
        }, false);
        _this.collapseSelected = document.createElement('i');
        _this.collapseSelected.className = 'fa fa-chevron-left tree-header-action-icon';
        _this.collapseSelectedTooltip = new tooltip_1.WVTooltip(_this.collapseSelected);
        _this.collapseSelectedTooltip.setTitle(_lang_data['ID_COLLAPSE_SELECTED'][_this.lang]);
        _this.collapseSelected.addEventListener('click', function () {
            var s = '<Call Method="VirtualTreeViewCollapseSelected"></Call>';
            vsClient.command.executeXML(s);
        }, false);
        _this.expandSelectedLevel = document.createElement('i');
        _this.expandSelectedLevel.className = 'tree-header-action-icon fa fa-code';
        _this.expandSelectedLevelTooltip = new tooltip_1.WVTooltip(_this.expandSelectedLevel);
        _this.expandSelectedLevelTooltip.setTitle(_lang_data['ID_EXPAND_EACH_TILL_SELECTED'][_this.lang]);
        _this.expandSelectedLevel.addEventListener('click', function () {
            var s = '<Call Method="VirtualTreeViewExpandToSelectedLevel"></Call>';
            vsClient.command.executeXML(s);
        }, false);
        _this.selectSameLevel = document.createElement('i');
        _this.selectSameLevel.className = 'tree-header-action-icon fa fa-stream';
        _this.selectSameLevelTooltip = new tooltip_1.WVTooltip(_this.selectSameLevel);
        _this.selectSameLevelTooltip.setTitle(_lang_data['ID_SELECT_SAME_LEVEL'][_this.lang]);
        _this.selectSameLevel.addEventListener('click', function () {
            var s = '<Call Method="VirtualTreeViewSelectSameLevelNodes"></Call>';
            vsClient.command.executeXML(s);
        }, false);
        _this.modeltreeButtons.appendChild(_this.expandAll);
        _this.modeltreeButtons.appendChild(_this.collapseAll);
        _this.modeltreeButtons.appendChild(_this.expandSelected);
        _this.modeltreeButtons.appendChild(_this.collapseSelected);
        _this.modeltreeButtons.appendChild(_this.expandSelectedLevel);
        _this.modeltreeButtons.appendChild(_this.selectSameLevel);
        _this.el = document.createElement('div');
        _this.el.classList.add('modeltree-innerwrapper');
        _this.el.style.position = 'relative';
        _this.el.style.height = '100%';
        _this.el.appendChild(_this.modeltreeButtons);
        _this.contentWrapper = document.createElement('div');
        _this.contentWrapper.classList.add('modeltree-content');
        _this.el.appendChild(_this.contentWrapper);
        _this.bar = document.createElement('div');
        _this.bar.classList.add('modeltree-bar');
        _this.contentWrapper.appendChild(_this.bar);
        _this.barRail = document.createElement('div');
        _this.barRail.className = "modeltree-bar-rail";
        _this.barRail.style.display = 'none';
        _this.barRail.addEventListener('click', function (ev) {
            var deltaClick = parseInt(_this.bar.style.top.replace("px", "")) - ev.offsetY;
            var page = _this.currentMaxVisible();
            if (deltaClick > 0) {
                var xml = '<Call Method="VirtualTreeViewScrollUp"><Steps>' + page + '</Steps></Call>';
                vsClient.command.executeXMLAsync(xml);
            }
            else {
                var xml = '<Call Method="VirtualTreeViewScrollDown"><Steps>' + page + '</Steps></Call>';
                vsClient.command.executeXMLAsync(xml);
            }
        });
        _this.contentWrapper.addEventListener('mouseenter', function (ev) {
            _this.toggleScrollEvents(true);
        });
        _this.contentWrapper.addEventListener('mouseleave', function (ev) {
            _this.toggleScrollEvents(false);
        });
        _this.contentWrapper.appendChild(_this.barRail);
        _this.itemsContainer = document.createElement('div');
        _this.itemsContainer.classList.add('modeltree-itemscontainer');
        _this.contentWrapper.appendChild(_this.itemsContainer);
        _this.el.addEventListener('contextmenu', function (ev) {
            ev.preventDefault();
            $('#contextMenu').remove();
            $(document).off('mousedown', vsClient.vsCanvas.closeContextMenu);
            $(document).off('keyup', vsClient.vsCanvas.closeContextMenu);
            vsClient.vsCanvas.createContextMenu(ev);
        });
        _this.bar.addEventListener('mousedown', _this.barOnclick, false);
        _this.el.addEventListener('wheel', _this.barOnwheel, false);
        _this.bar.addEventListener('touchstart', _this.barOntouchstart);
        _this.bar.addEventListener('touchmove', _this.barOntouchmove);
        _this.bar.addEventListener('touchend', _this.barOnstop);
        _this.wrapperEl.appendChild(_this.el);
        _this.lineHeight = 20;
        _this.contentWrapper.style.top = _this.modeltreeButtons.offsetHeight + 'px';
        _this.contentWrapper.style.height = "calc(100% - " + (_this.modeltreeButtons.offsetHeight) + 'px)';
        _this.touchStart = 0;
        vsClient.on('GetNodeTooltip', function (response, XML) {
            var newTooltip = {
                key: response.CustomId,
                tooltip: response.Tooltip
            };
            _this.addTooltipKey(newTooltip);
            var actualTooltipKey = _this.actualTooltip.key;
            var tooltipMatch = _this.mapTooltip(actualTooltipKey);
            if (tooltipMatch) {
                _this.actualTooltip.removeAttributes();
                _this.actualTooltip.addAttribute(tooltipMatch.tooltip);
            }
        });
        return _this;
    }
    Modeltree.prototype.addMethods = function () {
    };
    Modeltree.prototype.addTooltipKey = function (tooltip) {
        var keyCount = this.tooltipKeys.length;
        if (keyCount > 200) {
            this.tooltipKeys.shift();
        }
        var existed = false;
        for (var k = 0; k < keyCount; k++) {
            if (this.tooltipKeys[k].key === tooltip.key) {
                existed = true;
                break;
            }
        }
        if (!existed) {
            this.tooltipKeys.push(tooltip);
        }
    };
    Modeltree.prototype.mapTooltip = function (key) {
        var keyCount = this.tooltipKeys.length;
        for (var k = 0; k < keyCount; k++) {
            if (this.tooltipKeys[k].key === key) {
                return this.tooltipKeys[k];
            }
        }
        return undefined;
    };
    Modeltree.prototype.toggleScrollEvents = function (state) {
        if (state) {
            $(document).off('keydown', this.scrollOnKey).on('keydown', this.scrollOnKey);
        }
        else {
            $(document).off('keydown', this.scrollOnKey);
        }
    };
    Modeltree.prototype.scrollOnKey = function (ev) {
        var _this = this;
        var xml;
        switch (ev.keyCode) {
            case ev.ctrlKey && 67:
                xml = '<Call Method="ModifySelection"><SelectionModifier>Copy</SelectionModifier></Call>';
                break;
            case ev.ctrlKey && 86:
                xml = '<Call Method="ModifySelection"><SelectionModifier>PasteToSelection</SelectionModifier></Call>';
                break;
        }
        if (xml) {
            vsClient.command.executeXML(xml);
        }
        if (app_states_1.appStates.interactionMode.indexOf('Flythrough') === -1) {
            if (ev.keyCode === 37 || ev.keyCode === 39) {
                if (ev.keyCode === 37) {
                    var s = '<Call Method="VirtualTreeViewCollapseSelected"></Call>';
                    vsClient.command.executeXML(s);
                }
                else {
                    var s = '<Call Method="VirtualTreeViewExpandSelected"></Call>';
                    vsClient.command.executeXML(s);
                }
                return;
            }
            if (ev.keyCode !== 40 && ev.keyCode !== 38 || Date.now() - this.firstScrollHit < 200) {
                return;
            }
            this.firstScrollHit = Date.now();
            if (this.selectedNodeIds.length === 0) {
                if (ev.keyCode === 40) {
                    var xml_1 = '<Call Method="VirtualTreeViewScrollDown"><Steps>1</Steps></Call>';
                    vsClient.command.executeXMLAsync(xml_1);
                }
                else if (ev.keyCode === 38) {
                    var xml_2 = '<Call Method="VirtualTreeViewScrollUp"><Steps>1</Steps></Call>';
                    vsClient.command.executeXMLAsync(xml_2);
                }
            }
            else {
                var itemCount_1 = this.treeItemsInfo.length;
                var selectedItemIndex = void 0;
                for (var i = 0; i < itemCount_1; i++) {
                    if (this.treeItemsInfo[i].NodeId === this.selectedNodeIds[0]) {
                        selectedItemIndex = i;
                        break;
                    }
                }
                if (selectedItemIndex === 0 && ev.keyCode === 38) {
                    var xml_3 = '<Call Method="VirtualTreeViewScrollUp"><Steps>1</Steps></Call>';
                    vsClient.command.executeXMLAsync(xml_3);
                    vsClient.once('TreeviewUpdated', function () {
                        _this.setSelectedNodes(_this.treeItemsInfo[0].NodeId);
                        _this.selectedNodeIds = [];
                        _this.selectedNodeIds.push(_this.treeItemsInfo[0].NodeId);
                    });
                }
                else if (selectedItemIndex === itemCount_1 - 1 && ev.keyCode === 40) {
                    var xml_4 = '<Call Method="VirtualTreeViewScrollDown"><Steps>1</Steps></Call>';
                    vsClient.command.executeXMLAsync(xml_4);
                    vsClient.once('TreeviewUpdated', function () {
                        _this.setSelectedNodes(_this.treeItemsInfo[itemCount_1 - 1].NodeId);
                        _this.selectedNodeIds = [];
                        _this.selectedNodeIds.push(_this.treeItemsInfo[itemCount_1 - 1].NodeId);
                    });
                }
                else if (ev.keyCode === 38) {
                    var newSelectedItem = this.treeItemsInfo[selectedItemIndex - 1];
                    this.setSelectedNodes(newSelectedItem.NodeId);
                    this.selectedNodeIds = [];
                    this.selectedNodeIds.push(newSelectedItem.NodeId);
                }
                else if (ev.keyCode === 40) {
                    var newSelectedItem = this.treeItemsInfo[selectedItemIndex + 1];
                    this.setSelectedNodes(newSelectedItem.NodeId);
                    this.selectedNodeIds = [];
                    this.selectedNodeIds.push(newSelectedItem.NodeId);
                }
            }
        }
    };
    Modeltree.prototype.changeLang = function (lang) {
        this.expandAllTooltip.setTitle(_lang_data['ID_EXPAND_ALL'][lang]);
        this.collapseAllTooltip.setTitle(_lang_data['ID_COLLAPSE_ALL'][lang]);
        this.expandSelectedTooltip.setTitle(_lang_data['ID_EXPAND_SELECTED'][lang]);
        this.collapseSelectedTooltip.setTitle(_lang_data['ID_COLLAPSE_SELECTED'][lang]);
        this.expandSelectedLevelTooltip.setTitle(_lang_data['ID_EXPAND_EACH_TILL_SELECTED'][lang]);
        this.selectSameLevelTooltip.setTitle(_lang_data['ID_SELECT_SAME_LEVEL'][lang]);
    };
    Modeltree.prototype.currentMaxVisible = function () {
        return Math.floor(this.contentWrapper.clientHeight / this.lineHeight);
    };
    Modeltree.prototype.layout = function () {
        var _this = this;
        $('.webviewer-tooltip-wrapper').each(function () {
            $(this).remove();
        });
        while (this.itemsContainer.firstChild) {
            this.itemsContainer.removeChild(this.itemsContainer.firstChild);
        }
        this.items = [];
        this.tooltips = [];
        var i = 0;
        vsClient.setMaxListeners(0);
        for (var item = this.treeItemsInfo.length - 1; item >= 0; item--) {
            var hasParent = -1;
            for (var predecessor = item - 1; predecessor >= 0; predecessor--) {
                if (this.treeItemsInfo[predecessor].Level + 1 === this.treeItemsInfo[item].Level) {
                    hasParent = predecessor;
                    break;
                }
            }
            this.treeItemsInfo[item].Parent = hasParent;
        }
        this.selectedNodeIds = [];
        var _loop_1 = function (itemInfo) {
            if (itemInfo.NodeType === 81) {
                var sceneName = itemInfo.NodeName;
                try {
                    sceneName = _SceneNameOverride;
                }
                catch (e) {
                    if (app_states_1.appStates.fileName) {
                        sceneName = app_states_1.appStates.fileName;
                    }
                }
                itemInfo.NodeName = sceneName;
            }
            var item_1 = document.createElement('div');
            item_1.classList.add('modeltree-item');
            item_1.style.paddingLeft = 10 + itemInfo.Level * 10 + 'px';
            item_1.style.height = '20px';
            var expander = document.createElement('span');
            expander.classList.add('modeltree-item-expander');
            switch (itemInfo.ExpanderState) {
                case 0:
                    expander.style.marginLeft = '12px';
                    break;
                case 1:
                    expander.style.display = 'inline-block';
                    var expanderWrapper = document.createElementNS(SVG_NS, 'svg');
                    expanderWrapper.style.width = '12px';
                    expanderWrapper.style.height = '8px';
                    var downAngle = document.createElementNS(SVG_NS, "polygon");
                    downAngle.setAttributeNS(null, 'points', "9,0 0,9 9,9");
                    downAngle.setAttributeNS(null, 'style', "fill:black");
                    expanderWrapper.appendChild(downAngle);
                    expander.appendChild(expanderWrapper);
                    break;
                case 2:
                    expander.style.display = 'inline-block';
                    var expanderWrapper2 = document.createElementNS(SVG_NS, 'svg');
                    expanderWrapper2.style.width = '12px';
                    expanderWrapper2.style.height = '10px';
                    expanderWrapper2.style.zIndex = '50';
                    var rightAngle = document.createElementNS(SVG_NS, "polygon");
                    rightAngle.setAttributeNS(null, 'points', "4,0 4,10 10,5");
                    rightAngle.setAttributeNS(null, 'style', "fill:black");
                    expanderWrapper2.appendChild(rightAngle);
                    expander.appendChild(expanderWrapper2);
                    break;
            }
            expander.addEventListener('click', function (ev) {
                ev.stopPropagation();
                var s = '<Call Method="VirtualTreeViewToggleExpansion"><NodeId>' + itemInfo.NodeId + '</NodeId></Call>';
                vsClient.command.executeXML(s);
            }, false);
            var visibility = document.createElement('span');
            visibility.classList.add('modeltree-item-visibility');
            visibility.style.fontSize = '12px';
            switch (itemInfo.Visibility) {
                case 0:
                    visibility.classList.add('fa');
                    visibility.classList.add('fa-eye-slash');
                    visibility.style.color = 'black';
                    break;
                case 1:
                    visibility.classList.add('fa');
                    visibility.classList.add('fa-eye');
                    visibility.style.color = 'black';
                    break;
                case 2:
                    visibility.style.color = 'black';
                    break;
                case 3:
                    visibility.classList.add('fa');
                    visibility.classList.add('fa-eye');
                    visibility.style.color = 'lightsteelblue';
                    break;
            }
            visibility.addEventListener('click', function (ev) {
                ev.stopPropagation();
                var s = '<Call Method="VirtualTreeViewToggleVisibility"><NodeId>' + itemInfo.NodeId + '</NodeId></Call>';
                vsClient.command.executeXML(s);
            });
            var nodeTypeIcon = document.createElementNS(SVG_NS, 'svg');
            nodeTypeIcon.setAttribute('class', 'viewpane-item-icon');
            nodeTypeIcon.style.width = '12px';
            nodeTypeIcon.style.height = '12px';
            nodeTypeIcon.style.marginRight = '2px';
            nodeTypeIcon.style.marginBottom = '1px';
            var useEl = document.createElementNS(SVG_NS, 'use');
            useEl.setAttributeNS(XLINK_NS, 'href', '#' + GetNodeItemImage(itemInfo.NodeType));
            if (GetNodeItemImage(itemInfo.NodeType) === 'ICON_GEOMETRY' || GetNodeItemImage(itemInfo.NodeType) === 'ICON_ROOT') {
                $(nodeTypeIcon).addClass('viewpane-item-icon-translate-down');
            }
            nodeTypeIcon.appendChild(useEl);
            var nodeName = document.createElement('span');
            nodeName.classList.add('modeltree-item-nodename');
            nodeName.textContent = itemInfo.NodeName;
            switch (itemInfo.Selection) {
                case 0:
                    item_1.classList.add('treeitem-selection-none');
                    break;
                case 1:
                    item_1.classList.add('treeitem-selection-highlight');
                    this_1.selectedNodeIds.push(itemInfo.NodeId);
                    break;
                case 2:
                    item_1.classList.add('treeitem-selection-parent-selected');
            }
            item_1.addEventListener('contextmenu', function (ev) {
                if (!app_states_1.appStates.nodesSelected) {
                    _this.setSelectedNodes(itemInfo.NodeId);
                    _this.selectedNodeIds = [];
                    _this.selectedNodeIds.push(itemInfo.NodeId);
                }
            });
            item_1.addEventListener('click', function (ev) {
                _this.selectedNodeIds.push(itemInfo.NodeId);
                if (ev.ctrlKey === true && ev.shiftKey === false) {
                    _this.addToSelection(itemInfo.NodeId);
                }
                else if (ev.ctrlKey === false && ev.shiftKey === true && _this.selectedNodeIds.length >= 2) {
                    var lastNodeId = _this.selectedNodeIds[_this.selectedNodeIds.length - 2];
                    var s = "<Call Method=\"VirtualTreeViewSelectBetweenNodes\">\n<NodeId>" + lastNodeId + "</NodeId>\n<NodeId>" + itemInfo.NodeId + "</NodeId></Call>";
                    vsClient.command.executeXML(s);
                }
                else {
                    _this.setSelectedNodes(itemInfo.NodeId);
                    _this.selectedNodeIds = [];
                    _this.selectedNodeIds.push(itemInfo.NodeId);
                }
            });
            var tooltip = new tooltip_1.WVTooltip(item_1);
            tooltip.setTitle(itemInfo.NodeName);
            tooltip.setKey(itemInfo.NodeId.toString());
            tooltip.setTriggerTime(1000);
            $(item_1).hover(function (ev) {
                _this.actualTooltip = tooltip;
                var xml = '<Call Method="GetNodeTooltip" CustomId="' + itemInfo.NodeId + '"><NodeId>' + itemInfo.NodeId + '</NodeId></Call>';
                vsClient.command.executeXML(xml);
            });
            item_1.appendChild(expander);
            item_1.appendChild(visibility);
            item_1.appendChild(nodeTypeIcon);
            item_1.appendChild(nodeName);
            this_1.items.push(item_1);
            var lineWrapper = document.createElementNS(SVG_NS, 'svg');
            lineWrapper.style.width = '100%';
            lineWrapper.style.height = '100%';
            lineWrapper.style.position = 'absolute';
            lineWrapper.style.pointerEvents = 'none';
            var hLine = document.createElementNS(SVG_NS, "line");
            hLine.setAttributeNS(null, 'x1', (7 + itemInfo.Level * 10).toString());
            hLine.setAttributeNS(null, 'x2', (14 + itemInfo.Level * 10).toString());
            hLine.setAttributeNS(null, 'y1', '10');
            hLine.setAttributeNS(null, 'y2', '10');
            hLine.setAttributeNS(null, "style", "stroke:black;stroke-width:2");
            lineWrapper.appendChild(hLine);
            var lineWrapper2 = document.createElementNS(SVG_NS, 'svg');
            lineWrapper2.style.width = '100%';
            lineWrapper2.style.height = '100%';
            lineWrapper2.style.position = 'absolute';
            lineWrapper2.style.top = '0';
            lineWrapper2.style.zIndex = '1';
            lineWrapper2.style.pointerEvents = 'none';
            var vLine = document.createElementNS(SVG_NS, "line");
            vLine.setAttributeNS(null, 'x1', (itemInfo.Level * 10 + 8).toString());
            vLine.setAttributeNS(null, 'x2', (itemInfo.Level * 10 + 8).toString());
            if (itemInfo.Parent !== -1) {
                vLine.setAttributeNS(null, 'y1', ((itemInfo.Parent + 1) * 20).toString());
            }
            else {
                vLine.setAttributeNS(null, 'y1', '0');
            }
            vLine.setAttributeNS(null, 'y2', (10 + i * 20).toString());
            vLine.setAttributeNS(null, "style", "stroke:black;stroke-width:2");
            lineWrapper2.appendChild(vLine);
            this_1.itemsContainer.appendChild(lineWrapper2);
            this_1.itemsContainer.appendChild(lineWrapper);
            this_1.itemsContainer.appendChild(item_1);
            i++;
        };
        var this_1 = this;
        for (var _i = 0, _a = this.treeItemsInfo; _i < _a.length; _i++) {
            var itemInfo = _a[_i];
            _loop_1(itemInfo);
        }
        vsClient.setMaxListeners(30);
    };
    Modeltree.prototype.addToSelection = function (nodeId) {
        var s = '<Call Method="SetSelectedNodes"><NodeId>' + nodeId + '</NodeId><AddToSelection>true</AddToSelection></Call>';
        vsClient.command.executeXML(s);
    };
    Modeltree.prototype.setSelectedNodes = function (nodeId) {
        if (typeof vsClient === 'undefined') {
            return;
        }
        var nodeIdString = '';
        if (Array.isArray(nodeId)) {
            for (var i = 0; i < nodeId.length; i++) {
                nodeIdString += '<NodeId>';
                nodeIdString += nodeId[i];
                nodeIdString += '</NodeId>';
            }
        }
        else {
            nodeIdString += '<NodeId>';
            nodeIdString += nodeId;
            nodeIdString += '</NodeId>';
        }
        var s = '<Call Method="SetSelectedNodes">' + nodeIdString + '</Call>';
        vsClient.command.executeXML(s);
    };
    return Modeltree;
}(pane_template_1.PaneTemplate));
exports.Modeltree = Modeltree;
function GetNodeItemImage(nodeType) {
    var svgId;
    switch (nodeType) {
        case node_types_1.NodeType.MasterRootNode:
            svgId = 'ICON_SCENE';
            break;
        case node_types_1.NodeType.Root:
            svgId = 'ICON_ROOT';
            break;
        case node_types_1.NodeType.ProductOccurrence:
            svgId = 'ICON_PO';
            break;
        case node_types_1.NodeType.DoNotUse1:
            svgId = 'ICON_GEOMETRY';
            break;
        case node_types_1.NodeType.DoNotUse2:
            svgId = 'ICON_GEOMETRY';
            break;
        case node_types_1.NodeType.Ri_BrepModel:
            svgId = 'ICON_GEOMETRY';
            break;
        case node_types_1.NodeType.Ri_PolyBrepModel:
            svgId = 'ICON_GEOMETRY';
            break;
        case node_types_1.NodeType.Ri_Set:
            svgId = 'ICON_GEOMETRY';
            break;
        case node_types_1.NodeType.Ri_PolyWire:
            svgId = 'ICON_WIRE';
            break;
        case node_types_1.NodeType.Ri_TessMarkup:
            svgId = 'ICON_MARKUP';
            break;
        case node_types_1.NodeType.DoNotUse3:
            svgId = '';
            break;
        case node_types_1.NodeType.Part:
            svgId = 'ICON_PART';
            break;
        case node_types_1.NodeType.AxisRoot:
            svgId = 'ICON_WIRE';
            break;
        case node_types_1.NodeType.Axis:
            svgId = 'ICON_WIRE';
            break;
        case node_types_1.NodeType.PMIView:
            svgId = 'ICON_VIEW';
            break;
        case node_types_1.NodeType.Annotation:
            svgId = 'ICON_MARKUP';
            break;
        case node_types_1.NodeType.AnnotationItem:
            svgId = 'ICON_MARKUP';
            break;
        case node_types_1.NodeType.PmiMarkup_Unknown:
        case node_types_1.NodeType.PmiMarkup_Text:
        case node_types_1.NodeType.PmiMarkup_Dimension:
        case node_types_1.NodeType.PmiMarkup_Arrow:
        case node_types_1.NodeType.PmiMarkup_Balloon:
        case node_types_1.NodeType.PmiMarkup_CircleCenter:
        case node_types_1.NodeType.PmiMarkup_Coordinate:
        case node_types_1.NodeType.PmiMarkup_Datum:
        case node_types_1.NodeType.PmiMarkup_Fastener:
        case node_types_1.NodeType.PmiMarkup_Gdt:
        case node_types_1.NodeType.PmiMarkup_Locator:
        case node_types_1.NodeType.PmiMarkup_MeasurementPoint:
        case node_types_1.NodeType.PmiMarkup_Roughness:
        case node_types_1.NodeType.PmiMarkup_Welding:
        case node_types_1.NodeType.PmiMarkup_Table:
        case node_types_1.NodeType.PmiMarkup_Other:
            svgId = 'ICON_MARKUP';
            break;
        case node_types_1.NodeType.DataAnalysisResult:
            svgId = 'ICON_HEATMAP';
            break;
        case node_types_1.NodeType.AnnotationReference:
            svgId = 'ICON_MARKUP';
            break;
        case node_types_1.NodeType.AnnotationSet:
            svgId = 'ICON_MARKUP';
            break;
        case node_types_1.NodeType.Curve:
            svgId = 'ICON_WIRE';
            break;
        case node_types_1.NodeType.Plane:
            svgId = 'ICON_PLANE';
            break;
        case node_types_1.NodeType.Solid:
            svgId = 'ICON_GEOMETRY';
            break;
        case node_types_1.NodeType.Wire:
            svgId = 'ICON_WIRE';
            break;
        case node_types_1.NodeType.Dimensioning:
            svgId = 'ICON_PMI_DISTANCE';
            break;
        case node_types_1.NodeType.MarkupSet:
            svgId = 'ICON_FOLDER';
            break;
        case node_types_1.NodeType.Markup_Circle:
            svgId = 'ICON_MARKUP_CIRCLE';
            break;
        case node_types_1.NodeType.Markup_Rectangle:
            svgId = 'ICON_RECTANGLE';
            break;
        case node_types_1.NodeType.Markup_Freehand:
            svgId = 'ICON_LINE_FREEHAND';
            break;
        case node_types_1.NodeType.Markup_Text:
            svgId = 'ICON_NOTE';
            break;
        case node_types_1.NodeType.OffsetLine:
            svgId = 'ICON_OFFSETLINE';
            break;
        case node_types_1.NodeType.Drawing_Block:
            svgId = 'ICON_FOLDER';
            break;
        case node_types_1.NodeType.Drawing_BlockBackground:
            svgId = 'ICON_FOLDER';
            break;
        case node_types_1.NodeType.Drawing_BlockBasic:
            svgId = 'ICON_FOLDER';
            break;
        case node_types_1.NodeType.Drawing_BlockOperator:
            svgId = 'ICON_FOLDER';
            break;
        case node_types_1.NodeType.Drawing_Sheet:
            svgId = 'ICON_SHEET';
            break;
        case node_types_1.NodeType.Drawing_View:
            svgId = 'ICON_VIEW';
            break;
        case node_types_1.NodeType.Drawing_Model:
            svgId = 'ICON_SHEET';
            break;
        case node_types_1.NodeType.CutGeometry_Set:
            svgId = 'ICON_FOLDER';
            break;
        case node_types_1.NodeType.CutGeometry_Wire:
            svgId = 'ICON_WIRE';
            break;
        case node_types_1.NodeType.CutGeometry_Surface:
            svgId = 'ICON_PLANE';
            break;
        case node_types_1.NodeType.Document2D:
            svgId = 'ICON_SHEET';
            break;
        default:
            svgId = 'ICON_GEOMETRY';
    }
    return svgId;
}


/***/ }),
/* 63 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var w = __webpack_require__(10);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var app_states_1 = __webpack_require__(4);
var ribbonMenu = __webpack_require__(13);
var NeighbourhoodSearchPane = (function (_super) {
    __extends(NeighbourhoodSearchPane, _super);
    function NeighbourhoodSearchPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            if (response && !response.Type) {
                if (_this.values && _this.values['Event']) {
                    response = _this.values['Event'];
                }
            }
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    NeighbourhoodSearchPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetNeighbourhoodSearchPaneTemplate = "<Call Method=\"GetTemplate\"><Type>NeighbourhoodSearchPane</Type></Call>";
        vsClient.command.executeXML(GetNeighbourhoodSearchPaneTemplate);
        vsClient.once('GetTemplate.NeighbourhoodSearchPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    NeighbourhoodSearchPane.prototype.addMethods = function () {
        $("#wv-neighbourhoodsearch #OnNHSApplyToAllClick").off('click').click(function (ev) {
            var xml = '<Call Method="ApplyNeighbourhoodSearchSettings"/>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-neighbourhoodsearch #OnNHSCompute").off('click').click(function (ev) {
            var xml = '<Call Method="ExecuteNeighbourhoodSearch"/>';
            vsClient.command.executeXML(xml);
            vsClient.once('ExecuteNeighbourhoodSearch', function (res) {
                if (res.Error === 'SUCCESS') {
                    if ($('#UID_NEIGHBOURHOOD_SEARCH_CLOSE_SELECTION_MODE_FLAG').val() === 'true') {
                        vsClient.command.executeXML('<Call Method="SetSelectionMode"><SelectionMode>Select</SelectionMode></Call>');
                        vsClient.once('SetSelectionMode', function (response) {
                            if (response.Error === 'SUCCESS') {
                                app_states_1.appStates.selectionMode = 'Select';
                                ribbonMenu.handlePrependingPane('wv-neighbourhoodsearch', 'off');
                                var nhsButton = w.findButton('ID_RIBBON_NEIGHBOURHOOD_SEARCH');
                                if (nhsButton) {
                                    nhsButton.applyHighlight(false);
                                }
                                var selectButton = w.findButton('ID_RIBBON_SELECT');
                                if (selectButton) {
                                    selectButton.applyHighlight(true);
                                }
                            }
                        });
                    }
                }
            });
        });
    };
    NeighbourhoodSearchPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.addMethods();
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            if (path[0] === 'Event') {
                value = parseFloat(value).toString();
                pane.modifySettings(_this.values, path, value);
                var xml = XMLParser.serializeWithValue(path, value, ['Type=' + template['Event']]);
                vsClient.command.executeXML(xml);
            }
            else {
                pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
                var xml = XMLParser.serializeWithValue(path, value);
                var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
                vsClient.command.executeXML(settings);
                if (_this.hasPresets) {
                    _this.stack.changeToCustomPreset();
                }
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return NeighbourhoodSearchPane;
}(pane_template_1.PaneTemplate));
exports.NeighbourhoodSearchPane = NeighbourhoodSearchPane;


/***/ }),
/* 64 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var NeutralAxisPane = (function (_super) {
    __extends(NeutralAxisPane, _super);
    function NeutralAxisPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    NeutralAxisPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetNeutralAxisPaneTemplate = "<Call Method=\"GetTemplate\"><Type>NeutralAxisPane</Type></Call>";
        vsClient.command.executeXML(GetNeutralAxisPaneTemplate);
        vsClient.once('GetTemplate.NeutralAxisPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    NeutralAxisPane.prototype.addMethods = function () {
        $("#wv-neutralaxis #OnNeutralAxisComputeClicked").click(function (ev) {
            var xml = '<Call Method="Compute"><Mode>NeutralAxis</Mode></Call>';
            vsClient.command.executeXML(xml);
        });
    };
    NeutralAxisPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.addMethods();
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return NeutralAxisPane;
}(pane_template_1.PaneTemplate));
exports.NeutralAxisPane = NeutralAxisPane;


/***/ }),
/* 65 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var ProjectedAreaPane = (function (_super) {
    __extends(ProjectedAreaPane, _super);
    function ProjectedAreaPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    ProjectedAreaPane.prototype.addMethods = function () {
        $("#wv-projectedarea #OnProjectedAreaComputeClicked").click(function (ev) {
            var xml = '<Call Method="Compute">';
            xml += '<Mode>ProjectedArea</Mode>';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
    };
    ProjectedAreaPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetProjectedAreaPane = "<Call Method=\"GetTemplate\"><Type>ProjectedAreaPane</Type></Call>";
        vsClient.command.executeXML(GetProjectedAreaPane);
        vsClient.once('GetTemplate.ProjectedAreaPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    ProjectedAreaPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return ProjectedAreaPane;
}(pane_template_1.PaneTemplate));
exports.ProjectedAreaPane = ProjectedAreaPane;


/***/ }),
/* 66 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var app_states_1 = __webpack_require__(4);
var w = __webpack_require__(10);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var tooltip_1 = __webpack_require__(8);
var ui = __webpack_require__(0);
var PropertyPane = (function (_super) {
    __extends(PropertyPane, _super);
    function PropertyPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.scrollPosNode = 0;
        _this.scrollPosScene = 0;
        _this.sortAttributes = false;
        _this.update = function () {
            _this.nodePropertiesWrapper.scrollTop = _this.scrollPosNode;
            _this.scenePropertiesWrapper.scrollTop = _this.scrollPosScene;
            var heightString = 'calc(100% - ' + ($(_this.buttonRow).outerHeight(true)) + 'px)';
            _this.nodePropertiesWrapper.style.height = heightString;
            _this.scenePropertiesWrapper.style.height = heightString;
        };
        _this.noAdapter = true;
        _this.wrapperEl.style.overflow = 'hidden';
        _this.nodePropertiesWrapper = document.createElement('div');
        _this.nodePropertiesWrapper.style.overflowY = 'scroll';
        _this.nodePropertiesWrapper.onscroll = function (e) {
            _this.scrollPosNode = _this.nodePropertiesWrapper.scrollTop;
        };
        _this.scenePropertiesWrapper = document.createElement('div');
        _this.scenePropertiesWrapper.style.overflowY = 'scroll';
        _this.scenePropertiesWrapper.onscroll = function (e) {
            _this.scrollPosScene = _this.scenePropertiesWrapper.scrollTop;
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.scenePropertiesEl = document.createElement('table');
        _this.scenePropertiesEl.classList.add('pane-content');
        _this.scenePropertiesWrapper.style.display = '';
        _this.nodePropertiesWrapper.style.display = 'none';
        _this.attributesList = [];
        _this.buttonRow = document.createElement('div');
        _this.buttonRow.classList.add('pane-buttons-tab');
        var sortAttributesIcon = document.createElement('i');
        sortAttributesIcon.className = 'fa fa-sort-alpha-up tree-header-action-icon';
        sortAttributesIcon.addEventListener('click', function (ev) {
            _this.sortAttributes = !_this.sortAttributes;
            if (_this.sortAttributes) {
                sortAttributesIcon.style.backgroundColor = 'rgb(160, 160, 160)';
            }
            else {
                sortAttributesIcon.style.backgroundColor = '';
            }
            _this.addAttributes();
        });
        _this.sortAttributesTooltip = new tooltip_1.WVTooltip(sortAttributesIcon);
        _this.sortAttributesTooltip.setTitle(ui.translate('ID_SORT_NODE_ATTRIBUTES_SETTING_INFO'));
        _this.buttonRow.appendChild(sortAttributesIcon);
        _this.nodePropertiesWrapper.appendChild(_this.el);
        _this.scenePropertiesWrapper.appendChild(_this.scenePropertiesEl);
        _this.wrapperEl.appendChild(_this.buttonRow);
        _this.wrapperEl.appendChild(_this.nodePropertiesWrapper);
        _this.wrapperEl.appendChild(_this.scenePropertiesWrapper);
        _this.addMethods();
        return _this;
    }
    PropertyPane.prototype.addMethods = function () {
        $("#wv-properties #OnCreateGravityCenterClicked").off('click').on('click', function (ev) {
            var xml = '<Call Method="VisualizeGravityCenter">';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-properties #OnNumberOfTrianglesClicked").off('click').on('click', function (ev) {
            var xml = '<Call Method="Compute"><Mode>NumberOfTriangles</Mode></Call>';
            vsClient.command.executeXML(xml);
        });
    };
    PropertyPane.prototype.changeLang = function (lang) {
        this.changeTemplateLang();
        this.sortAttributesTooltip.setTitle(ui.translate('ID_SORT_NODE_ATTRIBUTES_SETTING_INFO'));
        this.addMethods();
    };
    PropertyPane.prototype.changeTemplateLang = function () {
        var _this = this;
        var GetScenePropertiesTemplate = "<Call Method=\"GetTemplate\"><Type>PropertiesPane</Type></Call>";
        vsClient.command.executeXML(GetScenePropertiesTemplate);
        vsClient.once('GetTemplate.PropertiesPane', function (response) {
            var template = response['Source']['Template'];
            _this.fromTemplate(template);
            if (_this.sceneSettings) {
                _this.updateSceneSettings(_this.sceneSettings);
            }
            if (_this.nodeProperties) {
                _this.updateNodeProperties(_this.nodeProperties);
            }
        });
    };
    PropertyPane.prototype.updateSceneSettings = function (settings) {
        if (settings.Error === 'SUCCESS') {
            this.sceneSettings = settings;
            var renderModes = settings['Settings']['Scene']['Visualization']['RenderMode'];
            var renderModeStr = renderModes;
            if (renderModeStr.length > 0) {
                var renderModes_1 = renderModeStr.split(' ');
                app_states_1.appStates.renderingModes = renderModes_1;
            }
            else {
                app_states_1.appStates.renderingModes = [];
            }
            var groupRender = w.findGroup('ID_RIBBON_RENDERING_MODE');
            var documentMode = w.findGroup('ID_RIBBON_GRAPHIC_EFFECTS');
            groupRender.getWidgets().forEach(function (button) { return button.applyHighlight(false); });
            documentMode.getWidgets().forEach(function (button) { return button.applyHighlight(false); });
            app_states_1.appStates.renderingModes.forEach(function (mode) {
                switch (mode) {
                    case 'Solid':
                        w.findButton('ID_RIBBON_SOLID').applyHighlight(true);
                        break;
                    case 'Wires':
                        w.findButton('ID_RIBBON_WIRES').applyHighlight(true);
                        break;
                    case 'Illustration':
                        w.findButton('ID_RIBBON_ILLUSTRATION_1').applyHighlight(true);
                        w.findButton('ID_RIBBON_ILLUSTRATION').applyHighlight(true);
                        break;
                    case 'Perspective':
                        w.findButton('ID_RIBBON_PERSPECTIVE').applyHighlight(true);
                        break;
                    case 'Inverse':
                        w.findButton('ID_RIBBON_INVERT').applyHighlight(true);
                        break;
                }
            });
            var groupGraphic = w.findGroup('ID_RIBBON_GRAPHIC_EFFECTS_1');
            if (!groupGraphic) {
                groupGraphic = w.findGroup('ID_RIBBON_GRAPHIC_EFFECTS');
            }
            groupGraphic.getWidgets().forEach(function (button) { return button.applyHighlight(false); });
            app_states_1.appStates.renderingModes.forEach(function (mode) {
                switch (mode) {
                    case 'Silhouette':
                        w.findButton('ID_RIBBON_SILHOUETTE').applyHighlight(true);
                        break;
                    case 'Opaque':
                        w.findButton('ID_RIBBON_OPAQUE').applyHighlight(true);
                        break;
                    case 'Shadow':
                        w.findButton('ID_RIBBON_SHADOW').applyHighlight(true);
                        break;
                    case 'Material':
                        w.findButton('ID_RIBBON_MATERIAL').applyHighlight(true);
                        break;
                }
            });
            this.scenePropertiesAdapter.updateValues(this.sceneSettings);
        }
    };
    PropertyPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.scenePropertiesAdapter = new pane.PaneAdapter(this.scenePropertiesEl);
        var appendRoot = true;
        this.scenePropertiesAdapter.fromTemplate(template['Group'][0], appendRoot);
        this.scenePropertiesAdapter.on('user-input', function (src, val) {
            if (val === 'toggle-folder-visibility') {
                _this.scenePropertiesAdapter.updateValues(_this.sceneSettings);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(_this.sceneSettings, path, val);
            var xml = XMLParser.serializeWithValue(path, val);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        this.nodePropertiesAdapter = new pane.PaneAdapter(this.el);
        this.nodePropertiesAdapter.fromTemplate(template['Group'][1], appendRoot);
        this.nodePropertiesAdapter.on('user-input', function (src, val) {
            if (val === 'toggle-folder-visibility') {
                _this.nodePropertiesAdapter.updateValues(_this.nodeProperties);
                _this.addAttributes();
                return;
            }
            else if (val === 'UID_PROPERTIES_PANE_ATTRIBUTES_SHOW') {
                _this.attributesList.forEach(function (item) {
                    $(item).show();
                });
                return;
            }
            else if (val === 'UID_PROPERTIES_PANE_ATTRIBUTES_HIDE') {
                _this.attributesList.forEach(function (item) {
                    $(item).hide();
                });
                return;
            }
            else if (src.item.id === 'UID_PRESET') {
                _this.setNodeProperty(['Event', 'PhysicalProperties', 'Density'], val);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(_this.nodeProperties, path, val);
            _this.setNodeProperty(path, val);
        });
    };
    PropertyPane.prototype.setNodeProperty = function (path, propValue) {
        var xml = XMLParser.serializeWithValue(path, propValue);
        xml = xml.replace('<Event>', '<Event Type="NodePropertiesChanged">');
        vsClient.command.executeXMLAsync(xml.replace(/\n<\//, "</"));
    };
    PropertyPane.prototype.clear = function () {
        while (this.el.firstChild) {
            this.el.removeChild(this.el.firstChild);
        }
    };
    PropertyPane.prototype.showSceneProperties = function () {
        this.nodePropertiesWrapper.style.display = 'none';
        this.scenePropertiesWrapper.style.display = '';
    };
    PropertyPane.prototype.updateNodeProperties = function (nodeProperties) {
        var value;
        if (nodeProperties.Event) {
            value = nodeProperties;
        }
        else {
            value = { Event: nodeProperties };
        }
        this.nodeProperties = value;
        this.scenePropertiesWrapper.style.display = 'none';
        this.nodePropertiesWrapper.style.display = '';
        this.nodePropertiesAdapter.updateValues(this.nodeProperties);
        $('#UID_PRESET').val(parseFloat(this.nodeProperties.Event.PhysicalProperties.Density.__text__).toFixed(6));
        this.addAttributes();
        this.addMethods();
    };
    PropertyPane.prototype.addAttributes = function () {
        if (this.attributesList) {
            for (var i = 0; i < this.attributesList.length; i++) {
                $(this.attributesList[i]).remove();
            }
            this.attributesList = [];
        }
        this.attributesRow = document.getElementById('UID_PROPERTIES_PANE_ATTRIBUTES');
        if (this.nodeProperties && this.nodeProperties.Event && this.nodeProperties.Event.Attributes) {
            var attributeArr = this.nodeProperties.Event.Attributes.Attribute;
            if (!Array.isArray(attributeArr)) {
                attributeArr = [attributeArr];
            }
            var attributes = attributeArr.slice();
            if (this.sortAttributes) {
                attributes = attributes.sort(function (a, b) {
                    var keyA = a.Key.toUpperCase();
                    var keyB = b.Key.toUpperCase();
                    if (keyA < keyB) {
                        return 1;
                    }
                    if (keyA > keyB) {
                        return -1;
                    }
                    return 0;
                });
            }
            for (var i = 0; i < attributes.length; i++) {
                var prop = attributes[i];
                var row = document.createElement('tr');
                row.className = 'pane-item';
                var rowName = document.createElement('td');
                var rowNameRef = $(rowName);
                rowNameRef.addClass('pane-item-entry-name pane-item-indent-level2');
                rowName.textContent = prop.Key;
                var rowNameTooltip = new tooltip_1.WVTooltip(rowName);
                rowNameTooltip.setTitle(prop.Key);
                row.appendChild(rowName);
                var rowValWrapper = document.createElement('td');
                rowValWrapper.className = 'pane-item-visual';
                var valWrapper = document.createElement('div');
                valWrapper.className = 'pane-item-entry-wrapper';
                valWrapper.style.position = 'relative';
                var rowVal = document.createElement('span');
                rowVal.className = 'pane-item-entry-text';
                rowVal.textContent = prop.Value;
                var rowValTooltip = new tooltip_1.WVTooltip(rowVal);
                rowValTooltip.setTitle(prop.Value);
                valWrapper.appendChild(rowVal);
                rowValWrapper.appendChild(valWrapper);
                row.appendChild(rowValWrapper);
                this.attributesList.push(row);
            }
            $(this.attributesRow).show();
            if (this.attributesList && this.attributesList.length > 0 && this.attributesRow) {
                for (var _i = 0, _a = this.attributesList; _i < _a.length; _i++) {
                    var row = _a[_i];
                    this.attributesRow.parentNode.insertBefore(row, this.attributesRow.nextSibling);
                }
            }
        }
        else {
            $(this.attributesRow).hide();
        }
    };
    PropertyPane.prototype.toggleAttributes = function (forceCollapse) {
        if (this.attributesRow && forceCollapse) {
            if ($(this.el).find('tbody').find('.far').first().hasClass('fa-plus-square')) {
                this.attributesRow.style.display = 'none';
                for (var i = 0; i < this.attributesList.length; i++) {
                    this.attributesList[i].style.display = 'none';
                }
            }
            else {
                this.attributesRow.style.display = '';
                if ($(this.attributesRow).find('i').first().hasClass('fa-minus-square')) {
                    for (var i = 0; i < this.attributesList.length; i++) {
                        this.attributesList[i].style.display = '';
                    }
                }
            }
            return;
        }
        for (var i = 0; i < this.attributesList.length; i++) {
            if (this.attributesList[i].style.display === '' || forceCollapse === true) {
                this.attributesList[i].style.display = 'none';
                $('#properties_attributes').removeClass('fa-minus-square');
                $('#properties_attributes').addClass('fa-plus-square');
            }
            else {
                $('#properties_attributes').removeClass('fa-plus-square');
                $('#properties_attributes').addClass('fa-minus-square');
                this.attributesList[i].style.display = '';
            }
        }
    };
    return PropertyPane;
}(pane_template_1.PaneTemplate));
exports.PropertyPane = PropertyPane;


/***/ }),
/* 67 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var QuickComparePane = (function (_super) {
    __extends(QuickComparePane, _super);
    function QuickComparePane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    QuickComparePane.prototype.addMethods = function () {
    };
    QuickComparePane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetQuickComparePaneTemplate = "<Call Method=\"GetTemplate\"><Type>QuickComparePane</Type></Call>";
        vsClient.command.executeXML(GetQuickComparePaneTemplate);
        vsClient.once('GetTemplate.QuickComparePane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
        });
    };
    QuickComparePane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return QuickComparePane;
}(pane_template_1.PaneTemplate));
exports.QuickComparePane = QuickComparePane;


/***/ }),
/* 68 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var clipboard_overlay_1 = __webpack_require__(37);
var SectionPane = (function (_super) {
    __extends(SectionPane, _super);
    function SectionPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.setSectionNormal = function () {
            if (_this.values.Event) {
                var eventPathToNormal = _this.values.Event.Movement.Normal;
                var xml = '<Call Method="SectionSetNormal">';
                xml += '<X>' + eventPathToNormal.X + '</X>';
                xml += '<Y>' + eventPathToNormal.Y + '</Y>';
                xml += '<Z>' + eventPathToNormal.Z + '</Z>';
                xml += '</Call>';
                vsClient.command.executeXMLAsync(xml);
            }
        };
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    SectionPane.prototype.addMethods = function () {
        $("#wv-section #OnSectionCenterHandleClicked").click(function (ev) {
            var xml = '<Call Method="SectionCenterHandles"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-section #OnSectionAlignmentXClicked").click(function (ev) {
            var xml = '<Call Method="SectionAlignAxis">';
            xml += '<Axis>X</Axis>';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-section #OnSectionAlignmentYClicked").click(function (ev) {
            var xml = '<Call Method="SectionAlignAxis">';
            xml += '<Axis>Y</Axis>';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-section #OnSectionAlignmentZClicked").click(function (ev) {
            var xml = '<Call Method="SectionAlignAxis">';
            xml += '<Axis>Z</Axis>';
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-section #OnSectionSetNormalClicked").click(function (ev) {
            vsClient.emit('setSectionNormal');
        });
        $("#wv-section #OnSectionCreateSurfaceClicked").click(function (ev) {
            var xml = '<Call Method="Compute"><Mode>SectionGeometry</Mode>';
            xml += '<Type>Filled</Type>';
            if ($('#UID_SECTION_PANE_CREATE_MULTIPLE').val() === 'true') {
                xml += '<Step>' + $('#UID_SECTION_PANE_STEP_WIDTH').text() + '</Step>';
            }
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-section #OnSectionCreateWireClicked").click(function (ev) {
            var xml = '<Call Method="Compute"><Mode>SectionGeometry</Mode>';
            xml += '<Type>Wire</Type>';
            if ($('#UID_SECTION_PANE_CREATE_MULTIPLE').val() === 'true') {
                xml += '<Step>' + $('#UID_SECTION_PANE_STEP_WIDTH').val() + '</Step>';
            }
            xml += '</Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-section #OnSectionVectorExportClicked").click(function (ev) {
            var xml = '<Call Method="ExportSectionGeometry"><ExportFormat2D>SVG</ExportFormat2D></Call>';
            vsClient.command.executeXML(xml);
            vsClient.once('ExportSectionGeometry', function (res) {
                var src = res.Image;
                var overlay = new clipboard_overlay_1.ClipboardModal(src, vsClient.vsCanvas.width, vsClient.vsCanvas.height, 'svg+xml');
            });
        });
    };
    SectionPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetSectionPaneTemplate = "<Call Method=\"GetTemplate\"><Type>SectionPane</Type></Call>";
        vsClient.command.executeXML(GetSectionPaneTemplate);
        vsClient.once('GetTemplate.SectionPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    SectionPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (src.item.id === 'UID_SECTION_PANE_CREATE_MULTIPLE') {
                return;
            }
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            if (path[0] === 'Event') {
                var event_1 = template['Event'];
                value = parseFloat(value).toString();
                pane.modifySettings(_this.values, path, value);
                var xml = XMLParser.serializeWithValue(path, value, ["Type=" + event_1]);
                vsClient.command.executeXML(xml);
            }
            else {
                pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
                var xml = XMLParser.serializeWithValue(path, value);
                var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
                vsClient.command.executeXML(settings);
                if (_this.hasPresets) {
                    _this.stack.changeToCustomPreset();
                }
            }
        });
        if (template['Event']) {
            var event_2 = template['Event'];
            vsClient.removeListener(event_2, this.update);
            vsClient.on(event_2, this.update);
        }
        vsClient.on('setSectionNormal', this.setSectionNormal);
    };
    return SectionPane;
}(pane_template_1.PaneTemplate));
exports.SectionPane = SectionPane;


/***/ }),
/* 69 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var app_settings_1 = __webpack_require__(9);
var pane_template_1 = __webpack_require__(1);
var SelectionsPane = (function (_super) {
    __extends(SelectionsPane, _super);
    function SelectionsPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.rows = [];
        _this.selections = [];
        _this.multiSelections = [];
        _this.multiRows = [];
        _this.update = function () {
        };
        _this.noAdapter = true;
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        _this.tableBody = document.createElement('tbody');
        _this.el.appendChild(_this.tableBody);
        _this.el.addEventListener('contextmenu', function (ev) {
            ev.preventDefault();
            $('#contextMenu').remove();
            $(document).off('mousedown', vsClient.vsCanvas.closeContextMenu);
            $(document).off('keyup', vsClient.vsCanvas.closeContextMenu);
            vsClient.vsCanvas.createContextMenu(ev);
        });
        var hiddenRow = document.createElement('tr');
        _this.tableBody.appendChild(hiddenRow);
        var titleRow = document.createElement('tr');
        titleRow.className = 'pane-item';
        var titleRowCell = document.createElement('td');
        titleRowCell.className = 'pane-item-visual pane-item-group';
        titleRowCell.colSpan = 2;
        _this.tableTitle = document.createElement('b');
        _this.tableTitle.className = '';
        _this.tableTitle.textContent = _lang_data['ID_SELECTIONS_COLUMN_NAME'][app_settings_1.settings.lang];
        titleRow.appendChild(titleRowCell);
        titleRowCell.appendChild(_this.tableTitle);
        _this.tableBody.appendChild(titleRow);
        vsClient.on('OpenFile', function (res) {
            _this.reset();
        });
        vsClient.on('NewScene3D', function (res) {
            _this.reset();
        });
        vsClient.on('GetSavedSelections', function (res) {
            _this.buildSelectionTable(res);
        });
        vsClient.on('SavedSelectionsChanged', function (res) {
            _this.buildSelectionTable(res, false);
        });
        _this.buttons = document.createElement('div');
        _this.buttons.classList.add('pane-buttons-tab');
        var addSelection = document.createElement('i');
        addSelection.className = 'fa fa-plus tree-header-action-icon';
        addSelection.addEventListener('click', function (ev) {
            var createCall = '<Call Method="SaveCurrentSelection"></Call>';
            vsClient.command.executeXML(createCall);
        });
        var updateSelection = document.createElement('i');
        updateSelection.className = 'fa fa-sync-alt tree-header-action-icon';
        updateSelection.addEventListener('click', function (ev) {
            var row = _this.selectedRow;
            var updateXML = '<Call Method="UpdateSavedSelection"><Index>' + row.id.split('_')[1] + '</Index></Call>';
            vsClient.command.executeXML(updateXML);
        });
        var removeSelection = document.createElement('i');
        removeSelection.className = 'fa fa-trash tree-header-action-icon';
        removeSelection.addEventListener('click', function (ev) {
            var xml = '<Call Method="DeleteSavedSelections">';
            for (var i = 0; i < _this.multiRows.length; i++) {
                var row = _this.multiRows[i];
                xml += '<Index>' + row.id.split('_')[1] + '</Index>';
            }
            xml += '</Call>';
            vsClient.command.executeXML(xml);
            _this.multiRows = [];
        });
        _this.buttons.appendChild(addSelection);
        _this.buttons.appendChild(updateSelection);
        _this.buttons.appendChild(removeSelection);
        _this.wrapperEl.appendChild(_this.buttons);
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    SelectionsPane.prototype.addMethods = function () {
    };
    SelectionsPane.prototype.changeLang = function (lang) {
        this.tableTitle.textContent = _lang_data['ID_SELECTIONS_COLUMN_NAME'][app_settings_1.settings.lang];
    };
    SelectionsPane.prototype.reset = function (getNewSessions, resetSelection) {
        if (getNewSessions === void 0) { getNewSessions = true; }
        if (resetSelection === void 0) { resetSelection = true; }
        for (var i = 0; i < this.rows.length; i++) {
            $(this.rows[i]).remove();
        }
        this.rows = [];
        if (resetSelection) {
            this.multiRows = [];
            this.multiSelections = [];
            this.selectedRow = undefined;
        }
        this.selections = [];
        if (getNewSessions) {
            var xml = '<Call Method="GetSavedSelections"></Call>';
            vsClient.command.executeXML(xml);
        }
    };
    SelectionsPane.prototype.buildSelectionTable = function (res, resetSelection) {
        if (resetSelection === void 0) { resetSelection = true; }
        this.reset(false, resetSelection);
        if (!res.Selection) {
            return;
        }
        if (res.Selection && !Array.isArray(res.Selection)) {
            res.Selection = [res.Selection];
        }
        for (var i = 0; i < res.Selection.length; i++) {
            this.addRow(res.Selection[i].Index, res.Selection[i].Name, !resetSelection);
        }
    };
    SelectionsPane.prototype.enableTextChange = function (element) {
        var el = $(element);
        el.attr('contenteditable', 'true');
        el.focus();
        var range = document.createRange();
        range.selectNodeContents(element);
        var sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
        el.blur(function (e) {
            $(e.target).off('blur');
            $(e.target).attr('contenteditable', 'false');
            var newName = e.target.textContent;
            var index = e.target.parentElement.parentElement.id.split('_')[1];
            var xml = '<Call Method="RenameSavedSelection"><Index>' + index + '</Index>';
            xml += '<Name>' + newName + '</Name></Call>';
            vsClient.command.executeXML(xml);
        });
        el.on('keydown', function (e) {
            if (e.keyCode === 13) {
                e.preventDefault();
                $(e.target).off('keyup');
                $(e.target).attr('contenteditable', 'false');
            }
        });
    };
    SelectionsPane.prototype.addRow = function (index, name, applySelectionState) {
        var _this = this;
        if (applySelectionState === void 0) { applySelectionState = false; }
        var newRow = document.createElement('tr');
        newRow.className = 'pane-item selection-pane-row';
        newRow.id = 'Selection_' + index;
        var newRowCell = document.createElement('td');
        newRowCell.className = 'pane-item-entry-name pane-item-visual';
        newRowCell.colSpan = 2;
        newRowCell.style.whiteSpace = 'normal';
        var newRowEditIcon = document.createElement('i');
        newRowEditIcon.className = 'fas fa-edit selection-pane-row-icon';
        newRowEditIcon.onclick = function (ev) {
            _this.enableTextChange(newRowText);
        };
        var newRowText = document.createElement('span');
        newRowText.textContent = name;
        newRowText.addEventListener('keyup', function (ev) {
            ev.preventDefault();
            ev.stopPropagation();
        });
        var newRowBadge = document.createElement('div');
        newRowBadge.className = 'selection-pane-row-badge';
        newRowBadge.id = 'Selection_' + index + '_Number';
        newRowBadge.textContent = '-';
        var changeText = false;
        $(newRowText).mousedown(function (ev) {
            changeText = true;
            setTimeout(function () {
                if (changeText) {
                    _this.enableTextChange(newRowText);
                }
            }, 500);
        });
        $(newRowText).mouseup(function (ev) {
            changeText = false;
        });
        newRow.onclick = function (ev) {
            var selection = newRow.id.split('_')[1];
            if (ev.ctrlKey) {
                $(newRow).toggleClass('selection-pane-row-active');
                if (_this.multiRows.indexOf(newRow) === -1) {
                    _this.multiRows.push(newRow);
                    if (_this.multiSelections.indexOf(selection) === -1) {
                        _this.multiSelections.push(selection);
                    }
                    var xml = '<Call Method="ActivateSavedSelections">';
                    for (var n = 0; n < _this.multiSelections.length; n++) {
                        xml += '<Index>' + _this.multiSelections[n] + '</Index>';
                    }
                    xml += '</Call>';
                    vsClient.command.executeXML(xml);
                }
                else {
                    var index_1 = _this.multiRows.indexOf(newRow);
                    _this.multiRows.splice(index_1, 1);
                    for (var s = 0; s < selection.length; s++) {
                        if (_this.multiSelections.indexOf(selection) !== -1) {
                            _this.multiSelections.splice(_this.multiSelections.indexOf(selection), 1);
                        }
                    }
                    var xml = '<Call Method="ActivateSavedSelections">';
                    for (var n = 0; n < _this.multiSelections.length; n++) {
                        xml += '<Index>' + _this.multiSelections[n] + '</Index>';
                    }
                    xml += '</Call>';
                    vsClient.command.executeXML(xml);
                }
            }
            else {
                $('.selection-pane-row-active').each(function (ev) {
                    $(this).removeClass('selection-pane-row-active');
                });
                $(newRow).addClass('selection-pane-row-active');
                _this.selectedRow = newRow;
                _this.multiRows = [];
                _this.multiSelections = [];
                _this.multiRows.push(newRow);
                _this.multiSelections.push(selection);
                var xml = '<Call Method="ActivateSavedSelections">';
                xml += '<Index>' + selection + '</Index>';
                xml += '</Call>';
                vsClient.command.executeXML(xml);
            }
        };
        newRowCell.appendChild(newRowEditIcon);
        newRowCell.appendChild(newRowText);
        newRow.appendChild(newRowCell);
        this.rows.push(newRow);
        var newSelection = {
            id: 'Selection_' + index,
            count: '-'
        };
        this.tableBody.appendChild(newRow);
        this.selections.push(newSelection);
        if (applySelectionState && this.selectedRow && this.selectedRow.id.split('_')[1] === index) {
            $(newRow).addClass('selection-pane-row-active');
        }
    };
    return SelectionsPane;
}(pane_template_1.PaneTemplate));
exports.SelectionsPane = SelectionsPane;


/***/ }),
/* 70 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var app_settings_1 = __webpack_require__(9);
var ui = __webpack_require__(0);
var pane = __webpack_require__(2);
var js2xmlparser = __webpack_require__(17);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var tooltip_1 = __webpack_require__(8);
var app_states_1 = __webpack_require__(4);
var SettingsPane = (function (_super) {
    __extends(SettingsPane, _super);
    function SettingsPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.scrollPosGlobal = 0;
        _this.scrollPosScene = 0;
        _this.resizableHandleAdded = false;
        _this.update = function () {
            _this.globalSettingsWrapper.scrollTop = _this.scrollPosGlobal;
            _this.sceneSettingsWrapper.scrollTop = _this.scrollPosScene;
            var heightString = 'calc(100% - ' + ($(_this.buttonsTab).outerHeight(true) + $(_this.viewTab).outerHeight(true)) + 'px)';
            _this.globalSettingsWrapper.style.height = heightString;
            _this.sceneSettingsWrapper.style.height = heightString;
            if (_this.defaultSettings) {
                _this.updateSceneSettings();
                _this.updateSettings(_this.defaultSettings);
            }
        };
        _this.noAdapter = true;
        _this.langId_default = 'ID_DEFAULT_COLOR';
        _this.langId_currentScene = 'ID_SCENE_TAB';
        _this.globalSettingsEl = document.createElement('table');
        _this.globalSettingsEl.classList.add('pane-content');
        _this.globalSettingsEl.style.minWidth = '100px';
        _this.sceneSettingsEl = document.createElement('table');
        _this.sceneSettingsEl.classList.add('pane-content');
        _this._buildTabs();
        _this._buildSearch();
        _this.buttonsTab.appendChild(_this.searchInput);
        _this.wrapperEl.appendChild(_this.buttonsTab);
        _this.wrapperEl.appendChild(_this.viewTab);
        ;
        _this.globalSettingsWrapper = document.createElement('div');
        _this.globalSettingsWrapper.classList.add('pane-scroll-area');
        _this.globalSettingsWrapper.style.overflowY = 'scroll';
        _this.globalSettingsWrapper.appendChild(_this.globalSettingsEl);
        _this.globalSettingsWrapper.onscroll = function (e) {
            _this.scrollPosGlobal = _this.globalSettingsWrapper.scrollTop;
        };
        _this.sceneSettingsWrapper = document.createElement('div');
        _this.sceneSettingsWrapper.classList.add('pane-scroll-area');
        _this.sceneSettingsWrapper.style.overflowY = 'scroll';
        _this.sceneSettingsWrapper.appendChild(_this.sceneSettingsEl);
        _this.sceneSettingsWrapper.hidden = true;
        _this.sceneSettingsWrapper.onscroll = function (e) {
            _this.scrollPosScene = _this.sceneSettingsWrapper.scrollTop;
        };
        _this.wrapperEl.appendChild(_this.globalSettingsWrapper);
        _this.wrapperEl.appendChild(_this.sceneSettingsWrapper);
        _this.wrapperEl.style.overflow = 'hidden';
        return _this;
    }
    SettingsPane.prototype._buildTabs = function () {
        var _this = this;
        this.buttonsTab = document.createElement('div');
        this.buttonsTab.classList.add('pane-buttons-tab-large');
        this.expandAll = document.createElement('i');
        this.expandAll.className = 'fa fa-chevron-double-right tree-header-action-icon';
        this.expandAll.addEventListener('click', function (ev) {
            var target;
            if (_this.globalSettingsWrapper.hidden) {
                target = _this.sceneSettingsAdapter;
            }
            else {
                target = _this.settingsAdapter;
            }
            target.root.children.forEach(function (item) {
                var folder = item.visual;
                folder.expander.classList.remove(pane.Folder.minus, pane.Folder.plus);
                folder.expander.classList.add(pane.Folder.minus);
                item.expandAll();
            });
            _this.sceneSettingsAdapter.emit('user-input', _this, 'toggle-folder-visibility');
            _this.settingsAdapter.emit('user-input', _this, 'toggle-folder-visibility');
        });
        this.expandAllTooltip = new tooltip_1.WVTooltip(this.expandAll);
        this.expandAllTooltip.setTitle(_lang_data['ID_EXPAND_ALL'][this.lang]);
        this.collapseAll = document.createElement('i');
        this.collapseAll.className = 'fa fa-chevron-double-left tree-header-action-icon';
        this.collapseAll.addEventListener('click', function (ev) {
            var target;
            if (_this.globalSettingsWrapper.hidden) {
                target = _this.sceneSettingsAdapter;
            }
            else {
                target = _this.settingsAdapter;
            }
            target.root.children.forEach(function (item) {
                var folder = item.visual;
                folder.expander.classList.remove(pane.Folder.minus, pane.Folder.plus);
                folder.expander.classList.add(pane.Folder.plus);
                item.collapseAll(false);
            });
            _this.sceneSettingsAdapter.emit('user-input', _this, 'toggle-folder-visibility');
            _this.settingsAdapter.emit('user-input', _this, 'toggle-folder-visibility');
        });
        this.collapseAllTooltip = new tooltip_1.WVTooltip(this.collapseAll);
        this.collapseAllTooltip.setTitle(_lang_data['ID_COLLAPSE_ALL'][this.lang]);
        this.saveIcon = document.createElement('i');
        this.saveIcon.className = 'fa fa-save tree-header-action-icon';
        this.saveIcon.id = 'save_scene_settings';
        this.saveIcon.addEventListener('click', function (ev) {
            var sceneSettings = _this.sceneSettings.Settings.Scene;
            var mergedSettings = _this.defaultSettings.Settings;
            mergedSettings.Scene = sceneSettings;
            mergedSettings = removeProp(mergedSettings, '__text__');
            mergedSettings = removeProp(mergedSettings, '__ordinal__');
            delete mergedSettings.Renderer.General.Language;
            var xml = js2xmlparser.parse('Settings', mergedSettings).replace("<?xml version='1.0'?>", "");
            var settingsCall = '<Call Method="SetSettings">' + xml + '</Call>';
            vsClient.command.executeXML(settingsCall);
        });
        this.saveIconTooltip = new tooltip_1.WVTooltip(this.saveIcon);
        this.saveIconTooltip.setTitle(_lang_data['ID_RIBBON_SAVE'][this.lang].split('(')[0]);
        this.refreshIcon = document.createElement('i');
        this.refreshIcon.className = 'fa fa-sync-alt tree-header-action-icon';
        this.refreshIcon.id = 'settings_refresh';
        this.refreshIcon.addEventListener('click', function (ev) {
            localStorage.setItem('VSWVSettings', localStorage.getItem('VSWVDefaultSettings'));
            var settingsCall = '<Call Method="SetSettings">' + localStorage.getItem('VSWVDefaultSettings') + '</Call>';
            vsClient.command.executeXMLAsync(settingsCall);
            settingsCall = '<Call Method="GetSettings"></Call>';
            vsClient.command.executeXMLAsync(settingsCall);
            vsClient.once('GetSettings', function (response, xml) {
                _this.updateSettings(response);
            });
            localStorage.removeItem('nativeLoadingSettings');
        });
        this.refreshIconTooltip = new tooltip_1.WVTooltip(this.refreshIcon);
        this.refreshIconTooltip.setTitle(_lang_data['ID_BUTTON_PROFILES_DEFAULT'][this.lang].split('(')[0]);
        this.buttonsTab.appendChild(this.expandAll);
        this.buttonsTab.appendChild(this.collapseAll);
        this.buttonsTab.appendChild(this.saveIcon);
        this.buttonsTab.appendChild(this.refreshIcon);
        this.viewTab = document.createElement('div');
        this.viewTab.classList.add('settings-selector-header');
        this.settingsButton = document.createElement('span');
        this.settingsButton.textContent = _lang_data[this.langId_default][app_settings_1.settings.lang];
        this.settingsButton.className = 'active-settings-pane';
        this.settingsButton.classList.add('general-settings-tab');
        this.settingsButton.addEventListener('click', function (ev) {
            if ($(_this.settingsButton).hasClass('active-settings-pane')) {
                return;
            }
            $(_this.settingsButton).toggleClass('active-settings-pane');
            $(_this.currentSceneButton).toggleClass('active-settings-pane');
            _this.sceneSettingsWrapper.hidden = true;
            _this.globalSettingsWrapper.hidden = false;
            _this.settingsAdapter.filter(_this.searchInput.value);
        });
        this.currentSceneButton = document.createElement('span');
        this.currentSceneButton.textContent = _lang_data[this.langId_currentScene][app_settings_1.settings.lang];
        this.currentSceneButton.classList.add('scene-settings-tab');
        this.currentSceneButton.addEventListener('click', function (ev) {
            if ($(_this.currentSceneButton).hasClass('active-settings-pane')) {
                return;
            }
            $(_this.settingsButton).toggleClass('active-settings-pane');
            $(_this.currentSceneButton).toggleClass('active-settings-pane');
            _this.sceneSettingsWrapper.hidden = false;
            _this.globalSettingsWrapper.hidden = true;
            _this.sceneSettingsAdapter.filter(_this.searchInput.value);
        });
        this.viewTab.appendChild(this.settingsButton);
        this.viewTab.appendChild(this.currentSceneButton);
    };
    SettingsPane.prototype._buildSearch = function () {
        var _this = this;
        this.searchInput = document.createElement('input');
        this.searchInput.className = 'settings-pane-search-input';
        this.searchInput.placeholder = 'Search Settings...';
        this.searchInput.setAttribute('type', 'search');
        this.searchInput.onfocus = function (e) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
        };
        this.searchInput.onblur = function (e) {
            app_states_1.appStates.preventGlobalKeyEvents = false;
        };
        this.searchInput.addEventListener('input', function (ev) {
            if (_this.sceneSettingsWrapper.hidden) {
                _this.settingsAdapter.filter(_this.searchInput.value);
                _this.settingsAdapter.filterString = _this.searchInput.value;
            }
            else if (_this.globalSettingsWrapper.hidden) {
                _this.sceneSettingsAdapter.filter(_this.searchInput.value);
                _this.sceneSettingsAdapter.filterString = _this.searchInput.value;
            }
        });
    };
    SettingsPane.prototype.fromTemplate = function (settingsTemplate) {
        var _this = this;
        this.settingsTemaplte = settingsTemplate;
        this.settingsAdapter = new pane.PaneAdapter(this.globalSettingsEl);
        this.settingsAdapter.fromTemplate(settingsTemplate['Group']);
        this.settingsAdapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                return;
            }
            var path = src.item.path;
            pane.modifySettings(_this.defaultSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSettings\"> " + xml + " </Call>";
            vsClient.command.executeXMLAsync(settings);
        });
        this.sceneSettingsAdapter = new pane.PaneAdapter(this.sceneSettingsEl);
        this.sceneSettingsAdapter.fromTemplate(settingsTemplate['Group']['Group'][2]);
        this.sceneSettingsAdapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                return;
            }
            var path = src.item.path;
            pane.modifySettings(_this.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXMLAsync(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
    };
    SettingsPane.prototype.addMethods = function () {
    };
    SettingsPane.prototype.changeLang = function (lang) {
        var _this = this;
        this.expandAllTooltip.setTitle(_lang_data['ID_EXPAND_ALL'][lang]);
        this.collapseAllTooltip.setTitle(_lang_data['ID_COLLAPSE_ALL'][lang]);
        this.refreshIconTooltip.setTitle(_lang_data['ID_BUTTON_PROFILES_DEFAULT'][lang].split('(')[0]);
        this.saveIconTooltip.setTitle(_lang_data['ID_RIBBON_SAVE'][lang]);
        this.settingsButton.textContent = _lang_data[this.langId_default][lang];
        this.currentSceneButton.textContent = _lang_data[this.langId_currentScene][lang];
        var GetSettingsTemplate = "<Call Method=\"GetTemplate\"><Type>SettingsPane</Type></Call>";
        vsClient.command.executeXML(GetSettingsTemplate);
        vsClient.once('GetTemplate.SettingsPane', function (response) {
            var template = response['Source']['Template'];
            ui.settingsPane.fromTemplate(template);
            if (_this.defaultSettings) {
                _this.updateSettings(_this.defaultSettings);
                if (_this.sceneSettings) {
                    _this.updateSceneSettings(_this.sceneSettings);
                }
            }
        });
    };
    SettingsPane.prototype.updateSettings = function (settings) {
        this.defaultSettings = settings;
        this.settingsAdapter.updateValues(this.defaultSettings);
    };
    SettingsPane.prototype.updateSceneSettings = function (settings) {
        if (settings === void 0) { settings = undefined; }
        if (settings !== undefined) {
            this.sceneSettings = settings;
        }
        this.sceneSettingsAdapter.updateValues(this.sceneSettings);
    };
    SettingsPane.prototype.applySettings = function (settings) {
        var buildAttribute = 'Build="' + settings.Build + '"';
        var xml = js2xmlparser.parse('Settings', settings);
        var re = new RegExp('<Settings>\n    <Build>' + settings.Build + '</Build>');
        xml = xml.replace(re, '<Settings ' + buildAttribute + '>');
        var s = "<Call Method=\"SetSettings\">" + xml + "</Call>";
        vsClient.command.executeXML(s);
    };
    SettingsPane.prototype.applySceneSettings = function (settings) {
        var buildAttribute = 'Build="' + settings.Build + '"';
        var xml = js2xmlparser.parse('Settings', settings);
        var re = new RegExp('<Settings>\n    <Build>' + settings.Build + '</Build>');
        xml = xml.replace(re, '<Settings ' + buildAttribute + '>');
        var s = "<Call Method=\"SetSceneSettings\">" + xml + "</Call>";
        vsClient.command.executeXMLAsync(s);
    };
    return SettingsPane;
}(pane_template_1.PaneTemplate));
exports.SettingsPane = SettingsPane;
var removeProp = function (obj, prop) {
    Object.keys(obj).forEach(function (key) {
        return (key === prop) && delete obj[key] ||
            (obj[key] && typeof obj[key] === 'object') && removeProp(obj[key], prop);
    });
    return obj;
};


/***/ }),
/* 71 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var widgets_1 = __webpack_require__(11);
var SplitPane = (function (_super) {
    __extends(SplitPane, _super);
    function SplitPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.sessions = [];
        _this.resultInitialized = false;
        _this.update = function (response) {
            if (response === true) {
                $(_this.groupTableBody).empty();
                $(_this.groupTable).hide();
                _this.sessions = [];
                _this.activeSession = undefined;
                if (_this.resultGroup) {
                    _this.resultGroup.collapse();
                    $(_this.resultGroup.wrapperEl).hide();
                }
            }
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        var buttonRowTable = document.createElement('table');
        buttonRowTable.className = 'pane-content';
        var splitRestartSessionButton = new widgets_1.PlainButton(3, buttonRowTable, "", "", 'ID_SPLIT_RESTART_SESSION_BUTTON', _this.restartSession.bind(_this));
        _this.wrapperEl.appendChild(buttonRowTable);
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        _this.groupTable = document.createElement('table');
        _this.groupTable.className = 'pane-content';
        _this.wrapperEl.appendChild(_this.groupTable);
        var tableHeader = document.createElement('thead');
        _this.groupTable.appendChild(tableHeader);
        var headerRow = document.createElement('tr');
        headerRow.className = 'pane-item';
        tableHeader.appendChild(headerRow);
        _this.directionCol = document.createElement('th');
        _this.directionCol.textContent = ui.translate('ID_SPLIT_DIRECTION_VECTOR');
        _this.directionCol.className = 'pane-item-entry-name';
        headerRow.appendChild(_this.directionCol);
        _this.upCol = document.createElement('th');
        _this.upCol.textContent = ui.translate('ID_SPLIT_RESULT_GROUP_UP');
        _this.upCol.className = 'pane-item-entry-name';
        headerRow.appendChild(_this.upCol);
        _this.downCol = document.createElement('th');
        _this.downCol.textContent = ui.translate('ID_SPLIT_RESULT_GROUP_DOWN');
        _this.downCol.className = 'pane-item-entry-name';
        headerRow.appendChild(_this.downCol);
        _this.groupTableBody = document.createElement('tbody');
        _this.groupTable.appendChild(_this.groupTableBody);
        var placeholderRow = document.createElement('tr');
        _this.groupTableBody.appendChild(placeholderRow);
        $(_this.groupTable).hide();
        return _this;
    }
    SplitPane.prototype.appendSplitSession = function (ev) {
        var _this = this;
        if (ev.Error !== 'SUCCESS') {
            return;
        }
        var tableBody = $(this.el).children('tbody').first()[0];
        var session = {
            id: parseInt(ev.SplitSessionId),
            name: ev.SplitSessionName,
            directionId: parseInt(ev.SplitDirectionId),
            directionName: ev.SplitDirectionName,
            upColor: ev.SplitGroupUpColor,
            upNumPatches: parseInt(ev.SplitGroupUpNumPatches),
            downColor: ev.SplitGroupDownColor,
            downNumPatches: parseInt(ev.SplitGroupDownNumPatches),
            unassignedColor: ev.SplitGroupUnassignedColor,
            unassignedNumPatches: parseInt(ev.SplitGroupUnassignedNumPatches),
            directionEl: undefined,
            upEl: undefined,
            downEl: undefined,
            maxExplodeDistance: parseFloat(ev.SplitFullExplodeDistance),
            sliderPos: ev.SplitExplodeSliderPosition ? parseFloat(ev.SplitExplodeSliderPosition) : 0
        };
        if (!this.resultInitialized) {
            this.resultGroup = new widgets_1.PlainGroup(1, tableBody, 'ID_SPLIT_RESULTS', "");
            this.resultSessionIdEl = new widgets_1.PlainInput(2, tableBody, 'ID_SPLIT_SESSION_ID', "", 'false', undefined);
            this.resultSessionNameEl = new widgets_1.PlainInput(2, tableBody, 'ID_SPLIT_SESSION_NAME', "", 'true', this.setSessionName.bind(this));
            this.resultExplodeDistanceEl = new widgets_1.PlainInput(2, tableBody, 'ID_SPLIT_EXPLODE_DISTANCE', "", 'true', this.setMaxExplodeDistance.bind(this));
            this.resultSliderEl = new widgets_1.PlainSlider(2, tableBody, 'ID_SPLIT_EXPLODE_LEVEL', "", this.setDistance);
            this.resultSliderEl.setVal(0);
            this.resultGroup.children.push(this.resultSessionIdEl.wrapperEl, this.resultSessionNameEl.wrapperEl, this.resultExplodeDistanceEl.wrapperEl, this.resultSliderEl.wrapperEl);
            var unassignedGroup = new widgets_1.PlainGroup(2, tableBody, 'ID_SPLIT_RESULT_GROUP_UNASSIGNED', "");
            this.unassignedPatches = new widgets_1.PlainInput(3, tableBody, 'ID_SPLIT_NUMBER_OF_UNASSIGNED_PATCHES', "", 'false', undefined);
            this.unassignedColor = new widgets_1.PlainColorPicker(3, tableBody, 'ID_COLOR', "", this.setUnassignedColor.bind(this));
            var unassignedButton = new widgets_1.PlainButton(3, tableBody, "", "", 'ID_SPLIT_REGROUP_PATCH', this.moveUnassigned.bind(this));
            unassignedGroup.children.push(this.unassignedPatches.wrapperEl, this.unassignedColor.wrapperEl, unassignedButton.wrapperEl);
            var upGroup = new widgets_1.PlainGroup(2, tableBody, 'ID_SPLIT_RESULT_GROUP_UP', "");
            this.upColor = new widgets_1.PlainColorPicker(3, tableBody, 'ID_COLOR', "", this.setUpColor.bind(this));
            var upButton = new widgets_1.PlainButton(3, tableBody, "", "", 'ID_SPLIT_REGROUP_PATCH', this.moveUp.bind(this));
            upGroup.children.push(this.upColor.wrapperEl, upButton.wrapperEl);
            var downGroup = new widgets_1.PlainGroup(2, tableBody, 'ID_SPLIT_RESULT_GROUP_DOWN', "");
            this.downColor = new widgets_1.PlainColorPicker(3, tableBody, 'ID_COLOR', "", this.setDownColor.bind(this));
            var downButton = new widgets_1.PlainButton(3, tableBody, "", "", 'ID_SPLIT_REGROUP_PATCH', this.moveDown.bind(this));
            downGroup.children.push(this.downColor.wrapperEl, downButton.wrapperEl);
            this.resultGroup.childGroups.push(unassignedGroup, upGroup, downGroup);
            this.resultInitialized = true;
            $(this.groupTable).show();
        }
        if (this.sessions.length === 0) {
            var placeholderRow = document.createElement('tr');
            this.groupTableBody.appendChild(placeholderRow);
            $(this.groupTable).show();
            this.resultGroup.expand();
            $(this.resultGroup.wrapperEl).show();
        }
        var tableRow = document.createElement('tr');
        tableRow.className = 'pane-item';
        tableRow.onclick = function (e) {
            _this.activateSession(session);
        };
        this.groupTableBody.appendChild(tableRow);
        session.directionEl = document.createElement('td');
        session.directionEl.textContent = session.directionName;
        session.directionEl.className = 'pane-item-entry-name';
        tableRow.appendChild(session.directionEl);
        session.upEl = document.createElement('td');
        session.upEl.textContent = session.upNumPatches.toString();
        session.upEl.style.backgroundColor = '#' + session.upColor.slice(3);
        session.upEl.style.color = this.calculateFontColor('#' + session.downColor.slice(3));
        session.upEl.className = 'pane-item-entry-name';
        tableRow.appendChild(session.upEl);
        session.downEl = document.createElement('td');
        session.downEl.textContent = session.downNumPatches.toString();
        session.downEl.style.backgroundColor = '#' + session.downColor.slice(3);
        session.downEl.style.color = this.calculateFontColor('#' + session.downColor.slice(3));
        session.downEl.className = 'pane-item-entry-name';
        tableRow.appendChild(session.downEl);
        this.sessions.push(session);
        this.activateSession(session);
    };
    SplitPane.prototype.clearGroupTable = function () {
        $(this.groupTableBody).empty();
    };
    SplitPane.prototype.restartSession = function () {
        if (!this.resultGroup) {
            return;
        }
        var xml = '<Call Method="StartNewSplitSession"></Call>';
        vsClient.command.executeXML(xml);
        $(this.groupTable).hide();
        this.sessions = [];
        this.resultGroup.collapse();
        this.clearGroupTable();
        $(this.resultGroup.wrapperEl).hide();
    };
    SplitPane.prototype.activateSession = function (session) {
        this.resultSliderEl.setVal(session.sliderPos / 100);
        this.resultExplodeDistanceEl.setVal(session.maxExplodeDistance);
        this.resultSessionIdEl.setVal(session.id);
        this.resultSessionNameEl.setVal(session.name);
        this.unassignedPatches.setVal(session.unassignedNumPatches);
        this.unassignedColor.setVal(session.unassignedColor);
        this.upColor.setVal(session.upColor);
        this.downColor.setVal(session.downColor);
        this.activeSession = session;
        $('.split-group-active').removeClass('split-group-active');
        $(session.directionEl).addClass('split-group-active');
    };
    SplitPane.prototype.setSessionName = function (val) {
    };
    SplitPane.prototype.setMaxExplodeDistance = function (val) {
        var xml = '<Call Method="SetSplitFullExplodeDistance">';
        xml += '<SplitFullExplodeDistance>' + parseFloat(val) + '</SplitFullExplodeDistance>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
    };
    SplitPane.prototype.setDistance = function (val) {
        var xml = '<Call Method="ExplodeSplitGroups">';
        xml += '<Position>' + parseInt((val * 100).toString()) + '</Position>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
    };
    SplitPane.prototype.setUnassignedColor = function (val) {
        var xml = '<Call Method="SetSplitUnassignedColor">';
        xml += '<SplitDirectionId>' + this.activeSession.directionId + '</SplitDirectionId>';
        xml += '<SplitGroupUnassignedColor>' + val + '</SplitGroupUnassignedColor>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
        this.activeSession.unassignedColor = val;
    };
    SplitPane.prototype.setUpColor = function (val) {
        var xml = '<Call Method="SetSplitGroupUpColor">';
        xml += '<SplitDirectionId>' + this.activeSession.directionId + '</SplitDirectionId>';
        xml += '<SplitGroupUpColor>' + val + '</SplitGroupUpColor>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
        this.activeSession.upColor = val;
        this.activeSession.upEl.style.backgroundColor = val;
    };
    SplitPane.prototype.setDownColor = function (val) {
        var xml = '<Call Method="SetSplitGroupDownColor">';
        xml += '<SplitDirectionId>' + this.activeSession.directionId + '</SplitDirectionId>';
        xml += '<SplitGroupDownColor>' + val + '</SplitGroupDownColor>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
        this.activeSession.downColor = val;
        this.activeSession.downEl.style.backgroundColor = val;
    };
    SplitPane.prototype.moveUnassigned = function () {
        var xml = '<Call Method="UnassignSplitSelectedPatches"></Call>';
        vsClient.command.executeXML(xml);
    };
    SplitPane.prototype.moveUp = function () {
        var xml = '<Call Method="AssignSplitSelectedPatchesToGroupUp">';
        xml += '<SplitDirectionId>' + this.activeSession.directionId + '</SplitDirectionId>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
    };
    SplitPane.prototype.moveDown = function () {
        var xml = '<Call Method="AssignSplitSelectedPatchesToGroupDown">';
        xml += '<SplitDirectionId>' + this.activeSession.directionId + '</SplitDirectionId>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
    };
    SplitPane.prototype.calculateFontColor = function (color) {
        var rgb = color.substr(1);
        var int = parseInt(rgb, 16);
        var r = ((int >> 16) & 255) / 255;
        var g = ((int >> 8) & 255) / 255;
        var b = (int & 255) / 255;
        var rgbArr = [r, g, b];
        for (var j = 0; j < rgbArr.length; j++) {
            if (rgbArr[j] <= 0.03928) {
                rgbArr[j] = rgbArr[j] / 12.92;
            }
            else {
                rgbArr[j] = Math.pow((rgbArr[j] + 0.055) / 1.055, 2.4);
            }
        }
        var luminance = 0.2126 * rgbArr[0] + 0.7152 * rgbArr[1] + 0.0722 * rgbArr[2];
        var fontColor = (luminance > 0.179) ? 'black' : 'white';
        return fontColor;
    };
    SplitPane.prototype.setSplitDirection = function () {
        var xml = '<Call Method="SetSplitDirection">';
        xml += '<X>' + $("#wv-split #SplitXDirection").text() + '</X>';
        xml += '<Y>' + $("#wv-split #SplitYDirection").text() + '</Y>';
        xml += '<Z>' + $("#wv-split #SplitZDirection").text() + '</Z>';
        xml += '</Call>';
        vsClient.command.executeXML(xml);
    };
    SplitPane.prototype.addMethods = function () {
        var _this = this;
        $("#wv-split #OnSplitByNormalClicked").off('click').click(function (ev) {
            var xml = '<Call Method="ActivateSplitDirectionPick"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-split #OnSplitXClicked").off('click').click(function (ev) {
            var xml = '<Call Method="SetSplitDirectionXAxis"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-split #OnSplitYClicked").off('click').click(function (ev) {
            var xml = '<Call Method="SetSplitDirectionYAxis"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-split #OnSplitZClicked").off('click').click(function (ev) {
            var xml = '<Call Method="SetSplitDirectionZAxis"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-split #OnSplitComputeClicked").off('click').click(function (ev) {
            var xml = '<Call Method="Compute"><Mode>Split</Mode></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-split #SplitXDirection").text(0);
        $("#wv-split #SplitYDirection").text(0);
        $("#wv-split #SplitZDirection").text(0);
        $("#wv-split #SplitXDirection").off('blur').blur(function (ev) {
            _this.setSplitDirection();
        });
        $("#wv-split #SplitYDirection").off('blur').blur(function (ev) {
            _this.setSplitDirection();
        });
        $("#wv-split #SplitZDirection").off('blur').blur(function (ev) {
            _this.setSplitDirection();
        });
    };
    SplitPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetSplitPaneTemplate = "<Call Method=\"GetTemplate\"><Type>SplitPane</Type></Call>";
        vsClient.command.executeXML(GetSplitPaneTemplate);
        vsClient.once('GetTemplate.SplitPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    SplitPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            if ((path.indexOf('Angle1') !== -1 && value < 0) || (path.indexOf('Angle2') !== -1 && value > 0) || path.indexOf('Tolerance') !== -1 && value < 0) {
                value *= -1;
            }
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return SplitPane;
}(pane_template_1.PaneTemplate));
exports.SplitPane = SplitPane;


/***/ }),
/* 72 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var CanvasStack = (function () {
    function CanvasStack(parent, client) {
        this.stackSize = 0;
        this.stack = [];
        this.isMaximized = false;
        this.sceneStack = [];
        this.parent = parent;
        this.client = client;
        this.tabBar = document.createElement('div');
        this.tabBar.className = 'canvas-pane-tab-bar';
        this.parent.appendChild(this.tabBar);
    }
    CanvasStack.prototype.addScene = function (sceneId) {
        this.addTab(sceneId);
        var newSceneWrapper = document.createElement('div');
        newSceneWrapper.id = 'wv-canvas';
        newSceneWrapper.className = 'pane-content-area';
        newSceneWrapper.style.margin = '0px';
        this.parent.appendChild(newSceneWrapper);
        this.activeSceneId = sceneId;
        var newScene = {
            id: sceneId,
            canvas: newSceneWrapper
        };
        this.sceneStack.push(newScene);
        return newSceneWrapper;
    };
    CanvasStack.prototype.addTab = function (sceneId) {
        var _this = this;
        $(this.parent).show();
        var title = '/';
        var tab = document.createElement('div');
        tab.className = 'pane-tab active-scene-pane-tab';
        tab.style.marginBottom = '0px!important';
        tab.textContent = title;
        $(tab).click(function (e) {
            for (var i = 0; i < _this.stackSize; i++) {
                _this.stack[i].active = false;
                $(_this.stack[i].tab).removeClass('active-pane-tab');
            }
            $(tab).addClass('active-pane-tab');
        });
        var newTab = {
            name: title,
            id: sceneId,
            tab: tab,
            active: true,
        };
        for (var i = 0; i < this.stackSize; i++) {
            this.stack[i].active = false;
            $(this.stack[i].tab).removeClass('active-pane-tab');
        }
        this.stack.push(newTab);
        this.stackSize++;
        this.tabBar.appendChild(tab);
    };
    CanvasStack.prototype.setTabTitle = function (title) {
        this.stack[0].tab.textContent = title;
    };
    CanvasStack.prototype.maximize = function () {
        this.isMaximized = true;
        $(this.parent).addClass('canvas-maximized');
        $(this.sceneStack[0].canvas).addClass('canvas-maximized');
    };
    CanvasStack.prototype.minimize = function () {
        this.isMaximized = false;
        $(this.sceneStack[0].canvas).removeClass('canvas-maximized');
        $(this.parent).removeClass('canvas-maximized');
    };
    return CanvasStack;
}());
exports.CanvasStack = CanvasStack;


/***/ }),
/* 73 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var app_settings_1 = __webpack_require__(9);
var ui = __webpack_require__(0);
var app_states_1 = __webpack_require__(4);
var SVG_NS = 'http://www.w3.org/2000/svg';
var XLINK_NS = 'http://www.w3.org/1999/xlink';
var MinimizedPaneStack = (function () {
    function MinimizedPaneStack(orientation) {
        this.isVisible = false;
        this.stackSize = 0;
        this.tabStack = [];
        this.stickyPane = false;
        this.paneArray = [];
        this.langKeys = [];
        this.orientation = orientation;
        this.paneWrapper = document.createElement('div');
        this.paneWrapper.className = 'minimized-pane-wrapper';
        if (localStorage.getItem('WV' + this.orientation + 'MinimizedPaneWidth') === null) {
            this.paneWidth = (document.body.clientWidth / 5);
        }
        else {
            this.paneWidth = parseInt(localStorage.getItem('WV' + this.orientation + 'MinimizedPaneWidth'));
        }
        this.paneWrapper.style.width = this.paneWidth + 'px';
        this.tabBar = document.createElement('div');
        this.tabBar.className = 'minimized-pane-tab-bar';
        this.panel = document.getElementById(orientation + '-minimized-pane-panel');
        this.panel.appendChild(this.tabBar);
        this.panes = document.getElementById(orientation + '-pane-wrapper');
        this.presetTable = document.createElement('table');
        this.presetTable.className = 'pane-content';
        $(this.presetTable).hide();
        this.paneWrapper.appendChild(this.presetTable);
        this.contentArea = document.createElement('div');
        this.contentArea.className = 'minimized-pane-content-area';
        this.panel.appendChild(this.paneWrapper);
        this.handleVerticalDown = this.handleVerticalDown.bind(this);
        this.handleVerticalMove = this.handleVerticalMove.bind(this);
        this.handleVerticalUp = this.handleVerticalUp.bind(this);
        if (this.orientation === 'left') {
            this.paneWrapper.style.left = -(this.paneWidth + 20) + 'px';
            this.tabBar.style.borderRight = '1px solid #c3c3c3';
        }
        else {
            this.paneWrapper.style.right = -(this.paneWidth + 20) + 'px';
            this.tabBar.style.borderLeft = '1px solid #c3c3c3';
        }
        $(this.panel).hide();
        this.checkTarget = this.checkTarget.bind(this);
    }
    MinimizedPaneStack.prototype.registerPane = function (pane, paneId) {
        $(this.panel).show();
        this.isVisible = true;
        if (this.orientation === 'left') {
            this.panes.style.left = '20px';
        }
        else {
            this.panes.style.right = '20px';
        }
        this.registerTab(pane, paneId);
        pane.registerInStack(this.contentArea, this.presetTable);
        ui.paneResize();
    };
    MinimizedPaneStack.prototype.translateTitle = function (langId) {
        var title;
        if (_lang_data[langId] && _lang_data[langId][app_settings_1.settings.lang]) {
            title = _lang_data[langId][app_settings_1.settings.lang];
        }
        else if (_custom_lang_data && _custom_lang_data[langId] && _custom_lang_data[langId][app_settings_1.settings.lang]) {
            title = _custom_lang_data[langId][app_settings_1.settings.lang];
        }
        else if (_lang_data[langId] && _lang_data[langId]['ENU']) {
            title = _lang_data[langId]['ENU'];
        }
        else if (_custom_lang_data && _custom_lang_data[langId] && _custom_lang_data[langId]['ENU']) {
            title = _custom_lang_data[langId]['ENU'];
        }
        else {
            title = langId;
        }
        return title;
    };
    MinimizedPaneStack.prototype.registerTab = function (pane, paneId) {
        var _this = this;
        if (this.paneArray.indexOf(paneId) !== -1) {
            return;
        }
        var langId = pane.langId;
        var title = this.translateTitle(langId);
        var tab = document.createElement('div');
        tab.className = 'minimized-pane-tab';
        tab.textContent = title;
        this.tabBar.appendChild(tab);
        $(tab).hover(function (e) {
            for (var i = 0; i < _this.stackSize; i++) {
                _this.tabStack[i].style.backgroundColor = 'rgb(225, 225, 225)';
            }
            tab.style.backgroundColor = 'white';
            _this.showPane(pane, langId, paneId, tab);
        });
        this.tabStack.push(tab);
        this.paneArray.push(paneId);
        this.langKeys.push(pane.langId);
        this.stackSize++;
    };
    MinimizedPaneStack.prototype.changeTitleLang = function () {
        for (var i = 0; i < this.stackSize; i++) {
            var langId = this.langKeys[i];
            var title = this.translateTitle(langId);
            this.tabStack[i].childNodes[0].nodeValue = title;
        }
    };
    MinimizedPaneStack.prototype.showPane = function (pane, langId, paneId, panelTab) {
        var _this = this;
        $(this.paneWrapper).empty();
        $(this.paneWrapper).show();
        if (pane.lang !== app_settings_1.settings.lang) {
            pane.changeLang(app_settings_1.settings.lang);
        }
        var ribbon = document.getElementById('wv-ribbon');
        this.paneWrapper.style.height = 'calc(100% - ' + (ribbon.clientHeight) + 'px)';
        document.addEventListener('mousemove', this.checkTarget);
        document.addEventListener('mousedown', this.checkTarget);
        var tab = document.createElement('div');
        tab.className = 'minimized-active-pane-tab';
        var title = this.translateTitle(langId);
        tab.textContent = title;
        var tabIconDiv = document.createElement('div');
        tabIconDiv.className = 'pane-tab-icon-wrapper';
        tab.appendChild(tabIconDiv);
        var maximizeIcon = document.createElement('i');
        maximizeIcon.className = 'fal fa-thumbtack fa-rotate-90';
        maximizeIcon.style.cursor = 'pointer';
        tabIconDiv.appendChild(maximizeIcon);
        maximizeIcon.onclick = function (e) {
            e.preventDefault();
            e.stopPropagation();
            var openPaneCount = app_states_1.appStates.panes.length;
            for (var i = 0; i < openPaneCount; i++) {
                if (app_states_1.appStates.panes[i].paneId === paneId) {
                    app_states_1.appStates.panes[i].minimized = false;
                }
            }
            localStorage.setItem('panePositions', JSON.stringify(app_states_1.appStates.panes));
            ui.prependPane(paneId);
            $(_this.paneWrapper).hide();
            if (_this.orientation === 'left') {
                _this.paneWrapper.style.left = '-100%';
            }
            else {
                _this.paneWrapper.style.right = '-100%';
            }
            $(panelTab).remove();
            _this.stackSize--;
            var index = _this.tabStack.indexOf(tab);
            _this.tabStack.splice(index, 1);
            _this.paneArray.splice(index, 1);
            _this.langKeys.splice(index, 1);
            if (_this.stackSize === 0) {
                $(_this.panel).hide();
                _this.isVisible = false;
                ui.paneResize(true);
                if (_this.orientation === 'left') {
                    _this.panes.style.left = '0';
                }
                else {
                    _this.panes.style.right = '0';
                }
            }
        };
        var closeIcon = document.createElement('i');
        closeIcon.className = 'fal fa-times';
        closeIcon.style.marginLeft = '10px';
        closeIcon.style.cursor = 'pointer';
        tabIconDiv.appendChild(closeIcon);
        this.paneWrapper.appendChild(tab);
        this.paneWrapper.appendChild(this.presetTable);
        pane.stack.checkForPresets(paneId, this.presetTable);
        this.contentArea.style.height = this.paneWrapper.clientHeight - tab.clientHeight - 5 + 'px';
        this.paneWrapper.appendChild(pane.mount);
        $(pane.mount).empty();
        pane.mount.appendChild(pane.wrapperEl);
        var prevEvent = pane.searchForEvent(pane.paneId);
        if (prevEvent) {
            pane.update(prevEvent);
        }
        else {
            pane.update();
        }
        this.verticalDivider = document.createElement('div');
        this.verticalDivider.className = 'vertical-pane-divider';
        if (!app_states_1.appStates.lockPanes) {
            this.verticalDivider.addEventListener('mousedown', this.handleVerticalDown);
            $(this.verticalDivider).kendoTouch({
                dragstart: function (e) {
                    _this.stickyPane = true;
                    _this.paneWrapper.style.transition = '0s';
                },
                drag: function (e) {
                    var width;
                    if (_this.orientation === 'left') {
                        width = (e.touch.x.location - 20);
                    }
                    else {
                        var wvDock = document.getElementById('wv-dock');
                        width = wvDock.clientWidth - e.touch.x.location - 20;
                    }
                    _this.paneWrapper.style.width = width + 'px';
                    _this.paneWidth = width;
                },
                dragend: function (e) {
                    setTimeout(function (e) {
                        _this.stickyPane = false;
                    }, 200);
                    localStorage.setItem('WV' + _this.orientation + 'MinimizedPaneWidth', _this.paneWidth.toString());
                    _this.paneWrapper.style.transition = '1s';
                }
            });
        }
        else {
            this.verticalDivider.style.pointerEvents = 'none';
        }
        this.paneWrapper.appendChild(this.verticalDivider);
        closeIcon.onclick = function (e) {
            e.preventDefault();
            e.stopPropagation();
            $(panelTab).remove();
            pane.stack.removePane(paneId);
            _this.stackSize--;
            var index = _this.tabStack.indexOf(tab);
            _this.tabStack.splice(index, 1);
            _this.paneArray.splice(index, 1);
            _this.langKeys.splice(index, 1);
            if (_this.stackSize === 0) {
                $(_this.panel).hide();
                _this.isVisible = false;
                ui.paneResize(true);
                if (_this.orientation === 'left') {
                    _this.panes.style.left = '0';
                }
                else {
                    _this.panes.style.right = '0';
                }
            }
            var openPaneCount = app_states_1.appStates.panes.length;
            for (var i = 0; i < openPaneCount; i++) {
                if (app_states_1.appStates.panes[i].paneId === paneId) {
                    app_states_1.appStates.panes[i].visible = false;
                }
            }
            vsClient.emit('pane-closed', paneId);
            localStorage.setItem('panePositions', JSON.stringify(app_states_1.appStates.panes));
        };
        if (this.orientation === 'left') {
            this.paneWrapper.style.left = '20px';
            this.verticalDivider.style.right = '0';
        }
        else {
            this.paneWrapper.style.right = '20px';
            this.verticalDivider.style.left = '0';
        }
        pane.addMethods();
    };
    MinimizedPaneStack.prototype.checkTarget = function (e) {
        if (!this.panel.contains(e.target) && !(e.target.correspondingUseElement)) {
            if (!this.stickyPane) {
                for (var i = 0; i < this.stackSize; i++) {
                    this.tabStack[i].style.backgroundColor = 'rgb(225, 225, 225)';
                }
                document.removeEventListener('mousemove', this.checkTarget);
                document.removeEventListener('mousedown', this.checkTarget);
                if (this.orientation === 'left') {
                    this.paneWrapper.style.left = -(this.paneWidth + 20) + 'px';
                }
                else {
                    this.paneWrapper.style.right = -(this.paneWidth + 20) + 'px';
                }
            }
        }
    };
    MinimizedPaneStack.prototype.handleVerticalDown = function (e) {
        e.preventDefault();
        this.stickyPane = true;
        this.paneWrapper.style.transition = '0s';
        document.addEventListener('mousemove', this.handleVerticalMove);
        document.addEventListener('mouseup', this.handleVerticalUp);
    };
    MinimizedPaneStack.prototype.handleVerticalMove = function (e) {
        var width;
        if (this.orientation === 'left') {
            width = (e.pageX - 20);
        }
        else {
            var wvDock = document.getElementById('wv-dock');
            width = wvDock.clientWidth - e.pageX - 20;
        }
        this.paneWrapper.style.width = width + 'px';
        this.paneWidth = width;
    };
    MinimizedPaneStack.prototype.handleVerticalUp = function (e) {
        var _this = this;
        setTimeout(function (e) {
            _this.stickyPane = false;
        }, 200);
        localStorage.setItem('WV' + this.orientation + 'MinimizedPaneWidth', this.paneWidth.toString());
        this.paneWrapper.style.transition = '1s';
        document.removeEventListener('mousemove', this.handleVerticalMove);
        document.removeEventListener('mouseup', this.handleVerticalUp);
    };
    MinimizedPaneStack.prototype.reset = function () {
        this.paneWidth = (document.body.clientWidth / 5);
        this.paneWrapper.style.width = this.paneWidth + 'px';
        if (this.orientation === 'left') {
            this.panes.style.left = '0';
        }
        else {
            this.panes.style.right = '0';
        }
        $(this.panel).hide();
        $(this.paneWrapper).empty();
        $(this.tabBar).empty();
        this.isVisible = false;
        this.stackSize = 0;
        this.tabStack = [];
        this.paneArray = [];
    };
    MinimizedPaneStack.prototype.closeTabById = function (paneId) {
        var index = this.paneArray.indexOf(paneId);
        if (index !== -1) {
            this.paneArray.splice(index, 1);
            this.langKeys.splice(index, 1);
            var tab = this.tabStack.splice(index, 1)[0];
            $(tab).remove();
            this.stackSize--;
            if (this.stackSize === 0) {
                $(this.panel).hide();
                this.isVisible = false;
                if (this.orientation === 'left') {
                    this.panes.style.left = '0';
                }
                else {
                    this.panes.style.right = '0';
                }
            }
        }
    };
    return MinimizedPaneStack;
}());
exports.MinimizedPaneStack = MinimizedPaneStack;


/***/ }),
/* 74 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var app_settings_1 = __webpack_require__(9);
var ui = __webpack_require__(0);
var app_states_1 = __webpack_require__(4);
var widget_1 = __webpack_require__(10);
var js2xmlparser = __webpack_require__(17);
var widgets_1 = __webpack_require__(11);
var SVG_NS = 'http://www.w3.org/2000/svg';
var XLINK_NS = 'http://www.w3.org/1999/xlink';
var PaneStack = (function () {
    function PaneStack(parent, minimizedStack, pos) {
        var _this = this;
        this.isVisible = false;
        this.stackSize = 0;
        this.stack = [];
        this.stackedTabs = [];
        this.height = '50%';
        this.hasPresets = false;
        this.parent = parent;
        this.pos = pos;
        this.orientation = minimizedStack.orientation;
        this.tabBar = document.createElement('div');
        this.tabBar.className = 'pane-tab-bar';
        this.tabBarTitle = document.createElement('div');
        this.tabBarTitle.textContent = 'No Tab';
        this.tabBarTitle.className = 'pane-tab-bar-title';
        this.tabBarTitle.onclick = function (ev) {
            _this.tabStack.click();
        };
        this.parent.appendChild(this.tabBarTitle);
        this.parent.appendChild(this.tabBar);
        this.presetTable = document.createElement('table');
        this.presetTable.className = 'pane-content';
        this.presetTable.style.marginTop = '5px';
        this.presetTable.style.marginBottom = '-5px';
        if (this.orientation === 'right') {
            this.presetTable.style.marginLeft = '5px';
        }
        $(this.presetTable).hide();
        this.parent.appendChild(this.presetTable);
        this.contentArea = document.createElement('div');
        this.contentArea.className = 'pane-content-area';
        if (this.orientation === 'right') {
            this.contentArea.style.marginLeft = '5px';
            this.contentArea.style.position = 'relative';
            this.contentArea.style.right = '5px';
        }
        this.parent.appendChild(this.contentArea);
        this.minimizedStack = minimizedStack;
        this.tabStack = document.createElement('div');
        this.tabStack.className = 'pane-tab';
        this.tabStack.style.minWidth = 'min-content';
        this.tabStack.style.overflow = 'visible';
        this.tabStackCountEl = document.createElement('span');
        this.tabStackCountEl.style.marginRight = '3px';
        this.tabStack.appendChild(this.tabStackCountEl);
        var tabStackIcon = document.createElement('i');
        tabStackIcon.className = 'fas fa-caret-down';
        this.tabStack.appendChild(tabStackIcon);
        this.tabList = document.createElement('div');
        this.tabList.className = 'stacked-pane-tab-list-wrapper';
        vsClient.on('@changeLang', function (e) {
            _this.minimizedStack.changeTitleLang();
            for (var i = 0; i < _this.stackSize; i++) {
                if (_this.stack[i].pane.adapter || _this.stack[i].pane.noAdapter) {
                    _this.stack[i].pane.changeLang(e);
                }
                _this.stack[i].pane.lang = e;
                _this.setTitle(_this.stack[i].tab, _this.stack[i].pane.langId, false);
            }
            if (_this.activePane) {
                _this.tabBarTitle.textContent = _this.setTitle(undefined, _this.activePane.langId, false) + '...';
            }
        });
        $(this.tabStack).hide();
        this.tabBar.appendChild(this.tabStack);
        this.tabStack.onclick = function (e) {
            $(_this.tabList).empty();
            $(_this.tabList).show();
            var stackedTabCount = _this.stackedTabs.length;
            var list = document.createElement('div');
            _this.tabList.appendChild(list);
            _this.tabStack.appendChild(_this.tabList);
            var _loop_1 = function (i) {
                var tab = _this.stackedTabs[i];
                var newTab = document.createElement('div');
                newTab.className = 'stacked-pane-tab';
                newTab.id = tab.id + '-stacked-tab';
                var tabText = document.createElement('span');
                tabText.textContent = tab.tab.textContent;
                newTab.appendChild(tabText);
                list.appendChild(newTab);
                newTab.onclick = function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    for (var j = 0; j < _this.stackSize; j++) {
                        if (_this.stack[j].id === tab.id) {
                            var tabToSwitch = _this.stack.splice(j, 1)[0];
                            _this.stack.unshift(tabToSwitch);
                            _this.tabBar.removeChild(tabToSwitch.tab);
                            _this.tabBar.insertBefore(tabToSwitch.tab, _this.tabBar.firstChild);
                            $(tabToSwitch.tab).click();
                            _this.tabResize(false);
                        }
                    }
                    $(_this.tabList).hide();
                    document.removeEventListener('mousedown', _this.checkStackTabClick);
                };
            };
            for (var i = 0; i < stackedTabCount; i++) {
                _loop_1(i);
            }
            document.addEventListener('mousedown', _this.checkStackTabClick);
        };
        this.checkStackTabClick = this.checkStackTabClick.bind(this);
        $(this.parent).hide();
    }
    PaneStack.prototype.setTitle = function (tab, langId, init) {
        var title;
        if (_lang_data[langId] && _lang_data[langId][app_settings_1.settings.lang]) {
            title = _lang_data[langId][app_settings_1.settings.lang];
        }
        else if (_custom_lang_data && _custom_lang_data[langId] && _custom_lang_data[langId][app_settings_1.settings.lang]) {
            title = _custom_lang_data[langId][app_settings_1.settings.lang];
        }
        else if (_lang_data[langId] && _lang_data[langId]['ENU']) {
            title = _lang_data[langId]['ENU'];
        }
        else if (_custom_lang_data && _custom_lang_data[langId] && _custom_lang_data[langId]['ENU']) {
            title = _custom_lang_data[langId]['ENU'];
        }
        else {
            title = langId;
        }
        if (init) {
            tab.textContent = title;
        }
        else if (tab) {
            $(tab).contents().filter(function () {
                return this.nodeType == 3;
            })
                .replaceWith(title);
        }
        return title;
    };
    PaneStack.prototype.checkStackTabClick = function (e) {
        if (!this.tabList.contains(e.target)) {
            $(this.tabList).hide();
            document.removeEventListener('mousedown', this.checkStackTabClick);
        }
    };
    PaneStack.prototype.addPane = function (pane, paneId) {
        var indexOfTab = this.stack.map(function (item) { return item.id; }).indexOf(paneId);
        if (indexOfTab !== -1) {
            $(this.stack[indexOfTab].tab).click();
            return;
        }
        this.addTab(pane, paneId);
        pane.setStack(this);
        this.activePane = pane;
        pane.registerInStack(this.contentArea);
        if (paneId === 'wv-views') {
            pane.wrapperEl.style.overflow = 'hidden';
        }
        this.isVisible = true;
        this.tabBarTitle.textContent = this.setTitle(undefined, pane.langId, false) + '...';
        var button = widget_1.findPaneButton(paneId);
        if (button) {
            button.applyHighlight(true);
        }
        ui.paneStackIncrement(this.pos);
    };
    PaneStack.prototype.checkForPresets = function (paneId, minimizedTable) {
        try {
            if (_PanePresets[paneId]) {
                $(this.presetTable).empty();
                if (minimizedTable) {
                    $(minimizedTable).empty();
                }
                var presetTableBody = document.createElement('tbody');
                if (minimizedTable) {
                    minimizedTable.appendChild(presetTableBody);
                }
                else {
                    this.presetTable.appendChild(presetTableBody);
                }
                var placeholderRow = document.createElement('tr');
                presetTableBody.appendChild(placeholderRow);
                var presetGroup = new widgets_1.PlainGroup(1, presetTableBody, 'ID_PRESETS_HEATMAP', "");
                var presets = _PanePresets[paneId];
                this.presetSelect = new widgets_1.PlainSelectSingleLine(2, presetTableBody, this.selectPreset.bind(this));
                presetGroup.children.push(this.presetSelect.wrapperEl);
                var options = [];
                for (var i = 0; i < presets.length; i++) {
                    var option = {
                        name: presets[i].name,
                        val: presets[i].settings,
                        isDefault: presets[i].isDefault,
                        isCustom: false
                    };
                    options.push(option);
                }
                var customPresetsString = localStorage.getItem('WVPreset_' + this.activePane.paneId);
                if (customPresetsString !== null) {
                    var customPresets = JSON.parse(customPresetsString);
                    for (var i = 0; i < customPresets.length; i++) {
                        var option = {
                            name: customPresets[i].name,
                            val: customPresets[i].val,
                            isDefault: customPresets[i].isDefault,
                            isCustom: true
                        };
                        options.push(option);
                    }
                }
                this.presetSelect.setOptions(options);
                var paneActivePreset = this.activePane.activePreset;
                if (paneActivePreset) {
                    if (paneActivePreset === '<Not saved>') {
                        this.changeToCustomPreset();
                    }
                    this.presetSelect.setActivePreset(paneActivePreset);
                }
                var activePreset = this.presetSelect.getActivePreset();
                this.selectPreset(activePreset.val);
                try {
                    if (_UseCachedSettings) {
                        this.addPresetButtons(this.presetSelect.selectWrapperEl);
                    }
                }
                catch (e) {
                    this.addPresetButtons(this.presetSelect.selectWrapperEl);
                }
                if (minimizedTable) {
                    $(minimizedTable).show();
                }
                else {
                    $(this.presetTable).show();
                }
                this.hasPresets = true;
            }
            else {
                if (minimizedTable) {
                    $(minimizedTable).hide();
                }
                else {
                    $(this.presetTable).hide();
                }
                this.hasPresets = false;
            }
        }
        catch (e) {
            if (minimizedTable) {
                $(minimizedTable).hide();
            }
            else {
                $(this.presetTable).hide();
            }
            this.hasPresets = false;
        }
    };
    PaneStack.prototype.addPresetButtons = function (wrapperEl) {
        var _this = this;
        this.presetNameEl = new widgets_1.SimplePaneInlineModal(wrapperEl, this.addPreset.bind(this));
        var iconWrapper = document.createElement('span');
        iconWrapper.className = 'pane-buttons-tab';
        iconWrapper.style.position = 'relative';
        iconWrapper.style.top = '1px';
        wrapperEl.appendChild(iconWrapper);
        var restoreDefault = document.createElement('i');
        restoreDefault.className = 'fas fa-sync-alt tree-header-action-icon';
        restoreDefault.onclick = function (e) {
            _this.restoreDefaultPreset();
        };
        iconWrapper.appendChild(restoreDefault);
        var addButton = document.createElement('i');
        addButton.className = 'fas fa-plus-circle tree-header-action-icon';
        addButton.onclick = function (e) {
            var newPresetObj = {};
            var childs = _this.activePane.adapter.settingItems;
            for (var i = 0; i < childs.length; i++) {
                var child = childs[i];
                if (child.visualStatus !== 'hidden') {
                    _this.parseItem(child, newPresetObj);
                }
            }
            _this.newPresetValue = js2xmlparser.parse('Settings', newPresetObj, { declaration: { include: false }, format: { pretty: false } });
            _this.presetNameEl.show();
        };
        iconWrapper.appendChild(addButton);
        var deleteButton = document.createElement('i');
        deleteButton.className = 'fas fa-minus-circle tree-header-action-icon';
        deleteButton.onclick = function (e) {
            _this.deletePreset();
        };
        iconWrapper.appendChild(deleteButton);
        var setDefaultButton = document.createElement('i');
        setDefaultButton.className = 'fas fa-bookmark tree-header-action-icon';
        setDefaultButton.style.left = '5px';
        setDefaultButton.onclick = function (e) {
            _this.setPresetDefault();
        };
        iconWrapper.appendChild(setDefaultButton);
    };
    PaneStack.prototype.changeToCustomPreset = function () {
        var newPresetObj = {};
        var childs = this.activePane.adapter.settingItems;
        for (var i = 0; i < childs.length; i++) {
            var child = childs[i];
            if (child.visualStatus !== 'hidden') {
                this.parseItem(child, newPresetObj);
            }
        }
        var newPresetValue = js2xmlparser.parse('Settings', newPresetObj, { declaration: { include: false }, format: { pretty: false } });
        var newPreset = {
            isDefault: false,
            name: '<Not saved>',
            val: newPresetValue,
            isCustom: true,
            isActive: true
        };
        this.presetSelect.removeOptionByName('<Not saved>');
        this.presetSelect.addOption(newPreset);
        this.activePane.activePreset = newPreset.name;
    };
    PaneStack.prototype.parseItem = function (item, obj) {
        for (var i = 1; i < item.path.length; i++) {
            var pathPart = item.path[i];
            obj = obj[pathPart] = i === item.path.length - 1 ? item.value : obj[pathPart] || {};
        }
    };
    PaneStack.prototype.selectPreset = function (preset, setPanePreset) {
        if (setPanePreset === void 0) { setPanePreset = true; }
        if (setPanePreset) {
            this.activePane.activePreset = this.presetSelect.getActivePreset().name;
        }
        var xml = '<Call Method="SetSceneSettings">' + preset + '</Call>';
        vsClient.command.executeXML(xml);
        xml = '<Call Method="GetSceneSettings"></Call>';
        vsClient.command.executeXML(xml);
    };
    PaneStack.prototype.restoreDefaultPreset = function () {
        var defaultPreset = this.presetSelect.restoreDefault();
        this.selectPreset(defaultPreset.val);
    };
    PaneStack.prototype.addPreset = function (name) {
        var customPresetsString = localStorage.getItem('WVPreset_' + this.activePane.paneId);
        var newPreset = {
            isDefault: false,
            name: name,
            val: this.newPresetValue,
            isCustom: true
        };
        var customPresets;
        if (customPresetsString !== null) {
            customPresets = JSON.parse(customPresetsString);
            if (!Array.isArray(customPresets)) {
                customPresets = [customPresets];
            }
            for (var i = 0; i < customPresets.length; i++) {
                if (customPresets[i].name === name) {
                    newPreset.name = name + '*';
                }
            }
            customPresets.push(newPreset);
        }
        else {
            customPresets = [newPreset];
        }
        localStorage.setItem('WVPreset_' + this.activePane.paneId, JSON.stringify(customPresets));
        this.presetSelect.addOption(newPreset);
        this.presetSelect.removeOptionByName('<Not saved>');
    };
    PaneStack.prototype.deletePreset = function () {
        var activeOption = this.presetSelect.getActivePreset();
        if (activeOption.isCustom) {
            this.presetSelect.removeOption(activeOption);
            var customPresets = JSON.parse(localStorage.getItem('WVPreset_' + this.activePane.paneId));
            for (var i = 0; i < customPresets.length; i++) {
                if (customPresets[i].name === activeOption.name) {
                    customPresets.splice(i, 1);
                    break;
                }
            }
            localStorage.setItem('WVPreset_' + this.activePane.paneId, JSON.stringify(customPresets));
        }
        else {
            var globalPresetWarning = {
                ErrorCode: 0,
                ErrorInfo: undefined,
                Identifier: '',
                Message: 'Global presets cannot be deleted.',
                Type: ['Event', 'Warning']
            };
            vsClient.emit('ShowMessageBox', globalPresetWarning);
        }
    };
    PaneStack.prototype.setPresetDefault = function () {
        var activeOption = this.presetSelect.getActivePreset();
        if (activeOption.isCustom) {
            var customPresets = JSON.parse(localStorage.getItem('WVPreset_' + this.activePane.paneId));
            for (var i = 0; i < customPresets.length; i++) {
                if (customPresets[i].name === activeOption.name) {
                    customPresets[i].isDefault = true;
                }
                else {
                    customPresets[i].isDefault = false;
                }
            }
            localStorage.setItem('WVPreset_' + this.activePane.paneId, JSON.stringify(customPresets));
        }
        this.presetSelect.setDefault(activeOption);
    };
    PaneStack.prototype.addTab = function (pane, paneId, triggerResize) {
        var _this = this;
        if (triggerResize === void 0) { triggerResize = true; }
        $(this.parent).show();
        var tab = document.createElement('div');
        tab.className = 'pane-tab active-pane-tab';
        if (!app_states_1.appStates.lockPanes) {
            tab.draggable = true;
        }
        tab.id = paneId + '-pane-tab';
        var langId = pane.langId;
        var title = this.setTitle(tab, pane.langId, true);
        var tabIconDiv = document.createElement('div');
        tabIconDiv.className = 'pane-tab-icon-wrapper';
        tab.appendChild(tabIconDiv);
        if (app_states_1.appStates.paneHelpLinks[paneId]) {
            var helpIcon = document.createElement('i');
            helpIcon.className = 'fas fa-question-circle';
            helpIcon.style.marginRight = '10px';
            tabIconDiv.appendChild(helpIcon);
            helpIcon.onclick = function (e) {
                e.preventDefault();
                e.stopPropagation();
                var offlineHelp = false;
                try {
                    offlineHelp = _UseOfflineHelp;
                }
                catch (e) {
                }
                var cat = offlineHelp ? app_states_1.appStates.paneHelpLinks[paneId].replace('php', 'html') : app_states_1.appStates.paneHelpLinks[paneId];
                var url = offlineHelp ? '/Help/webviewer/' + ui.mapCountry(app_settings_1.settings.lang) + '/' + cat : 'https://viewer.kisters.de/help/webviewer/' + app_states_1.appStates.version + '/' + ui.mapCountry(app_settings_1.settings.lang) + '/' + cat;
                window.open(url, '_blank');
            };
        }
        var showPopoutIcon = true;
        try {
            showPopoutIcon = !_PopoutLock;
        }
        catch (e) { }
        if (showPopoutIcon && paneId !== 'wv-command') {
            var popOutIcon = document.createElement('i');
            popOutIcon.className = 'far fa-window-restore';
            popOutIcon.style.marginRight = '10px';
            tabIconDiv.appendChild(popOutIcon);
            popOutIcon.onclick = function (e) {
                e.preventDefault();
                e.stopPropagation();
                ui.popout(paneId, langId);
            };
        }
        var minimizeIcon = document.createElement('i');
        minimizeIcon.className = 'fal fa-thumbtack';
        minimizeIcon.style.marginRight = '10px';
        tabIconDiv.appendChild(minimizeIcon);
        minimizeIcon.onclick = function (e) {
            e.preventDefault();
            e.stopPropagation();
            _this.minimizePane(pane, paneId);
        };
        var closeIcon = document.createElement('i');
        closeIcon.className = 'fal fa-times';
        tabIconDiv.appendChild(closeIcon);
        closeIcon.onclick = function (e) {
            e.preventDefault();
            e.stopPropagation();
            var openPaneCount = app_states_1.appStates.panes.length;
            for (var i = 0; i < openPaneCount; i++) {
                if (app_states_1.appStates.panes[i].paneId === paneId) {
                    app_states_1.appStates.panes[i].visible = false;
                }
            }
            vsClient.emit('pane-closed', paneId);
            localStorage.setItem('panePositions', JSON.stringify(app_states_1.appStates.panes));
            _this.removePane(paneId);
        };
        tab.addEventListener('dragstart', function (e) {
            e.stopPropagation();
            e.dataTransfer.setData('Text', 'mock');
            $('.pane-drop').each(function () {
                $(this).show();
            });
            var highestElement = document.elementFromPoint(e.pageX, e.pageY);
            if (!$(highestElement).hasClass('pane-tab')) {
                $('.pane-drop').each(function () {
                    this.style.pointerEvents = 'none';
                    tab.ondrag = function (e) {
                        var highestElement = document.elementFromPoint(e.pageX, e.pageY);
                        if (!$(highestElement).hasClass('pane-drop')) {
                            $('.pane-drop').each(function () {
                                this.style.pointerEvents = '';
                            });
                            $(tab).off('drag');
                        }
                    };
                });
            }
            $(_this.contentArea).toggleClass('pane-in-drag');
            ui.setDraggedPane(paneId);
            tab.appendChild(_this.contentArea.cloneNode(true));
            $(_this.contentArea).toggleClass('pane-in-drag');
            $(_this.contentArea).empty();
            _this.dragTime = e.timeStamp;
        });
        tab.addEventListener('dragend', function (e) {
            if (e.timeStamp - _this.dragTime < 100) {
                return;
            }
            e.preventDefault();
            $(tab).remove();
            $('.pane-drop').each(function () {
                $(this).removeClass('allow-pane-drop');
                $(this).hide();
            });
            for (var i = 0; i < _this.stackSize; i++) {
                if (_this.stack[i].id === paneId) {
                    _this.stack.splice(i, 1);
                    _this.stackSize--;
                    break;
                }
            }
            if (_this.stackSize === 0) {
                $(_this.parent).hide();
                _this.isVisible = false;
            }
            else {
                var stackNeedNewActive = true;
                for (var i = 0; i < _this.stackSize; i++) {
                    if (_this.stack[i].id === paneId) {
                        stackNeedNewActive = false;
                    }
                }
                if (stackNeedNewActive) {
                    $(_this.stack[0].tab).click();
                }
            }
            ui.paneStackDecrement(_this.pos);
            ui.prependPane(paneId);
        });
        $(tab).click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            _this.activePane = pane;
            pane.setStack(_this);
            pane.registerInStack(_this.contentArea);
            _this.tabBarTitle.textContent = _this.setTitle(undefined, pane.langId, false) + '...';
            for (var i = 0; i < _this.stackSize; i++) {
                _this.stack[i].active = _this.stack[i].tab === tab;
                _this.activeTab = newTab;
                $(_this.stack[i].tab).removeClass('active-pane-tab');
                $(_this.stack[i].tabIconWrapper).hide();
            }
            $(tab).addClass('active-pane-tab');
            $(tabIconDiv).show();
            _this.tabResize(false);
        });
        var newTab = {
            name: title,
            langId: langId,
            id: paneId,
            tab: tab,
            active: true,
            pane: pane,
            minimized: false,
            tabIconWrapper: tabIconDiv,
            width: 0
        };
        for (var i = 0; i < this.stackSize; i++) {
            this.stack[i].active = false;
            $(this.stack[i].tab).removeClass('active-pane-tab');
            $(this.stack[i].tabIconWrapper).hide();
        }
        this.stackSize++;
        this.stack.push(newTab);
        this.tabBar.appendChild(tab);
        $(this.tabStack).remove();
        this.tabBar.appendChild(this.tabStack);
        newTab.width = $(tab).outerWidth(true);
        this.activeTab = newTab;
    };
    PaneStack.prototype.minimizePane = function (pane, paneId) {
        var openPaneCount = app_states_1.appStates.panes.length;
        for (var i = 0; i < openPaneCount; i++) {
            if (app_states_1.appStates.panes[i].paneId === paneId) {
                app_states_1.appStates.panes[i].minimized = true;
            }
        }
        localStorage.setItem('panePositions', JSON.stringify(app_states_1.appStates.panes));
        this.minimizedStack.registerPane(pane, paneId);
        this.removePane(paneId);
    };
    PaneStack.prototype.removePane = function (paneId, poppedOut) {
        if (poppedOut === void 0) { poppedOut = false; }
        var tab;
        if (paneId === 'wv-neighbourhoodsearch') {
            var selectionModeSelectCall = '<Call Method="SetSelectionMode"><SelectionMode>Select</SelectionMode></Call>';
            vsClient.command.executeXML(selectionModeSelectCall);
            app_states_1.appStates.selectionMode = 'Select';
            var selectButton = widget_1.findButton('ID_RIBBON_SELECT');
            if (selectButton) {
                selectButton.applyHighlight(true);
            }
        }
        else if (paneId === 'wv-clash') {
            var clashCloseCall = '<Call Method="DeactivateClash"></Call>';
            vsClient.command.executeXML(clashCloseCall);
        }
        for (var i = 0; i < this.stackSize; i++) {
            if (paneId === this.stack[i].id) {
                tab = this.stack[i];
                $(tab.tab).remove();
                this.stack.splice(i, 1);
                this.stackSize--;
                if (this.stackSize > 0) {
                    if (i === 0) {
                        $(this.stack[i].tab).click();
                    }
                    else {
                        $(this.stack[i - 1].tab).click();
                    }
                }
                else {
                    $(this.parent).hide();
                    this.activePane = undefined;
                    this.isVisible = false;
                }
                ui.paneStackDecrement(this.pos);
                break;
            }
        }
        if (!poppedOut) {
            var button = widget_1.findPaneButton(paneId);
            if (button) {
                button.applyHighlight(false);
            }
        }
    };
    PaneStack.prototype.tabResize = function (recursive) {
        if (recursive === void 0) { recursive = true; }
        this.stackedTabs = [];
        var fit = true;
        var accumulatedWidth = this.activeTab ? this.activeTab.width : 0;
        var maxWidth = (accumulatedWidth + ((this.stackSize - 1) * 55) > this.tabBar.clientWidth) ? this.tabBar.clientWidth - 45 : this.tabBar.clientWidth;
        for (var i = 0; i < this.stackSize; i++) {
            var tab = this.stack[i];
            accumulatedWidth += tab.active ? 0 : 55;
            if (accumulatedWidth < maxWidth) {
                $(tab.tab).removeClass('pane-tab-hidden');
                continue;
            }
            else {
                $(tab.tab).addClass('pane-tab-hidden');
                $(this.tabStack).show();
                this.stackedTabs.push(tab);
                fit = false;
            }
        }
        this.tabStackCountEl.textContent = '+' + this.stackedTabs.length.toString();
        if (this.stackSize !== 0 && this.stackedTabs.length === this.stackSize) {
            $(this.tabBarTitle).show();
            $(this.tabStack).addClass('pane-stack-right-floating');
        }
        else {
            $(this.tabBarTitle).hide();
            $(this.tabStack).removeClass('pane-stack-right-floating');
        }
        if (fit) {
            $(this.tabStack).hide();
        }
        if (recursive) {
            var stackedLength = this.stackedTabs.length;
            for (var i = 0; i < stackedLength; i++) {
                var stackedTab = this.stackedTabs[i];
                if (stackedTab && stackedTab.id === this.activePane.paneId) {
                    for (var j = 0; j < this.stackSize; j++) {
                        if (this.stack[j].id === stackedTab.id) {
                            var tabToSwitch = this.stack.splice(j, 1)[0];
                            this.stack.unshift(tabToSwitch);
                            this.tabBar.removeChild(tabToSwitch.tab);
                            this.tabBar.insertBefore(tabToSwitch.tab, this.tabBar.firstChild);
                            $(stackedTab.tab).click();
                            $(stackedTab.tab).removeClass('pane-tab-hidden');
                            this.stackedTabs.splice(i, 1);
                            this.stackedTabs.push(this.stack[1]);
                            this.tabStackCountEl.textContent = this.stackedTabs.length.toString();
                            this.tabResize(false);
                        }
                    }
                }
            }
        }
    };
    PaneStack.prototype.resize = function (newSize, resizeHeader) {
        if (resizeHeader === void 0) { resizeHeader = true; }
        var presetHeight = this.hasPresets ? this.presetTable.clientHeight : 0;
        if (!newSize) {
            this.contentArea.style.height = this.parent.clientHeight - this.tabBar.clientHeight - 6 - presetHeight + 'px';
            if (this.activePane) {
                var prevEvent = this.activePane.searchForEvent(this.activePane.paneId);
                if (prevEvent) {
                    this.activePane.update(prevEvent);
                }
                else if (this.activePane.adapter || this.activePane.noAdapter) {
                    this.activePane.update();
                }
            }
        }
        else if (newSize === '0') {
            $(this.parent).hide();
        }
        else {
            if (newSize !== '100%') {
                this.height = newSize;
            }
            this.parent.style.height = newSize;
            this.contentArea.style.height = this.parent.clientHeight - this.tabBar.clientHeight - 6 - presetHeight + 'px';
            if (this.activePane) {
                var prevEvent = this.activePane.searchForEvent(this.activePane.paneId);
                if (prevEvent && (this.activePane.adapter || this.activePane.noAdapter)) {
                    this.activePane.update(prevEvent);
                }
                else if (this.activePane.adapter || this.activePane.noAdapter) {
                    this.activePane.update();
                }
            }
        }
        if (resizeHeader) {
            this.tabResize();
        }
    };
    PaneStack.prototype.reset = function (resetUI) {
        var length = this.stackSize;
        for (var i = 0; i < length; i++) {
            this.removePane(this.stack[0].id);
        }
        if (resetUI) {
            this.height = '50%';
            this.minimizedStack.reset();
        }
    };
    PaneStack.prototype.closePaneById = function (paneId, isMinimized, popedOut) {
        if (popedOut === void 0) { popedOut = false; }
        if (isMinimized) {
            this.minimizedStack.closeTabById(paneId);
        }
        this.removePane(paneId, popedOut);
    };
    return PaneStack;
}());
exports.PaneStack = PaneStack;


/***/ }),
/* 75 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var TextSearchPane = (function (_super) {
    __extends(TextSearchPane, _super);
    function TextSearchPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.searchCount = 0;
        _this.searchIndex = 1;
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    TextSearchPane.prototype.addMethods = function () {
        var _this = this;
        $('#wv-textsearch #OnTextSearchSearchClicked').off('click').click(this.textSearch);
        $('#wv-textsearch #UID_TEXT_SEARCH_TEXT').off('keyup').on('keyup', function (ev) {
            if (ev.keyCode === 13) {
                ev.preventDefault();
                _this.textSearch();
            }
        });
        $('#wv-textsearch #UID_TEXT_SEARCH_TEXT').off('keydown').on('keydown', function (ev) {
            if (ev.keyCode === 13) {
                ev.preventDefault();
            }
        });
        $('#wv-textsearch #OnTextSearchNextResultClicked').click(function (ev) {
            var xml = '<Call Method="HighlightNextTextSearchResult"></Call>';
            vsClient.command.executeXML(xml);
            vsClient.once('HighlightNextTextSearchResult', function (res) {
                if (res.Error === 'SUCCESS') {
                    var xml_1 = '<Call Method="GetHighlightedTextSearchResultIndex" />';
                    vsClient.command.executeXML(xml_1);
                    vsClient.once('GetHighlightedTextSearchResultIndex', function (res) {
                        vsClient.emit('TextSearchChangeIndex', res.Index);
                    });
                }
            });
        });
        $('#wv-textsearch #OnTextSearchPreviousResultClicked').click(function (ev) {
            var xml = '<Call Method="HighlightPreviousTextSearchResult"></Call>';
            vsClient.command.executeXML(xml);
            vsClient.once('HighlightPreviousTextSearchResult', function (res) {
                if (res.Error === 'SUCCESS') {
                    var xml_2 = '<Call Method="GetHighlightedTextSearchResultIndex" />';
                    vsClient.command.executeXML(xml_2);
                    vsClient.once('GetHighlightedTextSearchResultIndex', function (res) {
                        vsClient.emit('TextSearchChangeIndex', res.Index);
                    });
                }
            });
        });
    };
    TextSearchPane.prototype.textSearch = function () {
        var searchText = $('#UID_TEXT_SEARCH_TEXT').text();
        if (searchText !== '') {
            vsClient.once('SearchText', function (res) {
                if (res.Error === 'SUCCESS') {
                    vsClient.emit('TextSearch', res.Results);
                }
            });
            var xml = '<Call Method="SearchText"><SearchString>' + searchText + '</SearchString></Call>';
            vsClient.command.executeXML(xml);
        }
    };
    TextSearchPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetTextSearchPaneTemplate = "<Call Method=\"GetTemplate\"><Type>TextSearchPane</Type></Call>";
        vsClient.command.executeXML(GetTextSearchPaneTemplate);
        vsClient.once('GetTemplate.TextSearchPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    TextSearchPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            event_1 = 'TextSearchChanged';
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return TextSearchPane;
}(pane_template_1.PaneTemplate));
exports.TextSearchPane = TextSearchPane;


/***/ }),
/* 76 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var TransformPane = (function (_super) {
    __extends(TransformPane, _super);
    function TransformPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    TransformPane.prototype.addMethods = function () {
    };
    TransformPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetTransformPaneTemplate = "<Call Method=\"GetTemplate\"><Type>TransformPane</Type></Call>";
        vsClient.command.executeXML(GetTransformPaneTemplate);
        vsClient.once('GetTemplate.TransformPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.adapter.updateValues(_this.values);
        });
    };
    TransformPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            if (path[0] === 'Event') {
                value = parseFloat(value).toString();
                pane.modifySettings(_this.values, path, value);
                var xml = XMLParser.serializeWithValue(path, value, ['Type=' + template['Event']]);
                vsClient.command.executeXML(xml);
            }
            else {
                pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
                var xml = XMLParser.serializeWithValue(path, value);
                var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
                vsClient.command.executeXML(settings);
                if (_this.hasPresets) {
                    _this.stack.changeToCustomPreset();
                }
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return TransformPane;
}(pane_template_1.PaneTemplate));
exports.TransformPane = TransformPane;


/***/ }),
/* 77 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var pane_template_1 = __webpack_require__(1);
var app_states_1 = __webpack_require__(4);
var tooltip_1 = __webpack_require__(8);
var SVG_NS = 'http://www.w3.org/2000/svg';
var XLINK_NS = 'http://www.w3.org/1999/xlink';
var ViewPane = (function (_super) {
    __extends(ViewPane, _super);
    function ViewPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.scrollPos = 0;
        _this.currentPosition = 0;
        _this.duration = 3.5;
        _this.viewElements = [];
        _this.hasMultiSelect = false;
        _this.positionArray = [];
        _this.inDragPos = -1;
        _this.tooltips = [];
        _this.update = function (viewsData) {
            if (!viewsData) {
                var heightString = 'calc(100% - ' + $(_this.buttons).outerHeight(true) + 'px)';
                _this.el.style.height = heightString;
                return;
            }
            vsClient.setConfigurationViews(viewsData);
            _this.viewElements = [];
            var tabindexBegin = 1000;
            _this.positionArray = [];
            _this.tooltips = [];
            var _loop_1 = function (itemInfo) {
                var viewEl = document.createElement('div');
                viewEl.classList.add('viewpane-item');
                viewEl.tabIndex = tabindexBegin++;
                var viewImg = document.createElement('img');
                viewImg.width = 160;
                viewImg.height = 90;
                viewImg.style.border = '1px solid #000';
                viewImg.src = 'data:image/jpeg;base64,' + itemInfo.Image;
                viewImg.draggable = false;
                viewImg.style.pointerEvents = 'none';
                viewEl.draggable = true;
                viewEl.appendChild(viewImg);
                var iconBar = document.createElement('div');
                iconBar.className = 'viewpane-item-action-bar';
                viewEl.appendChild(iconBar);
                var activateIcon = document.createElement('i');
                activateIcon.className = 'fas fa-play view-action-icon';
                var activateTooltip = new tooltip_1.WVTooltip(activateIcon);
                activateTooltip.setTitle(_lang_data['ID_ACTIVATE_CONFIGURATION_VIEW_TOOLTIP'][_this.lang]);
                _this.tooltips.push(activateTooltip);
                iconBar.appendChild(activateIcon);
                activateIcon.onclick = function (e) {
                    vsClient.setConfigurationViewPosition(parseInt(itemInfo.Position));
                };
                var onlyCameraIcon = document.createElement('i');
                onlyCameraIcon.className = 'fas fa-video view-action-icon';
                var cameraTooltip = new tooltip_1.WVTooltip(onlyCameraIcon);
                cameraTooltip.setTitle(_lang_data['ID_ACTIVATE_CONFIGURATION_VIEW_CAMERA_TOOLTIP'][_this.lang]);
                _this.tooltips.push(cameraTooltip);
                iconBar.appendChild(onlyCameraIcon);
                onlyCameraIcon.onclick = function (e) {
                    vsClient.setConfigurationViewPosition(parseInt(itemInfo.Position), true, false);
                };
                var withoutCameraIcon = document.createElement('i');
                withoutCameraIcon.className = 'fas fa-video-slash view-action-icon';
                var withoutCameraTooltip = new tooltip_1.WVTooltip(withoutCameraIcon);
                withoutCameraTooltip.setTitle(_lang_data['ID_ACTIVATE_CONFIGURATION_VIEW_STATE_TOOLTIP'][_this.lang]);
                _this.tooltips.push(withoutCameraTooltip);
                iconBar.appendChild(withoutCameraIcon);
                withoutCameraIcon.onclick = function (e) {
                    vsClient.setConfigurationViewPosition(parseInt(itemInfo.Position), false, true);
                };
                var nameWrapper = document.createElement('div');
                viewEl.appendChild(nameWrapper);
                var editIcon = document.createElement('i');
                editIcon.className = 'fas fa-edit';
                editIcon.style.marginRight = '5px';
                var viewName = document.createElement('span');
                nameWrapper.appendChild(editIcon);
                viewName.textContent = itemInfo.Name;
                nameWrapper.appendChild(viewName);
                viewEl.ondragstart = function (e) {
                    _this.inDragPos = parseInt(itemInfo.Position);
                };
                viewEl.ondragenter = function (e) {
                    e.preventDefault();
                    viewImg.style.borderLeft = '5px solid ' + app_states_1.appStates.mainColor;
                };
                viewEl.ondragleave = function (e) {
                    e.preventDefault();
                    viewImg.style.borderLeft = '1px solid rgb(0, 0, 0)';
                };
                viewEl.ondragover = function (e) {
                    e.preventDefault();
                    viewImg.style.borderLeft = '5px solid ' + app_states_1.appStates.mainColor;
                };
                viewEl.ondrop = function (e) {
                    if (_this.inDragPos !== -1) {
                        var xml = '<Call Method="MoveConfigurationView">';
                        xml += '<ConfigurationView>' + _this.inDragPos + '</ConfigurationView>';
                        xml += '<Position>' + parseInt(itemInfo.Position) + '</Position></Call>';
                        _this.inDragPos = -1;
                        xml += '<Call Method="GetConfigurationViewInformation"><Image>true</Image></Call>';
                        vsClient.command.executeXML(xml);
                    }
                };
                viewEl.addEventListener('click', function (ev) {
                    var allItems = _this.content.querySelectorAll('.viewpane-item');
                    var itemsArray = Array.prototype.slice.call(allItems);
                    var pos = parseInt(itemInfo.Position) || 0;
                    if (ev.ctrlKey) {
                        _this.hasMultiSelect = true;
                    }
                    else {
                        _this.hasMultiSelect = false;
                        _this.positionArray = [];
                    }
                    if (_this.hasMultiSelect) {
                        if (_this.positionArray.indexOf(pos) === -1) {
                            _this.positionArray.push(pos);
                            setHighlight(viewEl, true);
                        }
                        else {
                            _this.positionArray.splice(_this.positionArray.indexOf(pos), 1);
                            setHighlight(viewEl, false);
                        }
                        if (_this.positionArray.indexOf(_this.currentPosition) === -1 && _this.currentPosition !== undefined) {
                            _this.positionArray.push(_this.currentPosition);
                            setHighlight(viewEl, true);
                        }
                        _this.currentPosition = undefined;
                    }
                    else {
                        itemsArray.forEach(function (item) { return setHighlight(item, false); });
                        _this.positionArray = [];
                        _this.currentPosition = pos;
                        setHighlight(viewEl, true);
                    }
                });
                editIcon.addEventListener('click', function (ev) {
                    ev.preventDefault();
                    ev.stopPropagation();
                    var el = $(viewName);
                    el.attr('contenteditable', 'true');
                    var range = document.createRange();
                    range.selectNodeContents(viewName);
                    var sel = window.getSelection();
                    sel.removeAllRanges();
                    sel.addRange(range);
                    el.focus();
                    el.blur(function (e) {
                        e.stopPropagation();
                        setName(e, itemInfo.Position);
                        el.off('blur');
                        el.attr('contenteditable', 'false');
                    });
                    el.on('keydown', function (e) {
                        e.stopPropagation();
                        if (e.keyCode === 13) {
                            e.preventDefault();
                            el.off('keydown');
                            el.attr('contenteditable', 'false');
                        }
                    });
                    el.on('keyup', function (e) {
                        e.stopPropagation();
                    });
                });
                $(viewEl).kendoTouch({
                    doubletap: function (ev) {
                        _this.activateView(itemInfo);
                        setHighlight(viewEl, true);
                        _this.currentPosition = parseInt(itemInfo.Position) || 0;
                    },
                    hold: function (ev) {
                        ev.preventDefault();
                        var el = $(viewName);
                        el.attr('contenteditable', 'true');
                        el.focus();
                        var range = document.createRange();
                        range.selectNodeContents(viewName);
                        var sel = window.getSelection();
                        sel.removeAllRanges();
                        sel.addRange(range);
                        el.focus();
                        el.blur(function (e) {
                            e.stopPropagation();
                            setName(e, itemInfo.Position);
                            $(e.target).off('blur');
                            $(e.target).attr('contenteditable', 'false');
                        });
                        el.on('keydown', function (e) {
                            e.stopPropagation();
                            if (e.keyCode === 13) {
                                e.preventDefault();
                                $(e.target).off('keydown');
                                $(e.target).attr('contenteditable', 'false');
                            }
                        });
                        el.on('keyup', function (e) {
                            e.stopPropagation();
                        });
                    }
                });
                _this.content.appendChild(viewEl);
                _this.viewElements.push(viewEl);
            };
            for (var _i = 0, viewsData_1 = viewsData; _i < viewsData_1.length; _i++) {
                var itemInfo = viewsData_1[_i];
                _loop_1(itemInfo);
            }
            if (_this.viewElements.length && (!_this.currentPosition || _this.currentPosition === 0)) {
                vsClient.setDefaultConfigurationView(viewsData[0]);
                $(_this.viewElements[0]).children().first().css('border', '3px solid ' + app_states_1.appStates.mainColor);
                $(_this.viewElements[0]).children().last().css('color', app_states_1.appStates.mainColor);
                _this.currentPosition = 0;
            }
            _this.el.scrollTop = _this.scrollPos;
        };
        _this.noAdapter = true;
        _this.el = document.createElement('div');
        _this.el.classList.add('viewpane-innerwrapper');
        _this.el.onkeydown = function (e) {
            e.preventDefault();
            e.stopPropagation();
        };
        _this.buttons = document.createElement('div');
        _this.buttons.classList.add('pane-buttons-tab');
        var addView = document.createElement('i');
        addView.className = 'fa fa-plus tree-header-action-icon';
        addView.addEventListener('click', function (ev) {
            var crateConfigurationView = '<Call Method="CreateConfigurationView"></Call>';
            vsClient.command.executeXML(crateConfigurationView);
            var getConfigurationView = '<Call Method="GetConfigurationViewInformation"><Image>true</Image></Call>';
            vsClient.command.executeXML(getConfigurationView);
        });
        _this.addTooltip = new tooltip_1.WVTooltip(addView);
        _this.addTooltip.setTitle(_lang_data['ID_CREATE_CONFIGVIEW'][_this.lang]);
        var deleteView = document.createElement('i');
        deleteView.className = 'fa fa-trash tree-header-action-icon';
        deleteView.addEventListener('click', function (ev) {
            var mutliSelectLength = _this.positionArray.length;
            if (mutliSelectLength > 0) {
                var numArray = _this.positionArray.sort(function (a, b) { return a - b; });
                for (var i = 0; i < mutliSelectLength; i++) {
                    var positionXml = '<Position>' + (numArray[i] - i) + '</Position>';
                    var deleteConfigurationView = '<Call Method="DeleteConfigurationView">' + positionXml + '</Call>';
                    vsClient.command.executeXML(deleteConfigurationView);
                }
            }
            else {
                var positionXml = '<Position>' + _this.currentPosition + '</Position>';
                var deleteConfigurationView = '<Call Method="DeleteConfigurationView">' + positionXml + '</Call>';
                vsClient.command.executeXML(deleteConfigurationView);
            }
            var getConfigurationView = '<Call Method="GetConfigurationViewInformation"><Image>true</Image></Call>';
            vsClient.command.executeXML(getConfigurationView);
        });
        _this.deleteTooltip = new tooltip_1.WVTooltip(deleteView);
        _this.deleteTooltip.setTitle(_lang_data['ID_DELETE_CONFIGVIEW'][_this.lang]);
        var updateView = document.createElement('i');
        updateView.className = 'fa fa-sync-alt tree-header-action-icon';
        updateView.addEventListener('click', function (ev) {
            var mutliSelectLength = _this.positionArray.length;
            if (mutliSelectLength > 0) {
                for (var i = 0; i < mutliSelectLength; i++) {
                    var positionXml = '<Position>' + _this.positionArray[i] + '</Position>';
                    var updateConfigurationView = '<Call Method="UpdateConfigurationView">' + positionXml + '</Call>';
                    vsClient.command.executeXML(updateConfigurationView);
                }
            }
            else {
                var positionXml = '<Position>' + _this.currentPosition + '</Position>';
                var updateConfigurationView = '<Call Method="UpdateConfigurationView">' + positionXml + '</Call>';
                vsClient.command.executeXML(updateConfigurationView);
            }
            var getConfigurationView = '<Call Method="GetConfigurationViewInformation"><Image>true</Image></Call>';
            vsClient.command.executeXML(getConfigurationView);
        });
        _this.updateTooltip = new tooltip_1.WVTooltip(updateView);
        _this.updateTooltip.setTitle(_lang_data['ID_VIEWS_UPDATE_VIEW'][_this.lang]);
        var home = document.createElement('i');
        home.className = 'fas fa-home tree-header-action-icon';
        home.addEventListener('click', function (ev) {
            var xml = '<Call Method="ActivateOnSaveConfigurationView"></Call>';
            vsClient.command.executeXML(xml);
        });
        _this.homeTooltip = new tooltip_1.WVTooltip(home);
        _this.homeTooltip.setTitle(_lang_data['ID_BUTTON_ACTIVATE_VIEW_ON_SAVE'][_this.lang]);
        var reversePlay = document.createElement('i');
        reversePlay.className = 'fa fa-backward tree-header-action-icon';
        reversePlay.addEventListener('click', function (ev) {
            var xml = '<Call Method="StartPlayConfigurationViews"><Reverse>true</Reverse><ConfigurationView>' + _this.currentPosition + '</ConfigurationView></Call>';
            vsClient.command.executeXML(xml);
        });
        _this.reversePlayTooltip = new tooltip_1.WVTooltip(reversePlay);
        _this.reversePlayTooltip.setTitle(_lang_data['ID_VIEWS_PLAY_BACKWARD'][_this.lang]);
        var stop = document.createElement('i');
        stop.className = 'fa fa-stop tree-header-action-icon';
        stop.addEventListener('click', function (ev) {
            stopPlayMode();
        });
        _this.stopTooltip = new tooltip_1.WVTooltip(stop);
        _this.stopTooltip.setTitle(_lang_data['ID_VIEWS_STOP'][_this.lang]);
        vsClient.on('OpenFile', function (ev) {
            stopPlayMode();
        });
        vsClient.on('NewScene3D', function (ev) {
            stopPlayMode();
        });
        vsClient.on('ImportFile', function (ev) {
            stopPlayMode();
        });
        vsClient.on('GetSceneSettings', function (response) {
            if (response.Error === 'SUCCESS') {
                _this.duration = parseInt(response.Settings.Scene.ConfigurationView.ViewPlay.DurationTime);
            }
        });
        var play = document.createElement('i');
        play.className = 'fa fa-forward tree-header-action-icon';
        play.addEventListener('click', function (ev) {
            var xml = '<Call Method="StartPlayConfigurationViews"><Reverse>false</Reverse><ConfigurationView>' + _this.currentPosition + '</ConfigurationView></Call>';
            vsClient.command.executeXML(xml);
        });
        _this.playTooltip = new tooltip_1.WVTooltip(play);
        _this.playTooltip.setTitle(_lang_data['ID_VIEWS_PLAY_FORWARD'][_this.lang]);
        vsClient.on('ConfigurationViewPlaySelectionChange', function (res) {
            var pos = parseInt(res.Selection);
            var activeViewEvent = {
                pos: pos,
                view: vsClient.getConfigurationViews()[pos]
            };
            vsClient.setDefaultConfigurationView(vsClient.getConfigurationViews()[pos]);
            vsClient.emit('ConfigurationViewChanged', activeViewEvent);
        });
        vsClient.on('ConfigurationViewChanged', function (event) {
            _this.currentPosition = event.pos;
            _this.viewElements[event.pos].focus();
            _this.viewElements.forEach(function (el) { return setHighlight(el, false); });
            setHighlight(_this.viewElements[event.pos], true);
            var GetSettings = "<Call Method=\"GetSceneSettings\"></Call>";
            vsClient.command.executeXML(GetSettings);
        });
        vsClient.on('ConfigurationViewPlayStart', function (res) {
            reversePlay.style.color = res.Reverse === 'true' ? app_states_1.appStates.mainColor : 'black';
            play.style.color = res.Reverse === 'true' ? 'black' : app_states_1.appStates.mainColor;
        });
        vsClient.on('ConfigurationViewPlayFinish', function (res) {
            reversePlay.style.color = 'black';
            play.style.color = 'black';
        });
        var stopPlayMode = function () {
            var xml = '<Call Method="StopPlayConfigurationViews"></Call>';
            vsClient.command.executeXML(xml);
        };
        var downloadPDFButton = document.createElement('i');
        downloadPDFButton.className = 'fas fa-file-pdf tree-header-action-icon';
        downloadPDFButton.onclick = function (e) {
            _this.createPDF();
        };
        _this.exportPDFTooltip = new tooltip_1.WVTooltip(downloadPDFButton);
        _this.exportPDFTooltip.setTitle(_lang_data['ID_BUTTON_SAVE_VIEWS_PDF'][_this.lang]);
        var selectAllIcon = document.createElement('i');
        selectAllIcon.className = 'fas fa-check-double tree-header-action-icon';
        selectAllIcon.onclick = function (e) {
            _this.selectAll();
        };
        _this.selectAllTooltip = new tooltip_1.WVTooltip(selectAllIcon);
        _this.selectAllTooltip.setTitle(_lang_data['ID_RIBBON_SELECT_ALL'][_this.lang]);
        _this.buttons.appendChild(home);
        _this.buttons.appendChild(addView);
        _this.buttons.appendChild(selectAllIcon);
        _this.buttons.appendChild(updateView);
        _this.buttons.appendChild(deleteView);
        _this.buttons.appendChild(reversePlay);
        _this.buttons.appendChild(stop);
        _this.buttons.appendChild(play);
        _this.buttons.appendChild(downloadPDFButton);
        _this.content = document.createElement('div');
        _this.content.classList.add('viewpane-content');
        _this.el.appendChild(_this.content);
        _this.el.onscroll = function (e) {
            _this.scrollPos = _this.el.scrollTop;
        };
        _this.wrapperEl.appendChild(_this.buttons);
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    ViewPane.prototype.addMethods = function () {
        if (vsClient && vsClient.command) {
            var getConfigurationView = '<Call Method="GetConfigurationViewInformation"><Image>true</Image></Call>';
            vsClient.command.executeXML(getConfigurationView);
        }
    };
    ViewPane.prototype.changeLang = function (lang) {
        for (var i = 0; i < this.tooltips.length; i += 3) {
            if (this.tooltips[i]) {
                this.tooltips[i].setTitle(_lang_data['ID_ACTIVATE_CONFIGURATION_VIEW_TOOLTIP'][lang]);
            }
            if (this.tooltips[i + 1]) {
                this.tooltips[i + 1].setTitle(_lang_data['ID_ACTIVATE_CONFIGURATION_VIEW_CAMERA_TOOLTIP'][lang]);
            }
            if (this.tooltips[i + 2]) {
                this.tooltips[i + 2].setTitle(_lang_data['ID_ACTIVATE_CONFIGURATION_VIEW_STATE_TOOLTIP'][lang]);
            }
        }
        this.homeTooltip.setTitle(_lang_data['ID_BUTTON_ACTIVATE_VIEW_ON_SAVE'][lang]);
        this.addTooltip.setTitle(_lang_data['ID_CREATE_CONFIGVIEW'][lang]);
        this.deleteTooltip.setTitle(_lang_data['ID_DELETE_CONFIGVIEW'][lang]);
        this.updateTooltip.setTitle(_lang_data['ID_VIEWS_UPDATE_VIEW'][lang]);
        this.reversePlayTooltip.setTitle(_lang_data['ID_VIEWS_PLAY_BACKWARD'][lang]);
        this.stopTooltip.setTitle(_lang_data['ID_VIEWS_STOP'][lang]);
        this.playTooltip.setTitle(_lang_data['ID_VIEWS_PLAY_FORWARD'][lang]);
        this.exportPDFTooltip.setTitle(_lang_data['ID_BUTTON_SAVE_VIEWS_PDF'][lang]);
        this.selectAllTooltip.setTitle(_lang_data['ID_RIBBON_SELECT_ALL'][lang]);
    };
    ViewPane.prototype.selectAll = function () {
        var _this = this;
        this.hasMultiSelect = true;
        this.positionArray = [];
        this.viewElements.forEach(function (view, index) {
            setHighlight(view, true);
            _this.positionArray.push(index);
        });
    };
    ViewPane.prototype.createPDF = function () {
        var xml = '<Call Method="GetViewsAsPDF" CustomId="WVViewPDF">';
        if (this.positionArray.length > 0) {
            var sortedArray = this.positionArray.sort(function (a, b) { return a - b; });
            sortedArray.forEach(function (pos) {
                xml += '<Id>' + pos + '</Id>';
            });
        }
        else {
            xml += '<Id>' + this.currentPosition + '</Id>';
        }
        xml += '</Call>';
        vsClient.command.executeXML(xml);
        ui.blockUI();
    };
    ViewPane.prototype.clearViews = function () {
        while (this.content.firstChild) {
            this.content.removeChild(this.content.firstChild);
        }
    };
    ViewPane.prototype.activateView = function (itemInfo) {
        vsClient.setConfigurationViewPosition(parseInt(itemInfo.Position));
    };
    return ViewPane;
}(pane_template_1.PaneTemplate));
exports.ViewPane = ViewPane;
function setHighlight(el, hightlight) {
    var element = $(el);
    $(element).children().first().css('border', hightlight ? '3px solid ' + app_states_1.appStates.mainColor : '1px solid rgb(0, 0, 0)');
    $(element).children().last().css('color', hightlight ? app_states_1.appStates.mainColor : 'rgb(0, 0, 0)');
}
function setName(e, position) {
    var command = '<Call Method="UpdateConfigurationView"><Position>' + position + '</Position>';
    command += '<Name>' + e.target.textContent + '</Name></Call>';
    vsClient.command.executeXML(command);
}


/***/ }),
/* 78 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var VisibilityTestPane = (function (_super) {
    __extends(VisibilityTestPane, _super);
    function VisibilityTestPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    VisibilityTestPane.prototype.addMethods = function () {
        $("#wv-visibilitytest #OnVisibilityTestComputeClicked").click(function (ev) {
            var xml = '<Call Method="Compute"><Mode>VisibilityTest</Mode></Call>';
            vsClient.command.executeXMLAsync(xml);
        });
    };
    VisibilityTestPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetVisibilityTestPaneTemplate = "<Call Method=\"GetTemplate\"><Type>VisibilityTestPane</Type></Call>";
        vsClient.command.executeXML(GetVisibilityTestPaneTemplate);
        vsClient.once('GetTemplate.VisibilityTestPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    VisibilityTestPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
            var xml = XMLParser.serializeWithValue(path, value);
            var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
            vsClient.command.executeXML(settings);
            if (_this.hasPresets) {
                _this.stack.changeToCustomPreset();
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return VisibilityTestPane;
}(pane_template_1.PaneTemplate));
exports.VisibilityTestPane = VisibilityTestPane;


/***/ }),
/* 79 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var pane = __webpack_require__(2);
var ui = __webpack_require__(0);
var XMLParser = __webpack_require__(3);
var pane_template_1 = __webpack_require__(1);
var WallthicknessPane = (function (_super) {
    __extends(WallthicknessPane, _super);
    function WallthicknessPane(paneId, caption) {
        var _this = _super.call(this, paneId, caption) || this;
        _this.update = function (response) {
            _this.values = {
                Event: ((response && !response.Type) && (_this.values && _this.values['Event'] && _this.values['Event'].Type)) ? _this.values['Event'] : response,
                Settings: ui.settingsPane.sceneSettings ? ui.settingsPane.sceneSettings['Settings'] : undefined
            };
            _this.adapter.updateValues(_this.values);
        };
        _this.el = document.createElement('table');
        _this.el.classList.add('pane-content');
        _this.wrapperEl.appendChild(_this.el);
        return _this;
    }
    WallthicknessPane.prototype.addMethods = function () {
        $("#wv-wallthickness #OnWallthicknessComputeClicked").click(function (ev) {
            var xml = '<Call Method="Compute"><Mode>Wallthickness</Mode></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-wallthickness #OnWallthicknessStopComputationClicked").click(function (ev) {
            var xml = '<Call Method="StopComputation"></Call>';
            vsClient.command.executeXML(xml);
        });
        $("#wv-wallthickness #OnWallthicknessResetClicked").click(function (ev) {
            var xml = '<Call Method="ResetWallthicknessVisualization"></Call>';
            vsClient.command.executeXML(xml);
        });
    };
    WallthicknessPane.prototype.changeLang = function (lang) {
        var _this = this;
        var GetWallthicknessPanePaneTemplate = "<Call Method=\"GetTemplate\"><Type>WallThicknessPane</Type></Call>";
        vsClient.command.executeXML(GetWallthicknessPanePaneTemplate);
        vsClient.once('GetTemplate.WallThicknessPane', function (response) {
            var template = response['Source']['Template'];
            _this.adapter.fromTemplate(template);
            _this.addMethods();
        });
    };
    WallthicknessPane.prototype.fromTemplate = function (template) {
        var _this = this;
        this.adapter = new pane.PaneAdapter(this.el);
        this.adapter.fromTemplate(template);
        this.adapter.on('user-input', function (src, value) {
            if (value === 'toggle-folder-visibility') {
                _this.adapter.updateValues(_this.values);
                return;
            }
            var path = src.item.path;
            if (path.length > 1 && path[1] === 'Preset' && value !== 'USERDEF') {
                var xml = '<Call Method="ActivatePreset"><Type>WallthicknessHeatmap</Type>';
                xml += '<Identifier>' + value + '</Identifier></Call>';
                vsClient.command.executeXML(xml);
                vsClient.on('ActivatePreset', function (ev) {
                    vsClient.command.executeXML('<Call Method="GetSceneSettings"></Call>');
                });
            }
            else if (path[0] === 'Event') {
                value = parseFloat(value).toString();
                pane.modifySettings(_this.values, path, value);
                var xml = XMLParser.serializeWithValue(path, value, ['Type=' + template['Event']]);
                vsClient.command.executeXML(xml);
            }
            else {
                pane.modifySettings(ui.settingsPane.sceneSettings, path, value);
                var xml = XMLParser.serializeWithValue(path, value);
                var settings = "<Call Method=\"SetSceneSettings\"> " + xml + " </Call>";
                vsClient.command.executeXML(settings);
                if (_this.hasPresets) {
                    _this.stack.changeToCustomPreset();
                }
            }
        });
        if (template['Event']) {
            var event_1 = template['Event'];
            vsClient.removeListener(event_1, this.update);
            vsClient.on(event_1, this.update);
        }
    };
    return WallthicknessPane;
}(pane_template_1.PaneTemplate));
exports.WallthicknessPane = WallthicknessPane;


/***/ }),
/* 80 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __assign = (this && this.__assign) || Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
        s = arguments[i];
        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
            t[p] = s[p];
    }
    return t;
};
Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var app_states_1 = __webpack_require__(4);
var w = __webpack_require__(10);
var app_settings_1 = __webpack_require__(9);
var XMLParser = __webpack_require__(3);
var js2xmlparser = __webpack_require__(17);
var ribbonMenu = __webpack_require__(13);
var ui_1 = __webpack_require__(0);
var holdActive = false;
var hasTouchHandlers = false;
var dbHandledInTouch = false;
var hasClicked = false;
var middleClick = false;
var moveIndex = 0;
var events = [
    'MeasurementChanged',
    'AsyncEventBegin',
    'AsyncEventProgress',
    'AsyncEventEnd',
    'TransformChanged',
    'DraftAngleChanged',
    'ProjectedAreaChanged',
    'TextSearchChanged',
    'NeighbourhoodSearchChanged',
    'SectionChanged',
    'ShowMessageBox',
    'ImportFinished',
    'CalloutSelectionChanged',
    'SavedSelectionsChanged',
    'WallthicknessValuesChanged',
    'SplitResultUpdated',
    'ActivateCompare',
    'CalloutAutoAlignmentChanged',
    'BandAnalysis',
    'ClashResultUpdated',
    'ConfigurationViewPlaySelectionChange',
    'ConfigurationViewPlayStart',
    'ConfigurationViewPlayFinish',
    'PresetChanged'
];
exports.getClient = function () {
    return vsClient;
};
exports.getStates = function () {
    return app_states_1.appStates;
};
exports.render = function () {
    ui.vsRibbon.render();
};
exports.lang = function (lang) {
    app_settings_1.settings.lang = lang;
    ui.vsRibbon.render();
};
exports.modeltree = function () {
};
exports.parseXML = function (xml) {
    return XMLParser.parseXML(xml);
};
exports.getRibbonGroups = function () {
    var content = 'var _RibbonGroups = ' + JSON.stringify(ui.vsRibbon.exposedGroupIDs, null, '\t');
    var blob = new Blob([content], { type: 'application/javascript' });
    var downloadEl = document.createElement('a');
    downloadEl.href = URL.createObjectURL(blob);
    downloadEl.download = 'custom_groups.js';
    downloadEl.style.display = 'none';
    document.body.appendChild(downloadEl);
    downloadEl.click();
    document.body.removeChild(downloadEl);
};
var stopLogging = localStorage.getItem('WVStopInitialLogging') === 'true';
try {
    if (_AppMainColor) {
        app_states_1.appStates.mainColor = _AppMainColor;
        document.documentElement.style.setProperty('--app-main-color', _AppMainColor);
    }
}
catch (e) {
}
try {
    if (_AppRibbonHeaderTextColor) {
        document.documentElement.style.setProperty('--app-ribbon-text-color', _AppRibbonHeaderTextColor);
    }
}
catch (e) {
}
var wvCanvas = ui.init();
vsClient.initOptions = {
    canvasMode: 'image',
    parseXMLResponse: true,
    emitXMLResponsesUnparsed: false,
    sendSessionReady: false,
    blockOnLoad: true
};
vsClient.on('@logMousemove', function (log) {
    vsClient.command.logMousemove(log);
});
var websocketAddress = "ws://localhost:8085/ws";
try {
    websocketAddress = g_sWebSocketAdress;
}
catch (e) {
    console.warn('Please define a WebSocket address!');
}
var parkedSession = localStorage.getItem('WVParkedSession');
var client = localStorage.getItem('WVClient');
var connectedToSession = false;
var initOptions = {};
var isNewSession = true;
var clientInitialized = false;
var urlFileName;
var urlFileType;
if (client && client !== null) {
    initOptions.testForSessions = true;
    initOptions.client = client;
}
else {
    initOptions.testForSessions = false;
}
if (parkedSession && parkedSession !== null) {
    initOptions.sessionToConnect = parkedSession;
    localStorage.removeItem('WVParkedSession');
    connectedToSession = true;
    vsClient.initialize(wvCanvas, websocketAddress, initOptions);
}
else {
    vsClient.initialize(wvCanvas, websocketAddress, initOptions);
}
ui.resizeHandler();
var array = new Uint32Array(10);
var crypto = prefixCrypto(window);
crypto.getRandomValues(array);
var uid = array[0];
app_states_1.appStates.sessionUID = uid;
function prefixCrypto(win) {
    return win.crypto || win.msCrypto;
}
function TouchPosCorrectionX(pos) {
    var rect = wvCanvas.getBoundingClientRect();
    var mouseX = pos - rect.left;
    return mouseX;
}
function TouchPosCorrectionY(pos) {
    var rect = wvCanvas.getBoundingClientRect();
    var mouseY = pos - rect.top;
    return mouseY;
}
function TouchHoldMove(e) {
    if (!app_states_1.appStates.touchActive) {
        e.sender.cancel();
        return;
    }
    var mouseX = TouchPosCorrectionX(e.touch.x.client);
    var mouseY = TouchPosCorrectionY(e.touch.y.client);
    var mouseFlag = '';
    if (e.event.altKey === true || e.event.ctrlKey === true) {
        mouseFlag = '<MouseFlag>Ctrl</MouseFlag>';
    }
    var s = '<Call Method="MouseMove" Response="true"><X>' + mouseX + '</X><Y>' + mouseY + '</Y><MouseButton>None</MouseButton></Call>';
    if (!holdActive) {
        s += '<Call Method="MouseDown" Response="false"><X>' + mouseX + '</X><Y>' + mouseY + '</Y><MouseButton>Left</MouseButton></Call>';
        holdActive = true;
    }
    vsClient.command.executeXMLMouse(s);
}
function HandleMouseForTouchGestureStart(touchevent) {
    app_states_1.appStates.lastGestureDistance = touchevent.distance;
    app_states_1.appStates.lastGestureCenterX = TouchPosCorrectionX(touchevent.center.x);
    app_states_1.appStates.lastGestureCenterY = TouchPosCorrectionY(touchevent.center.y);
    var sCommands = '<Call Method="SetMouseButtonFunctions" Response="false"><LeftMouseButtonFunction>Pan</LeftMouseButtonFunction></Call>';
    sCommands += '<Call Method="MouseDown" Response="false"><X>' + app_states_1.appStates.lastGestureCenterX + '</X><Y>' + app_states_1.appStates.lastGestureCenterY + '</Y><MouseButton>Left</MouseButton></Call>';
    vsClient.command.executeXMLMouse(sCommands);
}
function HandleMouseForTouchGesture(touchevent) {
    var bSendZoom = false;
    app_states_1.appStates.lastGestureDelta = touchevent.distance - app_states_1.appStates.lastGestureDistance;
    if (Math.abs(app_states_1.appStates.lastGestureDelta) > 10) {
        bSendZoom = true;
        app_states_1.appStates.lastGestureDistance = touchevent.distance;
    }
    app_states_1.appStates.lastGestureCenterX = TouchPosCorrectionX(touchevent.center.x);
    app_states_1.appStates.lastGestureCenterY = TouchPosCorrectionY(touchevent.center.y);
    var sMouseButtonDown = '<MouseButton>Left</MouseButton>';
    var callMove = '<Call Method="MouseMove" Response="true"><X>' + app_states_1.appStates.lastGestureCenterX + '</X><Y>' + app_states_1.appStates.lastGestureCenterY + '</Y>' + sMouseButtonDown + '</Call>';
    if (bSendZoom) {
        vsClient.command.executeXMLZoomMouseWheel(app_states_1.appStates.lastGestureCenterX, app_states_1.appStates.lastGestureCenterY, app_states_1.appStates.lastGestureDelta);
    }
    else {
        vsClient.command.executeXMLMouse(callMove);
    }
}
function HandleMouseForTouchGestureEnd() {
    var sCommands = '<Call Method="MouseUp" Response="false"><X>' + app_states_1.appStates.lastGestureCenterX + '</X><Y>' + app_states_1.appStates.lastGestureCenterY + '</Y><MouseButton>Left</MouseButton></Call>';
    sCommands += '<Call Method="SetMouseButtonFunctions" Response="false"><LeftMouseButtonFunction>' + app_states_1.appStates.mouseLeftButtonMode + '</LeftMouseButtonFunction></Call>';
    vsClient.command.executeXMLMouse(sCommands);
}
function HandleTouchDragStart(touchevent) {
    if (!app_states_1.appStates.touchGestureActive && !app_states_1.appStates.mouseActive) {
        touchevent.preventDefault();
        var mouseX = TouchPosCorrectionX(touchevent.touch.x.client);
        var mouseY = TouchPosCorrectionY(touchevent.touch.y.client);
        if (app_states_1.appStates.mouseLeftButtonMode === 'RectZoom' || app_states_1.appStates.mouseLeftButtonMode == 'RectSelect') {
            vsClient.startRect(mouseX, mouseY);
        }
        var s = '<Call Method="MouseMove" Response="true"><X>' + mouseX + '</X><Y>' + mouseY + '</Y><MouseButton>None</MouseButton></Call>';
        s += '<Call Method="MouseDown" Response="false"><X>' + mouseX + '</X><Y>' + mouseY + '</Y><MouseButton>Left</MouseButton></Call>';
        vsClient.command.executeXMLMouse(s);
    }
}
function HandleTouchDrag(touchevent) {
    if (!app_states_1.appStates.touchGestureActive && !app_states_1.appStates.mouseActive) {
        touchevent.preventDefault();
        var mouseX = TouchPosCorrectionX(touchevent.touch.x.client);
        var mouseY = TouchPosCorrectionY(touchevent.touch.y.client);
        var sMouseButtonDown = '<MouseButton>Left</MouseButton>';
        var callMove = '<Call Method="MouseMove" Response="true"><X>' + mouseX + '</X><Y>' + mouseY + '</Y>' + sMouseButtonDown + '</Call>';
        if ((app_states_1.appStates.mouseLeftButtonMode === 'RectZoom' || app_states_1.appStates.mouseLeftButtonMode == 'RectSelect') && app_states_1.appStates.drawRect
            && app_states_1.appStates.interactionMode.indexOf('Flythrough') === -1) {
            vsClient.drawRect(mouseX, mouseY);
        }
        else {
            vsClient.command.executeXMLMouseMove(callMove);
        }
    }
}
function HandleTouchDragEnd(touchevent) {
    if (!app_states_1.appStates.touchGestureActive && !app_states_1.appStates.mouseActive) {
        touchevent.preventDefault();
        var mouseX = TouchPosCorrectionX(touchevent.touch.x.client);
        var mouseY = TouchPosCorrectionY(touchevent.touch.y.client);
        var xml = '<Call Method="MouseUp" Response="false"><X>' + mouseX + '</X><Y>' + mouseY + '</Y><MouseButton>Left</MouseButton></Call>';
        vsClient.command.executeXMLMouse(xml);
    }
}
function mousedownHandler(ev) {
    $('#floating-attribute-wrapper').remove();
    if (app_states_1.appStates.touchActive) {
        return;
    }
    app_states_1.appStates.mouseActive = true;
    hasClicked = true;
    var boundingRect = wvCanvas.getBoundingClientRect();
    var offsetLeft = boundingRect.left;
    var offsetTop = boundingRect.top;
    var mouseX = ev.pageX - offsetLeft;
    var mouseY = ev.pageY - offsetTop;
    var button = 'None';
    switch (ev.which) {
        case 1:
            $('#wv-dock').toggleClass('disable-selection');
            app_states_1.appStates.mouseLeftButtonDown = true;
            button = 'Left';
            if (app_states_1.appStates.mouseLeftButtonMode === 'RectZoom' || app_states_1.appStates.mouseLeftButtonMode === 'RectSelect') {
                vsClient.startRect(mouseX, mouseY);
            }
            break;
        case 2:
            button = 'Middle';
            if (app_states_1.appStates.mouseMiddleButtonMode === 'RectZoom' || app_states_1.appStates.mouseMiddleButtonMode === 'RectSelect') {
                vsClient.startRect(mouseX, mouseY);
            }
            break;
        case 3:
            button = 'Right';
            if (app_states_1.appStates.mouseRightButtonMode === 'RectZoom' || app_states_1.appStates.mouseRightButtonMode === 'RectSelect') {
                vsClient.startRect(mouseX, mouseY);
            }
            break;
    }
    var xml = '<Call Method="MouseDown"><X>'
        + mouseX + '</X><Y>'
        + mouseY + '</Y>'
        + '<MouseButton>'
        + button + '</MouseButton></Call>';
    vsClient.command.executeXMLMouse(xml);
}
function mousemoveHandler(ev) {
    if (app_states_1.appStates.touchActive) {
        return;
    }
    if (ev.pageX === app_states_1.appStates.lastPagePosX && ev.pageY === app_states_1.appStates.lastPagePosY) {
        return;
    }
    app_states_1.appStates.lastPagePosX = ev.pageX;
    app_states_1.appStates.lastPagePosY = ev.pageY;
    var boundingRect = wvCanvas.getBoundingClientRect();
    var offsetLeft = boundingRect.left;
    var offsetTop = boundingRect.top;
    var mouseX = ev.pageX - offsetLeft;
    var mouseY = ev.pageY - offsetTop;
    vsClient.mouseX = mouseX;
    vsClient.mouseY = mouseY;
    var button = 'None';
    switch (ev.which) {
        case 1:
            if (ev.buttons > 1) {
                button = 'Middle';
                if ((app_states_1.appStates.mouseMiddleButtonMode === 'RectZoom' || app_states_1.appStates.mouseMiddleButtonMode == 'RectSelect') && app_states_1.appStates.drawRect
                    && app_states_1.appStates.interactionMode.indexOf('Flythrough') === -1) {
                    if (!middleClick) {
                        vsClient.startRect(mouseX, mouseY);
                        middleClick = true;
                        var xml = '<Call Method="MouseDown"><X>'
                            + mouseX + '</X><Y>'
                            + mouseY + '</Y>'
                            + '<MouseButton>'
                            + button + '</MouseButton></Call>';
                        vsClient.command.executeXMLNoMirror(xml);
                        return;
                    }
                    vsClient.drawRect(mouseX, mouseY);
                    return;
                }
                break;
            }
            button = 'Left';
            if (app_states_1.appStates.mouseLeftButtonDown &&
                ((app_states_1.appStates.mouseLeftButtonMode === 'RectZoom' || app_states_1.appStates.mouseLeftButtonMode == 'RectSelect') && app_states_1.appStates.drawRect
                    && app_states_1.appStates.interactionMode.indexOf('Flythrough') === -1)) {
                vsClient.drawRect(mouseX, mouseY);
                return;
            }
            break;
        case 2:
            if ((app_states_1.appStates.mouseMiddleButtonMode === 'RectZoom' || app_states_1.appStates.mouseMiddleButtonMode == 'RectSelect') && app_states_1.appStates.drawRect
                && app_states_1.appStates.interactionMode.indexOf('Flythrough') === -1) {
                vsClient.drawRect(mouseX, mouseY);
                return;
            }
            button = 'Middle';
            break;
        case 3:
            if ((app_states_1.appStates.mouseRightButtonMode === 'RectZoom' || app_states_1.appStates.mouseRightButtonMode == 'RectSelect') && app_states_1.appStates.drawRect
                && app_states_1.appStates.interactionMode.indexOf('Flythrough') === -1) {
                vsClient.drawRect(mouseX, mouseY);
                return;
            }
            button = 'Right';
            break;
    }
    var xml = '<Call Method="MouseMove" Response="true"><X>'
        + mouseX + '</X><Y>'
        + mouseY + '</Y><MouseButton>'
        + button + '</MouseButton></Call>';
    vsClient.command.executeXMLMouseMove(xml);
}
function mouseupHandler(ev) {
    app_states_1.appStates.lastMouseY = ev.clientY;
    app_states_1.appStates.lastMouseX = ev.clientX;
    if (app_states_1.appStates.touchActive) {
        return;
    }
    var boundingRect = wvCanvas.getBoundingClientRect();
    var offsetLeft = boundingRect.left;
    var offsetTop = boundingRect.top;
    var mouseX = ev.pageX - offsetLeft;
    var mouseY = ev.pageY - offsetTop;
    var button = 'None';
    switch (ev.which) {
        case 1:
            $('#wv-dock').toggleClass('disable-selection');
            button = 'Left';
            app_states_1.appStates.mouseLeftButtonDown = false;
            break;
        case 2:
            button = 'Middle';
            break;
        case 3:
            button = 'Right';
            break;
    }
    var mouseFlag = '';
    if (ev.ctrlKey === true) {
        mouseFlag = '<MouseFlag>Ctrl</MouseFlag>';
    }
    if (middleClick) {
        middleClick = false;
        button = 'Middle';
    }
    var xml = '<Call Method="MouseUp" Response="false"><X>'
        + mouseX + '</X><Y>'
        + mouseY + '</Y>'
        + mouseFlag
        + '<MouseButton>' + button + '</MouseButton></Call>';
    vsClient.command.executeXMLMouse(xml);
    app_states_1.appStates.mouseActive = false;
}
function dblclickHandler(ev) {
    ev.preventDefault();
    ev.stopPropagation();
    var boundingRect = wvCanvas.getBoundingClientRect();
    var offsetLeft = boundingRect.left;
    var offsetTop = boundingRect.top;
    var mouseX = ev.pageX - offsetLeft;
    var mouseY = ev.pageY - offsetTop;
    var button = 'None';
    if (ev.which === 1)
        button = 'Left';
    dbClickMethod(mouseX, mouseY, button);
}
function dbClickMethod(x, y, button) {
    if (dbHandledInTouch) {
        dbHandledInTouch = false;
        return;
    }
    var xml = '<Event Type="NodePropertiesChanged"></Event>';
    vsClient.command.executeXML(xml);
    vsClient.once('NodePropertiesChanged', function (res) {
        if (res && res.General && res.General.Name === 'MarkupSet') {
            var xml_1 = '<Call Method="Undo"><Steps>1</Steps></Call>';
            vsClient.command.executeXML(xml_1);
            vsClient.once('Undo', function () {
                vsClient.once('NodePropertiesChanged', function (resp) {
                    createMarkupOverlay(resp, x, y);
                });
            });
        }
        else if (res && res.General && res.General.Name === 'CreatedNotes') {
            var xml_2 = '<Call Method="Undo"><Steps>1</Steps></Call>';
            vsClient.command.executeXML(xml_2);
            vsClient.once('Undo', function () {
                if (res && res.General.Name === 'MarkupSet') {
                    var xml_3 = '<Call Method="Undo"><Steps>1</Steps></Call>';
                    vsClient.command.executeXML(xml_3);
                    vsClient.once('Undo', function () {
                        vsClient.once('NodePropertiesChanged', function (response) {
                            createMarkupOverlay(response, x, y);
                        });
                    });
                }
                else {
                    var dbClickXML = '<Call Method="MouseDoubleClick" Response="false"><X>'
                        + x + '</X><Y>'
                        + y + '</Y><MouseButton>'
                        + button + '</MouseButton></Call>';
                    vsClient.command.executeXMLMouse(dbClickXML);
                }
            });
        }
        else if (res && res.Markup) {
            createMarkupOverlay(res, x, y);
        }
        else {
            var dbClickXML = '<Call Method="MouseDoubleClick" Response="false"><X>'
                + x + '</X><Y>'
                + y + '</Y><MouseButton>'
                + button + '</MouseButton></Call>';
            vsClient.command.executeXMLMouse(dbClickXML);
        }
    });
}
function createMarkupOverlay(res, x, y) {
    if (!res.Markup) {
        return;
    }
    app_states_1.appStates.preventGlobalKeyEvents = true;
    var boundingRect = wvCanvas.getBoundingClientRect();
    var offsetLeft = boundingRect.left;
    var offsetTop = boundingRect.top;
    var text;
    var xml = '<Event Type="NodePropertiesChanged"><Markup><Text><Content>.</Content></Text></Markup></Event>';
    vsClient.command.executeXML(xml);
    var markupTextField = document.createElement('div');
    markupTextField.contentEditable = 'true';
    markupTextField.className = 'editable-markup-overlay';
    x = Math.max(0, Math.min(x - 150, wvCanvas.clientWidth - 300));
    y = Math.max(0, Math.min(y - 50, wvCanvas.clientHeight - 100));
    markupTextField.style.top = (y + offsetTop) + 'px';
    markupTextField.style.left = (x + offsetLeft) + 'px';
    var initialText = res.Markup.Text.Content;
    $(markupTextField).html(initialText);
    document.body.appendChild(markupTextField);
    markupTextField.focus();
    window.getSelection().selectAllChildren(markupTextField);
    markupTextField.addEventListener('keydown', function (e) {
        if (e.keyCode === 27) {
            app_states_1.appStates.preventGlobalKeyEvents = false;
            var xml_4 = '<Event Type="NodePropertiesChanged"><Markup><Text><Content>' + initialText + '</Content></Text></Markup></Event>';
            vsClient.command.executeXML(xml_4);
            $(markupTextField).off('blur');
            $(markupTextField).remove();
        }
    });
    $(markupTextField).on('blur', function (e) {
        app_states_1.appStates.preventGlobalKeyEvents = false;
        text = markupTextField.innerText ? markupTextField.innerText : '.';
        var xml = '<Event Type="NodePropertiesChanged"><Markup><Text><Content>' + text + '</Content></Text></Markup></Event>';
        vsClient.command.executeXML(xml);
        $(markupTextField).remove();
    });
}
function wheelHandler(ev) {
    ev.preventDefault();
    ev = ev.originalEvent;
    var boundingRect = wvCanvas.getBoundingClientRect();
    var offsetLeft = boundingRect.left;
    var offsetTop = boundingRect.top;
    var mouseX = ev.pageX - offsetLeft;
    var mouseY = ev.pageY - offsetTop;
    var deltaY = ev.deltaY;
    var correctedDeltaY = navigator.userAgent.indexOf("Firefox") != -1 ? deltaY * -0.1 : deltaY * -0.005;
    var xml = '<Call Method="MouseWheel" Response="false"><X>'
        + mouseX + '</X><Y>' + mouseY + '</Y><Delta>'
        + correctedDeltaY + ' </Delta></Call>';
    vsClient.command.executeXMLMouse(xml);
}
function applyCachedSettings(defaultSettings) {
    try {
        if (_UseCachedSettings) {
            var settingsObj = XMLParser.parseXML(localStorage.getItem('VSWVSettings'));
            ui.settingsPane.updateSettings(settingsObj);
            var settingsCall = '<Call Method="SetSettings">' + localStorage.getItem('VSWVSettings') + '</Call>';
            vsClient.command.executeXMLNoMirror(settingsCall);
        }
        else {
            ui.settingsPane.updateSettings(defaultSettings);
        }
    }
    catch (e) {
        ui.settingsPane.updateSettings(defaultSettings);
    }
}
var removeProp = function (obj, prop) {
    Object.keys(obj).forEach(function (key) {
        return (key === prop) && delete obj[key] ||
            (obj[key] && typeof obj[key] === 'object') && removeProp(obj[key], prop);
    });
    return obj;
};
function openFileHandler(response) {
    if (response.FileName) {
        app_states_1.appStates.fileName = response.FileName;
    }
    if (!(response.Error == "SUCCESS")) {
        var errorMessage = response.Error == "SUCCESS";
        alert("Error on loading file! " + errorMessage);
    }
    else {
        var type = response.Type;
        app_states_1.appStates.fileType = type;
        if (type === '2D') {
            try {
                for (var i = 0; i < _2DReducedSet.length; i++) {
                    $('#' + _2DReducedSet[i]).hide();
                }
                for (var i = 0; i < _3DReducedSet.length; i++) {
                    $('#' + _3DReducedSet[i]).show();
                }
            }
            catch (e) { }
        }
        else {
            try {
                for (var i = 0; i < _2DReducedSet.length; i++) {
                    $('#' + _2DReducedSet[i]).show();
                }
                for (var i = 0; i < _3DReducedSet.length; i++) {
                    $('#' + _3DReducedSet[i]).hide();
                }
            }
            catch (e) { }
        }
        var GetSettings = "<Call Method=\"GetSceneSettings\"></Call>";
        vsClient.command.executeXMLNoMirror(GetSettings);
        app_states_1.appStates.fileLoaded = true;
        ui.vsRibbon.reset();
        var maxVisible = ui.modeltreePane.currentMaxVisible();
        if (app_states_1.appStates.popoutPanes.indexOf('wv-modeltree') !== -1) {
            var height = app_states_1.appStates.popedOutWindows[app_states_1.appStates.popoutPanes.indexOf('wv-modeltree')].innerHeight - 30;
            var lineHeight = ui.modeltreePane.lineHeight;
            var popoutVisibleRows = Math.floor(height / lineHeight);
            maxVisible = popoutVisibleRows;
        }
        var getTreeview = "<Call Method=\"VirtualTreeViewSetSize\"><Size>" + maxVisible + "</Size></Call>";
        vsClient.command.executeXML(getTreeview);
        var getConfigurationView = '<Call Method="GetConfigurationViewInformation"><Image>true</Image></Call>';
        vsClient.command.executeXML(getConfigurationView);
        if (response.Type === '2D') {
            var pageCount = "<Call Method=\"GetPageCount\"></Call>";
            vsClient.command.executeXML(pageCount);
            vsClient.once('GetPageCount', function (res) {
                if (res.Error !== 'SUCCESS') {
                    app_states_1.appStates.pageCount = '';
                }
                else {
                    app_states_1.appStates.pageCount = res.Pages;
                    var pageInput = ui.vsRibbon.classes['PageInput'][0];
                    var inputEl = pageInput.el;
                    inputEl.value = "1 / " + res.Pages;
                }
            });
        }
        $(wvCanvas).off('mousedown').on('mousedown', function (e) {
            mousedownHandler(e);
        });
        $(wvCanvas).off('mousemove').on('mousemove', function (e) {
            mousemoveHandler(e);
        });
        $(wvCanvas).off('mouseup').on('mouseup', function (e) {
            mouseupHandler(e);
        });
        $(wvCanvas).off('dblclick').on('dblclick', function (e) {
            dblclickHandler(e);
        });
        $(wvCanvas).off('wheel').on('wheel', function (e) {
            wheelHandler(e);
        });
        $(wvCanvas).off('mouseleave').on('mouseleave', function (e) {
            mouseupHandler(e);
        });
        wvCanvas.ontouchmove = stopDefaultMouseEventPropagation;
        if (!hasTouchHandlers) {
            hasTouchHandlers = true;
            $(wvCanvas).kendoTouch({
                doubleTapTimeout: 250,
                multiTouch: true,
                enableSwipe: false,
                touchstart: function (e) {
                    if (app_states_1.appStates.mouseActive || (e.event.originalEvent['pointerType'] && e.event.originalEvent['pointerType'] !== 'touch')) {
                        e.sender.cancel();
                    }
                    else {
                        app_states_1.appStates.touchActive = true;
                    }
                },
                gesturestart: function (e) {
                    app_states_1.appStates.touchGestureActive = true;
                    HandleMouseForTouchGestureStart(e);
                },
                gesturechange: function (e) {
                    HandleMouseForTouchGesture(e);
                },
                gestureend: function (e) {
                    e.preventDefault();
                    HandleMouseForTouchGestureEnd();
                },
                drag: function (e) {
                    if (holdActive) {
                        TouchHoldMove(e);
                        return;
                    }
                    HandleTouchDrag(e);
                },
                dragstart: function (e) {
                    if (holdActive) {
                        TouchHoldMove(e);
                        return;
                    }
                    HandleTouchDragStart(e);
                },
                dragend: function (e) {
                    if (holdActive) {
                        e.sender.cancel();
                        holdActive = false;
                        var mouseX = TouchPosCorrectionX(e.touch.x.client);
                        var mouseY = TouchPosCorrectionY(e.touch.y.client);
                        var mouseFlag = '';
                        if (e.event.altKey === true || e.event.ctrlKey === true) {
                            mouseFlag = '<MouseFlag>Ctrl</MouseFlag>';
                        }
                        var s = '<Call Method="MouseMove" Response="true"><X>' + mouseX + '</X><Y>' + mouseY + '</Y><MouseButton>None</MouseButton></Call>';
                        s += '<Call Method="MouseUp" Response="false"><X>' + mouseX + '</X><Y>' + mouseY + '</Y>' + mouseFlag + '<MouseButton>Left</MouseButton></Call>';
                        vsClient.command.executeXMLMouse(s);
                        return;
                    }
                    HandleTouchDragEnd(e);
                    app_states_1.appStates.touchActive = false;
                    app_states_1.appStates.touchGestureActive = false;
                },
                hold: function (e) {
                    if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                        TouchHoldMove(e);
                    }
                },
                doubletap: function (e) {
                    e.preventDefault();
                    dbHandledInTouch = false;
                    var boundingRect = wvCanvas.getBoundingClientRect();
                    var offsetLeft = boundingRect.left;
                    var offsetTop = boundingRect.top;
                    var mouseX = e.touch.x.location - offsetLeft;
                    var mouseY = e.touch.y.location - offsetTop;
                    var button = 'None';
                    if (e.event.which !== undefined && (e.event.which === 1 || e.event.which === 0)) {
                        button = 'Left';
                    }
                    dbClickMethod(mouseX, mouseY, button);
                    dbHandledInTouch = true;
                },
                tap: function (e) {
                    if (hasClicked) {
                        hasClicked = false;
                        return;
                    }
                    else {
                        var boundingRect = wvCanvas.getBoundingClientRect();
                        var offsetLeft = boundingRect.left;
                        var offsetTop = boundingRect.top;
                        var mouseX = e.touch.x.location - offsetLeft;
                        var mouseY = e.touch.y.location - offsetTop;
                        var button = 'Left';
                        $('#wv-dock').toggleClass('disable-selection');
                        app_states_1.appStates.mouseLeftButtonDown = true;
                        if (app_states_1.appStates.mouseLeftButtonMode === 'RectZoom' || app_states_1.appStates.mouseLeftButtonMode === 'RectSelect') {
                            vsClient.startRect(mouseX, mouseY);
                        }
                        var xml = '<Call Method="MouseMove" Response="true"><X>';
                        xml += mouseX;
                        xml += '</X><Y>';
                        xml += mouseY;
                        xml += '</Y><MouseButton>None</MouseButton></Call>';
                        ;
                        vsClient.command.executeXMLNoMirror(xml);
                        xml = '<Call Method="MouseDown"><X>';
                        xml += mouseX + '</X><Y>';
                        xml += mouseY + '</Y>';
                        xml += '<MouseButton>';
                        xml += button + '</MouseButton></Call>';
                        vsClient.command.executeXMLNoMirror(xml);
                        xml = '<Call Method="MouseUp"><X>';
                        xml += mouseX + '</X><Y>';
                        xml += mouseY + '</Y>';
                        xml += '<MouseButton>';
                        xml += button + '</MouseButton></Call>';
                        vsClient.command.executeXMLNoMirror(xml);
                    }
                }
            });
        }
        try {
            if (_ClosePanesOnOpenFile) {
                ui.resetPanes(false);
                if (app_states_1.appStates.qsMode) {
                    var isOpen = app_states_1.appStates.panes.map(function (item) { return item.paneId === 'wv-command' && item.visible; }).indexOf(true) !== -1;
                    var isPopout = app_states_1.appStates.popoutPanes.indexOf('wv-command') !== -1;
                    if (!isOpen && !isPopout) {
                        ui.prependPane('wv-command');
                    }
                }
            }
            else {
                ui.closePane('wv-neighbourhoodsearch');
                ui.closePane('wv-split');
            }
        }
        catch (e) {
            ui.closePane('wv-neighbourhoodsearch');
            ui.closePane('wv-split');
        }
    }
}
function stopDefaultMouseEventPropagation(e) {
    e.preventDefault();
    e.stopPropagation();
}
vsClient.on('GetSessions', function (res) {
    var disableSessionRestore;
    try {
        disableSessionRestore = _DisableSessionRestore;
    }
    catch (e) {
        disableSessionRestore = false;
    }
    var queryString = window.location.search.substr(1);
    var kvs = queryString.split('&');
    var query = {};
    for (var _i = 0, kvs_1 = kvs; _i < kvs_1.length; _i++) {
        var kv = kvs_1[_i];
        var _a = kv.split('='), k = _a[0], v = _a[1];
        query[k] = v;
    }
    if (typeof query['session'] !== 'undefined') {
        return;
    }
    if (res && res.Session && !Array.isArray(res.Session)) {
        res.Session = [res.Session];
    }
    if (res.Session && res.Session.length > 0 && !disableSessionRestore) {
        ui.showSessionRestoreDialog(res.Session);
    }
    else {
        vsClient.connect();
        if (app_states_1.appStates.backendToken) {
            vsClient.SessionToken(app_states_1.appStates.backendToken);
        }
    }
});
vsClient.on('ConnectionLost', function () {
    ui.blockUI('Connection lost.\n Trying to reconnect..');
});
vsClient.on('ConnectionRestored', function () {
    try {
        $(".ws_indicator").css('fill', _AppRibbonHeaderTextColor);
    }
    catch (e) {
        $(".ws_indicator").css('fill', 'green');
    }
    ui.unblockUI();
});
vsClient.on('initialized', function (response) {
    try {
        $(".ws_indicator").css('fill', _AppRibbonHeaderTextColor);
    }
    catch (e) {
        $(".ws_indicator").css('fill', 'green');
    }
    app_states_1.appStates.clientInitialized = true;
    var queryString = window.location.search.substr(1);
    var kvs = queryString.split('&');
    var query = {};
    for (var _i = 0, kvs_2 = kvs; _i < kvs_2.length; _i++) {
        var kv = kvs_2[_i];
        var _a = kv.split('='), k = _a[0], v = _a[1];
        query[k] = v;
    }
    vsClient.on('NewScene3D', function (response) {
        var events = '<Call Method="AddEventListener">';
        events += '<Event>ActivateInteraction</Event>';
        events += '<Event>DeactivateInteraction</Event>';
        events += '<Event>SelectionChanged</Event>';
        events += '<Event>SelectionChangedCustomId</Event>';
        events += '<Event>NodePropertiesChanged</Event></Call>';
        vsClient.command.executeXMLNoMirror(events);
        vsClient.AutoResize();
        openFileHandler(response);
    });
    if (typeof query['session'] !== 'undefined') {
        vsClient.initOptions.sessionToConnect = query['session'];
        connectedToSession = true;
        if (typeof query['filetype'] !== 'undefined') {
            urlFileType = query['filetype'];
        }
        if (typeof query['filename'] !== 'undefined') {
            urlFileName = query['filename'];
        }
        vsClient.connect();
    }
    if (typeof query['token'] !== 'undefined') {
        app_states_1.appStates.backendToken = decodeURIComponent(query['token']);
        ui.vsRibbon.disableFileList();
        if (!client) {
            vsClient.SessionToken(app_states_1.appStates.backendToken);
        }
        else {
            vsClient.sessionInfo.token = app_states_1.appStates.backendToken;
        }
        vsClient.on('OpenFile', function (response) {
            handleVisShareOpen(response);
            var events = '<Call Method="AddEventListener">';
            events += '<Event>ActivateInteraction</Event>';
            events += '<Event>DeactivateInteraction</Event>';
            events += '<Event>SelectionChanged</Event>';
            events += '<Event>SelectionChangedCustomId</Event>';
            events += '<Event>NodePropertiesChanged</Event></Call>';
            vsClient.command.executeXMLNoMirror(events);
            vsClient.AutoResize();
            openFileHandler(response);
        });
        vsClient.on('SessionInitialized', function (res) {
            setSessionInfo(res);
            prepareApp(true);
        });
    }
    else {
        ui.vsRibbon.deleteShareRibbon();
        vsClient.on('SessionInitialized', function (res) {
            setSessionInfo(res);
            prepareApp(false);
        });
    }
    window.addEventListener('storage', function (e) {
        if (e.key === 'WVCommand' + app_states_1.appStates.sessionUID) {
            if (e.newValue.indexOf('ComputeSplitForPopout') !== -1) {
                vsClient.once('Compute', function (res) {
                    localStorage.setItem('WVSplitGroupAdded' + app_states_1.appStates.sessionUID, JSON.stringify(res));
                });
            }
            else if (e.newValue.indexOf('ComputeBOMForPopout') !== -1) {
                vsClient.once('Compute', function (res) {
                    localStorage.setItem('WVBOMComputed' + app_states_1.appStates.sessionUID, JSON.stringify(res));
                });
            }
            else if (e.newValue.indexOf('ComputeClashForPopout') !== -1) {
                vsClient.once('Compute', function (res) {
                    localStorage.setItem('WVClashComputed' + app_states_1.appStates.sessionUID, JSON.stringify(res));
                });
            }
            else if (e.newValue.indexOf('CustomId="WVViewPDF"') !== -1) {
                ui.blockUI();
            }
            else if (e.newValue.indexOf('GetBOMAttributeCols')) {
                vsClient.once('GetBillOfMaterialNodePropertyNames', function (props) {
                    vsClient.command.executeXML('<Call Method="GetBillOfMaterialAttributeNames"></Call>');
                    vsClient.once('GetBillOfMaterialAttributeNames', function (attr) {
                        var values = { props: props, attr: attr };
                        localStorage.setItem('WVBOMColls' + app_states_1.appStates.sessionUID, JSON.stringify(values));
                    });
                });
            }
            vsClient.command.executeXML(e.newValue);
            localStorage.removeItem(e.key);
        }
        else {
            switch (e.key) {
                case 'WVActivateView' + app_states_1.appStates.sessionUID:
                    var activationObj = JSON.parse(e.newValue);
                    vsClient.setConfigurationViewPosition(activationObj.pos, activationObj.withCamera, activationObj.withState);
                    localStorage.removeItem(e.key);
                    break;
                case 'WVViewsData' + app_states_1.appStates.sessionUID:
                    var views = JSON.parse(e.newValue);
                    vsClient.setConfigurationViews(views);
                    localStorage.removeItem(e.key);
                    break;
            }
        }
    }, false);
    window.onunload = function (e) {
        localStorage.removeItem('WVCommand' + app_states_1.appStates.sessionUID);
        var eventLength = events.length;
        for (var e_1 = 0; e_1 < eventLength; e_1++) {
            localStorage.removeItem('WV' + events[e_1] + app_states_1.appStates.sessionUID);
        }
        localStorage.removeItem('WVNodePropertiesChanged' + app_states_1.appStates.sessionUID);
        var length = app_states_1.appStates.popedOutWindows.length;
        for (var i = 0; i < length; i++) {
            app_states_1.appStates.popedOutWindows[i].close();
        }
        localStorage.removeItem('WVSettingsChange' + app_states_1.appStates.sessionUID);
        localStorage.removeItem('WVTreeViewUpdated' + app_states_1.appStates.sessionUID);
        localStorage.removeItem('WVSceneSettingsChange' + app_states_1.appStates.sessionUID);
        localStorage.removeItem('WVCommand' + app_states_1.appStates.sessionUID);
        localStorage.removeItem('WVSelectedNodeColor' + app_states_1.appStates.sessionUID);
        localStorage.removeItem('WVSplitGroupAdded' + app_states_1.appStates.sessionUID);
    };
});
function setSessionInfo(res) {
    var session = res.Session;
    var client = res.Client;
    isNewSession = res.NewSession;
    if (client) {
        localStorage.setItem('WVClient', client);
        vsClient.initOptions['client'] = client;
    }
    if (session) {
        if (app_states_1.appStates.session && isNewSession) {
            var sessionError = {
                ErrorCode: 0,
                ErrorInfo: 'SessionInvalid',
                Identifier: 'SessionInvalid',
                Message: 'Invalid session.',
                Type: ['Event', 'Error']
            };
            vsClient.emit('ShowMessageBox', sessionError);
            vsClient.vsCanvas.setDefaultImage();
        }
        app_states_1.appStates.session = session;
    }
}
function handleVisShareOpen(response) {
    if (response.CustomId && response.CustomId.indexOf('VSOpen') !== -1) {
        app_states_1.appStates.VisShareSpec = response.CustomId;
        if (response.CustomId.indexOf('VSName') !== -1) {
            document.title = response.CustomId.split('VSName')[1];
            ;
        }
        var accessRights = response.CustomId.split('VSOpen')[1].split('_')[0];
        if (accessRights === 'Write') {
            $('#ID_RIBBON_VISSHARE_SAVE').hide();
        }
        else if (accessRights === 'None') {
            ui.vsRibbon.deleteShareRibbon();
        }
    }
    else {
        ui.vsRibbon.deleteShareRibbon();
    }
}
function mapLanguage(browserLang) {
    var country = browserLang.split('-')[0].toLowerCase();
    switch (country) {
        case 'en':
            return 'ENU';
        case 'de':
            return 'DEU';
        case 'it':
            return 'ITA';
        case 'es':
            return 'ESP';
        case 'fr':
            return 'FRA';
        case 'ko':
            return 'KOR';
        case 'zh':
            return 'CHS';
        case 'ja':
            return 'JPN';
        default:
            return 'ENU';
    }
}
function prepareApp(isBackendMode) {
    if (clientInitialized) {
        return;
    }
    clientInitialized = true;
    var lang = localStorage.getItem('WVLang');
    if (!lang) {
        lang = mapLanguage(navigator.language);
        vsClient.emit('@changeLang', lang);
    }
    $('#wv-ribbon-language').val(lang).change();
    vsClient.setMaxListeners(30);
    var GetSettingsTemplate = "<Call Method=\"GetTemplate\"><Type>SettingsPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetSettingsTemplate);
    vsClient.once('GetTemplate.SettingsPane', function (response) {
        var template = response['Source']['Template'];
        ui.settingsPane.fromTemplate(template);
        var GetSettings = "<Call Method=\"GetSettings\"></Call>";
        vsClient.command.executeXMLNoMirror(GetSettings);
        vsClient.once('GetSettings', function (response, xml) {
            var cachedSettings = localStorage.getItem('VSWVSettings');
            response = removeProp(response, '__text__');
            response = removeProp(response, '__ordinal__');
            delete response.Settings.Renderer.General.Language;
            var version;
            if (response.Settings.Version) {
                if (Array.isArray(response.Settings.Version)) {
                    version = response.Settings.Version[0];
                }
                else {
                    version = response.Settings.Version;
                }
            }
            delete response.Settings.Version;
            var call = js2xmlparser.parse('Settings', response.Settings).replace("<?xml version='1.0'?>", "");
            call = call.replace('<Settings>', '<Settings Version="' + version + '">');
            localStorage.setItem('VSWVDefaultSettings', call);
            if (cachedSettings === null) {
                localStorage.setItem('VSWVSettings', call);
                ui.settingsPane.updateSettings(response);
                getTemplates(isBackendMode);
            }
            else {
                applyCachedSettings(response);
                getTemplates(isBackendMode);
            }
            localStorage.setItem('WVSettingsChange' + app_states_1.appStates.sessionUID, JSON.stringify(response));
            vsClient.on('GetSettings', function (response, xml) {
                response = removeProp(response, '__text__');
                response = removeProp(response, '__ordinal__');
                var version;
                if (response.Settings.Version) {
                    if (Array.isArray(response.Settings.Version)) {
                        version = response.Settings.Version[0];
                    }
                    else {
                        version = response.Settings.Version;
                    }
                }
                delete response.Settings.Version;
                var call = js2xmlparser.parse('Settings', response.Settings).replace("<?xml version='1.0'?>", "");
                call = call.replace('<Settings>', '<Settings Version="' + version + '">');
                ui.settingsPane.updateSettings(response);
                delete response.Settings.Renderer.General.Language;
                localStorage.setItem('VSWVSettings', call);
                localStorage.setItem('WVSettingsChange' + app_states_1.appStates.sessionUID, JSON.stringify(response));
            });
        });
        vsClient.on('SetSceneSettings', function () {
            var GetSettings = "<Call Method=\"GetSceneSettings\"></Call>";
            vsClient.command.executeXMLNoMirror(GetSettings);
        });
        vsClient.on('SetSettings', function () {
            var GetSettings = "<Call Method=\"GetSettings\"></Call>";
            vsClient.command.executeXMLNoMirror(GetSettings);
        });
    });
    vsClient.on('GetSceneSettings', GetSceneSettingsCallback);
    var registerEvents = ' <Call Method="AddEventListener">';
    var eventLength = events.length;
    for (var e = 0; e < eventLength; e++) {
        registerEvents += '<Event>' + events[e] + '</Event>';
        vsClient.on(events[e], registerEventHandlerForPopout);
    }
    registerEvents += '</Call>';
    vsClient.command.executeXMLNoMirror(registerEvents);
    var xml = '<Call Method="GetVersionInfo"></Call>';
    vsClient.command.executeXMLAsync(xml);
    vsClient.once("GetVersionInfo", function (response) {
        var versionArr = response.Version.split('.');
        versionArr.pop();
        app_states_1.appStates.version = versionArr.join('.');
    });
}
function registerEventHandlerForPopout(res) {
    if (Array.isArray(res.Type)) {
        return;
    }
    localStorage.setItem('WV' + res.Type + app_states_1.appStates.sessionUID, JSON.stringify(res));
}
function getTemplates(isBackendMode) {
    var GetScenePropertiesTsemplate = "<Call Method=\"GetTemplate\"><Type>PropertiesPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetScenePropertiesTsemplate);
    vsClient.once('GetTemplate.PropertiesPane', function (response) {
        var template = response['Source']['Template'];
        ui.propertiesPane.fromTemplate(template);
    });
    var GetMeasurementPane = "<Call Method=\"GetTemplate\"><Type>MeasurementPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetMeasurementPane);
    vsClient.once('GetTemplate.MeasurementPane', function (response) {
        var template = response['Source']['Template'];
        ui.measurementPane.fromTemplate(template);
    });
    var GetDraftAnglePane = "<Call Method=\"GetTemplate\"><Type>DraftAnglePane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetDraftAnglePane);
    vsClient.once('GetTemplate.DraftAnglePane', function (response) {
        var template = response['Source']['Template'];
        ui.draftAnglePane.fromTemplate(template);
    });
    var GetTransformPane = "<Call Method=\"GetTemplate\"><Type>TransformPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetTransformPane);
    vsClient.once('GetTemplate.TransformPane', function (response) {
        var template = response['Source']['Template'];
        ui.transformPane.fromTemplate(template);
    });
    var GetMarkupPaneReduced = "<Call Method=\"GetTemplate\"><Type>MarkupPane_Reduced</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetMarkupPaneReduced);
    vsClient.once('GetTemplate.MarkupPane_Reduced', function (response) {
        var template = response['Source']['Template'];
        ui.markupPane_Reduced.fromTemplate(template);
    });
    var GetMarkupPane = "<Call Method=\"GetTemplate\"><Type>MarkupPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetMarkupPane);
    vsClient.once('GetTemplate.MarkupPane', function (response) {
        var template = response['Source']['Template'];
        ui.markupPane.fromTemplate(template);
    });
    var GetSectionPane = "<Call Method=\"GetTemplate\"><Type>SectionPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetSectionPane);
    vsClient.once('GetTemplate.SectionPane', function (response) {
        var template = response['Source']['Template'];
        ui.sectionPane.fromTemplate(template);
    });
    var GetQuickComparePane = "<Call Method=\"GetTemplate\"><Type>QuickComparePane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetQuickComparePane);
    vsClient.once('GetTemplate.QuickComparePane', function (response) {
        var template = response['Source']['Template'];
        ui.quickComparePane.fromTemplate(template);
    });
    var GetProjectedAreaPane = "<Call Method=\"GetTemplate\"><Type>ProjectedAreaPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetProjectedAreaPane);
    vsClient.once('GetTemplate.ProjectedAreaPane', function (response) {
        var template = response['Source']['Template'];
        ui.projectedAreaPane.fromTemplate(template);
    });
    var GetExactComparePane = "<Call Method=\"GetTemplate\"><Type>ExactComparePane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetExactComparePane);
    vsClient.once('GetTemplate.ExactComparePane', function (response) {
        var template = response['Source']['Template'];
        ui.exactComparePane.fromTemplate(template);
    });
    var GetMirrorPane = "<Call Method=\"GetTemplate\"><Type>MirrorPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetMirrorPane);
    vsClient.once('GetTemplate.MirrorPane', function (response) {
        var template = response['Source']['Template'];
        ui.mirrorPane.fromTemplate(template);
    });
    var GetFilterPane = "<Call Method=\"GetTemplate\"><Type>FilterPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetFilterPane);
    vsClient.once('GetTemplate.FilterPane', function (response) {
        var template = response['Source']['Template'];
        ui.filterPane.fromTemplate(template);
    });
    var GetFlyThroughPane = "<Call Method=\"GetTemplate\"><Type>FlyThroughPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetFlyThroughPane);
    vsClient.once('GetTemplate.FlyThroughPane', function (response) {
        var template = response['Source']['Template'];
        ui.flyThroughPane.fromTemplate(template);
    });
    var GetDistortionPane = "<Call Method=\"GetTemplate\"><Type>DistortionPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetDistortionPane);
    vsClient.once('GetTemplate.DistortionPane', function (response) {
        var template = response['Source']['Template'];
        ui.distortionPane.fromTemplate(template);
    });
    var GetVisibilityTestPane = "<Call Method=\"GetTemplate\"><Type>VisibilityTestPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetVisibilityTestPane);
    vsClient.once('GetTemplate.VisibilityTestPane', function (response) {
        var template = response['Source']['Template'];
        ui.visibilityTestPane.fromTemplate(template);
    });
    var GetWallthicknessPane = "<Call Method=\"GetTemplate\"><Type>WallThicknessPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetWallthicknessPane);
    vsClient.once('GetTemplate.WallThicknessPane', function (response) {
        var template = response['Source']['Template'];
        ui.wallthicknessPane.fromTemplate(template);
    });
    var GetDrillholePane = "<Call Method=\"GetTemplate\"><Type>DrillholePane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetDrillholePane);
    vsClient.once('GetTemplate.DrillholePane', function (response) {
        var template = response['Source']['Template'];
        ui.drillholePane.fromTemplate(template);
    });
    var GetNeutralAxisPane = "<Call Method=\"GetTemplate\"><Type>NeutralAxisPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetNeutralAxisPane);
    vsClient.once('GetTemplate.NeutralAxisPane', function (response) {
        var template = response['Source']['Template'];
        ui.neutralAxisPane.fromTemplate(template);
    });
    var GetNeighbourhoodSearchPane = "<Call Method=\"GetTemplate\"><Type>NeighbourhoodSearchPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetNeighbourhoodSearchPane);
    vsClient.once('GetTemplate.NeighbourhoodSearchPane', function (response) {
        var template = response['Source']['Template'];
        ui.neighbourhoodSearchPane.fromTemplate(template);
    });
    var GetBOMPane = "<Call Method=\"GetTemplate\"><Type>BOMPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetBOMPane);
    vsClient.once('GetTemplate.BOMPane', function (response) {
        var template = response['Source']['Template'];
        ui.bomPane.fromTemplate(template);
    });
    var GetClashPane = "<Call Method=\"GetTemplate\"><Type>ClashPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetClashPane);
    vsClient.once('GetTemplate.ClashPane', function (response) {
        var template = response['Source']['Template'];
        ui.clashPane.fromTemplate(template);
    });
    var GetCalloutPane = "<Call Method=\"GetTemplate\"><Type>CalloutPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetCalloutPane);
    vsClient.once('GetTemplate.CalloutPane', function (response) {
        var template = response['Source']['Template'];
        ui.calloutPane.fromTemplate(template);
    });
    var GetSplitPane = "<Call Method=\"GetTemplate\"><Type>SplitPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetSplitPane);
    vsClient.once('GetTemplate.SplitPane', function (response) {
        var template = response['Source']['Template'];
        ui.splitPane.fromTemplate(template);
    });
    var GetExplodePane = "<Call Method=\"GetTemplate\"><Type>ExplodePane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetExplodePane);
    vsClient.once('GetTemplate.ExplodePane', function (response) {
        var template = response['Source']['Template'];
        ui.explodePane.fromTemplate(template);
    });
    var GetAnimationPane = "<Call Method=\"GetTemplate\"><Type>AnimationPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetAnimationPane);
    vsClient.once('GetTemplate.AnimationPane', function (response) {
        var template = response['Source']['Template'];
        ui.animationPane.fromTemplate(template);
    });
    var GetGeomertyToolsPane = "<Call Method=\"GetTemplate\"><Type>GeometryToolsPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetGeomertyToolsPane);
    vsClient.once('GetTemplate.GeometryToolsPane', function (response) {
        var template = response['Source']['Template'];
        ui.geometryToolsPane.fromTemplate(template);
    });
    var GetBandAnalysisPane = "<Call Method=\"GetTemplate\"><Type>BandAnalysisPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetBandAnalysisPane);
    vsClient.once('GetTemplate.BandAnalysisPane', function (response) {
        var template = response['Source']['Template'];
        ui.bandAnalysisPane.fromTemplate(template);
    });
    var GetTextSearchPane = "<Call Method=\"GetTemplate\"><Type>TextSearchPane</Type></Call>";
    vsClient.command.executeXMLNoMirror(GetTextSearchPane);
    vsClient.once('GetTemplate.TextSearchPane', function (response) {
        var template = response['Source']['Template'];
        ui.textSearchPane.fromTemplate(template);
        var SendSessionReady = "\n        <Call Method=\"SendSessionReady\">\n        </Call>\n        ";
        vsClient.command.executeXML(SendSessionReady);
        vsClient.emit('@logMousemove', (localStorage.getItem('WVLogMouseMove') !== 'false'));
        if (isBackendMode === false) {
            vsClient.on('OpenFile', openFileHandler);
            if (window.location.search.length > 0) {
                interceptQueryString(false);
            }
        }
        else {
            interceptQueryString(true);
        }
        if (connectedToSession) {
            var type = void 0;
            if (urlFileType) {
                type = urlFileType;
            }
            else {
                type = localStorage.getItem('WVFileType') ? localStorage.getItem('WVFileType') : '3D';
                localStorage.removeItem('WVFileType');
            }
            app_states_1.appStates.fileType = type;
            var fileName = void 0;
            if (urlFileName) {
                fileName = urlFileName;
            }
            else {
                fileName = localStorage.getItem('WVFileName') ? localStorage.getItem('WVFileName') : '';
                localStorage.removeItem('WVFileName');
            }
            var visShareSpec = localStorage.getItem('WVVisShareSpec') ? localStorage.getItem('WVVisShareSpec') : '';
            localStorage.removeItem('WVVisShareSpec');
            vsClient.emit('OpenFile', { Error: 'SUCCESS', Type: type, CustomId: visShareSpec, FileName: fileName });
        }
        stopLogging = false;
        console.log("WV Client send SessionReady");
    });
}
vsClient.on('AsyncEventBegin', function (res) {
    ui.progressContainer.start();
    if (res.BlockingOperation === "1") {
        ui.progressContainer.addBar(res.Id, res.Indeterminate === "1", res.Description, true);
    }
    else {
        ui.progressContainer.addBar(res.Id, res.Indeterminate === "1", res.Description);
    }
});
vsClient.on('AsyncEventProgress', function (res) {
    ui.progressContainer.stepBarById(res.Id, res.Progress);
});
vsClient.on('AsyncEventEnd', function (res) {
    ui.progressContainer.stopBarById(res.Id);
});
vsClient.on('ClashResultUpdated', function (res) {
    var isOpen = app_states_1.appStates.panes.map(function (item) { return item.paneId === 'wv-clash' && item.visible; }).indexOf(true) !== -1;
    var isPopout = app_states_1.appStates.popoutPanes.indexOf('wv-clash') !== -1;
    if (!isOpen && !isPopout) {
        ui.prependPane('wv-clash');
    }
});
vsClient.on('SplitResultUpdated', function (res, xml) {
    var isOpen = app_states_1.appStates.panes.map(function (item) { return item.paneId === 'wv-split' && item.visible; }).indexOf(true) !== -1;
    var isPopout = app_states_1.appStates.popoutPanes.indexOf('wv-split') !== -1;
    if (!isOpen && !isPopout) {
        ui.prependPane('wv-split');
    }
    ui.splitPane.clearGroupTable();
    ui.splitPane.sessions = [];
    if (!Array.isArray(res.Data)) {
        res.Data = [res.Data];
    }
    var splitSession = res.SplitGeneralData;
    if (!Array.isArray(res.Data[0].SplitDirectionId)) {
        res.Data[0].SplitDirectionId = [res.Data[0].SplitDirectionId];
    }
    if (isPopout) {
        localStorage.setItem('WVClearSplit' + app_states_1.appStates.sessionUID, '');
    }
    for (var i = 0; i < res.Data[0].SplitDirectionId.length; i++) {
        var item = res.Data[0].SplitDirectionId[i];
        var fullSession = __assign({}, splitSession, item);
        fullSession.SplitDirectionId = item.Id;
        fullSession.Error = 'SUCCESS';
        if (!isPopout) {
            ui.splitPane.appendSplitSession(fullSession);
        }
        else {
            localStorage.setItem('WVSplitGroupAdded' + app_states_1.appStates.sessionUID, JSON.stringify(fullSession));
        }
    }
});
vsClient.on('UpdateScene', function (response) {
    handleVisShareOpen(response);
    var maxVisible = ui.modeltreePane.currentMaxVisible();
    if (app_states_1.appStates.popoutPanes.indexOf('wv-modeltree') !== -1) {
        var height = app_states_1.appStates.popedOutWindows[app_states_1.appStates.popoutPanes.indexOf('wv-modeltree')].innerHeight - 30;
        var lineHeight = ui.modeltreePane.lineHeight;
        var popoutVisibleRows = Math.floor(height / lineHeight);
        maxVisible = popoutVisibleRows;
    }
    var getTreeview = "<Call Method=\"VirtualTreeViewSetSize\"><Size>" + maxVisible + "</Size></Call>";
    vsClient.command.executeXML(getTreeview);
});
vsClient.on('TreeviewUpdated', function (treeviewInfo) {
    if (app_states_1.appStates.popoutPanes.length > 0 && app_states_1.appStates.popoutPanes.indexOf('wv-modeltree') !== -1) {
        localStorage.setItem('WVTreeViewUpdated' + app_states_1.appStates.sessionUID, JSON.stringify(treeviewInfo));
    }
    else {
        ui.modeltreePane.update(treeviewInfo);
    }
});
vsClient.on('GetConfigurationViewInformation', function (response) {
    if (app_states_1.appStates.popoutPanes.length > 0 && app_states_1.appStates.popoutPanes.indexOf('wv-views') !== -1 && response.ConfigurationView) {
        var configurationViewsJson = Array.isArray(response.ConfigurationView) ? response.ConfigurationView : [response.ConfigurationView];
        localStorage.setItem('WVConfigurationViewInformation' + app_states_1.appStates.sessionUID, JSON.stringify(configurationViewsJson));
    }
    else {
        ui.viewPane.clearViews();
        if (!response.ConfigurationView) {
            return;
        }
        var configurationViewsJson = Array.isArray(response.ConfigurationView) ? response.ConfigurationView : [response.ConfigurationView];
        ui.viewPane.update(configurationViewsJson);
    }
});
vsClient.on('GetViewsAsPDF', function (res) {
    if (res.CustomId && res.CustomId.indexOf('WVViewPDF') !== -1) {
        var name_1 = app_states_1.appStates.fileName ? 'ViewExport_' + app_states_1.appStates.fileName + '.pdf' : 'ViewExport.pdf';
        ui.unblockUI();
        var byteCharacters = atob(res.Image);
        var byteNumbers = new Array(byteCharacters.length);
        for (var i = 0; i < byteCharacters.length; i++) {
            byteNumbers[i] = byteCharacters.charCodeAt(i);
        }
        var byteArray = new Uint8Array(byteNumbers);
        var blob = new Blob([byteArray], {
            type: 'application/pdf'
        });
        if (window.navigator && window.navigator.msSaveOrOpenBlob) {
            window.navigator.msSaveOrOpenBlob(blob, name_1);
        }
        else {
            var link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = name_1;
            document.body.appendChild(link);
            link.click();
            link.remove();
        }
    }
});
vsClient.on('PresetChanged', function (res) {
    if (res.Type.indexOf('WallthicknessHeatmap') !== -1) {
        $('#UID_PRESETS').val(res.Name === "" ? 'USERDEF' : res.Name);
    }
});
vsClient.on('SelectionChanged', function (response) {
    var nodeId = response.NodeId;
    if (typeof nodeId !== 'undefined') {
        app_states_1.appStates.nodesSelected = true;
    }
    else {
        ui.propertiesPane.showSceneProperties();
        app_states_1.appStates.nodesSelected = false;
    }
    var bomOpen = app_states_1.appStates.panes.some(function (pane) {
        return (pane.paneId === 'wv-bom' && pane.visible === true);
    });
    if (bomOpen) {
        ui.bomPane.selectCallouts();
    }
    if (app_states_1.appStates.popoutPanes.indexOf('wv-bom') !== -1) {
        var xml = '<Call Method="GetSelectedBillOfMaterialRows"></Call>';
        vsClient.command.executeXML(xml);
        vsClient.once('GetSelectedBillOfMaterialRows', function (res) {
            if (res.RowId) {
                var rows = Array.isArray(res.RowId) ? res.RowId : [res.RowId];
                localStorage.setItem('WVCalloutSelected' + app_states_1.appStates.sessionUID, JSON.stringify(rows));
            }
            else {
                localStorage.setItem('WVCalloutSelected' + app_states_1.appStates.sessionUID, JSON.stringify([]));
            }
        });
    }
    if (app_states_1.appStates.popoutPanes.indexOf('wv-explode') !== -1) {
        var xml = '<Call Method="GetSelectionExplosionValue"></Call>';
        xml += '<Call Method="GetSelectionNodeLevel"></Call>';
        vsClient.command.executeXML(xml);
        vsClient.once('GetSelectionNodeLevel', function (res) {
            localStorage.setItem('WVNodeLevel' + app_states_1.appStates.sessionUID, JSON.stringify(res));
        });
        vsClient.once('GetSelectionExplosionValue', function (res) {
            localStorage.setItem('WVExplosionLevel' + app_states_1.appStates.sessionUID, JSON.stringify(res));
        });
    }
    if (app_states_1.appStates.popoutPanes.indexOf('wv-modeltree') !== -1) {
        localStorage.setItem('WVSelectedNodes' + app_states_1.appStates.sessionUID, JSON.stringify(response));
    }
});
vsClient.on('NodePropertiesChanged', function (ev) {
    if (app_states_1.appStates.selectionMode === 'Attributes') {
        var attributes = ev.Attributes;
        if (attributes) {
            var wrapper = document.createElement('div');
            wrapper.className = 'floating-attribute-wrapper';
            wrapper.id = 'floating-attribute-wrapper';
            wrapper.style.left = (app_states_1.appStates.lastMouseX + 10) + 'px';
            wrapper.style.top = (app_states_1.appStates.lastMouseY + 10) + 'px';
            document.body.appendChild(wrapper);
            for (var i = 0; i < attributes.Attribute.length; i++) {
                var attribute = attributes.Attribute[i];
                var attrItem = document.createElement('div');
                attrItem.className = 'floating-attribute-item';
                attrItem.textContent = attribute.Key + ': ' + attribute.Value;
                wrapper.appendChild(attrItem);
            }
        }
    }
    app_states_1.appStates.drawRect = (!ev.General || ev.General.Type !== 'Markup_Text');
    if (ev.General) {
        ui.propertiesPane.updateNodeProperties(ev);
        localStorage.setItem('WVNodePropertiesChanged' + app_states_1.appStates.sessionUID, JSON.stringify(ev));
        if (ev.General.Color) {
            var color_1 = ev.General.Color.replace('#', '');
            localStorage.setItem('WVSelectedNodeColor' + app_states_1.appStates.sessionUID, color_1);
            $('.color-search-result-row').each(function () {
                if (this.id === 'ColorSearchResult_' + color_1) {
                    $(this).css('background-color', 'rgb(160, 160, 160)');
                }
                else {
                    $(this).css('background-color', 'white');
                }
            });
        }
    }
    else {
        $('.color-search-result-row').each(function () {
            $(this).css('background-color', 'white');
        });
    }
    if (ev.Markup && ev.Markup.Text && !ev.Markup.Text.Content) {
        var boundingRect = wvCanvas.getBoundingClientRect();
        var offsetLeft = boundingRect.left;
        var offsetTop = boundingRect.top;
        createMarkupOverlay(ev, app_states_1.appStates.lastPagePosX - offsetLeft, app_states_1.appStates.lastPagePosY - offsetTop);
    }
});
vsClient.on('CalloutAutoAlignmentChanged', function (res) {
    var button = w.findButton('ID_RIBBON_CALLOUTS_AUTO_ALIGNMENT');
    if (button && res && res.State) {
        button.applyHighlight(res.State === '1');
    }
});
vsClient.on('ActivateCompare', function (res) {
    ui.prependPane('wv-quickcompare');
});
function GetSceneSettingsCallback(response, xml) {
    ui.settingsPane.updateSceneSettings(response);
    ui.propertiesPane.updateSceneSettings(response);
    ui.measurementPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.draftAnglePane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.markupPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.markupPane_Reduced.update(ui.settingsPane.sceneSettings['Settings']);
    ui.sectionPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.quickComparePane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.exactComparePane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.projectedAreaPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.mirrorPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.filterPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.flyThroughPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.distortionPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.visibilityTestPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.wallthicknessPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.drillholePane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.neutralAxisPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.neighbourhoodSearchPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.textSearchPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.bomPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.clashPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.calloutPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.splitPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.explodePane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.geometryToolsPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.bandAnalysisPane.update(ui.settingsPane.sceneSettings['Settings']);
    ui.animationPane.update(ui.settingsPane.sceneSettings['Settings']);
    var leftMouseButtonMode = response.Settings.Scene.Mouse.LeftButtonFunction;
    var rightMouseButtonMode = response.Settings.Scene.Mouse.RightButtonFunction;
    var middleMouseButtonMode = response.Settings.Scene.Mouse.MiddleButtonFunction;
    app_states_1.appStates.mouseLeftButtonMode = leftMouseButtonMode;
    app_states_1.appStates.mouseRightButtonMode = rightMouseButtonMode;
    app_states_1.appStates.mouseMiddleButtonMode = middleMouseButtonMode;
    highlightLeftMouseMode(leftMouseButtonMode);
    var showGrid = response.Settings.Scene.Visualization.ShowGrid === 'true';
    var gridButton = w.findButton('ID_RIBBON_SHOW_GRID');
    if (gridButton) {
        gridButton.applyHighlight(showGrid);
    }
    var selectAssociatedNode = response.Settings.Scene.Tools.Callout.SelectAssociatedNodes === 'true';
    var calloutSelectButton = w.findButton('ID_RIBBON_CALLOUTS_SELECT_ASSOCIATED_NODES');
    if (calloutSelectButton) {
        calloutSelectButton.applyHighlight(selectAssociatedNode);
    }
    var mutliAnchors = response.Settings.Scene.Tools.Callout.MultiAnchorGroups === 'true';
    var ribbonConnectionsButton = w.findButton('ID_RIBBON_CALLOUTS_MULTIPLE_CONNECTIONS');
    if (ribbonConnectionsButton) {
        ribbonConnectionsButton.applyHighlight(mutliAnchors);
    }
    var freeRotateMouseMode = response.Settings.Scene.Mouse.UseFreeRotate === 'true';
    var freeRotateButton = w.findButton('ID_MOUSE_USE_FREE_ROTATE');
    if (freeRotateButton) {
        freeRotateButton.applyHighlight(freeRotateMouseMode);
    }
    if (app_states_1.appStates.popoutPanes.length > 0) {
        localStorage.setItem('WVSceneSettingsChange' + app_states_1.appStates.sessionUID, JSON.stringify(response));
    }
    var doAnimate = response.Settings.Scene.General.Animation === 'true';
    var animateButton = w.findButton('ID_RIBBON_ANIMATE');
    animateButton.applyHighlight(doAnimate);
}
function highlightLeftMouseMode(mode) {
    var buttonId;
    switch (mode) {
        case 'Rotate':
            buttonId = 'ID_RIBBON_ROTATE';
            break;
        case 'Pan':
            buttonId = 'ID_RIBBON_PAN';
            break;
        case 'RectSelect':
            buttonId = 'ID_RIBBON_SELECTION_FRAME';
            break;
        case 'Zoom':
            buttonId = 'ID_RIBBON_ZOOM';
            break;
        case 'RectZoom':
            buttonId = 'ID_RIBBON_ZOOM_RECTANGLE';
            break;
        case 'Turntable':
            buttonId = 'ID_RIBBON_TURNTABLE';
            break;
    }
    ui.vsRibbon.classes['LMBFunction'].forEach(function (button) {
        if (button.id.indexOf(buttonId) === -1) {
            button.applyHighlight(false);
        }
        else {
            if (button.id.indexOf('RECTANGLE') !== -1 && buttonId === 'ID_RIBBON_ZOOM') {
                button.applyHighlight(false);
            }
            else {
                button.applyHighlight(true);
            }
        }
        if (button instanceof w.DropdownButton) {
            button.items.forEach(function (item) {
                if (item.id.indexOf(buttonId) !== -1) {
                    if (item.id.indexOf('RECTANGLE') !== -1 && buttonId === 'ID_RIBBON_ZOOM') {
                        item.setHighlight(false);
                    }
                    else {
                        item.activate();
                    }
                }
                else {
                    item.setHighlight(false);
                }
            });
        }
    });
}
try {
    if (_ShortCuts) {
        window.onkeydown = function (e) {
            var externalEventPrevention = false;
            try {
                externalEventPrevention = _PreventGlobalKeyEvents;
            }
            catch (e) {
            }
            if (app_states_1.appStates.preventGlobalKeyEvents || externalEventPrevention) {
                return;
            }
            if (_ShortCuts[e.keyCode]) {
                var shortCut = _ShortCuts[e.keyCode];
                if (shortCut.ctrl && !e.ctrlKey || shortCut.alt && !e.altKey || shortCut.shift && !e.shiftKey) {
                    return;
                }
                e.preventDefault();
                e.stopPropagation();
            }
        };
        window.onkeyup = function (e) {
            var externalEventPrevention = false;
            try {
                externalEventPrevention = _PreventGlobalKeyEvents;
            }
            catch (e) {
            }
            if (app_states_1.appStates.preventGlobalKeyEvents || externalEventPrevention) {
                return;
            }
            if (_ShortCuts[e.keyCode]) {
                var shortCut_1 = _ShortCuts[e.keyCode];
                if (shortCut_1.ctrl && !e.ctrlKey || shortCut_1.alt && !e.altKey || shortCut_1.shift && !e.shiftKey) {
                    return;
                }
                e.preventDefault();
                e.stopPropagation();
                if (shortCut_1.method) {
                    shortCut_1.method(vsClient);
                    return;
                }
                if (shortCut_1.ribbonKey) {
                    document.getElementById(shortCut_1.ribbonKey).click();
                    return;
                }
                if (shortCut_1.call) {
                    vsClient.command.executeXML(shortCut_1.call);
                }
                if (shortCut_1.paneId) {
                    var isOpen = app_states_1.appStates.panes.map(function (item) { return item.paneId === shortCut_1.paneId && item.visible; }).indexOf(true) !== -1;
                    var isPopout = app_states_1.appStates.popoutPanes.indexOf(shortCut_1.paneId) !== -1;
                    if (!isOpen && !isPopout) {
                        ui.prependPane(shortCut_1.paneId);
                    }
                    else {
                        ui.closePane(shortCut_1.paneId, isPopout);
                        app_states_1.appStates.panes.forEach(function (pane) {
                            if (pane.paneId === shortCut_1.paneId) {
                                pane.visible = false;
                            }
                        });
                    }
                }
            }
        };
    }
}
catch (e) { }
window.addEventListener("keyup", function (e) {
    var externalEventPrevention = false;
    try {
        externalEventPrevention = _PreventGlobalKeyEvents;
    }
    catch (e) {
    }
    if (app_states_1.appStates.preventGlobalKeyEvents || externalEventPrevention) {
        return;
    }
    var xml = '';
    try {
        if (_ShortCuts && _ShortCuts[e.keyCode]) {
            var customShortcut = _ShortCuts[e.keyCode];
            var modifierMissMatch = (customShortcut.ctrl && !e.ctrlKey) || (customShortcut.alt && !e.altKey) || (customShortcut.shift && !e.shiftKey);
            if (!modifierMissMatch) {
                return;
            }
        }
    }
    catch (e) { }
    switch (e.keyCode) {
        case 27:
            ribbonMenu.deactivateAll(vsClient, ui_1.vsRibbon);
            break;
        case 46:
            xml = '<Call Method="ModifySelection"><SelectionModifier>Delete</SelectionModifier></Call>';
            vsClient.command.executeXML(xml);
            break;
        case 38:
        case 87:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>MoveFront</FlythroughCommand><Activate>false</Activate></Call>';
                vsClient.command.executeXML(xml);
            }
            break;
        case 40:
        case 83:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>MoveBack</FlythroughCommand><Activate>false</Activate></Call>';
                vsClient.command.executeXML(xml);
            }
            break;
        case 39:
        case 68:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>PanRight</FlythroughCommand><Activate>false</Activate></Call>';
                vsClient.command.executeXML(xml);
            }
            break;
        case 37:
        case 65:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>PanLeft</FlythroughCommand><Activate>false</Activate></Call>';
                vsClient.command.executeXML(xml);
            }
            break;
        case 32:
        case 33:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>PanUp</FlythroughCommand><Activate>false</Activate></Call>';
                vsClient.command.executeXML(xml);
            }
            break;
        case 67:
        case 34:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>PanDown</FlythroughCommand><Activate>false</Activate></Call>';
                vsClient.command.executeXML(xml);
            }
            break;
        case 187:
        case 171:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>IncreaseSpeed</FlythroughCommand></Call>';
                xml += '<Call Method="GetSceneSettings"></Call>';
                vsClient.command.executeXML(xml);
            }
            break;
        case 189:
        case 109:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>DecreaseSpeed</FlythroughCommand></Call>';
                xml += '<Call Method="GetSceneSettings"></Call>';
                vsClient.command.executeXML(xml);
            }
            break;
    }
}, false);
window.addEventListener("keydown", function (e) {
    var externalEventPrevention = false;
    try {
        externalEventPrevention = _PreventGlobalKeyEvents;
    }
    catch (e) {
    }
    if (app_states_1.appStates.preventGlobalKeyEvents || externalEventPrevention) {
        return;
    }
    var xml = '';
    try {
        if (_ShortCuts && _ShortCuts[e.keyCode]) {
            var customShortcut = _ShortCuts[e.keyCode];
            var modifierMissMatch = (customShortcut.ctrl && !e.ctrlKey) || (customShortcut.alt && !e.altKey) || (customShortcut.shift && !e.shiftKey);
            if (!modifierMissMatch) {
                return;
            }
        }
    }
    catch (e) { }
    switch (e.keyCode) {
        case e.altKey && 65:
            xml = '<Call Method="ShowAll"></Call>';
            break;
        case e.altKey && 73:
            xml = '<Call Method="ModifySelection"><SelectionModifier>Isolate</SelectionModifier></Call>';
            break;
        case e.altKey && 72:
            xml = '<Call Method="MouseHoverAction"><Action>Hide</Action></Call>';
            break;
        case e.altKey && 71:
            xml = '<Call Method="MouseHoverAction"><Action>Ghost</Action></Call>';
            break;
        case e.altKey && 83:
            xml = '<Call Method="UnghostLastNode" />';
            break;
        case e.altKey && 65:
            xml = '<Call Method="ShowAll"></Call>';
            break;
        case e.ctrlKey && 65:
            e.preventDefault();
            if (!e.shiftKey) {
                xml = '<Call Method="SelectAllGeometries"></Call>';
            }
            else {
                xml = '<Call Method="ModifySelection"><SelectionModifier>Deselect</SelectionModifier></Call>';
            }
            break;
        case e.ctrlKey && e.shiftKey && 65:
            xml = '<Call Method="ModifySelection"><SelectionModifier>Deselect</SelectionModifier></Call>';
            break;
        case e.ctrlKey && 73:
            xml = '<Call Method="ModifySelection"><SelectionModifier>Invert</SelectionModifier></Call>';
            break;
        case e.ctrlKey && 90:
            xml = '<Call Method="Undo"><Steps>1</Steps></Call>';
            break;
        case e.ctrlKey && 85:
            e.preventDefault();
            xml = '<Call Method="GetSceneSettings"></Call>';
            vsClient.command.executeXMLAsync(xml);
            vsClient.once('GetSceneSettings', function (response) {
                var gridStatus = response.Settings.Scene.Visualization.ShowGrid;
                gridStatus = gridStatus === 'true' ? 'false' : 'true';
                xml = '<Call Method="SetSceneSettings">';
                xml += '<Settings><Scene><Visualization><ShowGrid>' + gridStatus;
                xml += '</ShowGrid></Visualization></Scene></Settings></Call>';
                vsClient.command.executeXMLAsync(xml);
            });
            break;
        case 112:
            e.preventDefault();
            $('#wv-ribbon-about').click();
            break;
        case 120:
            var index = app_states_1.appStates.renderingModes.indexOf('Wireframe');
            if (index === -1) {
                app_states_1.appStates.renderingModes.push('Wireframe');
            }
            else {
                app_states_1.appStates.renderingModes.splice(index, 1);
            }
            xml = '<Call Method="SetSceneSettings"><Settings><Scene><Visualization><RenderMode>';
            for (var i = 0; i < app_states_1.appStates.renderingModes.length; i++) {
                xml = xml + app_states_1.appStates.renderingModes[i] + ' ';
            }
            xml = xml + '</RenderMode></Visualization></Scene></Settings></Call>';
            vsClient.command.executeXML(xml);
            vsClient.once('SetSceneSettings', function (ev) {
                vsClient.command.executeXML('<Call Method="GetSceneSettings"></Call>');
            });
            break;
        case 113:
            var length_1 = app_states_1.appStates.panes.length;
            var existing = false;
            for (var i_1 = 0; i_1 < length_1; i_1++) {
                var pane = app_states_1.appStates.panes[i_1];
                if (pane.paneId === 'wv-command') {
                    if (!pane.visible) {
                        ribbonMenu.handlePrependingPane('wv-command', 'on');
                        app_states_1.appStates.panes[i_1].visible = true;
                    }
                    else {
                        ribbonMenu.handlePrependingPane('wv-command', 'off');
                        app_states_1.appStates.panes[i_1].visible = false;
                    }
                    existing = true;
                }
            }
            if (!existing) {
                ribbonMenu.handlePrependingPane('wv-command', 'on');
            }
            localStorage.setItem('panePositions', JSON.stringify(app_states_1.appStates.panes));
            break;
        case 122:
            e.preventDefault();
            ribbonMenu.toggleFullscreen(ui.vsRibbon);
            break;
        case 38:
        case 87:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>MoveFront</FlythroughCommand><Activate>true</Activate></Call>';
            }
            break;
        case 40:
        case 83:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>MoveBack</FlythroughCommand><Activate>true</Activate></Call>';
            }
            break;
        case 39:
        case 68:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>PanRight</FlythroughCommand><Activate>true</Activate></Call>';
            }
            break;
        case 37:
        case 65:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>PanLeft</FlythroughCommand><Activate>true</Activate></Call>';
            }
            break;
        case 32:
        case 33:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>PanUp</FlythroughCommand><Activate>true</Activate></Call>';
            }
            break;
        case 67:
        case 34:
            if (app_states_1.appStates.interactionMode.indexOf('Flythrough') !== -1) {
                xml = '<Call Method="ApplyFlythroughCommand"><FlythroughCommand>PanDown</FlythroughCommand><Activate>true</Activate></Call>';
            }
            break;
        default:
            return;
    }
    vsClient.command.executeXML(xml);
}, false);
vsClient.on('Relay', function (res) {
    var message = res.__text__;
    if (message === 'VisShare_SaveAsDone') {
        ui.toast(true);
    }
    else if (message.startsWith('ShowNativeLoadingModal_') && !connectedToSession) {
        var parsedFileArr = message.split('_');
        parsedFileArr.shift();
        var filename = parsedFileArr.join('_');
        var showNativeLoading = ui.openNativeLoadingModal(filename, resumeBackendLoading.bind(vsClient), true);
        if (!showNativeLoading) {
            resumeBackendLoading(filename);
        }
    }
    else if (message.startsWith('VisShareBlockUI')) {
        var method = message.split('_')[1];
        vsClient.blockUI();
        vsClient.once(method, function (res) {
            vsClient.unblockUI();
        });
    }
});
vsClient.on('@changeLang', function (e) {
    var length = app_states_1.appStates.popoutPanes.length;
    var _loop_1 = function (i) {
        var paneId = app_states_1.appStates.popoutPanes[i];
        if (paneId === 'wv-modeltree' || paneId === 'wv-views') {
            return { value: void 0 };
        }
        var templateName = ui.mapPaneIdToTemplate(paneId);
        var template = '<Call Method="GetTemplate"><Type>' + templateName + '</Type></Call>';
        vsClient.command.executeXML(template);
        vsClient.once('GetTemplate.' + templateName, function (response) {
            var templateObj = response['Source']['Template'];
            localStorage.setItem('WV' + paneId + app_states_1.appStates.sessionUID, JSON.stringify(templateObj));
        });
    };
    for (var i = 0; i < length; i++) {
        var state_1 = _loop_1(i);
        if (typeof state_1 === "object")
            return state_1.value;
    }
});
vsClient.on('@recvXML', function (msg, timestamp) {
    var log = {
        type: 'inbound',
        msg: msg
    };
    ui.commandPane.addCommand(log);
});
vsClient.on('@sendXML', function (msg, timestamp) {
    if (!stopLogging) {
        try {
            if ((_HideUICommandLog || app_states_1.appStates.qsMode) &&
                (msg.indexOf('GetTemplate') !== -1
                    || msg.indexOf('SendSessionReady') !== -1
                    || msg.indexOf('VirtualTreeViewSetSize') !== -1
                    || msg.indexOf('GetNodeTooltip') !== -1
                    || msg.indexOf('GetSettings') !== -1
                    || msg.indexOf('GetSceneSettings') !== -1
                    || msg.indexOf('VirtualTreeViewToggleVisibility') !== -1
                    || msg.indexOf('SetSettings') !== -1
                    || msg.indexOf('GetSelectedBillOfMaterialRows') !== -1)) {
                return;
            }
        }
        catch (e) { }
        var log = {
            type: 'outbound',
            msg: msg
        };
        ui.commandPane.addCommand(log);
    }
});
function resumeBackendLoading(fileName) {
    vsClient.relayMessageToBackend('NativeLoadingModalFinished');
}
function interceptQueryString(isBackend) {
    var queryString = window.location.search.substr(1);
    var kvs = queryString.split('&');
    var query = {};
    for (var _i = 0, kvs_3 = kvs; _i < kvs_3.length; _i++) {
        var kv = kvs_3[_i];
        var _a = kv.split('='), k = _a[0], v = _a[1];
        query[k] = v;
    }
    if (query['closesessions']) {
        app_states_1.appStates.sessionUrlClose = query['closesessions'];
        localStorage.removeItem('WVSessionCloseID');
        localStorage.setItem('WVSessionCloseID', query['closesessions']);
        window.addEventListener('storage', function (e) {
            var urlCloseCommand = localStorage.getItem('WVSessionCloseID');
            if (e.key === 'WVSessionCloseID' && urlCloseCommand && urlCloseCommand !== null && urlCloseCommand !== '' && app_states_1.appStates.sessionUrlClose === urlCloseCommand) {
                vsClient.destroy();
                var url = location.href.split('/');
                url.pop();
                window.open(url.join('/') + '/session_in_use_index.html', '_self');
            }
        });
    }
    var file1, file2;
    if (query['compare'] === '2d') {
        if (query['file1']) {
            file1 = decodeURIComponent(query['file1']);
        }
        if (query['file2']) {
            file2 = decodeURIComponent(query['file2']);
        }
        if (query['open1']) {
            file1 = decodeURIComponent(escape(window.atob(query['open1'])));
        }
        if (query['open2']) {
            file2 = decodeURIComponent(escape(window.atob(query['open2'])));
        }
        if (file1 && file2) {
            try {
                if (!_ShowFileRibbonOnUrlOpen) {
                    ui.vsRibbon.disableFileList();
                }
            }
            catch (e) {
                ui.vsRibbon.disableFileList();
            }
            vsClient.OpenFile(file1);
            vsClient.on('ActivateGraphicalCompare', function (ev) {
                if (ev.CustomId == 'full_ui_2d_compare') {
                    if (ev.Error == 'SUCCESS') {
                    }
                    if (!(ev.Error == "SUCCESS")) {
                        alert("Error on 2D compare: " + ev.Error + " Info: " + ev.ErrorInfo);
                        console.log("Error on 2D compare: " + ev.Error + " Info: " + ev.ErrorInfo);
                    }
                }
            });
            vsClient.on('OpenFile', function () {
                var XML = "\n                <Call Method=\"ImportFile\">\n                <FileName>" + file2 + "</FileName>\n              </Call>";
                vsClient.command.executeXML(XML);
                var XML2 = "\n                <Call Method=\"ActivateGraphicalCompare\"><Activate>true</Activate> CustomId=\"full_ui_2d_compare\"</Call>";
                vsClient.command.executeXML(XML2);
            });
        }
    }
    else if (query['compare'] === 'quick') {
        compareByURI(query, 'full_ui_quick_compare', 'ActivateGraphicalCompare');
    }
    else if (query['compare'] === 'exact') {
        compareByURI(query, 'full_ui_exact_compare', 'ComputeBrepCompare');
    }
    else if (typeof query['file'] !== 'undefined') {
        try {
            if (!_ShowFileRibbonOnUrlOpen) {
                ui.vsRibbon.disableFileList();
            }
        }
        catch (e) {
            ui.vsRibbon.disableFileList();
        }
        var showModal = query['NativeLoadingModal'];
        var filename = decodeURIComponent(query['file']);
        if (showModal && showModal === 'true') {
            ui.openNativeLoadingModal(filename, vsClient.OpenFile.bind(vsClient));
        }
        else {
            vsClient.OpenFile(filename);
        }
    }
    else if (typeof query['open'] !== 'undefined') {
        try {
            if (!_ShowFileRibbonOnUrlOpen) {
                ui.vsRibbon.disableFileList();
            }
        }
        catch (e) {
            ui.vsRibbon.disableFileList();
        }
        var filename = decodeURIComponent(escape(window.atob(query['open'])));
        var showModal = query['NativeLoadingModal'];
        if (showModal && showModal === 'true') {
            ui.openNativeLoadingModal(filename, vsClient.OpenFile.bind(vsClient));
        }
        else {
            vsClient.OpenFile(filename);
        }
    }
    else if (query['internalMode']) {
        console.log('WebViewer runs in internal mode!');
        var xml = '<Call Method="EnableInternalMode"></Call>';
        vsClient.command.executeXML(xml);
    }
    else if (query['qs']) {
        console.log('WebViewer runs in internal mode!');
        var xml = '<Call Method="EnableInternalMode"></Call>';
        vsClient.command.executeXML(xml);
        app_states_1.appStates.qsMode = true;
        var isOpen = app_states_1.appStates.panes.map(function (item) { return item.paneId === 'wv-command' && item.visible; }).indexOf(true) !== -1;
        var isPopout = app_states_1.appStates.popoutPanes.indexOf('wv-command') !== -1;
        if (app_states_1.appStates.defaultPanes.indexOf('wv-command') === -1) {
            app_states_1.appStates.defaultPanes.push('wv-command');
        }
        if (!isOpen && !isPopout) {
            ui.prependPane('wv-command');
        }
    }
}
function compareByURI(query, customId, compareMethod) {
    var file1, file2;
    if (query['file1']) {
        file1 = decodeURIComponent(query['file1']);
    }
    if (query['file2']) {
        file2 = decodeURIComponent(query['file2']);
    }
    if (query['open1']) {
        file1 = decodeURIComponent(escape(window.atob(query['open1'])));
    }
    if (query['open2']) {
        file2 = decodeURIComponent(escape(window.atob(query['open2'])));
    }
    if (file1 && file2) {
        try {
            if (!_ShowFileRibbonOnUrlOpen) {
                ui.vsRibbon.disableFileList();
            }
        }
        catch (e) {
            ui.vsRibbon.disableFileList();
        }
        if (vsClient.initOptions.blockOnLoad) {
            vsClient.blockUI();
        }
        vsClient.once(compareMethod, function (ev) {
            vsClient.unblockUI();
            if (ev.CustomId === customId) {
                if (ev.Error != "SUCCESS") {
                    if (compareMethod === 'ComputeBrepCompare') {
                        console.log("Error on exact compare: " + ev.ErrorInfo + " Try quick compare.");
                        compareByURI(query, 'full_ui_quick_compare', 'ActivateGraphicalCompare');
                    }
                    else {
                        console.log("Error on quick compare: " + ev.Error + " Info: " + ev.ErrorInfo);
                    }
                }
                else {
                    handleCompare(ev);
                }
            }
        });
        vsClient.NewScene3D();
        vsClient.once('NewScene3D', function (response) {
            handleNewSceneForCompare(response, file1, file2, customId, compareMethod);
        });
    }
}
function handleCompare(ev) {
    if (ev.Error == 'SUCCESS') {
        var xml_5 = "<Call Method=\"AlignView\"><Alignment>Isometric</Alignment></Call><Call Method=\"ModifySelection\"><SelectionModifier>Deselect</SelectionModifier></Call>";
        vsClient.command.executeXML(xml_5);
    }
    var maxVisible = ui.modeltreePane.currentMaxVisible();
    if (app_states_1.appStates.popoutPanes.indexOf('wv-modeltree') !== -1) {
        var height = app_states_1.appStates.popedOutWindows[app_states_1.appStates.popoutPanes.indexOf('wv-modeltree')].innerHeight - 30;
        var lineHeight = ui.modeltreePane.lineHeight;
        var popoutVisibleRows = Math.floor(height / lineHeight);
        maxVisible = popoutVisibleRows;
    }
    var getTreeview = "<Call Method=\"VirtualTreeViewSetSize\"><Size>" + maxVisible + "</Size></Call>";
    vsClient.command.executeXML(getTreeview);
    var xml = "<Call Method=\"ResumeRendering\"/>";
    vsClient.command.executeXML(xml);
}
function handleNewSceneForCompare(response, file1, file2, customId, compareMethod) {
    openFileHandler(response);
    var xml = "\n    <Call Method=\"SetSettings\">\n        <Settings>\n            <Import3D>\n                <General>\n                    <ReadMode>PreferGeometry</ReadMode>\n                    <ReadPMIs>false</ReadPMIs>\n                    <ReadSolids>true</ReadSolids>\n                    <ReadConstructionAndReferences>false</ReadConstructionAndReferences>\n                </General>\n                <_3DVS>\n                    <IncrementalLoading>false</IncrementalLoading>\n                    <RemoveBrep>false</RemoveBrep>\n                </_3DVS>\n            </Import3D>\n        </Settings>\n    </Call>\n\n    <Call Method=\"PauseRendering\"/>\n\n    <Call Method=\"UpdateScene\">\n        <VSXML>\n            <Node CustomId=\"Root1\" Name=\"Compare1\" Type=\"Root\">\n                <Node CustomId=\"V1\" Name=\"V1\" Type=\"ProductOccurrence\" FileName=\"" + file1 + "\" />\n            </Node>\n            <Node CustomId=\"Root2\" Name=\"Compare2\" Type=\"Root\">\n                <Node CustomId=\"V2\" Name=\"V2\" Type=\"ProductOccurrence\" FileName=\"" + file2 + "\" />\n            </Node>\n        </VSXML>\n    </Call>\n\n    <Call Method=\"FitAll\"/>\n\n    <Call Method=\"SetSelectedNodes\">\n    <NodeId>#V1</NodeId>\n    <NodeId>#V2</NodeId>\n    </Call>\n\n        ";
    var fulLCompareCall = '<Call Method="ComputeBrepCompare" CustomId="full_ui_exact_compare"></Call>';
    var quickCompareCall = '<Call Method="ActivateGraphicalCompare" CustomId="full_ui_quick_compare"><Activate>true</Activate></Call>';
    xml += compareMethod === 'ComputeBrepCompare' ? fulLCompareCall : quickCompareCall;
    vsClient.command.executeXML(xml);
}


/***/ }),
/* 81 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var file_browser_switch_1 = __webpack_require__(35);
var breadcrumb_bar_1 = __webpack_require__(82);
var pagination_1 = __webpack_require__(86);
var folder_1 = __webpack_require__(85);
var file_1 = __webpack_require__(84);
var app_states_1 = __webpack_require__(4);
var FileBrowserModal = (function () {
    function FileBrowserModal(client, type, openCallBack) {
        var _this = this;
        this.doFolderSearch = true;
        this.showFilePreview = false;
        this.searchedFolder = [9];
        this.fileList = [];
        this.client = client;
        this.type = type;
        this.openCallBack = openCallBack;
        this.isOpen = true;
        this.detectOutsideClick = this.detectOutsideClick.bind(this);
        this.detectEscPressed = this.detectEscPressed.bind(this);
        this.pageSize = 100;
        this.activePath = app_states_1.appStates.activePath;
        try {
            this.pageSize = _FileBrowserPageSize;
        }
        catch (e) { }
        this.page = 1;
        this.folderSearchClick = this.folderSearchClick.bind(this);
        this.filePreviewClick = this.filePreviewClick.bind(this);
        this.submit = this.submit.bind(this);
        this.resize = this.resize.bind(this);
        document.body.addEventListener('mousedown', this.detectOutsideClick);
        document.body.addEventListener('keyup', this.detectEscPressed);
        this.modalWrapper = document.createElement('div');
        this.modalWrapper.className = 'file-browser-modal';
        this.loadingWrapper = document.createElement('div');
        this.loadingWrapper.className = 'fullscreen-loading-wrapper';
        this.loadingWrapper.style.left = "0";
        var spinnerIcon = document.createElement('i');
        spinnerIcon.className = 'fullscreen-loading-icon fal fa-spinner-third fa-spin';
        this.loadingWrapper.appendChild(spinnerIcon);
        var windowHeaderEl = document.createElement('div');
        windowHeaderEl.className = 'file-browser-header';
        this.folderSearchEl = new file_browser_switch_1.FileBrowserSwitch(windowHeaderEl, 'ID_FILE_BROWSER_DEEP_SEARCH', this.folderSearchClick, 'file', this.doFolderSearch);
        this.fileSearchEl = document.createElement('input');
        this.fileSearchEl.className = 'file-browser-search-input';
        this.fileSearchEl.placeholder = ui.translate('ID_FILE_BROWSER_SEARCH_PLACEHOLDER');
        this.fileSearchEl.oninput = function (e) {
            var xml = '<Call Method="SearchFolders"><FileName>' + _this.fileSearchEl.value + '</FileName><DeepSearch>' + _this.doFolderSearch + '</DeepSearch></Call>';
            _this.client.once('SearchFolders', function (res) {
            });
            _this.folder = _this.folder.filter(function (el) {
                return el.key.toLowerCase().indexOf(_this.fileSearchEl.value) !== -1;
            });
            _this.build();
        };
        windowHeaderEl.appendChild(this.fileSearchEl);
        this.breadcrumbBar = new breadcrumb_bar_1.BreadcrumbBar(this.modalWrapper, this);
        var rootCrumb = {
            key: "",
            name: "Root"
        };
        this.breadcrumbBar.pushBreadcrumb(rootCrumb);
        if (this.activePath !== "") {
            var path = this.activePath.split('\\');
            var pathLength = path.length;
            var accumPath = "";
            for (var p = 0; p < pathLength; p++) {
                accumPath += path[p] + '\\';
                var crumb = {
                    key: accumPath,
                    name: path[p]
                };
                this.breadcrumbBar.pushBreadcrumb(crumb);
            }
        }
        var tableEl = document.createElement('div');
        tableEl.className = 'file-browser-table-header-row';
        this.modalWrapper.appendChild(tableEl);
        this.nameHeader = document.createElement('div');
        this.nameHeader.className = 'file-browser-table-header';
        this.nameHeader.style.width = 'calc(55% + 14px)';
        tableEl.appendChild(this.nameHeader);
        var nameTextEl = document.createElement('span');
        nameTextEl.className = 'file-browser-table-header-text';
        nameTextEl.textContent = ui.translate('ID_FILE_BROWSER_TABLE_HEADER_NAME');
        this.nameHeader.appendChild(nameTextEl);
        var nameSortIcon = document.createElement('i');
        nameSortIcon.className = 'file-brwoser-table-header-icon fas fa-sort-down';
        this.nameHeader.onclick = function (e) {
        };
        this.dateHeader = document.createElement('div');
        this.dateHeader.className = 'file-browser-table-header';
        this.dateHeader.style.width = 'calc(25% + 12px)';
        tableEl.appendChild(this.dateHeader);
        var dateTextEl = document.createElement('span');
        dateTextEl.className = 'file-browser-table-header-text';
        dateTextEl.textContent = ui.translate('ID_FILE_BROWSER_TABLE_HEADER_DATE');
        this.dateHeader.appendChild(dateTextEl);
        var dateSortIcon = document.createElement('i');
        dateSortIcon.className = 'file-brwoser-table-header-icon fas fa-sort-down';
        this.dateHeader.onclick = function (e) {
        };
        this.sizeHeader = document.createElement('div');
        this.sizeHeader.className = 'file-browser-table-header';
        this.sizeHeader.style.width = 'calc(20% - 26px)';
        tableEl.appendChild(this.sizeHeader);
        var sizeTextEl = document.createElement('span');
        sizeTextEl.className = 'file-browser-table-header-text';
        sizeTextEl.textContent = ui.translate('ID_FILE_BROWSER_TABLE_HEADER_SIZE');
        this.sizeHeader.appendChild(sizeTextEl);
        var sizeSortIcon = document.createElement('i');
        sizeSortIcon.className = 'file-brwoser-table-header-icon fas fa-sort-down';
        this.sizeHeader.onclick = function (e) {
        };
        this.tableBody = document.createElement('div');
        this.tableBody.className = 'file-browser-table-body';
        this.modalWrapper.appendChild(this.tableBody);
        this.tableFooterEl = document.createElement('div');
        this.tableFooterEl.className = 'file-browser-table-footer';
        this.modalWrapper.appendChild(this.tableFooterEl);
        this.pagination = new pagination_1.PaginationRow(this.tableFooterEl, this);
        this.fileCountEl = document.createElement('div');
        this.fileCountEl.className = 'file-browser-file-count';
        this.tableFooterEl.appendChild(this.fileCountEl);
        this.buttonRow = document.createElement('div');
        this.buttonRow.className = 'file-browser-button-row';
        this.modalWrapper.appendChild(this.buttonRow);
        var storedPreviewState = localStorage.getItem('VSFilePreview');
        if (storedPreviewState !== null && this.type === 'open') {
            this.showFilePreview = storedPreviewState === 'true';
        }
        if (this.type === 'open') {
            this.folderSearchEl = new file_browser_switch_1.FileBrowserSwitch(this.buttonRow, 'ID_FILE_BROWSER_FILE_PREVIEW', this.filePreviewClick, 'file', this.showFilePreview);
        }
        var submitButton = document.createElement('button');
        submitButton.className = 'file-browser-submit-button';
        submitButton.textContent = 'OK';
        this.buttonRow.appendChild(submitButton);
        submitButton.onclick = this.submit;
        document.body.appendChild(this.modalWrapper);
        this.client.on('GetFolderContent', function (folderContent) {
            _this.folder = folderContent;
            _this.getFileNumber();
            _this.build();
            _this.stopLoadingBlocker();
        });
        this.client.on('GetFolderFileCount', function (folderSize) {
            _this.size = folderSize;
            _this.pagination.updatePageCount();
            _this.fileCountEl.textContent = _this.size + ' ' + ui.translate('ID_FILE_BROWSER_FILE_COUNT');
            if (folderSize <= _this.pageSize) {
                _this.pagination.hide();
            }
            else {
                _this.pagination.show();
            }
        });
        var newFolder = this.client.command.makeBinaryPath(this.activePath, true, 0, this.pageSize - 1);
        this.startLoadingBlocker();
        this.client.sendBinaryPackage(1, 210, newFolder);
        var sizeCall = this.client.command.makeBinaryPath(this.activePath, true, 0, this.pageSize - 1);
        this.client.sendBinaryPackage(1, 211, sizeCall);
        this.resize();
        window.addEventListener('resize', this.resize);
    }
    FileBrowserModal.prototype.resize = function () {
        var tableTop = this.tableBody.offsetTop;
        var footerHeight = this.tableFooterEl.offsetHeight;
        var buttonHeight = this.buttonRow.offsetHeight;
        var modalHeight = this.modalWrapper.clientHeight;
        var modalPadding = 40;
        this.tableBody.style.height = modalHeight - buttonHeight - footerHeight - tableTop - modalPadding + 'px';
    };
    FileBrowserModal.prototype.build = function () {
        $(this.tableBody).empty();
        $('.webviewer-tooltip-wrapper').each(function () {
            $(this).remove();
        });
        for (var i = 0; i < this.folder.length; i++) {
            if (!this.folder[i].size) {
                var newFolder = void 0;
                newFolder = {
                    name: this.folder[i].key,
                    date: this.folder[i].modified,
                    path: this.folder[i].path
                };
                var folder = new folder_1.Folder(this.tableBody, newFolder, this);
            }
            else {
                var newFile = void 0;
                newFile =
                    {
                        name: this.folder[i].key,
                        date: this.folder[i].modified,
                        path: this.folder[i].path,
                        size: this.folder[i].size
                    };
                var folder = new file_1.File(this.tableBody, newFile, this);
            }
        }
    };
    FileBrowserModal.prototype.getFileNumber = function () {
        var sizeCall = this.client.command.makeBinaryPath(this.activePath, false, 0, 100);
        this.client.sendBinaryPackage(1, 211, sizeCall);
    };
    FileBrowserModal.prototype.changeOrder = function (iconEl, fieldEl, orderKey) {
        var orderDirection;
        if ($(iconEl).hasClass('fa-sort-down')) {
            orderDirection = 'ASC';
            $(iconEl).removeClass('fa-sort-down');
            $(iconEl).addClass('fa-sort-up');
            this.sortAsc(orderKey);
        }
        else {
            orderDirection = 'DESC';
            $(iconEl).addClass('fa-sort-down');
            $(iconEl).removeClass('fa-sort-up');
            this.sortDesc(orderKey);
        }
        $(this.nameHeader).removeClass('file-browser-table-header-active');
        $(this.dateHeader).removeClass('file-browser-table-header-active');
        $(this.sizeHeader).removeClass('file-browser-table-header-active');
        $(fieldEl).addClass('file-browser-table-header-active');
        this.build();
        console.log('Sortkey:' + orderKey + 'Sortdirection: ' + orderDirection);
    };
    FileBrowserModal.prototype.sortDesc = function (orderKey) {
        switch (orderKey) {
            case 'name':
                this.folder.sort(function (a, b) {
                    if (!a.size) {
                        return -1;
                    }
                    var nameA = a.key.toLowerCase();
                    var nameB = b.key.toLowerCase();
                    if (nameA < nameB) {
                        return 1;
                    }
                    if (nameA > nameB) {
                        return -1;
                    }
                    return 0;
                });
                break;
            case 'date':
                this.folder.sort(function (a, b) {
                    if (!a.size) {
                        return -1;
                    }
                    var dateA = new Date(a.modified);
                    var dateB = new Date(b.modified);
                    if (dateA < dateB) {
                        return 1;
                    }
                    if (dateA > dateB) {
                        return -1;
                    }
                    return 0;
                });
                break;
            case 'size':
                this.folder.sort(function (a, b) {
                    if (!a.size) {
                        return -1;
                    }
                    var sizeA = parseFloat(a);
                    var sizeB = parseFloat(b);
                    if (sizeA < sizeB) {
                        return 1;
                    }
                    if (sizeA > sizeB) {
                        return -1;
                    }
                    return 0;
                });
        }
    };
    FileBrowserModal.prototype.sortAsc = function (orderKey) {
        switch (orderKey) {
            case 'name':
                this.folder.sort(function (a, b) {
                    if (!a.size) {
                        return -1;
                    }
                    var nameA = a.key.toLowerCase();
                    var nameB = b.key.toLowerCase();
                    if (nameA > nameB) {
                        return 1;
                    }
                    if (nameA < nameB) {
                        return -1;
                    }
                    return 0;
                });
                break;
            case 'date':
                this.folder.sort(function (a, b) {
                    if (!a.size) {
                        return -1;
                    }
                    var dateA = new Date(a.modified);
                    var dateB = new Date(b.modified);
                    if (dateA > dateB) {
                        return 1;
                    }
                    if (dateA < dateB) {
                        return -1;
                    }
                    return 0;
                });
                break;
            case 'size':
                this.folder.sort(function (a, b) {
                    if (!a.size) {
                        return -1;
                    }
                    var sizeA = parseFloat(a);
                    var sizeB = parseFloat(b);
                    if (sizeA > sizeB) {
                        return 1;
                    }
                    if (sizeA < sizeB) {
                        return -1;
                    }
                    return 0;
                });
        }
    };
    FileBrowserModal.prototype.folderSearchClick = function (state) {
        this.doFolderSearch = state;
    };
    FileBrowserModal.prototype.filePreviewClick = function (state) {
        localStorage.setItem('VSFilePreview', state.toString());
        this.showFilePreview = state;
    };
    FileBrowserModal.prototype.getPage = function () {
        return this.page;
    };
    FileBrowserModal.prototype.setPath = function (folder) {
        this.activePath = folder.path;
        var newCrumb = {
            key: folder.path,
            name: folder.name
        };
        this.breadcrumbBar.pushBreadcrumb(newCrumb);
    };
    FileBrowserModal.prototype.setPage = function (page) {
        this.page = page;
        this.startLoadingBlocker();
        var newFolder = this.client.command.makeBinaryPath(this.activePath, true, (this.page - 1) * this.pageSize, (this.page * this.pageSize) - 1);
        this.client.sendBinaryPackage(1, 210, newFolder);
    };
    FileBrowserModal.prototype.hide = function () {
        window.removeEventListener('resize', this.resize);
        document.body.removeEventListener('mousedown', this.detectOutsideClick);
        document.body.removeEventListener('keyup', this.detectEscPressed);
        this.isOpen = false;
        $(this.modalWrapper).remove();
    };
    FileBrowserModal.prototype.detectOutsideClick = function (e) {
        if (!(e.target === this.modalWrapper || this.modalWrapper.contains(e.target))) {
            this.submit();
        }
    };
    FileBrowserModal.prototype.detectEscPressed = function (e) {
        e.preventDefault();
        e.stopPropagation();
        if (e.keyCode === 27) {
            this.submit();
        }
    };
    FileBrowserModal.prototype.submit = function (e) {
        if (e) {
            e.preventDefault();
            e.stopPropagation();
        }
        $('.webviewer-tooltip-wrapper').each(function () {
            $(this).remove();
        });
        app_states_1.appStates.activePath = this.activePath;
        var length = this.fileList.length;
        if (length > 0) {
            ui.serializedLoad(this.fileList, true);
        }
        this.fileList = [];
        this.hide();
    };
    FileBrowserModal.prototype.startLoadingBlocker = function () {
        this.modalWrapper.appendChild(this.loadingWrapper);
    };
    FileBrowserModal.prototype.stopLoadingBlocker = function () {
        if (this.modalWrapper.contains(this.loadingWrapper)) {
            this.modalWrapper.removeChild(this.loadingWrapper);
        }
    };
    return FileBrowserModal;
}());
exports.FileBrowserModal = FileBrowserModal;


/***/ }),
/* 82 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var breadcrumb_1 = __webpack_require__(83);
var BreadcrumbBar = (function () {
    function BreadcrumbBar(parentEl, browser) {
        var _this = this;
        this.breadcrumbs = [];
        this.breadcrumbsMap = [];
        this.parentEl = parentEl;
        this.fileBrowser = browser;
        this.pageSize = browser.pageSize;
        this.client = browser.client;
        var breadcrumbBarWrapper = document.createElement('div');
        breadcrumbBarWrapper.className = 'file-browser-breadcrumb-bar-wrapper';
        this.parentEl.appendChild(breadcrumbBarWrapper);
        this.backButton = document.createElement('i');
        this.backButton.className = 'file-browser-breadcrumb-back-button fas fa-arrow-alt-square-left';
        this.backButton.onclick = function (e) {
            _this.popCrumb();
        };
        breadcrumbBarWrapper.appendChild(this.backButton);
        this.barEl = document.createElement('ul');
        this.barEl.className = 'file-browser-breadcrumb-bar';
        breadcrumbBarWrapper.appendChild(this.barEl);
    }
    BreadcrumbBar.prototype.changePath = function () {
        var currentFolder = this.client.command.makeBinaryPath(this.activePath, true, 0, this.pageSize - 1);
        this.client.sendBinaryPackage(1, 210, currentFolder);
        this.fileBrowser.activePath = this.activePath;
    };
    BreadcrumbBar.prototype.pushBreadcrumb = function (breadcrumb) {
        var newBreadCrum = new breadcrumb_1.Breadcrumb(this.barEl, this, breadcrumb);
        this.breadcrumbs.push(newBreadCrum);
        this.breadcrumbsMap.push(breadcrumb.key);
        this.activePath = breadcrumb.key;
    };
    BreadcrumbBar.prototype.popCrumb = function () {
        if (this.breadcrumbs.length > 1) {
            var breadcrumb = this.breadcrumbs.pop();
            this.breadcrumbsMap.pop();
            breadcrumb.remove();
            var breadcrumbKey = this.breadcrumbsMap[this.breadcrumbsMap.length - 1];
            this.activePath = breadcrumbKey;
            this.changePath();
        }
    };
    BreadcrumbBar.prototype.removeBreadcrumbByKey = function (key) {
        var startIndex;
        var breadcrumbLength = this.breadcrumbsMap.length;
        for (var i = 0; i < breadcrumbLength; i++) {
            if (this.breadcrumbsMap[i] === key) {
                startIndex = i + 1;
                break;
            }
        }
        if (startIndex) {
            this.breadcrumbsMap.splice(startIndex, this.breadcrumbsMap.length - 1);
            for (var j = startIndex; j < breadcrumbLength; j++) {
                var crumb = this.breadcrumbs[j];
                crumb.remove();
            }
            this.breadcrumbs.splice(startIndex, this.breadcrumbs.length - 1);
        }
        this.activePath = key;
        this.changePath();
    };
    return BreadcrumbBar;
}());
exports.BreadcrumbBar = BreadcrumbBar;


/***/ }),
/* 83 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var Breadcrumb = (function () {
    function Breadcrumb(parentEl, breadcrumbBar, breadcrumb) {
        var _this = this;
        this.parentEl = parentEl;
        this.bar = breadcrumbBar;
        this.item = breadcrumb;
        this.itemEl = document.createElement('li');
        var itemTextEl = document.createElement('a');
        itemTextEl.textContent = this.item.name.replace('\\', '');
        this.itemEl.appendChild(itemTextEl);
        this.itemEl.onclick = function (e) {
            breadcrumbBar.removeBreadcrumbByKey(_this.item.key);
        };
        this.parentEl.appendChild(this.itemEl);
    }
    Breadcrumb.prototype.remove = function () {
        $(this.itemEl).remove();
    };
    return Breadcrumb;
}());
exports.Breadcrumb = Breadcrumb;


/***/ }),
/* 84 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var tooltip_1 = __webpack_require__(8);
var File = (function () {
    function File(parentEl, values, browser) {
        var _this = this;
        this.parentEl = parentEl;
        this.item = values;
        this.browser = browser;
        this.fileWrapper = document.createElement('div');
        this.fileWrapper.className = 'file-browser-item-row';
        this.parentEl.appendChild(this.fileWrapper);
        var fileIcon = document.createElement('i');
        fileIcon.className = 'fas fa-file file-browser-file-icon';
        fileIcon.style.width = '20px';
        fileIcon.style.color = 'black';
        this.fileWrapper.appendChild(fileIcon);
        var fileName = document.createElement('span');
        fileName.className = 'file-browser-item-text';
        fileName.textContent = this.item.name;
        fileName.style.width = 'calc(55% - 12px)';
        this.fileWrapper.appendChild(fileName);
        var fileDate = document.createElement('span');
        fileDate.className = 'file-browser-item-text';
        fileDate.style.width = 'calc(25% - 12px)';
        var date = this.item.date.replace(/-/g, '/');
        fileDate.textContent = new Date(date).toLocaleString();
        this.fileWrapper.appendChild(fileDate);
        var fileSize = document.createElement('span');
        fileSize.className = 'file-browser-item-text';
        fileSize.style.width = 'calc(20% - 12px)';
        fileSize.style.textAlign = 'right';
        var size = this.calculateSize(this.item.size);
        fileSize.textContent = size;
        this.fileWrapper.appendChild(fileSize);
        var fileTooltip = new tooltip_1.WVTooltip(this.fileWrapper);
        fileTooltip.setTitle(this.item.name);
        fileTooltip.addAttribute(date);
        fileTooltip.addAttribute(size);
        this.fileWrapper.onclick = function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (!e.ctrlKey) {
                browser.fileList = [];
            }
            else {
                var index = browser.fileList.indexOf(_this.item.path);
                if (index === -1) {
                    browser.fileList.push(_this.item.path);
                }
                else {
                    browser.fileList.splice(index, 1);
                }
                $(_this.fileWrapper).toggleClass('file-browser-item-row-slected');
                return;
            }
            browser.openCallBack(_this.item.path);
            if (!browser.showFilePreview && !e.ctrlKey) {
                browser.submit();
            }
            else {
                $('.file-browser-item-row').each(function () {
                    $(this).removeClass('file-browser-item-row-slected');
                });
                $(_this.fileWrapper).addClass('file-browser-item-row-slected');
            }
        };
    }
    File.prototype.calculateSize = function (sizeInB) {
        var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
        var i = Math.floor(Math.log(sizeInB) / Math.log(1024));
        if (i === 0) {
            return sizeInB + ' ' + sizes[i];
        }
        return (sizeInB / Math.pow(1024, i)).toFixed(1) + ' ' + sizes[i];
    };
    return File;
}());
exports.File = File;


/***/ }),
/* 85 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var tooltip_1 = __webpack_require__(8);
var Folder = (function () {
    function Folder(parentEl, values, browser) {
        var _this = this;
        this.parentEl = parentEl;
        this.item = values;
        this.folderWrapper = document.createElement('div');
        this.folderWrapper.className = 'file-browser-item-row';
        this.parentEl.appendChild(this.folderWrapper);
        var folderIcon = document.createElement('i');
        folderIcon.className = 'far fa-folder file-browser-folder-icon';
        this.folderWrapper.appendChild(folderIcon);
        var folderName = document.createElement('span');
        folderName.className = 'file-browser-item-text';
        var name = this.item.name.replace('\\', '');
        folderName.textContent = name;
        folderName.style.width = 'calc(55% - 12px)';
        this.folderWrapper.appendChild(folderName);
        var folderDate = document.createElement('span');
        folderDate.className = 'file-browser-item-text';
        folderDate.style.width = 'calc(25% - 12px)';
        var date = this.item.date.replace(/-/g, '/');
        folderDate.textContent = new Date(date).toLocaleString();
        this.folderWrapper.appendChild(folderDate);
        var folderTooltip = new tooltip_1.WVTooltip(this.folderWrapper);
        folderTooltip.setTitle(name);
        folderTooltip.addAttribute(date);
        this.folderWrapper.onclick = function (e) {
            browser.setPath(_this.item);
            browser.setPage(1);
        };
    }
    Folder.prototype.calculateSize = function (sizeInB) {
        var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
        var i = Math.floor(Math.log(sizeInB) / Math.log(1024));
        if (i === 0) {
            return sizeInB + ' ' + sizes[i];
        }
        return (sizeInB / Math.pow(1024, i)).toFixed(1) + ' ' + sizes[i];
    };
    return Folder;
}());
exports.Folder = Folder;


/***/ }),
/* 86 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var PaginationRow = (function () {
    function PaginationRow(parentEl, browser) {
        var _this = this;
        this.page = 1;
        this.parentEl = parentEl;
        this.browser = browser;
        this.page = browser.getPage();
        this.wrapperEl = document.createElement('div');
        this.wrapperEl.className = 'file-browser-pagination-row';
        this.parentEl.appendChild(this.wrapperEl);
        var firstPage = document.createElement('div');
        firstPage.className = 'file-browser-pagination-icon';
        var firstPageIcon = document.createElement('i');
        firstPageIcon.className = 'far fa-chevron-double-left';
        $(firstPage).off('click').on('click', function (ev) {
            _this.setPage(1);
        });
        firstPage.appendChild(firstPageIcon);
        this.wrapperEl.appendChild(firstPage);
        var prevPage = document.createElement('div');
        prevPage.className = 'file-browser-pagination-icon';
        var prevPageIcon = document.createElement('i');
        prevPageIcon.className = 'far fa-chevron-left';
        $(prevPage).off('click').on('click', function (ev) {
            if (_this.page > 1) {
                _this.setPage(_this.page - 1);
            }
        });
        prevPage.appendChild(prevPageIcon);
        this.wrapperEl.appendChild(prevPage);
        this.actualPageInput = document.createElement('input');
        this.actualPageInput.className = 'file-browser-actual-page-input';
        this.actualPageInput.value = this.page.toString();
        $(this.actualPageInput).change(function (ev) {
            _this.setPage(parseInt(_this.actualPageInput.value));
        });
        this.wrapperEl.appendChild(this.actualPageInput);
        this.maxPage = document.createElement('span');
        this.maxPage.className = 'file-browser-max-page';
        this.maxPage.textContent = ' /' + Math.ceil(this.browser.size / this.browser.pageSize);
        this.wrapperEl.appendChild(this.maxPage);
        var nextPage = document.createElement('div');
        nextPage.className = 'file-browser-pagination-icon';
        var nextPageIcon = document.createElement('i');
        nextPageIcon.className = 'far fa-chevron-right';
        $(nextPage).off('click').on('click', function (ev) {
            if (_this.page < _this.browser.size / _this.browser.pageSize) {
                _this.setPage(_this.page + 1);
            }
        });
        nextPage.appendChild(nextPageIcon);
        this.wrapperEl.appendChild(nextPage);
        var lastPage = document.createElement('div');
        lastPage.className = 'file-browser-pagination-icon';
        var lastPageIcon = document.createElement('i');
        lastPageIcon.className = 'far fa-chevron-double-right';
        $(lastPage).off('click').on('click', function (ev) {
            _this.setPage(Math.ceil(_this.browser.size / _this.browser.pageSize));
        });
        lastPage.appendChild(lastPageIcon);
        this.wrapperEl.appendChild(lastPage);
    }
    PaginationRow.prototype.setPage = function (page) {
        this.page = page;
        this.actualPageInput.value = this.page.toString();
        this.browser.setPage(page);
    };
    PaginationRow.prototype.updatePageCount = function () {
        this.maxPage.textContent = ' /' + Math.ceil(this.browser.size / this.browser.pageSize);
    };
    PaginationRow.prototype.show = function () {
        $(this.wrapperEl).show();
    };
    PaginationRow.prototype.hide = function () {
        $(this.wrapperEl).hide();
    };
    return PaginationRow;
}());
exports.PaginationRow = PaginationRow;


/***/ }),
/* 87 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var switch_1 = __webpack_require__(90);
var option_toggle_1 = __webpack_require__(89);
var loading_slider_1 = __webpack_require__(88);
var tooltip_1 = __webpack_require__(8);
var sliderStepIdMapping = ['ID_IMPORTDIALOG_SLIDER_TEXT_0', 'ID_IMPORTDIALOG_SLIDER_TEXT_1', 'ID_IMPORTDIALOG_SLIDER_TEXT_2', 'ID_IMPORTDIALOG_SLIDER_TEXT_3'];
var sliderStepTooltipIdMapping = ['ID_IMPORTDIALOG_SLIDER_TOOLTIP_0', 'ID_IMPORTDIALOG_SLIDER_TOOLTIP_1', 'ID_IMPORTDIALOG_SLIDER_TOOLTIP_2', 'ID_IMPORTDIALOG_SLIDER_TOOLTIP_3'];
var NativeLoadingModal = (function () {
    function NativeLoadingModal(client, file, callback, hideRememberMe) {
        var _this = this;
        this.client = client;
        this.file = file;
        this.callback = callback;
        this.modalWrapper = document.createElement('div');
        this.modalWrapper.className = 'native-loading-modal';
        this.isOpen = true;
        this.detectOutsideClick = this.detectOutsideClick.bind(this);
        this.detectEscPressed = this.detectEscPressed.bind(this);
        this.setTesselation = this.setTesselation.bind(this);
        this.setImportMode = this.setImportMode.bind(this);
        this.setSliderStep = this.setSliderStep.bind(this);
        this.titleEl = document.createElement('span');
        this.titleEl.className = 'native-loading-modal-title';
        this.titleEl.textContent = ui.translate('ID_IMPORTDIALOG_TITLE_TEXT');
        this.modalWrapper.appendChild(this.titleEl);
        var contentWrapper = document.createElement('div');
        contentWrapper.className = 'native-loading-modal-content-wrapper';
        contentWrapper.style.marginTop = '20px';
        contentWrapper.style.height = 'calc(50% - 20px)';
        this.modalWrapper.appendChild(contentWrapper);
        this.slider = new loading_slider_1.LoadingSlider(contentWrapper, true, this.setSliderStep);
        this.preferGeometrySwitch = new option_toggle_1.OptionToggle(contentWrapper, 'ID_IMPORTDIALOG_SWITCH_READMODE_TEXT_BREP', 'ID_IMPORTDIALOG_SWITCH_READMODE_TEXT_TESSELLATION', this.setTesselation);
        this.geomTooltip = new tooltip_1.WVTooltip(this.preferGeometrySwitch.wrapperEl);
        this.geomTooltip.setTitle(ui.translate('ID_IMPORTDIALOG_SWITCH_READMODE_TOOLTIP'));
        this.prefer3DSwitch = new option_toggle_1.OptionToggle(contentWrapper, 'ID_IMPORTDIALOG_SWITCH_IMPORTMODE_TEXT_2D', 'ID_IMPORTDIALOG_SWITCH_IMPORTMODE_TEXT_3D', this.setImportMode);
        this.readModeTooltip = new tooltip_1.WVTooltip(this.prefer3DSwitch.wrapperEl);
        this.readModeTooltip.setTitle(ui.translate('ID_IMPORTDIALOG_SWITCH_IMPORTMODE_TOOLTIP'));
        this.prefer3DSwitch.wrapperEl.style.marginTop = '20px';
        try {
            if (_Hide2DSwitch) {
                $(this.prefer3DSwitch.wrapperEl).hide();
            }
        }
        catch (e) { }
        var buttonWrapper = document.createElement('div');
        buttonWrapper.className = 'native-loading-buttons';
        this.modalWrapper.appendChild(buttonWrapper);
        this.skipButton = document.createElement('button');
        this.skipButton.textContent = ui.translate('ID_IMPORTDIALOG_BUTTON_SKIP');
        this.skipButton.className = 'native-loading-skip';
        buttonWrapper.appendChild(this.skipButton);
        $(this.skipButton).click(function (e) {
            _this.skip();
        });
        if (!hideRememberMe) {
            this.rememberMeSwitch = new switch_1.NativeLoadingSwitch(buttonWrapper, 'ID_IMPORTDIALOG_SWITCH_DONOTSHOWAGAIN_TEXT', false);
            this.rememberMeSwitch.wrapperEl.className = 'remember-me-switch';
        }
        this.submitButton = document.createElement('button');
        this.submitButton.className = 'native-loading-ok';
        this.submitButton.textContent = ui.translate('ID_IMPORTDIALOG_BUTTON_OK');
        buttonWrapper.appendChild(this.submitButton);
        $(this.submitButton).click(function (e) {
            var step = _this.slider.getStep();
            var nativeLoadingSettings = {
                prefer2D: _this.prefer3DSwitch.getVal(),
                preferTesselation: _this.preferGeometrySwitch.getVal(),
                step: step,
                rememberMe: _this.rememberMeSwitch ? _this.rememberMeSwitch.getVal() : false
            };
            _this.initSettings = nativeLoadingSettings;
            _this.submit(nativeLoadingSettings);
        });
        document.body.appendChild(this.modalWrapper);
        window.onresize = function (e) {
            ui.resizeHandler();
            _this.resize();
        };
        var storage = localStorage.getItem('nativeLoadingSettings');
        if (storage !== null) {
            var parsedStorage = JSON.parse(storage);
            this.initSettings = parsedStorage;
        }
        else {
            this.initSettings = {
                step: 3,
                prefer2D: true,
                rememberMe: false,
                preferTesselation: true
            };
            this.slider.stepTo(3);
        }
        this.langChanged();
        this.client.on('@changeLang', function (lang) {
            _this.langChanged();
        });
        this.resize();
    }
    NativeLoadingModal.prototype.setCallback = function (callback) {
        this.callback = callback;
    };
    NativeLoadingModal.prototype.setTesselation = function (state) {
        if (this.preferGeometrySwitch) {
            this.slider.setTesselationMode(!state);
            if (!state) {
                this.preferGeometrySwitch.setHighlightColor('darkred');
            }
            else {
                this.preferGeometrySwitch.setHighlightColor('darkgreen');
            }
        }
    };
    NativeLoadingModal.prototype.setImportMode = function (state) {
    };
    NativeLoadingModal.prototype.setSliderStep = function (pos) {
        if (this.preferGeometrySwitch && this.prefer3DSwitch) {
            var preset = void 0;
            switch (pos) {
                case 0:
                    preset = _IncludeHiddenNativeLoading;
                    break;
                case 1:
                    preset = _CompleteNativeLoading;
                    break;
                case 2:
                    preset = _ModerateNativeLoading;
                    break;
                case 3:
                    preset = _FastNativeLoading;
                    break;
            }
            var preferBREP = preset.indexOf('PreferGeometry') !== -1;
            if (preferBREP) {
                this.preferGeometrySwitch.setVal(false);
            }
            var preferTesselation = preset.indexOf('PreferTessellation') !== -1;
            if (preferTesselation) {
                this.preferGeometrySwitch.setVal(true);
            }
            var prefer3D = preset.indexOf('Prefer3D') !== -1;
            if (prefer3D) {
                this.prefer3DSwitch.setVal(true);
            }
            var prefer2D = preset.indexOf('Prefer2D') !== -1;
            if (prefer2D) {
                this.prefer3DSwitch.setVal(false);
            }
        }
    };
    NativeLoadingModal.prototype.langChanged = function () {
        this.titleEl.textContent = ui.translate('ID_IMPORTDIALOG_TITLE_TEXT');
        this.prefer3DSwitch.changeLang();
        this.preferGeometrySwitch.changeLang();
        this.readModeTooltip.setTitle(ui.translate('ID_IMPORTDIALOG_SWITCH_IMPORTMODE_TOOLTIP'));
        this.geomTooltip.setTitle(ui.translate('ID_IMPORTDIALOG_SWITCH_READMODE_TOOLTIP'));
        var slider1 = document.getElementById('slider_step_0_text');
        slider1.textContent = ui.translate(sliderStepIdMapping[0]);
        var slider1Tooltip = new tooltip_1.WVTooltip(slider1);
        slider1Tooltip.setTitle(ui.translate(sliderStepTooltipIdMapping[0]));
        var slider1Handle = document.getElementById('Step_0');
        var slider1HandleTooltip = new tooltip_1.WVTooltip(slider1Handle);
        slider1HandleTooltip.setTitle(ui.translate(sliderStepTooltipIdMapping[0]));
        var slider2 = document.getElementById('slider_step_1_text');
        slider2.textContent = ui.translate(sliderStepIdMapping[1]);
        var slider2Tooltip = new tooltip_1.WVTooltip(slider2);
        slider2Tooltip.setTitle(ui.translate(sliderStepTooltipIdMapping[1]));
        var slider2Handle = document.getElementById('Step_1');
        var slider2HandleTooltip = new tooltip_1.WVTooltip(slider2Handle);
        slider2HandleTooltip.setTitle(ui.translate(sliderStepTooltipIdMapping[1]));
        var slider3 = document.getElementById('slider_step_2_text');
        slider3.textContent = ui.translate(sliderStepIdMapping[2]);
        var slider3Tooltip = new tooltip_1.WVTooltip(slider3);
        slider3Tooltip.setTitle(ui.translate(sliderStepTooltipIdMapping[2]));
        var slider3Handle = document.getElementById('Step_2');
        var slider3HandleTooltip = new tooltip_1.WVTooltip(slider3Handle);
        slider3HandleTooltip.setTitle(ui.translate(sliderStepTooltipIdMapping[2]));
        var slider4 = document.getElementById('slider_step_3_text');
        slider4.textContent = ui.translate(sliderStepIdMapping[3]);
        var slider4Tooltip = new tooltip_1.WVTooltip(slider4);
        slider4Tooltip.setTitle(ui.translate(sliderStepTooltipIdMapping[3]));
        var slider4Handle = document.getElementById('Step_3');
        var slider4HandleTooltip = new tooltip_1.WVTooltip(slider4Handle);
        slider4HandleTooltip.setTitle(ui.translate(sliderStepTooltipIdMapping[3]));
        if (this.rememberMeSwitch) {
            this.rememberMeSwitch.changeLang();
        }
    };
    NativeLoadingModal.prototype.resize = function () {
        this.slider.resize();
        this.prefer3DSwitch.resize();
        this.preferGeometrySwitch.resize();
    };
    NativeLoadingModal.prototype.skip = function () {
        var showAgain = this.rememberMeSwitch ? this.rememberMeSwitch.getVal() : false;
        this.initSettings.rememberMe = showAgain;
        localStorage.setItem('nativeLoadingSettings', JSON.stringify(this.initSettings));
        this.hide();
    };
    NativeLoadingModal.prototype.hide = function (cancel) {
        document.body.removeEventListener('click', this.detectOutsideClick);
        document.body.removeEventListener('keyup', this.detectEscPressed);
        this.isOpen = false;
        if (!cancel) {
            ui.deactivateInteraction(this.client);
            this.callback(this.file);
            ui.canvasStack.setTabTitle(this.file.split("/")[this.file.split("/").length - 1]);
            this.client.emit('@NativeLoad', this.file);
        }
        this.file = undefined;
        this.callback = undefined;
        $(this.modalWrapper).hide();
    };
    NativeLoadingModal.prototype.setFile = function (filename) {
        this.file = filename;
    };
    NativeLoadingModal.prototype.show = function () {
        this.isOpen = true;
        $(this.modalWrapper).show();
        document.body.addEventListener('click', this.detectOutsideClick);
        document.body.addEventListener('keyup', this.detectEscPressed);
        var storedSettings = localStorage.getItem('nativeLoadingSettings');
        if (storedSettings === null) {
            this.initSettings = {
                step: 3,
                prefer2D: true,
                preferTesselation: true
            };
        }
        this.prefer3DSwitch.setVal(this.initSettings.prefer2D);
        this.preferGeometrySwitch.setVal(this.initSettings.preferTesselation);
        this.slider.stepTo(this.initSettings.step);
        if (this.rememberMeSwitch) {
            this.rememberMeSwitch.setVal(false);
            var buttonWidthSum = this.submitButton.offsetWidth + this.skipButton.offsetWidth + 100;
            this.rememberMeSwitch.wrapperEl.style.width = 'calc(100% - ' + buttonWidthSum + 'px)';
            this.rememberMeSwitch.titleEl.style.overflow = 'hidden';
            this.rememberMeSwitch.titleEl.style.textOverflow = 'ellipsis';
            this.rememberMeSwitch.titleEl.style.whiteSpace = 'nowrap';
            this.rememberMeSwitch.titleEl.style.width = 'calc(100% - 40px)';
        }
    };
    NativeLoadingModal.prototype.detectOutsideClick = function (e) {
        if (!(e.target === this.modalWrapper || this.modalWrapper.contains(e.target)) && this.rememberMeSwitch) {
            this.hide(true);
        }
    };
    NativeLoadingModal.prototype.detectEscPressed = function (e) {
        e.preventDefault();
        e.stopPropagation();
        if (e.keyCode === 27) {
            this.hide(true);
        }
    };
    NativeLoadingModal.prototype.submit = function (nativeLoadingSettings) {
        var _this = this;
        localStorage.removeItem('nativeLoadingSettings');
        localStorage.setItem('nativeLoadingSettings', JSON.stringify(nativeLoadingSettings));
        var xml = '<Call Method="SetSettings">';
        switch (nativeLoadingSettings.step) {
            case 0:
                xml += _IncludeHiddenNativeLoading;
                break;
            case 1:
                xml += _CompleteNativeLoading;
                break;
            case 2:
                xml += _ModerateNativeLoading;
                break;
            case 3:
                xml += _FastNativeLoading;
                break;
        }
        xml += '</Call>';
        this.client.command.executeXML(xml);
        var prefer2DString = nativeLoadingSettings.prefer2D ? 'Prefer3D' : 'Prefer2D';
        var preferTesselationString = nativeLoadingSettings.preferTesselation === false ? 'PreferGeometry' : 'PreferTessellation';
        xml = '<Call Method="SetSettings"><Settings><Import3D><General><ImportMode>' + prefer2DString + '</ImportMode>';
        xml += '<ReadMode>' + preferTesselationString + '</ReadMode></General ></Import3D ></Settings ></Call > ';
        this.client.command.executeXML(xml);
        this.client.once('SetSettings', function (ev) {
            _this.hide();
        });
    };
    return NativeLoadingModal;
}());
exports.NativeLoadingModal = NativeLoadingModal;


/***/ }),
/* 88 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var sliderStepIdMapping = ['ID_IMPORTDIALOG_SLIDER_TEXT_0', 'ID_IMPORTDIALOG_SLIDER_TEXT_1', 'ID_IMPORTDIALOG_SLIDER_TEXT_2', 'ID_IMPORTDIALOG_SLIDER_TEXT_3'];
var LoadingSlider = (function () {
    function LoadingSlider(parent, loadTesselation, clickcallBack) {
        var _this = this;
        this.clickcallBack = clickcallBack;
        this.parent = parent;
        this.wrapperEl = document.createElement('div');
        this.wrapperEl.className = 'stepped-slider-wrapper';
        this.parent.appendChild(this.wrapperEl);
        this.sliderWrapper = document.createElement('div');
        this.sliderWrapper.className = 'stepped-slider-bar';
        this.wrapperEl.appendChild(this.sliderWrapper);
        this.handle = document.createElement('span');
        this.handle.className = 'stepped-slider-handle draggable';
        this.handle.id = 'native-loading-handle';
        this.sliderWrapper.appendChild(this.handle);
        this.bar = document.createElement('span');
        this.bar.className = 'stepped-slider-bar-filled';
        this.bar.id = 'native-loading-bar';
        this.sliderWrapper.appendChild(this.bar);
        var _loop_1 = function (i) {
            var step = document.createElement('span');
            step.id = 'Step_' + i;
            step.className = 'slider-step';
            $(step).css('left', i * 133);
            var placeHolder = document.createElement('span');
            step.appendChild(placeHolder);
            var stepText = document.createElement('span');
            stepText.className = 'slider-step-title';
            stepText.id = 'slider_step_' + i + '_text';
            var langId = sliderStepIdMapping[i];
            stepText.textContent = ui.translate(langId);
            $(step).click(function (e) {
                _this.stepTo(i);
            });
            step.appendChild(stepText);
            this_1.sliderWrapper.appendChild(step);
        };
        var this_1 = this;
        for (var i = 0; i < sliderStepIdMapping.length; i++) {
            _loop_1(i);
        }
        var emptyBar = document.createElement('span');
        emptyBar.className = 'stepped-slider-bar-empty';
        $(emptyBar).click(function (e) {
            var pos = e.pageX - $(e.target).parent().offset().left;
            var lowerStep = Math.floor(pos / 133);
            var higherStep = Math.ceil(pos / 133);
            if (higherStep > _this.step) {
                _this.stepTo(higherStep);
            }
            else {
                _this.stepTo(lowerStep);
            }
        });
        this.sliderWrapper.appendChild(emptyBar);
        this.setTesselationMode(loadTesselation);
        this.shrink = 0;
        $(this.handle).kendoTouch({
            dragstart: function (e) {
                _this.offset = $(_this.parent).offset().left;
            },
            drag: function (e) {
                var widthFactor = 500 - document.body.clientWidth;
                if (e.touch.x.location - _this.offset <= 404 - widthFactor && e.touch.x.location - _this.offset >= 0) {
                    _this.handle.style.left = e.touch.x.location - _this.offset + 'px';
                    _this.bar.style.width = e.touch.x.location - _this.offset + 'px';
                }
            },
            dragend: function (e) {
                var value = parseInt($(_this.handle).css('left'));
                _this.stepTo(Math.round(value / (133 - _this.shrink)));
            }
        });
    }
    LoadingSlider.prototype.stepTo = function (step) {
        this.clickcallBack(step);
        this.step = step;
        $('#native-loading-bar').css('width', step * 133 - step * this.shrink);
        $('#native-loading-handle').css('left', step * 133 - step * this.shrink + 4);
        var loadTesselation = this.loadTesselation;
        $('.slider-step').each(function (index) {
            var stepNumber = parseInt(this.id.split('_')[1]);
            if (loadTesselation) {
                $(this).removeClass('slider-step-green-hover').addClass('slider-step-orange-hover');
                if (stepNumber === step) {
                    $(this).children('.slider-step-title').css('color', 'darkred');
                }
                else {
                    $(this).children('.slider-step-title').css('color', 'black');
                }
            }
            else {
                $(this).removeClass('slider-step-orange-hover').addClass('slider-step-green-hover');
                if (stepNumber === step) {
                    $(this).children('.slider-step-title').css('color', 'green');
                }
                else {
                    $(this).children('.slider-step-title').css('color', 'black');
                }
            }
            if (stepNumber < step) {
                $(this).children().first().addClass('slider-step-highlighted');
            }
            else {
                $(this).children().first().removeClass('slider-step-highlighted');
            }
        });
        if (loadTesselation) {
            $('#native-loading-handle').css('background-color', 'darkred');
            $('.stepped-slider-bar-filled').css('background-color', 'darkred');
            $('.slider-step-highlighted').css('background-color', 'darkred');
        }
        else {
            $('#native-loading-handle').css('background-color', 'darkgreen');
            $('.stepped-slider-bar-filled').css('background-color', 'darkgreen');
            $('.slider-step-highlighted').css('background-color', 'darkgreen');
        }
    };
    LoadingSlider.prototype.setTesselationMode = function (bool) {
        this.loadTesselation = bool;
        if (bool) {
            $('#native-loading-handle').css('background-color', 'darkred');
            $('.stepped-slider-bar-filled').css('background-color', 'darkred');
            $('.slider-step-highlighted').css('background-color', 'darkred');
            var distance_1 = this.step;
            $('.slider-step').each(function (index) {
                var stepNumber = parseInt(this.id.split('_')[1]);
                $(this).removeClass('slider-step-green-hover').addClass('slider-step-orange-hover');
                if (stepNumber === distance_1) {
                    $(this).children('.slider-step-title').css('color', 'darkred');
                }
                else {
                    $(this).children('.slider-step-title').css('color', 'black');
                }
            });
        }
        else {
            $('#native-loading-handle').css('background-color', 'darkgreen');
            $('.stepped-slider-bar-filled').css('background-color', 'darkgreen');
            $('.slider-step-highlighted').css('background-color', 'darkgreen');
            var distance_2 = this.step;
            $('.slider-step').each(function (index) {
                var stepNumber = parseInt(this.id.split('_')[1]);
                $(this).removeClass('slider-step-orange-hover').addClass('slider-step-green-hover');
                if (stepNumber === distance_2) {
                    $(this).children('.slider-step-title').css('color', 'darkgreen');
                }
                else {
                    $(this).children('.slider-step-title').css('color', 'black');
                }
            });
        }
    };
    LoadingSlider.prototype.resize = function () {
        var widthFactor = 500 - document.body.clientWidth;
        if (widthFactor > 0) {
            this.sliderWrapper.style.width = 418 - widthFactor + 'px';
            var shrink_1 = widthFactor / 3;
            this.shrink = shrink_1;
            this.bar.style.width = this.step * 133 - this.step * this.shrink + 'px';
            this.handle.style.left = this.step * 133 - this.step * this.shrink + 4 + 'px';
            $('.slider-step').each(function (index) {
                this.style.left = index * 133 - index * shrink_1 + 'px';
            });
        }
        else {
            this.sliderWrapper.style.width = 418 + 'px';
            this.shrink = 0;
            var shrink_2 = 0;
            this.bar.style.width = this.step * 133 - this.step * this.shrink + 'px';
            this.handle.style.left = this.step * 133 - this.step * this.shrink + 4 + 'px';
            $('.slider-step').each(function (index) {
                this.style.left = index * 133 - index * shrink_2 + 'px';
            });
        }
    };
    LoadingSlider.prototype.getStep = function () {
        return this.step;
    };
    return LoadingSlider;
}());
exports.LoadingSlider = LoadingSlider;


/***/ }),
/* 89 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var OptionToggle = (function () {
    function OptionToggle(parent, titleIdLeft, titleIdRight, clickCallback, initialVal) {
        var _this = this;
        this.val = false;
        this.parent = parent;
        this.clickCallback = clickCallback;
        this.titleIdLeft = titleIdLeft;
        this.titleIdRight = titleIdRight;
        this.wrapperEl = document.createElement('div');
        this.wrapperEl.className = 'option-toggle';
        this.parent.appendChild(this.wrapperEl);
        if (initialVal) {
            this.val = initialVal === 'right';
        }
        this.titleElLeft = document.createElement('div');
        this.titleElLeft.className = 'option-toggle-title';
        this.titleElLeft.id = titleIdLeft;
        this.titleElLeft.textContent = ui.translate(titleIdLeft);
        this.wrapperEl.appendChild(this.titleElLeft);
        this.boxEl = document.createElement('div');
        this.boxEl.className = 'option-toggle-wrapper option-toggle-wrapper';
        var statusClass = this.val ? 'toggle-on' : 'toggle-off';
        $(this.boxEl).addClass(statusClass);
        this.wrapperEl.appendChild(this.boxEl);
        this.handleEl = document.createElement('div');
        this.handleEl.className = 'toggle-handle';
        this.boxEl.appendChild(this.handleEl);
        this.titleElRight = document.createElement('div');
        this.titleElRight.className = 'option-toggle-title';
        this.titleElRight.id = titleIdRight;
        this.titleElRight.textContent = ui.translate(titleIdRight);
        this.wrapperEl.appendChild(this.titleElRight);
        this.titleElLeft.style.left = 'calc(50% - ' + (this.titleElLeft.clientWidth + 15) + 'px)';
        $(this.boxEl).click(function (e) {
            _this.setVal(!_this.val);
        });
        this.setVal(this.val);
    }
    OptionToggle.prototype.resize = function () {
        this.titleElLeft.style.left = 'calc(50% - ' + (this.titleElLeft.clientWidth + 15) + 'px)';
    };
    OptionToggle.prototype.getVal = function () {
        return this.val;
    };
    OptionToggle.prototype.setVal = function (val) {
        this.val = val;
        this.clickCallback(this.val);
        if (this.val) {
            $(this.boxEl).removeClass('toggle-off').addClass('toggle-on');
            $(this.titleElLeft).removeClass('option-toggle-title-active');
            $(this.titleElRight).addClass('option-toggle-title-active');
        }
        else {
            $(this.boxEl).removeClass('toggle-on').addClass('toggle-off');
            $(this.titleElLeft).addClass('option-toggle-title-active');
            $(this.titleElRight).removeClass('option-toggle-title-active');
        }
    };
    OptionToggle.prototype.changeLang = function () {
        this.titleElLeft.textContent = ui.translate(this.titleIdLeft);
        this.titleElRight.textContent = ui.translate(this.titleIdRight);
    };
    OptionToggle.prototype.setHighlightColor = function (color) {
        if (this.val) {
            this.titleElRight.style.color = color;
            this.titleElLeft.style.color = 'black';
        }
        else {
            this.titleElLeft.style.color = color;
            this.titleElRight.style.color = 'black';
        }
    };
    return OptionToggle;
}());
exports.OptionToggle = OptionToggle;


/***/ }),
/* 90 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var NativeLoadingSwitch = (function () {
    function NativeLoadingSwitch(parent, titleId, initialVal) {
        var _this = this;
        this.val = false;
        this.parent = parent;
        this.titleId = titleId;
        this.wrapperEl = document.createElement('div');
        this.parent.appendChild(this.wrapperEl);
        if (initialVal) {
            this.val = initialVal;
        }
        this.hiddenCheckbox = document.createElement('input');
        this.hiddenCheckbox.type = 'checkbox';
        this.hiddenCheckbox.value = this.val + '';
        this.hiddenCheckbox.style.display = 'none';
        this.wrapperEl.appendChild(this.hiddenCheckbox);
        this.boxEl = document.createElement('div');
        this.boxEl.className = 'switch-wrapper';
        this.boxEl.style.display = 'inline-block';
        var statusClass = this.val ? 'switch-on' : 'switch-off';
        $(this.boxEl).addClass(statusClass);
        this.wrapperEl.appendChild(this.boxEl);
        this.titleEl = document.createElement('div');
        this.titleEl.className = 'switch-title';
        this.titleEl.id = titleId;
        this.titleEl.textContent = ui.translate(titleId);
        this.wrapperEl.appendChild(this.titleEl);
        this.handleEl = document.createElement('div');
        this.handleEl.className = 'switch-handle';
        this.boxEl.appendChild(this.handleEl);
        $(this.boxEl).click(function (e) {
            _this.val = !_this.val;
            var val = _this.val ? 'true' : 'false';
            $(_this.hiddenCheckbox).val(val);
            $(_this.hiddenCheckbox).trigger('change');
            if (_this.val) {
                $(_this.boxEl).removeClass('switch-off').addClass('switch-on');
            }
            else {
                $(_this.boxEl).removeClass('switch-on').addClass('switch-off');
            }
        });
        this.setVal(this.val);
    }
    NativeLoadingSwitch.prototype.getTitleEl = function () {
        return this.titleEl;
    };
    NativeLoadingSwitch.prototype.getClickEl = function () {
        return this.hiddenCheckbox;
    };
    NativeLoadingSwitch.prototype.getVal = function () {
        return this.val;
    };
    NativeLoadingSwitch.prototype.changeLang = function () {
        this.titleEl.textContent = ui.translate(this.titleId);
    };
    NativeLoadingSwitch.prototype.setVal = function (val) {
        var valString = val ? 'true' : 'false';
        this.val = val;
        $(this.hiddenCheckbox).val(valString);
        $(this.hiddenCheckbox).trigger('change');
        if (this.val) {
            $(this.boxEl).removeClass('switch-off').addClass('switch-on');
        }
        else {
            $(this.boxEl).removeClass('switch-on').addClass('switch-off');
        }
    };
    return NativeLoadingSwitch;
}());
exports.NativeLoadingSwitch = NativeLoadingSwitch;


/***/ }),
/* 91 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var NodeType;
(function (NodeType) {
    NodeType[NodeType["None"] = 0] = "None";
    NodeType[NodeType["Root"] = 1] = "Root";
    NodeType[NodeType["ProductOccurrence"] = 2] = "ProductOccurrence";
    NodeType[NodeType["DoNotUse1"] = 3] = "DoNotUse1";
    NodeType[NodeType["DoNotUse2"] = 4] = "DoNotUse2";
    NodeType[NodeType["Ri_BrepModel"] = 5] = "Ri_BrepModel";
    NodeType[NodeType["Ri_PolyBrepModel"] = 6] = "Ri_PolyBrepModel";
    NodeType[NodeType["Ri_Set"] = 7] = "Ri_Set";
    NodeType[NodeType["Ri_PolyWire"] = 8] = "Ri_PolyWire";
    NodeType[NodeType["Ri_TessMarkup"] = 9] = "Ri_TessMarkup";
    NodeType[NodeType["DoNotUse3"] = 10] = "DoNotUse3";
    NodeType[NodeType["Part"] = 11] = "Part";
    NodeType[NodeType["AxisRoot"] = 12] = "AxisRoot";
    NodeType[NodeType["Axis"] = 13] = "Axis";
    NodeType[NodeType["PMIView"] = 14] = "PMIView";
    NodeType[NodeType["Annotation"] = 15] = "Annotation";
    NodeType[NodeType["PLACEHOLDER_AnnotationItem"] = 16] = "PLACEHOLDER_AnnotationItem";
    NodeType[NodeType["AnnotationReference"] = 17] = "AnnotationReference";
    NodeType[NodeType["AnnotationSet"] = 18] = "AnnotationSet";
    NodeType[NodeType["Curve"] = 19] = "Curve";
    NodeType[NodeType["Line"] = 20] = "Line";
    NodeType[NodeType["Plane"] = 21] = "Plane";
    NodeType[NodeType["Direction"] = 22] = "Direction";
    NodeType[NodeType["Point"] = 23] = "Point";
    NodeType[NodeType["PointSet"] = 24] = "PointSet";
    NodeType[NodeType["CoordinateSystem"] = 25] = "CoordinateSystem";
    NodeType[NodeType["Handle_Root"] = 26] = "Handle_Root";
    NodeType[NodeType["Handle_Arrow"] = 27] = "Handle_Arrow";
    NodeType[NodeType["Handle_Sphere"] = 28] = "Handle_Sphere";
    NodeType[NodeType["Handle_Curlyarrow"] = 29] = "Handle_Curlyarrow";
    NodeType[NodeType["Solid"] = 30] = "Solid";
    NodeType[NodeType["Wire"] = 31] = "Wire";
    NodeType[NodeType["AnnotationItem"] = 32] = "AnnotationItem";
    NodeType[NodeType["Markup_Text"] = 33] = "Markup_Text";
    NodeType[NodeType["Dimensioning"] = 34] = "Dimensioning";
    NodeType[NodeType["PointMarker"] = 35] = "PointMarker";
    NodeType[NodeType["EdgeMarker"] = 36] = "EdgeMarker";
    NodeType[NodeType["CircleMarker"] = 37] = "CircleMarker";
    NodeType[NodeType["AxisMarker"] = 38] = "AxisMarker";
    NodeType[NodeType["ReferenceLine"] = 39] = "ReferenceLine";
    NodeType[NodeType["LineMarker"] = 40] = "LineMarker";
    NodeType[NodeType["TriangleMesh"] = 41] = "TriangleMesh";
    NodeType[NodeType["Scene"] = 42] = "Scene";
    NodeType[NodeType["Markup_Circle"] = 43] = "Markup_Circle";
    NodeType[NodeType["Markup_Rectangle"] = 44] = "Markup_Rectangle";
    NodeType[NodeType["Markup_Freehand"] = 45] = "Markup_Freehand";
    NodeType[NodeType["CutGeometry_Surface"] = 46] = "CutGeometry_Surface";
    NodeType[NodeType["CutGeometry_Wire"] = 47] = "CutGeometry_Wire";
    NodeType[NodeType["PmiMarkup_Unknown"] = 48] = "PmiMarkup_Unknown";
    NodeType[NodeType["PmiMarkup_Text"] = 49] = "PmiMarkup_Text";
    NodeType[NodeType["PmiMarkup_Dimension"] = 50] = "PmiMarkup_Dimension";
    NodeType[NodeType["PmiMarkup_Arrow"] = 51] = "PmiMarkup_Arrow";
    NodeType[NodeType["PmiMarkup_Balloon"] = 52] = "PmiMarkup_Balloon";
    NodeType[NodeType["PmiMarkup_CircleCenter"] = 53] = "PmiMarkup_CircleCenter";
    NodeType[NodeType["PmiMarkup_Coordinate"] = 54] = "PmiMarkup_Coordinate";
    NodeType[NodeType["PmiMarkup_Datum"] = 55] = "PmiMarkup_Datum";
    NodeType[NodeType["PmiMarkup_Fastener"] = 56] = "PmiMarkup_Fastener";
    NodeType[NodeType["PmiMarkup_Gdt"] = 57] = "PmiMarkup_Gdt";
    NodeType[NodeType["PmiMarkup_Locator"] = 58] = "PmiMarkup_Locator";
    NodeType[NodeType["PmiMarkup_MeasurementPoint"] = 59] = "PmiMarkup_MeasurementPoint";
    NodeType[NodeType["PmiMarkup_Roughness"] = 60] = "PmiMarkup_Roughness";
    NodeType[NodeType["PmiMarkup_Welding"] = 61] = "PmiMarkup_Welding";
    NodeType[NodeType["PmiMarkup_Table"] = 62] = "PmiMarkup_Table";
    NodeType[NodeType["PmiMarkup_Other"] = 63] = "PmiMarkup_Other";
    NodeType[NodeType["OffsetLine"] = 64] = "OffsetLine";
    NodeType[NodeType["Drawing"] = 65] = "Drawing";
    NodeType[NodeType["Drawing_Model"] = 66] = "Drawing_Model";
    NodeType[NodeType["Drawing_Sheet"] = 67] = "Drawing_Sheet";
    NodeType[NodeType["Drawing_View"] = 68] = "Drawing_View";
    NodeType[NodeType["Drawing_Entity"] = 69] = "Drawing_Entity";
    NodeType[NodeType["Drawing_Block"] = 70] = "Drawing_Block";
    NodeType[NodeType["Drawing_BlockBasic"] = 71] = "Drawing_BlockBasic";
    NodeType[NodeType["Drawing_BlockOperator"] = 72] = "Drawing_BlockOperator";
    NodeType[NodeType["Drawing_BlockBackground"] = 73] = "Drawing_BlockBackground";
    NodeType[NodeType["Drawing_ClipFrame"] = 74] = "Drawing_ClipFrame";
    NodeType[NodeType["Drawing_Curve"] = 75] = "Drawing_Curve";
    NodeType[NodeType["Drawing_FilledArea"] = 76] = "Drawing_FilledArea";
    NodeType[NodeType["Drawing_Picture"] = 77] = "Drawing_Picture";
    NodeType[NodeType["Drawing_Vertices"] = 78] = "Drawing_Vertices";
    NodeType[NodeType["Dummy"] = 79] = "Dummy";
    NodeType[NodeType["CutGeometry_Set"] = 80] = "CutGeometry_Set";
    NodeType[NodeType["MasterRootNode"] = 81] = "MasterRootNode";
    NodeType[NodeType["MarkupSet"] = 82] = "MarkupSet";
    NodeType[NodeType["DataAnalysisResult"] = 83] = "DataAnalysisResult";
    NodeType[NodeType["Markup"] = 84] = "Markup";
    NodeType[NodeType["UnitTranslation"] = 85] = "UnitTranslation";
    NodeType[NodeType["Document2D"] = 86] = "Document2D";
    NodeType[NodeType["Various"] = 4294967294] = "Various";
    NodeType[NodeType["Unknown"] = 4294967295] = "Unknown";
})(NodeType = exports.NodeType || (exports.NodeType = {}));
;


/***/ }),
/* 92 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var radiobutton_group_1 = __webpack_require__(94);
var ui = __webpack_require__(0);
var file_browser_switch_1 = __webpack_require__(35);
var color_picker_1 = __webpack_require__(93);
var app_states_1 = __webpack_require__(4);
;
;
var PrintModal = (function () {
    function PrintModal(client) {
        var _this = this;
        this.textModule = '%file';
        this.orientation = 'Portrait';
        this.client = client;
        this.isOpen = true;
        this.detectOutsideClick = this.detectOutsideClick.bind(this);
        this.detectEscPressed = this.detectEscPressed.bind(this);
        this.submit = this.submit.bind(this);
        this.resize = this.resize.bind(this);
        this.setWhiteBackgroundSetting = this.setWhiteBackgroundSetting.bind(this);
        this.setLineWidthEnabledSetting = this.setLineWidthEnabledSetting.bind(this);
        this.setTiledSetting = this.setTiledSetting.bind(this);
        this.setFontColorSetting = this.setFontColorSetting.bind(this);
        this.orientation = ui.settingsPane.defaultSettings.Settings.Print.Orientation;
        this.printFontNameEnum = [];
        this.printFontStyleEnum = [
            { langId: "ID_PRINT_MODAL_FONT_REGULAR", value: "0" },
            { langId: "ID_PRINT_MODAL_FONT_BOLD", value: "1" },
            { langId: "ID_PRINT_MODAL_FONT_ITALIC", value: "2" },
            { langId: "ID_PRINT_MODAL_FONT_BOLD_ITALIC", value: "3" },
            { langId: "ID_PRINT_MODAL_FONT_UNDERLINE", value: "4" },
            { langId: "ID_PRINT_MODAL_FONT_STRIKEOUT", value: "8" }
        ];
        try {
            this.printPaperSizeEnum = _PrintPaperSizes;
        }
        catch (e) {
            this.printPaperSizeEnum = [
                { langId: "-", width: -1, height: -1, dpi: 600 },
                { langId: "A0", width: 841, height: 1189, dpi: 200 },
                { langId: "A1", width: 594, height: 841, dpi: 300 },
                { langId: "A2", width: 420, height: 594, dpi: 400 },
                { langId: "A3", width: 297, height: 420, dpi: 500 },
                { langId: "A4", width: 210, height: 297, dpi: 600 },
                { langId: "A5", width: 148, height: 210, dpi: 600 },
                { langId: "Letter", width: 216, height: 279, dpi: 600 },
                { langId: "Legal", width: 216, height: 256, dpi: 600 },
                { langId: "Ledger", width: 279, height: 432, dpi: 500 }
            ];
        }
        document.body.addEventListener('mousedown', this.detectOutsideClick);
        document.body.addEventListener('keyup', this.detectEscPressed);
        this.modalWrapper = document.createElement('div');
        this.modalWrapper.className = 'print-modal';
        var optionsWrapper = document.createElement('div');
        optionsWrapper.className = 'print-modal-site-wrapper';
        optionsWrapper.style.borderRight = '1px solid lightgrey';
        this.modalWrapper.appendChild(optionsWrapper);
        var optionHeader = document.createElement('div');
        optionHeader.className = 'print-modal-image-title';
        optionHeader.textContent = ui.translate('ID_PRINT_MODAL_PRINT_SETTINGS');
        optionsWrapper.appendChild(optionHeader);
        var tabWrapper = document.createElement('div');
        tabWrapper.className = 'print-modal-tab-bar';
        optionsWrapper.appendChild(tabWrapper);
        var defaultTab = document.createElement('div');
        defaultTab.className = 'print-modal-tab print-modal-active-tab';
        defaultTab.textContent = 'General';
        tabWrapper.appendChild(defaultTab);
        var textTab = document.createElement('div');
        textTab.className = 'print-modal-tab';
        textTab.textContent = 'Text';
        tabWrapper.appendChild(textTab);
        defaultTab.onclick = function (e) {
            if (!$(defaultTab).hasClass('print-modal-active-tab')) {
                $(textTab).removeClass('print-modal-active-tab');
                $(defaultTab).addClass('print-modal-active-tab');
                _this.buildDefaultOptions();
                $(_this.textOptionWrapper).hide();
                $(_this.defaultOptionWrapper).show();
            }
        };
        textTab.onclick = function (e) {
            if (!$(textTab).hasClass('print-modal-active-tab')) {
                $(defaultTab).removeClass('print-modal-active-tab');
                $(textTab).addClass('print-modal-active-tab');
                $(_this.defaultOptionWrapper).hide();
                $(_this.textOptionWrapper).show();
            }
        };
        this.defaultOptionWrapper = document.createElement('div');
        this.defaultOptionWrapper.className = 'print-modal-options-wrapper';
        optionsWrapper.appendChild(this.defaultOptionWrapper);
        this.textOptionWrapper = document.createElement('div');
        this.textOptionWrapper.className = 'print-modal-options-wrapper';
        optionsWrapper.appendChild(this.textOptionWrapper);
        this.showDefaultOptions();
        var enumTemplateCall = '<Call Method="GetTemplate"><Type>PrintTemplate</Type></Call>';
        this.client.command.executeXML(enumTemplateCall);
        this.client.on('GetTemplate.PrintTemplate', function (res) {
            _this.fillOptions(res);
            _this.buildTextOptions();
            _this.buildDefaultOptions();
        });
        this.buttonRow = document.createElement('div');
        this.buttonRow.className = 'print-modal-button-row';
        optionsWrapper.appendChild(this.buttonRow);
        var hideOpenPDFButton = false;
        try {
            hideOpenPDFButton = _BrowserPrintButtonDeactivated;
        }
        catch (e) { }
        if (!hideOpenPDFButton) {
            var openPDFButton = document.createElement('i');
            openPDFButton.className = 'print-modal-icon fas fa-print';
            openPDFButton.style.marginRight = '15px';
            this.buttonRow.appendChild(openPDFButton);
            openPDFButton.onclick = function (e) {
                _this.createPDF(true);
            };
        }
        var downloadPDFButton = document.createElement('i');
        downloadPDFButton.className = 'print-modal-icon fas fa-download';
        downloadPDFButton.style.marginRight = '15px';
        this.buttonRow.appendChild(downloadPDFButton);
        downloadPDFButton.onclick = function (e) {
            _this.createPDF(false);
        };
        var printButton = document.createElement('button');
        printButton.className = 'print-modal-button';
        printButton.textContent = ui.translate('ID_PRINT_MODAL_PRINT');
        var submitButton = document.createElement('button');
        submitButton.className = 'print-modal-button';
        submitButton.style.cssFloat = 'right';
        submitButton.textContent = 'OK';
        this.buttonRow.appendChild(submitButton);
        submitButton.onclick = this.submit;
        var imageWrapper = document.createElement('div');
        imageWrapper.className = 'print-modal-site-wrapper';
        imageWrapper.style.left = '50%';
        this.modalWrapper.appendChild(imageWrapper);
        var imageHeader = document.createElement('div');
        imageHeader.className = 'print-modal-image-title';
        imageHeader.textContent = ui.translate('ID_PRINT_MODAL_IMAGE_PREVIEW');
        imageWrapper.appendChild(imageHeader);
        var imageCanvas = document.createElement('div');
        imageCanvas.className = 'print-modal-image-canvas';
        imageWrapper.appendChild(imageCanvas);
        this.previewImage = document.createElement('img');
        this.previewImage.className = 'print-modal-image';
        imageCanvas.appendChild(this.previewImage);
        this.dpi = parseInt(ui.settingsPane.defaultSettings.Settings.Print.PageDPI);
        var paperSizeWrapper = document.createElement('div');
        paperSizeWrapper.className = 'print-modal-long-input-wrapper';
        imageWrapper.appendChild(paperSizeWrapper);
        this.paperSizeSelect = document.createElement('select');
        this.paperSizeSelect.style.margin = '0';
        this.paperSizeSelect.className = 'print-modal-select';
        var pSizeLength = this.printPaperSizeEnum.length;
        for (var i = 0; i < pSizeLength; i++) {
            var option = document.createElement('option');
            option.value = i.toString();
            option.text = ui.translate(this.printPaperSizeEnum[i].langId);
            option.selected = this.isSelectedPaperSize(this.printPaperSizeEnum[i].width, this.printPaperSizeEnum[i].height);
            this.paperSizeSelect.appendChild(option);
        }
        this.paperSizeSelect.onchange = function (e) {
            var i = parseInt(_this.paperSizeSelect.value);
            _this.dpi = _this.printPaperSizeEnum[i].dpi;
            var width = _this.mmToPPI(_this.printPaperSizeEnum[i].width.toString());
            var height = _this.mmToPPI(_this.printPaperSizeEnum[i].height.toString());
            var xml = '<Call Method="SetSettings"><Settings><Print>';
            xml += '<PageWidth>';
            xml += _this.orientation === 'Portrait' ? width : height;
            xml += '</PageWidth>';
            xml += '<PageHeight>';
            xml += _this.orientation === 'Portrait' ? height : width;
            xml += '</PageHeight>';
            xml += '<PageDPI>' + _this.dpi + '</PageDPI>';
            xml += '</Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        paperSizeWrapper.appendChild(this.paperSizeSelect);
        var paperSizeText = document.createElement('div');
        paperSizeText.className = 'print-modal-size-wrapper';
        this.widthEl = document.createElement('span');
        this.widthEl.textContent = this.ppiToMM(ui.settingsPane.defaultSettings.Settings.Print.PageWidth) + ' mm';
        paperSizeText.appendChild(this.widthEl);
        var separator = document.createElement('span');
        separator.textContent = ' x ';
        paperSizeText.appendChild(separator);
        this.heightEl = document.createElement('span');
        this.heightEl.textContent = this.ppiToMM(ui.settingsPane.defaultSettings.Settings.Print.PageHeight) + ' mm';
        paperSizeText.appendChild(this.heightEl);
        paperSizeWrapper.appendChild(paperSizeText);
        var sizeGroup = document.createElement('div');
        sizeGroup.className = 'print-modal-option-group';
        imageWrapper.appendChild(sizeGroup);
        var sizeGroupTitle = document.createElement('div');
        sizeGroupTitle.textContent = ui.translate('ID_PRINT_MODAL_DOCUMENT_SIZE');
        sizeGroupTitle.className = 'print-modal-option-group-title';
        sizeGroup.appendChild(sizeGroupTitle);
        var widthWrapper = document.createElement('div');
        widthWrapper.className = 'print-modal-long-input-wrapper';
        sizeGroup.appendChild(widthWrapper);
        var widthTitle = document.createElement('span');
        widthTitle.textContent = ui.translate('ID_TEXT_PAPERWIDTH');
        widthTitle.className = 'print-modal-long-input-title';
        widthWrapper.appendChild(widthTitle);
        this.widthInput = document.createElement('input');
        this.widthInput.className = 'print-modal-long-input';
        this.widthInput.value = this.ppiToMM(ui.settingsPane.defaultSettings.Settings.Print.PageWidth).toString();
        this.widthInput.onfocus = this.onInputFocus;
        this.widthInput.onblur = this.onInputBlur;
        this.widthInput.onchange = function (e) {
            var val = _this.mmToPPI(_this.widthInput.value);
            var height = ui.settingsPane.defaultSettings.Settings.Print.PageHeight;
            var xml = '<Call Method="SetSettings"><Settings><Print><PageWidth>' + val + '</PageWidth>';
            xml += val > height ? '<Orientation>Landscape</Orientation>' : '<Orientation>Portrait</Orientation>';
            xml += '</Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        widthWrapper.appendChild(this.widthInput);
        var heightWrapper = document.createElement('div');
        heightWrapper.className = 'print-modal-long-input-wrapper';
        sizeGroup.appendChild(heightWrapper);
        var heightTitle = document.createElement('span');
        heightTitle.textContent = ui.translate('ID_TEXT_PAPERHEIGHT');
        heightTitle.className = 'print-modal-long-input-title';
        heightWrapper.appendChild(heightTitle);
        this.heightInput = document.createElement('input');
        this.heightInput.className = 'print-modal-long-input';
        this.heightInput.value = this.ppiToMM(ui.settingsPane.defaultSettings.Settings.Print.PageHeight).toString();
        this.heightInput.onfocus = this.onInputFocus;
        this.heightInput.onblur = this.onInputBlur;
        this.heightInput.onchange = function (e) {
            var val = _this.mmToPPI(_this.heightInput.value);
            var width = ui.settingsPane.defaultSettings.Settings.Print.PageWidth;
            var xml = '<Call Method="SetSettings"><Settings><Print><PageHeight>' + val + '</PageHeight>';
            xml += val > width ? '<Orientation>Portrait</Orientation>' : '<Orientation>Landscape</Orientation>';
            xml += '</Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        heightWrapper.appendChild(this.heightInput);
        var dpiWrapper = document.createElement('div');
        dpiWrapper.className = 'print-modal-long-input-wrapper';
        sizeGroup.appendChild(dpiWrapper);
        var dpiTitle = document.createElement('span');
        dpiTitle.textContent = ui.translate('ID_DPI');
        dpiTitle.className = 'print-modal-long-input-title';
        dpiWrapper.appendChild(dpiTitle);
        this.dpiInput = document.createElement('input');
        this.dpiInput.className = 'print-modal-long-input';
        this.dpiInput.value = ui.settingsPane.defaultSettings.Settings.Print.PageDPI;
        this.dpiInput.onfocus = this.onInputFocus;
        this.dpiInput.onblur = this.onInputBlur;
        this.dpiInput.onchange = function (e) {
            _this.dpi = parseInt(_this.dpiInput.value);
            var xml = '<Call Method="SetSettings"><Settings><Print>';
            xml += '<PageHeight>' + _this.mmToPPI(_this.heightInput.value) + '</PageHeight>';
            xml += '<PageWidth>' + _this.mmToPPI(_this.widthInput.value) + '</PageWidth><PageDPI>' + _this.dpiInput.value + '</PageDPI></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        dpiWrapper.appendChild(this.dpiInput);
        this.getPrintPreview();
        this.client.on('CreatePrintPreview', function (res) {
            var src = 'data:image/png;base64, ' + res.Image;
            _this.previewImage.src = src;
        });
        document.body.appendChild(this.modalWrapper);
        window.addEventListener('resize', this.resize);
        this.client.on('GetSettings', function (res) {
            if (_this.isOpen) {
                _this.getPrintPreview();
                _this.updateUI(res.Settings.Print);
            }
        });
    }
    PrintModal.prototype.onInputFocus = function () {
        app_states_1.appStates.preventGlobalKeyEvents = true;
    };
    PrintModal.prototype.onInputBlur = function () {
        app_states_1.appStates.preventGlobalKeyEvents = false;
    };
    PrintModal.prototype.createPDF = function (open) {
        var xml = '<Call Method="GetPrintImageAsPDF"></Call>';
        this.client.command.executeXML(xml);
        ui.blockUI();
        var name = app_states_1.appStates.fileName ? app_states_1.appStates.fileName + '.pdf' : 'print.pdf';
        this.client.once('GetPrintImageAsPDF', function (res) {
            ui.unblockUI();
            var byteCharacters = atob(res.Image);
            var byteNumbers = new Array(byteCharacters.length);
            for (var i = 0; i < byteCharacters.length; i++) {
                byteNumbers[i] = byteCharacters.charCodeAt(i);
            }
            var byteArray = new Uint8Array(byteNumbers);
            var blob = new Blob([byteArray], {
                type: 'application/pdf'
            });
            if (window.navigator && window.navigator.msSaveOrOpenBlob) {
                if (open) {
                    window.navigator.msSaveOrOpenBlob(blob);
                }
                else {
                    window.navigator.msSaveOrOpenBlob(blob, name);
                }
            }
            else {
                var blobUrl = URL.createObjectURL(blob);
                if (open) {
                    window.open(blobUrl);
                }
                else {
                    var link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = name;
                    document.body.appendChild(link);
                    link.click();
                    link.remove();
                }
            }
        });
    };
    PrintModal.prototype.updateUI = function (settings) {
        var sLength = this.printScaleEnum.length;
        for (var i = 0; i < sLength; i++) {
            if (settings.ScaleMode === this.printScaleEnum[i].value) {
                this.scalingGroup.setStateByIndex(i, true);
            }
        }
        this.scaleDynamicValue.value = settings.Scale;
        var alength = this.printOrientationEnum.length;
        this.orientation = settings.Orientation;
        for (var i = 0; i < alength; i++) {
            if (settings.Orientation === this.printOrientationEnum[i].value) {
                this.orientationGroup.setStateByIndex(i, true);
            }
        }
        this.whiteBackgroundSwitch.setVal(settings.WhiteBackground === 'true');
        this.lineWidthSwitch.setVal(settings.LineWidthEnabled === 'true');
        var uLength = this.printLineWidthUnit.length;
        for (var i = 0; i < uLength; i++) {
            if (settings.LineWidthUnit === this.printLineWidthUnit[i].value) {
                this.unitSelect.selectedIndex = i;
            }
        }
        var rLength = this.printRangeEnum.length;
        for (var i = 0; i < rLength; i++) {
            if (settings.PageRange === this.printRangeEnum[i].value) {
                this.rangeGroup.setStateByIndex(i, true);
            }
        }
        this.fromInput.value = settings.PageRangeFirst;
        this.toInput.value = settings.PageRangeLast;
        this.widthInput.value = this.ppiToMM(settings.PageWidth).toString();
        this.widthEl.textContent = this.ppiToMM(settings.PageWidth).toString() + ' mm';
        this.heightInput.value = this.ppiToMM(settings.PageHeight).toString();
        this.heightEl.textContent = this.ppiToMM(settings.PageHeight).toString() + ' mm';
        var pSizeLength = this.printPaperSizeEnum.length;
        var predefinedSize = false;
        for (var i = 0; i < pSizeLength; i++) {
            if (this.isSelectedPaperSize(this.printPaperSizeEnum[i].width, this.printPaperSizeEnum[i].height)) {
                predefinedSize = true;
                this.paperSizeSelect.selectedIndex = i;
            }
        }
        if (!predefinedSize) {
            this.paperSizeSelect.selectedIndex = 0;
        }
        var dpi = settings.PageDPI;
        this.dpiInput.value = dpi;
    };
    PrintModal.prototype.ppiToMM = function (ppi) {
        return Math.round((parseInt(ppi) / this.dpi) * 25.4);
    };
    PrintModal.prototype.mmToPPI = function (mm) {
        return Math.round((parseInt(mm) / 25.4) * this.dpi);
    };
    PrintModal.prototype.isSelectedPaperSize = function (width, height) {
        width = this.mmToPPI(width.toString());
        height = this.mmToPPI(height.toString());
        var actualWidth = parseInt(ui.settingsPane.defaultSettings.Settings.Print.PageWidth);
        var actualHeight = parseInt(ui.settingsPane.defaultSettings.Settings.Print.PageHeight);
        switch (this.orientation) {
            case 'Portrait':
                return (width === actualWidth && height === actualHeight);
            case 'Landscape':
                return (width === actualHeight && height === actualWidth);
            default:
                return false;
        }
    };
    PrintModal.prototype.getPrintPreview = function () {
        var xml = '<Call Method="CreatePrintPreview">';
        xml += '<Width>300</Width>';
        xml += '<Height>300</Height>';
        xml += '</Call>';
        this.client.command.executeXML(xml);
    };
    PrintModal.prototype.showDefaultOptions = function () {
        $(this.textOptionWrapper).hide();
        $(this.defaultOptionWrapper).show();
    };
    PrintModal.prototype.showTextOptions = function () {
        $(this.textOptionWrapper).show();
        $(this.defaultOptionWrapper).hide();
    };
    PrintModal.prototype.buildDefaultOptions = function () {
        var _this = this;
        $(this.defaultOptionWrapper).empty();
        this.scalingGroup = new radiobutton_group_1.RadioButtonGroup(this.defaultOptionWrapper, 'ID_PRINT_SCALING');
        var sLength = this.printScaleEnum.length;
        var _loop_1 = function (i) {
            var scaleOption = {
                value: this_1.printScaleEnum[i].value,
                langId: this_1.printScaleEnum[i].langId,
                initialState: ui.settingsPane.defaultSettings.Settings.Print.ScaleMode === this_1.printScaleEnum[i].value
            };
            var callback = function () {
                var xml = '<Call Method="SetSettings"><Settings><Print><ScaleMode>' + scaleOption.value + '</ScaleMode></Print></Settings></Call>';
                _this.client.command.executeXML(xml);
            };
            this_1.scalingGroup.addButton(scaleOption, callback);
            if (scaleOption.value === 'Scale') {
                var scaleStaticValue = document.createElement('div');
                scaleStaticValue.textContent = '1:';
                scaleStaticValue.className = 'print-modal-static-text';
                var buttonAnchor = this_1.scalingGroup.buttons[this_1.scalingGroup.buttons.length - 1].wrapperEl;
                buttonAnchor.appendChild(scaleStaticValue);
                this_1.scaleDynamicValue = document.createElement('input');
                this_1.scaleDynamicValue.className = 'print-modal-input';
                this_1.scaleDynamicValue.value = ui.settingsPane.defaultSettings.Settings.Print.Scale;
                this_1.scaleDynamicValue.onfocus = this_1.onInputFocus;
                this_1.scaleDynamicValue.onblur = this_1.onInputBlur;
                this_1.scaleDynamicValue.onchange = function (e) {
                    var xml = '<Call Method="SetSettings"><Settings><Print>';
                    xml += '<Scale>' + _this.scaleDynamicValue.value + '</Scale></Print></Settings></Call>';
                    _this.client.command.executeXML(xml);
                };
                buttonAnchor.appendChild(this_1.scaleDynamicValue);
            }
        };
        var this_1 = this;
        for (var i = 0; i < sLength; i++) {
            _loop_1(i);
        }
        this.orientationGroup = new radiobutton_group_1.RadioButtonGroup(this.defaultOptionWrapper, 'ID_PRINT_ORIENTATION');
        var oLength = this.printOrientationEnum.length;
        var _loop_2 = function (i) {
            var orientationOption = {
                value: this_2.printOrientationEnum[i].value,
                langId: this_2.printOrientationEnum[i].langId,
                initialState: ui.settingsPane.defaultSettings.Settings.Print.Orientation === this_2.printOrientationEnum[i].value
            };
            var callback = function () {
                if (_this.orientation !== orientationOption.value) {
                    var xml = '<Call Method="SetSettings"><Settings><Print><Orientation>' + orientationOption.value + '</Orientation>';
                    var width = ui.settingsPane.defaultSettings.Settings.Print.PageWidth;
                    var height = ui.settingsPane.defaultSettings.Settings.Print.PageHeight;
                    switch (orientationOption.value) {
                        case 'Landscape':
                        case 'Portrait':
                            xml += '<PageWidth>' + height + '</PageWidth>';
                            xml += '<PageHeight>' + width + '</PageHeight>';
                            break;
                    }
                    xml += '</Print></Settings></Call>';
                    _this.client.command.executeXML(xml);
                }
            };
            this_2.orientationGroup.addButton(orientationOption, callback);
        };
        var this_2 = this;
        for (var i = 0; i < oLength; i++) {
            _loop_2(i);
        }
        var miscGroup = document.createElement('div');
        miscGroup.className = 'print-modal-option-group';
        this.defaultOptionWrapper.appendChild(miscGroup);
        var miscGroupTitle = document.createElement('div');
        miscGroupTitle.textContent = ui.translate('ID_PRINT_MISC');
        miscGroupTitle.className = 'print-modal-option-group-title';
        miscGroup.appendChild(miscGroupTitle);
        this.whiteBackgroundSwitch = new file_browser_switch_1.FileBrowserSwitch(miscGroup, 'ID_WHITE_BACKGROUND', this.setWhiteBackgroundSetting, 'print', true);
        this.lineWidthSwitch = new file_browser_switch_1.FileBrowserSwitch(miscGroup, 'ID_CUSTOM_LINEWIDTH', this.setLineWidthEnabledSetting, 'print', true);
        this.lineWidthInput = document.createElement('input');
        this.lineWidthInput.className = 'print-modal-input';
        this.lineWidthInput.style.marginLeft = '15px';
        this.lineWidthInput.value = ui.settingsPane.defaultSettings.Settings.Print.LineWidth;
        this.lineWidthInput.onfocus = this.onInputFocus;
        this.lineWidthInput.onblur = this.onInputBlur;
        this.lineWidthInput.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><LineWidth>' + _this.lineWidthInput.value + '</LineWidth></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        this.lineWidthSwitch.wrapperEl.appendChild(this.lineWidthInput);
        this.unitSelect = document.createElement('select');
        this.unitSelect.className = 'print-modal-select';
        var uLength = this.printLineWidthUnit.length;
        for (var i = 0; i < uLength; i++) {
            var option = document.createElement('option');
            option.value = this.printLineWidthUnit[i].value;
            option.text = ui.translate(this.printLineWidthUnit[i].langId);
            option.selected = ui.settingsPane.defaultSettings.Settings.Print.LineWidthUnit === this.printLineWidthUnit[i].value;
            this.unitSelect.appendChild(option);
        }
        this.unitSelect.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><LineWidthUnit>' + _this.unitSelect.value + '</LineWidthUnit></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        this.lineWidthSwitch.wrapperEl.appendChild(this.unitSelect);
        this.tiledSwitch = new file_browser_switch_1.FileBrowserSwitch(miscGroup, 'ID_PRINT_TILED', this.setTiledSetting, 'print', false);
        this.rangeGroup = new radiobutton_group_1.RadioButtonGroup(this.defaultOptionWrapper, 'ID_PRINT_RANGE');
        var rLength = this.printRangeEnum.length;
        var _loop_3 = function (i) {
            var rangeOption = {
                value: this_3.printRangeEnum[i].value,
                langId: this_3.printRangeEnum[i].langId,
                initialState: ui.settingsPane.defaultSettings.Settings.Print.PageRange === this_3.printRangeEnum[i].value
            };
            var callback = function () {
                var xml = '<Call Method="SetSettings"><Settings><Print><PageRange>' + rangeOption.value + '</PageRange></Print></Settings></Call>';
                _this.client.command.executeXML(xml);
            };
            this_3.rangeGroup.addButton(rangeOption, callback);
            if (rangeOption.value === 'Range') {
                var fromTitle = document.createElement('div');
                fromTitle.textContent = ui.translate('ID_PRINT_RANGE_FROM') + ':';
                fromTitle.className = 'print-modal-static-text';
                var buttonAnchor = this_3.rangeGroup.buttons[this_3.rangeGroup.buttons.length - 1].wrapperEl;
                buttonAnchor.appendChild(fromTitle);
                this_3.fromInput = document.createElement('input');
                this_3.fromInput.className = 'print-modal-input';
                this_3.fromInput.value = ui.settingsPane.defaultSettings.Settings.Print.PageRangeFirst;
                this_3.fromInput.onfocus = this_3.onInputFocus;
                this_3.fromInput.onblur = this_3.onInputBlur;
                this_3.fromInput.onchange = function (e) {
                    var xml = '<Call Method="SetSettings"><Settings><Print><PageRangeFirst>' + _this.fromInput.value + '</PageRangeFirst></Print></Settings></Call>';
                    _this.client.command.executeXML(xml);
                };
                buttonAnchor.appendChild(this_3.fromInput);
                var toTitle = document.createElement('div');
                toTitle.textContent = ui.translate('ID_PRINT_RANGE_TO') + ':';
                toTitle.className = 'print-modal-static-text';
                buttonAnchor.appendChild(toTitle);
                this_3.toInput = document.createElement('input');
                this_3.toInput.className = 'print-modal-input';
                this_3.toInput.value = ui.settingsPane.defaultSettings.Settings.Print.PageRangeLast;
                this_3.toInput.onfocus = this_3.onInputFocus;
                this_3.toInput.onblur = this_3.onInputBlur;
                this_3.toInput.onchange = function (e) {
                    var xml = '<Call Method="SetSettings"><Settings><Print><PageRangeLast>' + _this.toInput.value + '</PageRangeLast></Print></Settings></Call>';
                    _this.client.command.executeXML(xml);
                };
                buttonAnchor.appendChild(this_3.toInput);
            }
        };
        var this_3 = this;
        for (var i = 0; i < rLength; i++) {
            _loop_3(i);
        }
    };
    PrintModal.prototype.buildTextOptions = function () {
        var _this = this;
        $(this.textOptionWrapper).empty();
        var headerGroup = document.createElement('div');
        headerGroup.className = 'print-modal-option-group';
        this.textOptionWrapper.appendChild(headerGroup);
        var headerGroupTitle = document.createElement('div');
        headerGroupTitle.textContent = ui.translate('ID_PRINT_HEADER');
        headerGroupTitle.className = 'print-modal-option-group-title';
        headerGroup.appendChild(headerGroupTitle);
        var headerLeftWrapper = document.createElement('div');
        headerLeftWrapper.className = 'print-modal-long-input-wrapper';
        headerGroup.appendChild(headerLeftWrapper);
        var headerLeftTitle = document.createElement('span');
        headerLeftTitle.className = 'print-modal-long-input-title';
        headerLeftTitle.textContent = ui.translate('ID_PRINT_HEADER_LEFT');
        headerLeftWrapper.appendChild(headerLeftTitle);
        var headerLeftInput = document.createElement('input');
        headerLeftInput.className = 'print-modal-long-input';
        headerLeftInput.value = ui.settingsPane.defaultSettings.Settings.Print.HeaderLeft;
        this.activeTextInput = headerLeftInput;
        this.activeTextInput.onblur = this.onInputBlur;
        headerLeftInput.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><HeaderLeft>' + headerLeftInput.value + '</HeaderLeft></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        headerLeftInput.onfocus = function (e) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
            _this.activeTextInput = headerLeftInput;
        };
        headerLeftWrapper.appendChild(headerLeftInput);
        var headerCenterWrapper = document.createElement('div');
        headerCenterWrapper.className = 'print-modal-long-input-wrapper';
        headerGroup.appendChild(headerCenterWrapper);
        var headerCenterTitle = document.createElement('span');
        headerCenterTitle.textContent = ui.translate('ID_PRINT_HEADER_CENTER');
        headerCenterTitle.className = 'print-modal-long-input-title';
        headerCenterWrapper.appendChild(headerCenterTitle);
        var headerCenterInput = document.createElement('input');
        headerCenterInput.className = 'print-modal-long-input';
        headerCenterInput.value = ui.settingsPane.defaultSettings.Settings.Print.HeaderCenter;
        headerCenterInput.onblur = this.onInputBlur;
        headerCenterInput.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><HeaderCenter>' + headerCenterInput.value + '</HeaderCenter></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        headerCenterInput.onfocus = function (e) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
            _this.activeTextInput = headerCenterInput;
        };
        headerCenterWrapper.appendChild(headerCenterInput);
        var headerRightWrapper = document.createElement('div');
        headerRightWrapper.className = 'print-modal-long-input-wrapper';
        headerGroup.appendChild(headerRightWrapper);
        var headerRightTitle = document.createElement('span');
        headerRightTitle.textContent = ui.translate('ID_PRINT_HEADER_RIGHT');
        headerRightTitle.className = 'print-modal-long-input-title';
        headerRightWrapper.appendChild(headerRightTitle);
        var headerRightInput = document.createElement('input');
        headerRightInput.className = 'print-modal-long-input';
        headerRightInput.value = ui.settingsPane.defaultSettings.Settings.Print.HeaderRight;
        headerRightInput.onblur = this.onInputBlur;
        headerRightInput.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><HeaderRight>' + headerRightInput.value + '</HeaderRight></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        headerRightInput.onfocus = function (e) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
            _this.activeTextInput = headerRightInput;
        };
        headerRightWrapper.appendChild(headerRightInput);
        var footerGroup = document.createElement('div');
        footerGroup.className = 'print-modal-option-group';
        this.textOptionWrapper.appendChild(footerGroup);
        var footerGroupTitle = document.createElement('div');
        footerGroupTitle.textContent = ui.translate('ID_PRINT_FOOTER');
        footerGroupTitle.className = 'print-modal-option-group-title';
        footerGroup.appendChild(footerGroupTitle);
        var footerLeftWrapper = document.createElement('div');
        footerLeftWrapper.className = 'print-modal-long-input-wrapper';
        footerGroup.appendChild(footerLeftWrapper);
        var footerLeftTitle = document.createElement('span');
        footerLeftTitle.textContent = ui.translate('ID_PRINT_FOOTER_LEFT');
        footerLeftTitle.className = 'print-modal-long-input-title';
        footerLeftWrapper.appendChild(footerLeftTitle);
        var footerLeftInput = document.createElement('input');
        footerLeftInput.className = 'print-modal-long-input';
        footerLeftInput.value = ui.settingsPane.defaultSettings.Settings.Print.FooterLeft;
        footerLeftInput.onblur = this.onInputBlur;
        footerLeftInput.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><FooterLeft>' + footerLeftInput.value + '</FooterLeft></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        footerLeftInput.onfocus = function (e) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
            _this.activeTextInput = footerLeftInput;
        };
        headerRightWrapper.appendChild(headerRightInput);
        footerLeftWrapper.appendChild(footerLeftInput);
        var footerCenterWrapper = document.createElement('div');
        footerCenterWrapper.className = 'print-modal-long-input-wrapper';
        footerGroup.appendChild(footerCenterWrapper);
        var footerCenterTitle = document.createElement('span');
        footerCenterTitle.textContent = ui.translate('ID_PRINT_FOOTER_CENTER');
        footerCenterTitle.className = 'print-modal-long-input-title';
        footerCenterWrapper.appendChild(footerCenterTitle);
        var footerCenterInput = document.createElement('input');
        footerCenterInput.className = 'print-modal-long-input';
        footerCenterInput.value = ui.settingsPane.defaultSettings.Settings.Print.FooterCenter;
        footerCenterInput.onblur = this.onInputBlur;
        footerCenterInput.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><FooterCenter>' + footerCenterInput.value + '</FooterCenter></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        footerCenterInput.onfocus = function (e) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
            _this.activeTextInput = footerCenterInput;
        };
        footerCenterWrapper.appendChild(footerCenterInput);
        var footerRightWrapper = document.createElement('div');
        footerRightWrapper.className = 'print-modal-long-input-wrapper';
        footerGroup.appendChild(footerRightWrapper);
        var footerRightTitle = document.createElement('span');
        footerRightTitle.textContent = ui.translate('ID_PRINT_FOOTER_RIGHT');
        footerRightTitle.className = 'print-modal-long-input-title';
        footerRightWrapper.appendChild(footerRightTitle);
        var footerRightInput = document.createElement('input');
        footerRightInput.className = 'print-modal-long-input';
        footerRightInput.value = ui.settingsPane.defaultSettings.Settings.Print.FooterRight;
        footerRightInput.onblur = this.onInputBlur;
        footerRightInput.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><FooterRight>' + footerRightInput.value + '</FooterRight></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        footerRightInput.onfocus = function (e) {
            app_states_1.appStates.preventGlobalKeyEvents = true;
            _this.activeTextInput = footerRightInput;
        };
        footerRightWrapper.appendChild(footerRightInput);
        var textActionButtonGroup = document.createElement('div');
        textActionButtonGroup.className = 'print-modal-option-group';
        this.textOptionWrapper.appendChild(textActionButtonGroup);
        var textActionButtonGroupTitle = document.createElement('div');
        textActionButtonGroupTitle.textContent = ui.translate('ID_PRINT_ADD_TEXT');
        textActionButtonGroupTitle.className = 'print-modal-option-group-title';
        textActionButtonGroup.appendChild(textActionButtonGroupTitle);
        var textActionButton = document.createElement('button');
        textActionButton.className = 'print-modal-button';
        textActionButton.textContent = ui.translate('ID_PRINT_INSERT_VARIABLE');
        textActionButtonGroup.appendChild(textActionButton);
        var textActionSelect = document.createElement('select');
        textActionSelect.className = 'print-modal-select';
        textActionButtonGroup.appendChild(textActionSelect);
        var textActionFileOption = document.createElement('option');
        textActionFileOption.value = '%file';
        textActionFileOption.selected = true;
        textActionFileOption.text = ui.translate('ID_PRINT_INSERT_VARIABLE_FILE_NAME');
        textActionSelect.appendChild(textActionFileOption);
        var textActionDateOption = document.createElement('option');
        textActionDateOption.value = '%date';
        textActionDateOption.text = ui.translate('ID_PRINT_INSERT_VARIABLE_DATE');
        textActionSelect.appendChild(textActionDateOption);
        var textActionTimeOption = document.createElement('option');
        textActionTimeOption.value = '%time';
        textActionTimeOption.text = ui.translate('ID_PRINT_INSERT_VARIABLE_TIME');
        textActionSelect.appendChild(textActionTimeOption);
        var textActionUser = document.createElement('option');
        textActionUser.value = '%user';
        textActionUser.text = ui.translate('ID_PRINT_INSERT_VARIABLE_USER_NAME');
        textActionSelect.appendChild(textActionUser);
        textActionSelect.onchange = function (e) {
            _this.textModule = textActionSelect.value;
        };
        textActionButton.onclick = function (e) {
            var tempVal = _this.activeTextInput.value;
            tempVal += _this.textModule;
            $(_this.activeTextInput).val(tempVal);
            $(_this.activeTextInput).trigger('change');
        };
        var fontGroup = document.createElement('div');
        fontGroup.className = 'print-modal-option-group';
        this.textOptionWrapper.appendChild(fontGroup);
        var fontGroupTitle = document.createElement('div');
        fontGroupTitle.textContent = ui.translate('ID_PRINT_MODAL_FONT');
        fontGroupTitle.className = 'print-modal-option-group-title';
        fontGroup.appendChild(fontGroupTitle);
        var fontNameWrapper = document.createElement('div');
        fontNameWrapper.className = 'print-modal-long-input-wrapper';
        fontGroup.appendChild(fontNameWrapper);
        var fontNameTitle = document.createElement('div');
        fontNameTitle.className = 'print-modal-long-input-title';
        fontNameTitle.textContent = ui.translate('ID_PRINT_SET_FONT');
        fontNameWrapper.appendChild(fontNameTitle);
        this.fontName = document.createElement('select');
        this.fontName.className = 'print-modal-select';
        this.fontName.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><BannerFontName>' + _this.fontName.value + '</BannerFontName></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        fontNameWrapper.appendChild(this.fontName);
        var xml = '<Call Method="GetFonts"></Call>';
        this.client.command.executeXML(xml);
        this.client.on('GetFonts', function (res) {
            _this.printFontNameEnum = res.Font;
            var fontCount = _this.printFontNameEnum.length;
            for (var i = 0; i < fontCount; i++) {
                var fontNameOptionItem = _this.printFontNameEnum[i];
                var fontNameOption = document.createElement('option');
                fontNameOption.text = fontNameOptionItem;
                fontNameOption.value = fontNameOptionItem;
                if (ui.settingsPane.defaultSettings.Settings.Print.BannerFontName === fontNameOptionItem) {
                    fontNameOption.selected = true;
                }
                _this.fontName.appendChild(fontNameOption);
            }
        });
        var fontSizeWrapper = document.createElement('div');
        fontSizeWrapper.className = 'print-modal-long-input-wrapper';
        fontGroup.appendChild(fontSizeWrapper);
        var fontSizeTitle = document.createElement('div');
        fontSizeTitle.className = 'print-modal-long-input-title';
        fontSizeTitle.textContent = ui.translate('ID_FONT_SIZE');
        fontSizeWrapper.appendChild(fontSizeTitle);
        var fontSize = document.createElement('input');
        fontSize.className = 'print-modal-input';
        fontSize.value = ui.settingsPane.defaultSettings.Settings.Print.BannerFontSize;
        fontSize.onfocus = this.onInputFocus;
        fontSize.onblur = this.onInputBlur;
        fontSize.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><BannerFontSize>' + fontSize.value + '</BannerFontSize></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        fontSizeWrapper.appendChild(fontSize);
        var fontStyleWrapper = document.createElement('div');
        fontStyleWrapper.className = 'print-modal-long-input-wrapper';
        fontGroup.appendChild(fontStyleWrapper);
        var fontStyleTitle = document.createElement('div');
        fontStyleTitle.className = 'print-modal-long-input-title';
        fontStyleTitle.textContent = ui.translate('ID_PRINT_MODAL_FONT_STYLE');
        fontStyleWrapper.appendChild(fontStyleTitle);
        var fontStyle = document.createElement('select');
        fontStyle.className = 'print-modal-select';
        var fontStyleCount = this.printFontStyleEnum.length;
        for (var i = 0; i < fontStyleCount; i++) {
            var fontStyleOptionItem = this.printFontStyleEnum[i];
            var fontStyleOption = document.createElement('option');
            fontStyleOption.text = ui.translate(fontStyleOptionItem.langId);
            fontStyleOption.value = fontStyleOptionItem.value;
            if (ui.settingsPane.defaultSettings.Settings.Print.BannerFontStyle === fontStyleOptionItem.value) {
                fontStyleOption.selected = true;
            }
            fontStyle.appendChild(fontStyleOption);
        }
        fontStyle.onchange = function (e) {
            var xml = '<Call Method="SetSettings"><Settings><Print><BannerFontStyle>' + fontStyle.value + '</BannerFontStyle></Print></Settings></Call>';
            _this.client.command.executeXML(xml);
        };
        fontStyleWrapper.appendChild(fontStyle);
        var fontColorWrapper = document.createElement('div');
        fontColorWrapper.className = 'print-modal-long-input-wrapper';
        fontGroup.appendChild(fontColorWrapper);
        var fontColorTitle = document.createElement('div');
        fontColorTitle.className = 'print-modal-long-input-title';
        fontColorTitle.textContent = ui.translate('ID_TEXT_COLOR');
        fontColorTitle.style.marginBottom = '5px';
        fontColorWrapper.appendChild(fontColorTitle);
        this.fontColor = new color_picker_1.ModalColorPicker(fontColorWrapper, this.setFontColorSetting);
        this.fontColor.setColor(ui.settingsPane.defaultSettings.Settings.Print.BannerFontColor);
    };
    PrintModal.prototype.setFontColorSetting = function (color) {
        var xml = '<Call Method="SetSettings"><Settings><Print><BannerFontColor>' + color + '</BannerFontColor></Print></Settings></Call>';
        this.client.command.executeXML(xml);
    };
    PrintModal.prototype.setWhiteBackgroundSetting = function (state) {
        var xml = '<Call Method="SetSettings"><Settings><Print><WhiteBackground>' + state + '</WhiteBackground></Print></Settings></Call>';
        this.client.command.executeXML(xml);
    };
    PrintModal.prototype.setLineWidthEnabledSetting = function (state) {
        var xml = '<Call Method="SetSettings"><Settings><Print><LineWidthEnabled>' + state + '</LineWidthEnabled></Print></Settings></Call>';
        this.client.command.executeXML(xml);
    };
    PrintModal.prototype.setTiledSetting = function (state) {
        var xml = '<Call Method="SetSettings"><Settings><Print>';
        xml += '<Tiled>' + state + '</Tiled>';
        xml += '</Print></Settings></Call>';
        this.client.command.executeXML(xml);
    };
    PrintModal.prototype.fillOptions = function (template) {
        this.printRangeEnum = [];
        this.printScaleEnum = [];
        this.printOrientationEnum = [];
        this.printLineWidthUnit = [];
        var enums = template.Source.Template.Enum;
        var range = enums[0].Options.Option;
        var rangeLength = range.length;
        for (var r = 0; r < rangeLength; r++) {
            var rangeOpt = {
                value: range[r].Value,
                langId: range[r].DisplayName
            };
            this.printRangeEnum.push(rangeOpt);
        }
        var scale = enums[1].Options.Option;
        var scaleLength = scale.length;
        for (var s = 0; s < scaleLength; s++) {
            var scaleOpt = {
                value: scale[s].Value,
                langId: scale[s].DisplayName
            };
            this.printScaleEnum.push(scaleOpt);
        }
        var orientation = enums[2].Options.Option;
        var orientationLength = orientation.length;
        for (var o = 0; o < orientationLength; o++) {
            var orientationOpt = {
                value: orientation[o].Value,
                langId: orientation[o].DisplayName
            };
            this.printOrientationEnum.push(orientationOpt);
        }
        var unit = enums[3].Options.Option;
        var unitLength = unit.length;
        for (var u = 0; u < unitLength; u++) {
            var unitOpt = {
                value: unit[u].Value,
                langId: unit[u].DisplayName
            };
            this.printLineWidthUnit.push(unitOpt);
        }
    };
    PrintModal.prototype.resize = function () {
    };
    PrintModal.prototype.hide = function () {
        window.removeEventListener('resize', this.resize);
        document.body.removeEventListener('mousedown', this.detectOutsideClick);
        document.body.removeEventListener('keyup', this.detectEscPressed);
        this.isOpen = false;
        $(this.modalWrapper).remove();
    };
    PrintModal.prototype.detectOutsideClick = function (e) {
        if (!(e.target === this.modalWrapper || this.modalWrapper.contains(e.target) || $('.wv-color-picker-popup').find(e.target).length > 0)) {
            this.submit();
        }
    };
    PrintModal.prototype.detectEscPressed = function (e) {
        e.preventDefault();
        e.stopPropagation();
        if (e.keyCode === 27) {
            this.submit();
        }
    };
    PrintModal.prototype.submit = function () {
        this.hide();
    };
    return PrintModal;
}());
exports.PrintModal = PrintModal;


/***/ }),
/* 93 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var custom_palette_1 = __webpack_require__(36);
var tinycolor = __webpack_require__(16);
var ModalColorPicker = (function () {
    function ModalColorPicker(parentEl, callback) {
        var _this = this;
        this.isDefaultSet = false;
        this.parentEl = parentEl;
        this.callback = callback;
        this.colorpicker = document.createElement('span');
        this.colorpicker.classList.add('modal-colorpicker');
        this.parentEl.appendChild(this.colorpicker);
        this.colorpicker.addEventListener('click', function (ev) {
            _this.openPalette();
        }, false);
    }
    ModalColorPicker.prototype.openPalette = function () {
        var _this = this;
        var activeColor = this.colorpicker.dataset['lastPickedColor'];
        this.palette = new custom_palette_1.CustomPalette(activeColor, this.showAlpha);
        this.palette.on('customColorChosen', function (color) { return _this.updateElementState(color); });
    };
    ModalColorPicker.prototype.updateElementState = function (color) {
        this.colorpicker.dataset['lastPickedColor'] = color;
        this.colorpicker.style.backgroundColor = color;
        var hashHex = tinycolor(color).toHexString();
        this.color = hashHex;
        this.callback(this.color);
    };
    ModalColorPicker.prototype.setColor = function (hexColor) {
        var RGBAColor = hexToRgba(hexColor);
        this.alpha = RGBAColor.a;
        var cssColor;
        if (this.showAlpha) {
            cssColor = "rgba(" + RGBAColor.r + ", " + RGBAColor.g + ", " + RGBAColor.b + ", " + this.alpha + ")";
        }
        else {
            cssColor = "rgb(" + RGBAColor.r + ", " + RGBAColor.g + ", " + RGBAColor.b + ")";
        }
        if (!this.isDefaultSet) {
            this.colorpicker.dataset['defaultColor'] = cssColor;
            this.isDefaultSet = true;
        }
        this.colorpicker.dataset['lastPickedColor'] = cssColor;
        this.colorpicker.style.backgroundColor = cssColor;
    };
    return ModalColorPicker;
}());
exports.ModalColorPicker = ModalColorPicker;
function hexToRgba(hex) {
    var bigint, r, g, b, a;
    var aRgb;
    if (hex[0] == '#') {
        aRgb = hex.substr(1);
    }
    else {
        aRgb = hex.substr(2);
    }
    bigint = parseInt(aRgb, 16);
    r = (bigint >> 16) & 255;
    g = (bigint >> 8) & 255;
    b = bigint & 255;
    var rgb = r + "," + g + "," + b;
    a = ((bigint >> 24) & 255) / 255;
    return {
        a: a,
        r: r,
        g: g,
        b: b
    };
}


/***/ }),
/* 94 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ui = __webpack_require__(0);
var app_states_1 = __webpack_require__(4);
var RadioButtonGroup = (function () {
    function RadioButtonGroup(parentEl, titleId) {
        this.buttons = [];
        this.newButtonIndex = 0;
        this.parentEl = parentEl;
        this.titleId = titleId;
        this.groupWrapper = document.createElement('div');
        this.groupWrapper.className = 'radio-button-group';
        this.parentEl.appendChild(this.groupWrapper);
        this.titleEl = document.createElement('div');
        this.titleEl.className = 'radio-button-group-title';
        this.titleEl.textContent = ui.translate(titleId);
        this.groupWrapper.appendChild(this.titleEl);
        this.buttonGroup = document.createElement('div');
        this.buttonGroup.className = 'radio-button-group-content';
        this.groupWrapper.appendChild(this.buttonGroup);
    }
    RadioButtonGroup.prototype.toggleStates = function (index) {
        var length = this.buttons.length;
        for (var i = 0; i < length; i++) {
            if (i !== index) {
                this.buttons[i].setState(false);
            }
        }
    };
    RadioButtonGroup.prototype.setStateByIndex = function (index, state) {
        if (index < this.buttons.length) {
            this.buttons[index].setState(true);
        }
    };
    RadioButtonGroup.prototype.addButton = function (item, callback) {
        var button = new RadioButton(this.buttonGroup, item, this, this.newButtonIndex, callback);
        this.buttons.push(button);
        button.setState(item.initialState);
        this.newButtonIndex++;
    };
    RadioButtonGroup.prototype.setTitle = function () {
        var length = this.buttons.length;
        for (var i = 0; i < length; i++) {
            this.buttons[i].setTitle();
        }
        this.titleEl.textContent = ui.translate(this.titleId);
    };
    return RadioButtonGroup;
}());
exports.RadioButtonGroup = RadioButtonGroup;
var RadioButton = (function () {
    function RadioButton(parentEl, item, group, index, callback) {
        var _this = this;
        this.parentEl = parentEl;
        this.item = item;
        this.group = group;
        this.titleId = item.langId;
        this.index = index;
        this.callback = callback;
        this.wrapperEl = document.createElement('div');
        this.wrapperEl.className = 'radio-button-wrapper';
        this.parentEl.appendChild(this.wrapperEl);
        var outerCircle = document.createElement('div');
        outerCircle.className = 'radio-button-container';
        this.wrapperEl.appendChild(outerCircle);
        this.innerCircle = document.createElement('div');
        this.innerCircle.className = 'radio-button-fill';
        outerCircle.appendChild(this.innerCircle);
        this.titleEl = document.createElement('div');
        this.titleEl.className = 'radio-button-title';
        this.titleEl.textContent = ui.translate(this.titleId);
        this.wrapperEl.appendChild(this.titleEl);
        outerCircle.onclick = function (e) {
            if (!_this.state) {
                if (_this.callback) {
                    _this.callback();
                }
                _this.setState(true);
            }
        };
        outerCircle.onmouseenter = function (e) {
            _this.innerCircle.style.backgroundColor = app_states_1.appStates.mainColor;
        };
        outerCircle.onmouseleave = function (e) {
            if (!_this.state) {
                _this.innerCircle.style.backgroundColor = 'white';
            }
        };
    }
    RadioButton.prototype.setState = function (state) {
        this.state = state;
        if (state) {
            this.innerCircle.style.backgroundColor = app_states_1.appStates.mainColor;
            this.group.toggleStates(this.index);
        }
        else {
            this.innerCircle.style.backgroundColor = 'white';
        }
    };
    RadioButton.prototype.setTitle = function () {
        this.titleEl.textContent = ui.translate(this.titleId);
    };
    return RadioButton;
}());


/***/ }),
/* 95 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ProgressBar = (function () {
    function ProgressBar(id, indeterminate, type, anchorEl) {
        this.id = id;
        this.indeterminate = indeterminate;
        this.type = type;
        this.anchorEl = anchorEl;
        this.wrapperEl = document.createElement('div');
        this.wrapperEl.className = 'progress-bar-wrapper';
        this.anchorEl.appendChild(this.wrapperEl);
        this.titleEl = document.createElement('span');
        this.titleEl.textContent = type;
        this.titleEl.className = 'progress-bar-title';
        this.wrapperEl.appendChild(this.titleEl);
        this.barEl = document.createElement('span');
        this.barEl.className = "progress-bar";
        if (!this.indeterminate) {
            this.textEl = document.createElement('span');
            this.textEl.className = 'progress-bar-text';
            this.textEl.textContent = '0%';
            this.barEl.appendChild(this.textEl);
        }
        this.wrapperEl.appendChild(this.barEl);
        this.progressEl = document.createElement('div');
        this.progressEl.className = this.indeterminate ? 'progress-indeterminate' : 'progress';
        this.barEl.appendChild(this.progressEl);
        this.wrapperEl.appendChild(this.barEl);
    }
    ProgressBar.prototype.setProgress = function (number) {
        this.progressEl.style.width = number + '%';
        this.textEl.textContent = number + '%';
    };
    return ProgressBar;
}());
exports.ProgressBar = ProgressBar;


/***/ }),
/* 96 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var progress_bar_1 = __webpack_require__(95);
var ui = __webpack_require__(0);
var ProgressContainer = (function () {
    function ProgressContainer(anchorEl, client) {
        var _this = this;
        this.isOpen = false;
        this.progressBars = [];
        this.isBlocked = false;
        this.anchorEl = anchorEl;
        this.anchorEl.onclick = function (e) {
            if (_this.isOpen) {
                _this.close();
            }
            else {
                _this.open();
            }
        };
        var wrapperEl = document.createElement('div');
        wrapperEl.className = 'progress-container-wrapper';
        this.wrapperEl = wrapperEl;
        this.anchorEl.appendChild(this.wrapperEl);
        var cancelWrapper = document.createElement('div');
        cancelWrapper.className = 'progress-bar-wrapper';
        this.wrapperEl.appendChild(cancelWrapper);
        var cancelTitleEl = document.createElement('span');
        cancelTitleEl.textContent = 'Cancel all';
        cancelTitleEl.className = 'progress-bar-title';
        cancelTitleEl.style.fontWeight = '900';
        cancelWrapper.appendChild(cancelTitleEl);
        var cancelIcon = document.createElement('span');
        cancelIcon.className = 'fas fa-ban progress-cancel-icon';
        cancelIcon.onclick = function (e) {
            var xml = '<Call Method="StopComputation"></Call>';
            client.command.executeXML(xml);
        };
        cancelWrapper.appendChild(cancelIcon);
        this.close();
        this.stop();
    }
    ProgressContainer.prototype.open = function () {
        this.isOpen = true;
        $(this.wrapperEl).show();
    };
    ProgressContainer.prototype.close = function () {
        this.isOpen = false;
        $(this.wrapperEl).hide();
    };
    ProgressContainer.prototype.start = function () {
        $(this.anchorEl).show();
    };
    ProgressContainer.prototype.stop = function () {
        $(this.anchorEl).hide();
    };
    ProgressContainer.prototype.stopBarById = function (id) {
        if (this.isBlocked) {
            this.isBlocked = false;
            ui.unblockUI();
        }
        var index = this.getBarIndexById(id);
        if (index !== -1) {
            $(this.progressBars[index].wrapperEl).remove();
            this.progressBars.splice(index, 1);
        }
        if (this.progressBars.length === 0) {
            this.close();
            this.stop();
        }
    };
    ProgressContainer.prototype.stepBarById = function (id, progress) {
        var index = this.getBarIndexById(id);
        if (index !== -1) {
            var progressInFloat = parseFloat(progress);
            var progressRounded = Math.round(progressInFloat);
            var bar = this.progressBars[index];
            bar.setProgress(progressRounded.toString());
        }
    };
    ProgressContainer.prototype.getBarIndexById = function (id) {
        for (var i = 0; i < this.progressBars.length; i++) {
            if (this.progressBars[i].id === id) {
                return i;
            }
        }
        return -1;
    };
    ProgressContainer.prototype.addBar = function (id, indeterminate, type, blocking) {
        if (blocking) {
            this.isBlocked = true;
            ui.blockUI(type);
        }
        else {
            var pgBar = new progress_bar_1.ProgressBar(id, indeterminate, type, this.wrapperEl);
            this.progressBars.push(pgBar);
        }
    };
    return ProgressContainer;
}());
exports.ProgressContainer = ProgressContainer;


/***/ }),
/* 97 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var _1 = __webpack_require__(2);
var events_1 = __webpack_require__(19);
var widgets_1 = __webpack_require__(11);
var ui = __webpack_require__(0);
if (!String.prototype['startsWith']) {
    String.prototype['startsWith'] = function (searchString, position) {
        if (position === void 0) { position = 0; }
        position = position || 0;
        return this.substr(position, searchString.length) === searchString;
    };
}
if (!String.prototype['includes']) {
    String.prototype['includes'] = function (search, start) {
        if (start === void 0) { start = 0; }
        if (typeof start !== 'number') {
            start = 0;
        }
        if (start + search.length > this.length) {
            return false;
        }
        else {
            return this.indexOf(search, start) !== -1;
        }
    };
}
var PaneAdapter = (function (_super) {
    __extends(PaneAdapter, _super);
    function PaneAdapter(target) {
        var _this = _super.call(this) || this;
        _this.items = {};
        _this.settingItems = [];
        _this.filterString = '';
        _this.toCollapse = [];
        _this.$target = $(target);
        _this.items = {};
        return _this;
    }
    PaneAdapter.prototype.get = function (path) {
        var finding = this.items[path];
        if (finding) {
            return finding;
        }
        else {
            return undefined;
        }
    };
    PaneAdapter.prototype.traverse__ = function (item, callback) {
        for (var _i = 0, _a = item.children; _i < _a.length; _i++) {
            var child = _a[_i];
            this.traverse__(child, callback);
        }
        callback(item);
    };
    PaneAdapter.prototype.traverseReverse = function (callback) {
        this.traverse__(this.root, callback);
    };
    PaneAdapter.prototype.traverse = function (callback) {
        var stack = [];
        var current;
        for (var i = this.root.children.length; i-- > 0;) {
            stack.push(this.root.children[i]);
        }
        while (stack.length) {
            current = stack.pop();
            callback(current);
            for (var i = current.children.length; i-- > 0;) {
                stack.push(current.children[i]);
            }
        }
    };
    PaneAdapter.prototype.buildItem__ = function (itemTemplate, keyName, parent) {
        var shouldTerminate = false;
        var displayName = itemTemplate['DisplayName'] || '';
        var item = new _1.Item(this, displayName);
        if (itemTemplate['Setting']) {
            item.path = itemTemplate['Setting'].split('.');
            item.triggeredBySetting = true;
            this.settingItems.push(item);
        }
        else if (itemTemplate['EventPath']) {
            item.path = itemTemplate['EventPath'].split('.');
            item.triggeredByEvent = true;
        }
        else if (!parent && itemTemplate['Name']) {
            item.path = [itemTemplate['Name']];
        }
        else if (parent && itemTemplate['Name']) {
            item.path = parent.path.concat([itemTemplate['Name']]);
        }
        if (itemTemplate['Tooltip']) {
            item.tooltip = itemTemplate['Tooltip'];
        }
        var shouldHidden = false;
        if (itemTemplate['IsHidden'] === 'true') {
            shouldHidden = true;
        }
        if (itemTemplate['Prefix']) {
            item.prefix = itemTemplate['Prefix'];
        }
        if (itemTemplate['UId']) {
            item.id = itemTemplate['UId'];
        }
        switch (keyName) {
            case 'Template':
            case 'Group': {
                item.visual = new _1.Folder(item);
                if (itemTemplate['IsCollapsed'] === 'true') {
                    this.toCollapse.push(item.visual);
                }
                break;
            }
            case 'Enum': {
                var select = new _1.Select(item);
                var options = itemTemplate['Options']['Option'];
                if (typeof options !== 'undefined') {
                    var displays_1 = [];
                    var optionValues_1 = [];
                    options.forEach(function (val) {
                        displays_1.push(val['DisplayName']);
                        optionValues_1.push(val['Value']);
                    });
                    if (item.id === 'UID_PRESETS') {
                        displays_1.push(ui.translate('ID_WALLTHICKNESS_PRESET_USERDEFINED'));
                        optionValues_1.push('USERDEF');
                    }
                    select.addOptions(displays_1, optionValues_1);
                }
                item.visual = select;
                shouldTerminate = true;
                break;
            }
            case 'Bool': {
                item.visual = new _1.Checkbox(item);
                break;
            }
            case 'Color': {
                var colorPicker = new _1.ColorPicker(item);
                if (itemTemplate['Mode'] === 'RGB') {
                    colorPicker.showAlpha = false;
                }
                else {
                    colorPicker.showAlpha = true;
                }
                item.visual = colorPicker;
                break;
            }
            case 'Float':
            case 'Integer':
            case 'Text': {
                item.inputType = keyName;
                if (itemTemplate.Suffix) {
                    item.suffix = itemTemplate.Suffix;
                }
                if (itemTemplate.IsReadOnly === 'true') {
                    item.visual = new _1.TextBox(item);
                }
                else {
                    if (item.path.indexOf('AttributesToDisplay') !== -1) {
                        item.visual = new widgets_1.MultiBox(item);
                    }
                    else {
                        item.visual = new _1.Input(item);
                    }
                }
                if (itemTemplate.DisplayType === 'Slider') {
                    item.visual = new _1.Slider(item);
                }
                break;
            }
            case 'EnumFlag': {
                var flag = new _1.Flag(item);
                var options = itemTemplate['Options']['Option'];
                var flagOptions_1 = [];
                options.forEach(function (val) {
                    var option = {
                        displayName: val['DisplayName'],
                        value: val['Value']
                    };
                    flagOptions_1.push(option);
                });
                flag.addOptions(flagOptions_1);
                item.visual = flag;
                shouldTerminate = true;
                break;
            }
            case 'Button': {
                item.id = itemTemplate['OnClick'];
                item.visual = new _1.Button(item);
                break;
            }
            case 'KeyValue': {
                item.visual = new _1.KeyValue(item);
                break;
            }
            default:
                shouldTerminate = true;
        }
        item.readOnly = (itemTemplate.IsReadOnly === 'true') ? true : false;
        if (parent) {
            parent.children.push(item);
            item.parent = parent;
            if (parent.isHiddenAttr) {
                shouldHidden = true;
            }
            if (this.items[item.path.join('.')]) {
                this.items[item.path.join('.')] = item;
            }
            else {
                this.items[item.path.join('.')] = item;
            }
        }
        item.isHiddenAttr = shouldHidden;
        return [item, shouldTerminate];
    };
    PaneAdapter.prototype.fromTemplate__ = function (template, keyName, parent) {
        if (typeof template === 'string') {
            return;
        }
        var _a = this.buildItem__(template, keyName, parent), item = _a[0], shouldTerminate = _a[1];
        if (shouldTerminate) {
            return;
        }
        var arrayIndices = {};
        for (var ik = 0; ik < template['__ordinal__'].length; ik++) {
            var key = template['__ordinal__'][ik];
            var itemTemplate = template[key];
            if (Array.isArray(itemTemplate)) {
                if (typeof arrayIndices[key] === 'undefined') {
                    arrayIndices[key] = 0;
                    itemTemplate = itemTemplate[arrayIndices[key]];
                    this.fromTemplate__(itemTemplate, key, item);
                }
                else {
                    arrayIndices[key] += 1;
                    itemTemplate = itemTemplate[arrayIndices[key]];
                    this.fromTemplate__(itemTemplate, key, item);
                }
            }
            else {
                this.fromTemplate__(itemTemplate, key, item);
            }
        }
        return item;
    };
    PaneAdapter.prototype.fromTemplate = function (settingsTemplate, appendRoot) {
        var _this = this;
        if (appendRoot === void 0) { appendRoot = false; }
        this.$target.children().remove();
        this.$target.append('<tr class="pane-item"><td/><td/></tr>');
        this.root = this.fromTemplate__(settingsTemplate, 'Group');
        if (appendRoot) {
            this.root.indent = 0;
            this.root.visual.setText(this.root.text);
            this.root.visual.constructHTML(this.root.el);
            this.$target.append(this.root.el);
        }
        this.traverse(function (item) {
            if (item.isHiddenAttr) {
                return;
            }
            item.indent = item.parent.indent + 1;
            item.visual.setText(item.text);
            if (item.tooltip) {
                item.visual.setTooltip(item.tooltip);
            }
            item.visual.constructHTML(item.el);
            if (item.parent.visual instanceof _1.KeyValue) {
                item.parent.visual.addEntry(item.visual);
            }
            else {
                _this.$target.append(item.el);
            }
        });
        if (this.toCollapse.length > 0) {
            this.toCollapse.forEach(function (f) { return f.collapse(true); });
        }
    };
    PaneAdapter.prototype.resetVisibility = function () {
        var _this = this;
        var itemKeys = Object.keys(this.items);
        itemKeys.forEach(function (itemKey) {
            var item = _this.items[itemKey];
            item.visual.highlightSearchString(undefined);
            if (item.visualStatus == 'hidden') {
                item.el.style.display = 'none';
            }
            else {
                item.el.style.display = '';
            }
        });
    };
    PaneAdapter.prototype.filter = function (searchPhrase) {
        var _this = this;
        searchPhrase = searchPhrase.toLowerCase();
        var itemKeys = Object.keys(this.items);
        if (!searchPhrase) {
            this.resetVisibility();
            return;
        }
        this.traverse(function (item) {
            var text = item.text.toLowerCase();
            if (!(item.visual instanceof _1.Folder)) {
                if (!text.includes(searchPhrase)) {
                    item.el.style.display = 'none';
                    item.visual.highlightSearchString(undefined);
                }
                else {
                    item.visual.highlightSearchString(searchPhrase);
                    item.el.style.display = '';
                }
            }
        });
        this.traverseReverse(function (item) {
            var text = item.text.toLowerCase();
            if (item.visual instanceof _1.Folder) {
                var children = item.children;
                var allHidden = children.every(function (child) {
                    return child.el.style.display === 'none';
                });
                if (allHidden && text.indexOf(searchPhrase) === -1 && !item.id) {
                    item.el.style.display = 'none';
                    item.visual.highlightSearchString(undefined);
                }
                else {
                    if (text.indexOf(searchPhrase) !== -1) {
                        item.el.style.display = '';
                        item.visual.highlightSearchString(searchPhrase);
                        if (item.indent !== 1 || allHidden) {
                            _this.traverse__(item, function (child) {
                                child.el.style.display = '';
                            });
                        }
                    }
                    else if (text.indexOf(searchPhrase) === -1 && allHidden && item.id) {
                        item.el.style.display = 'none';
                        item.visual.highlightSearchString(undefined);
                    }
                    else {
                        item.el.style.display = '';
                        item.visual.highlightSearchString(undefined);
                    }
                }
            }
        });
    };
    PaneAdapter.prototype.updateValues = function (settings) {
        var _this = this;
        var keys = Object.keys(this.items);
        if (settings === undefined) {
            keys.forEach(function (k) {
                var i = _this.items[k];
                i.el.style.display = 'none';
            });
            return;
        }
        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
            var itemIndex = keys_1[_i];
            var item = this.items[itemIndex];
            var visual = item.visual;
            var settingValue = item.indexByPath(settings);
            if ((settingValue === undefined && item.path.indexOf('AttributesToDisplay') === -1 && ((item.triggeredByEvent && item.path[1] !== 'Preset') || (item.triggeredBySetting && item.id !== 'UID_DENSITY_PRESET')))
                || item.isHiddenAttr) {
                item.el.style.display = 'none';
            }
            else {
                if (item.visualStatus !== 'hidden') {
                    if (this.filterString === '') {
                        item.el.style.display = '';
                    }
                }
                if (settingValue) {
                    visual.setUIValue(settingValue);
                }
                else if (!settingValue && item.path.indexOf('AttributesToDisplay') !== -1) {
                    visual.setUIValue('');
                }
                if (settings.Event !== undefined && (settings.Event.Type === 'MeasurementChanged')) {
                    if ((item.id === 'OnAccumulatedLengthComplete' || item.id === 'OnAccumulatedLengthFromSelection') && settings.Event.AccumulatedLength === undefined) {
                        item.el.style.display = 'none';
                    }
                }
            }
        }
        this.traverseReverse(function (item) {
            if (item.visual instanceof _1.Folder) {
                var children = item.children;
                var allMissing = children.every(function (child) {
                    return (child.el.style.display === 'none' && child.visualStatus !== 'hidden')
                        || (item.visualStatus === 'hidden' && child.visualStatus === 'hidden');
                });
                if (allMissing && !item.id) {
                    item.el.style.display = 'none';
                }
                else {
                    item.el.style.display = '';
                }
            }
        });
        if (this.filterString) {
            this.filter(this.filterString);
        }
    };
    PaneAdapter.prototype.getItemById = function (id) {
        var keys = Object.keys(this.items);
        for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {
            var itemIndex = keys_2[_i];
            var item = this.items[itemIndex];
            if (item.id && item.id === id) {
                return item;
            }
        }
    };
    return PaneAdapter;
}(events_1.EventEmitter));
exports.PaneAdapter = PaneAdapter;


/***/ }),
/* 98 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var _1 = __webpack_require__(2);
var Item = (function () {
    function Item(context, text) {
        this.visualStatus = 'shown';
        this.indentClass = 'pane-item-indent-level0';
        this.displayAttr = '';
        this.isHiddenAttr = false;
        this.context = context;
        if (text) {
            this.text = text;
        }
        else {
            this.text = '';
        }
        this.parent = undefined;
        this.children = [];
        this.path = [];
        this.indent = 0;
        this.el = document.createElement('tr');
        this.el.classList.add('pane-item');
    }
    Item.prototype.indexByPath = function (obj) {
        var current = obj;
        if (this.path.length === 0) {
            return undefined;
        }
        for (var i = 0; i < this.path.length; i++) {
            current = current[this.path[i]];
            if (!current) {
                return undefined;
            }
        }
        return current;
    };
    Item.prototype.collapseAll = function (hideSelf) {
        if (this.visual instanceof _1.Folder) {
            var folder = this.visual;
            for (var _i = 0, _a = this.children; _i < _a.length; _i++) {
                var it = _a[_i];
                it.collapseAll(true);
            }
            folder.collapse(true, false);
            if (hideSelf) {
                this.visualStatus = 'hidden';
                this.el.style.display = 'none';
            }
        }
    };
    Item.prototype.expandAll = function () {
        if (this.visual instanceof _1.Folder) {
            var folder = this.visual;
            for (var _i = 0, _a = this.children; _i < _a.length; _i++) {
                var it = _a[_i];
                it.expandAll();
            }
            folder.expand(true, false);
            if (this.text.toLowerCase().indexOf(this.context.filterString) !== -1) {
                this.el.style.display = '';
            }
            this.visualStatus = 'shown';
            if (this.context.filterString !== '' && this.text.toLowerCase().indexOf(this.context.filterString) === -1) {
                if (this.hasVisibleChild()) {
                    this.el.style.display = '';
                }
            }
        }
    };
    Item.prototype.hide = function () {
        if (this.visual instanceof _1.Folder) {
            var folder = this.visual;
            if (folder.expander.classList.contains(_1.Folder.minus)) {
                this.visualStatus = 'hidden';
                this.el.style.display = 'none';
                folder.collapse(false, true);
            }
            else {
                this.visualStatus = 'hidden';
                this.el.style.display = 'none';
            }
            return;
        }
        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {
            var it = _a[_i];
            it.hide();
        }
        this.visualStatus = 'hidden';
        this.el.style.display = 'none';
    };
    Item.prototype.show = function (emit) {
        var _this = this;
        if (this.visual instanceof _1.Folder) {
            var folder = this.visual;
            if (this.text.toLowerCase().indexOf(this.context.filterString) !== -1) {
                this.el.style.display = '';
            }
            else if (this.context.filterString !== '') {
                this.children.map(function (child) {
                    if (child.el.style.display !== 'none') {
                        _this.el.style.display = '';
                    }
                });
            }
            if (folder.expander.classList.contains(_1.Folder.minus)) {
                folder.expand(false, emit);
            }
            this.visualStatus = 'shown';
            return;
        }
        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {
            var it = _a[_i];
            it.show(emit);
        }
        if (this.text.toLowerCase().indexOf(this.context.filterString) !== -1) {
            this.el.style.display = '';
        }
        else if (this.context.filterString !== '' && this.hasMatchingParent(this)) {
            this.el.style.display = '';
        }
        this.visualStatus = 'shown';
    };
    Item.prototype.hasMatchingParent = function (item) {
        if (!item.parent || !item.parent.parent || !item.parent.parent.parent) {
            return false;
        }
        if (item.text.toLowerCase().indexOf(this.context.filterString) !== -1) {
            return true;
        }
        if (item.parent.text.toLowerCase().indexOf(this.context.filterString) !== -1) {
            return true;
        }
        else {
            return this.hasMatchingParent(item.parent);
        }
    };
    Item.prototype.hasVisibleChild = function () {
        var hasVisibleChild = false;
        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {
            var it = _a[_i];
            if (it.text.toLowerCase().indexOf(this.context.filterString) !== -1) {
                return true;
            }
            if (it.visual instanceof _1.Folder) {
                hasVisibleChild = this.recHasVisibleChild(it);
            }
        }
        return hasVisibleChild;
    };
    Item.prototype.recHasVisibleChild = function (item) {
        for (var _i = 0, _a = item.children; _i < _a.length; _i++) {
            var it = _a[_i];
            if (it.text.toLowerCase().indexOf(this.context.filterString) !== -1) {
                return true;
            }
            else if (it.visual instanceof _1.Folder) {
                return this.recHasVisibleChild(it);
            }
        }
    };
    return Item;
}());
exports.Item = Item;


/***/ }),
/* 99 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.internalDisabledGroups = {
    ID_RIBBON_VECTOR_EXPORT: false,
    ID_RIBBON_FILTER: true,
    ID_RIBBON_BILL_OF_MATERIAL: true,
    ID_RIBBON_STATISTICS: true,
    ID_RIBBON_COMPUTE: true,
    ID_RIBBON_SCREENSHOT: true,
    ID_RIBBON_PROJECTED_AREA: true,
    ID_RIBBON_CLASH_DETECTION: true,
    ID_RIBBON_BOUNDARY_CONDITION: true,
    ID_RIBBON_ALIGNING_MOVE: true,
    ID_RIBBON_ALIGNING_ROTATE: true,
    ID_RIBBON_ALIGNING_MOVE_ROTATE: true,
    ID_RIBBON_MODEL_ALIGNING: false,
    ID_RIBBON_NODE: false,
    ID_RIBBON_ROTATE: false,
    ID_RIBBON_HEAT_MAP: true,
    Extras: true
};


/***/ }),
/* 100 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var app_settings_1 = __webpack_require__(9);
var app_states_1 = __webpack_require__(4);
var w = __webpack_require__(10);
var events = __webpack_require__(19);
var menu = __webpack_require__(13);
var ui = __webpack_require__(0);
var disabled_widgets_1 = __webpack_require__(99);
var widget_1 = __webpack_require__(10);
var tooltip_1 = __webpack_require__(8);
var SVG_NS = 'http://www.w3.org/2000/svg';
var XLINK_NS = 'http://www.w3.org/1999/xlink';
var VSRibbon = (function (_super) {
    __extends(VSRibbon, _super);
    function VSRibbon(el) {
        var _this = _super.call(this) || this;
        _this.lastSliderPos = '0';
        _this.classes = {};
        _this.exposedGroupIDs = {};
        _this.toggleVisibility = function (forceMaximise, resize) {
            if (resize === void 0) { resize = true; }
            _this.ribbonBody.style.position = 'relative';
            _this.ribbonBody.style.top = '';
            _this.ribbonBody.style.left = '';
            if (app_states_1.appStates.ribbonVis === true && forceMaximise === false) {
                _this.ribbonBody.style.display = 'none';
                _this.header.style.borderBottom = '1px solid #c3c3c3';
                _this.toggleVisibilityButton.classList.remove('fa-chevron-down');
                _this.toggleVisibilityButton.classList.add('fa-chevron-right');
                app_states_1.appStates.ribbonVis = false;
                if (resize) {
                    ui.resizeHandler();
                }
            }
            else {
                _this.ribbonBody.style.display = '';
                _this.header.style.borderBottom = 'none';
                _this.toggleVisibilityButton.classList.remove('fa-chevron-right');
                _this.toggleVisibilityButton.classList.add('fa-chevron-down');
                app_states_1.appStates.ribbonVis = true;
                document.removeEventListener('click', _this.hideRibbonBody);
                if (resize) {
                    ui.resizeHandler();
                }
            }
        };
        _this.hideRibbonBody = function (event) {
            var clickTarget = event.target;
            var isDescendantOfRibbon = isDescendant(target, clickTarget)
                || isDescendant(_this.ribbonBody, clickTarget);
            if (!isDescendantOfRibbon) {
                _this.ribbonBody.style.display = 'none';
                document.removeEventListener('click', _this.hideRibbonBody);
            }
        };
        _this.closeAboutDialog = function (e) {
            if ($(e.target).hasClass('ribbon-about-button')) {
                return;
            }
            var dialog = document.getElementById('aboutDialog');
            var versionWrapper = document.getElementsByClassName('ribbon-about-version-wrapper')[0];
            if ((!versionWrapper.contains(e.target) && e.type === 'click') || (e.type === 'keyup' && e.keyCode === 27)) {
                _this.aboutOpen = false;
                document.body.removeChild(dialog);
                $(document).off('click', _this.closeAboutDialog);
                $(document).off('keyup', _this.closeAboutDialog);
            }
        };
        target = el;
        _this.aboutOpen = false;
        ribbonExpandables = document.createElement('div');
        ribbonExpandables.id = app_settings_1.settings.ribbon.expandablesContainerId;
        ribbonDropdowns = document.createElement('div');
        ribbonDropdowns.id = app_settings_1.settings.ribbon.dropdownsContainerId;
        target.appendChild(ribbonExpandables);
        target.appendChild(ribbonDropdowns);
        _this.header = document.createElement('ul');
        _this.header.classList.add('ribbon-header');
        _this.ribbonBody = document.createElement('div');
        _this.ribbonBody.classList.add('ribbon-body');
        _this.ribbonBody.style.position = 'relative';
        _this.ribbonBody.style.background = 'white';
        _this.ribbonBody.style.height = app_settings_1.settings.ribbon.tabPageHeight + 'px';
        _this.toggleVisibilityButton = document.createElement('div');
        _this.toggleVisibilityButton.id = 'wv-ribbon-toggle-ribbon';
        _this.toggleVisibilityButton.className = 'fa fa-chevron-down';
        target.appendChild(_this.toggleVisibilityButton);
        _this.toggleStreaming = document.createElement('div');
        _this.toggleStreaming.id = 'wv-ribbon-toggle-streaming';
        _this.toggleStreaming.className = 'fa fa-image';
        _this.toggleStreaming.style.right = '30px';
        _this.toggleStreaming.style.top = '5px';
        _this.wsIndicator = document.createElement('div');
        _this.wsIndicator.className = 'wv-ribbon-wsindicator';
        _this.wsIndicator.addEventListener('click', function () {
            if ($(_this.wsIndicator).css('fill') === 'red') {
                window.location.reload();
            }
        });
        _this.wsIcon = document.createElementNS(SVG_NS, 'svg');
        _this.wsIcon.setAttribute('class', 'ws_indicator');
        var useIcon = document.createElementNS(SVG_NS, 'use');
        useIcon.setAttributeNS(XLINK_NS, 'href', '#cloud-connection-2');
        _this.wsIcon.appendChild(useIcon);
        _this.wsIndicator.appendChild(_this.wsIcon);
        target.appendChild(_this.wsIndicator);
        var showMobileIcon = true;
        try {
            if (_KISTERSWebViewerHideMobile === true) {
                showMobileIcon = false;
            }
        }
        catch (e) { }
        if (showMobileIcon) {
            _this.toggleMobile = document.createElement('div');
            _this.toggleMobile.className = "fa fa-mobile-alt wv-mobile-switch";
            $(_this.toggleMobile).off('click').click(function (ev) {
                localStorage.setItem('WVUseMobile', 'true');
                localStorage.setItem('WVParkedSession', app_states_1.appStates.session);
                localStorage.setItem('WVFileType', app_states_1.appStates.fileType);
                localStorage.setItem('WVVisShareSpec', app_states_1.appStates.VisShareSpec);
                localStorage.setItem('WVFileName', app_states_1.appStates.fileName);
                var call = '<Request Type="Park"><Timeout>0</Timeout></Request>';
                vsClient.sessionInfo.socket.send(call);
                setTimeout(function () {
                    window.location.reload();
                }, 100);
            });
            target.appendChild(_this.toggleMobile);
            var mobileTooltip = new tooltip_1.WVTooltip(_this.toggleMobile);
            mobileTooltip.setOrientation('bottom');
            mobileTooltip.setTitle('Mobile UI');
        }
        var progressIconWrapper = document.createElement('div');
        progressIconWrapper.className = "wv-progress-bar-icon-wrapper";
        var progressIcon = document.createElement('span');
        progressIcon.className = 'fal fa-spinner-third fa-spin wv-progress-bar-icon';
        target.appendChild(progressIconWrapper);
        ui.initProgressContainer(progressIconWrapper);
        progressIconWrapper.appendChild(progressIcon);
        _this.languageSwitch = _this._buildLangSwitch();
        target.appendChild(_this.languageSwitch);
        _this.aboutDialog = _this._buildAboutDialog();
        target.appendChild(_this.aboutDialog);
        var ribbonVis = localStorage.getItem('WVRibbonVis');
        if (ribbonVis === null) {
            try {
                localStorage.setItem('WVRibbonVis', _RibbonMenuVisibility.toString());
                app_states_1.appStates.ribbonVis = true;
                if (!_RibbonMenuVisibility) {
                    _this.toggleVisibility(false, false);
                }
            }
            catch (e) {
                localStorage.setItem('WVRibbonVis', 'true');
            }
        }
        else {
            app_states_1.appStates.ribbonVis = true;
            if (ribbonVis === 'false') {
                _this.toggleVisibility(false, false);
            }
        }
        _this.toggleVisibilityButton.addEventListener('click', function () {
            _this.toggleVisibility(false);
            var ribbonVis = localStorage.getItem('WVRibbonVis');
            localStorage.setItem('WVRibbonVis', ribbonVis === 'true' ? 'false' : 'true');
        }, false);
        _this.toggleStreaming.addEventListener('click', function (ev) {
            if (vsClient.getTransferMode() === 'image') {
                if (vsClient.setTransferMode('streaming')) {
                    _this.toggleStreaming.classList.remove('fa-image');
                    _this.toggleStreaming.classList.add('fa-video-camera');
                }
            }
            else if (vsClient.getTransferMode() === 'streaming') {
                if (vsClient.setTransferMode('image')) {
                    _this.toggleStreaming.classList.remove('fa-video-camera');
                    _this.toggleStreaming.classList.add('fa-image');
                }
            }
        });
        vsClient.on('pane-closed', function (paneId) {
            var button = widget_1.findPaneButton(paneId);
            if (button) {
                button.applyHighlight(false);
            }
            var interaction = ui.getInteractionForPane(paneId, app_states_1.appStates.interactionMode);
            if (interaction) {
                ui.deactivateInteraction(vsClient, interaction);
            }
        });
        vsClient.on('ActivateInteraction', function (ev) {
            var mode;
            mode = ev['Interaction'];
            if (mode === 'Flythrough_SelectStartPositionAndDirection') {
                return;
            }
            if (mode) {
                switch (mode) {
                    case 'CuttingPlane_FromPointNormal':
                        mode = 'Section_FromPointNormal';
                        break;
                    case 'CuttingPlane':
                        mode = 'Section';
                        break;
                }
                _this.classes['Interaction'].forEach(function (button) {
                    if (button.event === mode) {
                        button.applyHighlight(true);
                    }
                    if (button instanceof w.DropdownButton) {
                        button.items.forEach(function (item) {
                            if (item.event === mode) {
                                item.applyHighlight(true);
                            }
                        });
                    }
                });
                app_states_1.appStates.interactionMode.push(mode);
                var generalMode = mode.split('_')[0];
                var paneId = void 0;
                var switchToRotate = false;
                switch (generalMode) {
                    case 'Measurement':
                    case 'wv-measurement':
                        paneId = 'wv-measurement';
                        break;
                    case 'Section':
                    case 'wv-section':
                        paneId = 'wv-section';
                        switchToRotate = true;
                        break;
                    case 'Transformation':
                    case 'wv-transform':
                        paneId = 'wv-transform';
                        switchToRotate = true;
                        break;
                    case 'DraftAngle':
                    case 'wv-draftangle':
                        paneId = 'wv-draftangle';
                        break;
                    case 'wv-markup-reduced':
                        paneId = 'wv-markup-reduced';
                        break;
                    case 'Markup':
                    case 'wv-markup':
                        if (mode === 'Markup_Circle' || mode === 'Markup_Freehand' || mode === 'Markup_Rectangle') {
                            switchToRotate = true;
                            paneId = 'wv-markup-reduced';
                        }
                        else {
                            paneId = 'wv-markup';
                        }
                        break;
                    case 'Flythrough':
                        paneId = 'wv-flythrough';
                        switchToRotate = true;
                        vsClient.command.executeXML('<Call Method="GetSceneSettings"></Call>');
                        break;
                    case 'Callout':
                        switchToRotate = true;
                        break;
                    default:
                        paneId = undefined;
                        break;
                }
                if (paneId) {
                    ui.prependPane(paneId);
                }
                if (switchToRotate && (app_states_1.appStates.mouseLeftButtonMode === 'RectZoom' || app_states_1.appStates.mouseLeftButtonMode === 'RectSelect')) {
                    var mouseMode = ui.settingsPane.defaultSettings.Settings.Scene.Mouse.LeftButtonFunction;
                    if (mouseMode === 'RectZoom' || mouseMode === 'RectSelect') {
                        mouseMode = 'Rotate';
                    }
                    var xml = '<Call Method="SetSceneSettings"><Settings><Scene><Mouse><LeftButtonFunction>' + mouseMode + '</LeftButtonFunction></Mouse></Scene></Settings></Call>';
                    vsClient.command.executeXML(xml);
                }
                if (generalMode === 'Measurement') {
                    var event_1 = { Type: 'MeasurementChanged' };
                    if (mode === 'Measurement_EdgeLengthAccumulated') {
                        event_1['AccumulatedLength'] = 0;
                    }
                    vsClient.emit('MeasurementChanged', event_1);
                }
            }
        });
        vsClient.on('DeactivateInteraction', function (ev) {
            var mode;
            mode = ev['Interaction'];
            if (mode === 'Flythrough_SelectStartPositionAndDirection') {
                return;
            }
            switch (mode) {
                case 'CuttingPlane_FromPointNormal':
                    mode = 'Section_FromPointNormal';
                    break;
                case 'CuttingPlane':
                    mode = 'Section';
                    break;
            }
            var generalMode = mode.split('_')[0];
            var paneId;
            var paneTitle;
            switch (generalMode) {
                case 'Measurement':
                    paneId = 'wv-measurement';
                    break;
                case 'Section':
                    paneId = 'wv-section';
                    break;
                case 'Transformation':
                    paneId = 'wv-transform';
                    break;
                case 'DraftAngle':
                    paneId = 'wv-draftangle';
                    break;
                case 'Markup':
                    if (mode === 'Markup_Circle' || mode === 'Markup_Freehand' || mode === 'Markup_Rectangle') {
                        paneId = 'wv-markup-reduced';
                    }
                    else {
                        paneId = 'wv-markup';
                    }
                    break;
                case 'Flythrough':
                    paneId = 'wv-flythrough';
                    break;
                default:
                    paneId = undefined;
                    break;
            }
            if (paneId) {
                paneTitle = undefined;
                ui.closePane(paneId);
            }
            _this.classes['Interaction'].forEach(function (button) {
                if (button.event === mode) {
                    button.applyHighlight(false);
                }
                if (button instanceof w.DropdownButton) {
                    button.items.forEach(function (item) {
                        if (item.event === mode) {
                            item.applyHighlight(false);
                        }
                    });
                }
            });
            app_states_1.appStates.interactionMode.splice(app_states_1.appStates.interactionMode.indexOf(mode), 1);
            for (var i = 0; i < app_states_1.appStates.lastInteractionModes.length; i++) {
                if (app_states_1.appStates.lastInteractionModes[i].split('_')[0] === generalMode) {
                    app_states_1.appStates.lastInteractionModes.splice(i, 1);
                }
            }
            app_states_1.appStates.lastInteractionModes.push(mode);
        });
        return _this;
    }
    VSRibbon.prototype.loadTab = function (initOptions) {
        var tab = new w.Tab(initOptions.langId);
        try {
            if (tab.langId in _Tabs && _Tabs[tab.langId] === false) {
                return;
            }
        }
        catch (e) { }
        for (var _i = 0, _a = initOptions.groups; _i < _a.length; _i++) {
            var groupOption = _a[_i];
            var group = new w.Group(groupOption.langId);
            for (var _b = 0, _c = groupOption.widgets; _b < _c.length; _b++) {
                var widgetOption = _c[_b];
                var widget = void 0;
                if (widgetOption.type === undefined) {
                    widgetOption.type = w.WidgetType.Button;
                }
                switch (widgetOption.type) {
                    case w.WidgetType.Button:
                        widget = group.addButton(widgetOption);
                        break;
                    case w.WidgetType.ButtonLet:
                        widget = group.addButtonlet(widgetOption);
                        break;
                    case w.WidgetType.Dropdown:
                        widget = group.addDropdown(widgetOption);
                        var dropdown = widget;
                        if (widgetOption.dropdownClick) {
                            dropdown.addClick(context, widgetOption.dropdownClick);
                        }
                        break;
                    case w.WidgetType.Input:
                        widget = group.addInput(widgetOption);
                        var input = widget;
                        if (widgetOption.inputCallback) {
                            input.addInputCallback(context, widgetOption.inputCallback);
                        }
                        break;
                    case w.WidgetType.SplittedDropdown:
                        widget = group.addSplittedDropdown(widgetOption);
                        var splittedDropdown = widget;
                        if (widgetOption.splittedDropdownClick) {
                            splittedDropdown.addClick(context, widgetOption.splittedDropdownClick);
                        }
                        break;
                    default:
                        throw "unknown widget type";
                }
                if (widgetOption.interaction) {
                    widget.event = widgetOption.interaction;
                }
                if (widgetOption.ribbonClass) {
                    for (var _d = 0, _e = widgetOption.ribbonClass; _d < _e.length; _d++) {
                        var cls = _e[_d];
                        if (!(cls in this.classes)) {
                            this.classes[cls] = [];
                        }
                        this.classes[cls].push(widget);
                    }
                }
            }
            if (groupOption.groupClick) {
                group.addClick(context, groupOption.groupClick);
            }
            tab.addGroup(group);
        }
        tabs.push(tab);
        return tab;
    };
    VSRibbon.prototype.loadRibbonConfig = function () {
        var _this = this;
        startTab = this.loadTab(menu.startTab);
        documentTab = this.loadTab(menu.documentTab);
        viewTab = this.loadTab(menu.viewTab);
        meausurementTab = this.loadTab(menu.measurementTab);
        analyseTab = this.loadTab(menu.analyseTab);
        transformTab = this.loadTab(menu.transformTab);
        techDocTab = this.loadTab(menu.techDocTab);
        modelTab = this.loadTab(menu.modelTab);
        toolTab = this.loadTab(menu.toolTab);
        try {
            var userTabs = !Array.isArray(UserConfiguration) ? [UserConfiguration] : UserConfiguration;
            userTabs.forEach(function (tab) {
                _this.loadTab(tab);
            });
        }
        catch (e) {
        }
    };
    VSRibbon.prototype.cullRibbonGroups = function () {
        var _this = this;
        tabs.forEach(function (tab) {
            for (var i = tab.groups.length; i--;) {
                var group = tab.groups[i];
                if (group.id in disabled_widgets_1.internalDisabledGroups && disabled_widgets_1.internalDisabledGroups[group.id] === false) {
                    tab.groups.splice(i, 1);
                }
            }
        });
        tabs.forEach(function (tab) {
            tab.groups.forEach(function (group) {
                _this.exposedGroupIDs[group.id] = true;
            });
        });
        tabs.forEach(function (tab) {
            try {
                for (var i = tab.groups.length; i--;) {
                    var group = tab.groups[i];
                    if (group.id in _RibbonGroups && _RibbonGroups[group.id] === false) {
                        tab.groups.splice(i, 1);
                    }
                }
            }
            catch (e) {
                if (e.name === 'ReferenceError') {
                    var RibbonGroups = undefined;
                }
            }
        });
        for (var i = tabs.length; i--;) {
            var tab = tabs[i];
            if (tab.groups.length === 0) {
                tabs.splice(i, 1);
            }
        }
    };
    VSRibbon.prototype.initialize = function () {
        var _this = this;
        context = {
            client: vsClient,
            ribbon: this,
            menu: menu
        };
        this.loadRibbonConfig();
        this.cullRibbonGroups();
        app_states_1.appStates.ribbonWidth = window.innerWidth;
        if (app_states_1.appStates.ribbonWidth < 600) {
            app_states_1.appStates.ribbonWidth = 600;
        }
        tabs.forEach(function (tab) {
            tab.el.addEventListener('click', function (ev) {
                tabs.forEach(function (tab) {
                    var el = ev.currentTarget;
                    if (el.id !== tab.id) {
                        tab.hide();
                    }
                });
                if (_this.ribbonBody.style.display === 'none') {
                    var wvApp = document.getElementById('wv-app');
                    var wvDock = document.getElementById('wv-dock');
                    _this.ribbonBody.style.position = 'absolute';
                    _this.ribbonBody.style.top = '24px';
                    _this.ribbonBody.style.left = '0px';
                    var zIndex = 400;
                    _this.ribbonBody.style.zIndex = zIndex.toString();
                    wvDock.style.zIndex = (zIndex - 100).toString();
                    wvApp.insertBefore(_this.ribbonBody, wvDock);
                    activeTab = tab;
                    _this.ribbonBody.style.display = '';
                    activeTab.page.style.display = '';
                    document.addEventListener('click', _this.hideRibbonBody);
                    return;
                }
                activeTab = tab;
                activeTab.show();
            });
        });
        activeTab = startTab;
        this.render();
    };
    VSRibbon.prototype.render = function () {
        var _this = this;
        target.appendChild(this.header);
        target.appendChild(this.ribbonBody);
        for (var _i = 0, tabs_1 = tabs; _i < tabs_1.length; _i++) {
            var tab = tabs_1[_i];
            tab.addToHeader(this.header);
        }
        tabs.forEach(function (tab) { return tab.render(_this.ribbonBody); });
        activeTab.show();
        this.classes['DeactivateAll'].forEach(function (button) {
            $(button.el).closest('.ribbon-group').addClass('ribbon-deactivate');
        });
    };
    VSRibbon.prototype.reset = function () {
        app_states_1.appStates.reset();
        tabs.forEach(function (tab) {
            tab.groups.forEach(function (g) {
                g.getWidgets().forEach(function (widget) {
                    if (widget instanceof w.BaseButton && !widget.paneId) {
                        widget.applyHighlight(false);
                    }
                });
            });
        });
        w.initHightlightedButtons.forEach(function (b) {
            b.applyHighlight(true);
        });
    };
    VSRibbon.prototype.disableFileList = function () {
        var openEl = document.getElementById('ID_RIBBON_OPEN');
        var importEl = document.getElementById('ID_RIBBON_IMPORT');
        var saveEl = document.getElementById('ID_RIBBON_SAVE');
        if (openEl) {
            tabs[0].groups[0].configuration.splice(0, 1);
            openEl.parentNode.removeChild(openEl);
        }
        if (importEl) {
            tabs[0].groups[0].configuration.splice(0, 1);
            importEl.parentNode.removeChild(importEl);
        }
        if (saveEl) {
            saveEl.parentNode.removeChild(saveEl);
        }
    };
    VSRibbon.prototype.deleteShareRibbon = function () {
        var shareEl = document.getElementById('ID_RIBBON_VISSHARE_FILE');
        var shareCompactEl = document.getElementById('ID_RIBBON_VISSHARE_FILE_Compact');
        if (shareEl) {
            shareEl.parentNode.removeChild(shareEl);
            tabs[0].groups.splice(1, 1);
        }
        else if (shareCompactEl) {
            shareCompactEl.parentNode.removeChild(shareCompactEl);
            tabs[0].groups.splice(1, 1);
        }
    };
    VSRibbon.prototype._buildLangSwitch = function () {
        var languageSwitch = document.createElement('select');
        languageSwitch.id = 'wv-ribbon-language';
        var langs = {
            ENU: 'English',
            DEU: 'Deutsch',
            ITA: 'Italiano',
            ESP: 'Espaol',
            FRA: 'Franais',
            KOR: '',
            CHS: '',
            JPN: '',
        };
        for (var k in langs) {
            var el = document.createElement('option');
            el.value = k;
            el.textContent = langs[k];
            if (el.value === app_settings_1.settings.lang) {
                el.setAttribute('selected', 'selected');
            }
            languageSwitch.appendChild(el);
        }
        var vsRibbon = this;
        languageSwitch.onchange = function () {
            var lang = languageSwitch.value;
            app_settings_1.settings.lang = lang;
            vsRibbon.render();
            var SetSettingsParam = "\n            <Settings>\n                <Renderer>\n                    <General>\n                        <Language>" + lang + "</Language>\n                    </General>\n                </Renderer>\n            </Settings>\n        ";
            var SetSettings = "<Call Method=\"SetSettings\">" + SetSettingsParam + "</Call>";
            vsClient.command.executeXML(SetSettings);
            vsClient.once('SetSettings', function (response) {
                vsClient.emit('@changeLang', lang);
                localStorage.setItem('WVLang', lang);
                if (app_states_1.appStates.fileLoaded) {
                    var GetSettings = "<Call Method=\"GetSceneSettings\"></Call>";
                    vsClient.command.executeXML(GetSettings);
                }
            });
        };
        return languageSwitch;
    };
    VSRibbon.prototype.openPage = function (url) {
        var offlineHelp = false;
        try {
            offlineHelp = _UseOfflineHelp;
        }
        catch (e) {
        }
        if (url === 'https://viewer.kisters.de/help/webviewer') {
            url = offlineHelp ? '/Help/webviewer/' + ui.mapCountry(app_settings_1.settings.lang) + '/index.html' : url + '/' + app_states_1.appStates.version + '/' + ui.mapCountry(app_settings_1.settings.lang) + '/index.php';
        }
        window.open(url, '_blank');
    };
    VSRibbon.prototype._buildAboutDialog = function () {
        var _this = this;
        var aboutDialog = document.createElement('div');
        aboutDialog.classList.add('ribbon-about');
        var aboutDialogIcon = document.createElement('i');
        aboutDialogIcon.id = 'wv-ribbon-about';
        aboutDialogIcon.classList.add('fa');
        aboutDialogIcon.classList.add('fa-question-circle');
        var aboutDialogWrapper = document.createElement('div');
        aboutDialogWrapper.classList.add('ribbon-about-wrapper');
        aboutDialogWrapper.id = "aboutDialog";
        var aboutDialogImage = document.createElement('img');
        aboutDialogImage.src = '3D-VS_About-Screen.png';
        var defaultTextWrapper = document.createElement('div');
        defaultTextWrapper.classList.add('ribbon-about-default-text-wrapper');
        var defaultTextEdition = document.createElement('span');
        defaultTextEdition.classList.add('ribbon-about-default-text');
        defaultTextEdition.textContent = "WebViewer-Edition";
        var defaultTextCopyRight = document.createElement('span');
        defaultTextCopyRight.classList.add('ribbon-about-default-copyright');
        defaultTextCopyRight.textContent = "\u00A92020 by KISTERS All rights reserved";
        var versionTextWrapper = document.createElement('div');
        versionTextWrapper.classList.add('ribbon-about-version-wrapper');
        var programVersionWrapper = document.createElement('div');
        var programVersionTitle = document.createElement('span');
        programVersionTitle.textContent = _lang_data['ID_ABOUT_PROGRAMVERSION'][app_settings_1.settings.lang] + " ";
        var programVersion = document.createElement('span');
        programVersion.id = "program_version_text";
        programVersionWrapper.appendChild(programVersionTitle);
        programVersionWrapper.appendChild(programVersion);
        var versionImporterWrapper = document.createElement('div');
        var versionImporterTitle = document.createElement('span');
        versionImporterTitle.textContent = "Importer: ";
        var versionImporter = document.createElement('span');
        versionImporter.id = "version_importer_text";
        versionImporterWrapper.appendChild(versionImporterTitle);
        versionImporterWrapper.appendChild(versionImporter);
        vsClient.on('@changeLang', function (lang) {
            programVersionTitle.textContent = _lang_data['ID_ABOUT_PROGRAMVERSION'][app_settings_1.settings.lang] + " ";
            versionImporterTitle.textContent = "Importer: ";
        });
        versionTextWrapper.appendChild(programVersionWrapper);
        versionTextWrapper.appendChild(versionImporterWrapper);
        aboutDialogWrapper.appendChild(versionTextWrapper);
        defaultTextWrapper.appendChild(defaultTextEdition);
        defaultTextWrapper.appendChild(defaultTextCopyRight);
        aboutDialogWrapper.appendChild(defaultTextWrapper);
        aboutDialogWrapper.appendChild(aboutDialogImage);
        var buttonWidth = 40;
        var buttons;
        try {
            buttons = _AboutLinks;
        }
        catch (e) {
            buttons = app_states_1.appStates.aboutLinks;
        }
        var leftButtonPos = (buttons.length - 1) * 50;
        var _loop_1 = function (i) {
            var button = document.createElement('div');
            button.classList.add('ribbon-about-button');
            button.style.right = (leftButtonPos - (i * buttonWidth) - (i * 10)) + 'px';
            $(button).click(function (e) {
                e.preventDefault();
                _this.openPage(buttons[i]);
            });
            aboutDialogWrapper.appendChild(button);
        };
        for (var i = 0; i < buttons.length; i++) {
            _loop_1(i);
        }
        aboutDialogIcon.onclick = function (e) {
            if (_this.aboutOpen === false) {
                e.stopPropagation();
                var xml = '<Call Method="GetVersionInfo"></Call>';
                vsClient.command.executeXMLAsync(xml);
                vsClient.once("GetVersionInfo", function (response) {
                    var versionArr = response.Version.split('.');
                    versionArr.pop();
                    app_states_1.appStates.version = versionArr.join('.');
                    $('#program_version_text').text(response.LongVersion);
                    $('#version_importer_text').text(response.ImporterVersion);
                });
                document.body.appendChild(aboutDialogWrapper);
                $(document).on('click', _this.closeAboutDialog);
                $(document).on('keyup', _this.closeAboutDialog);
                _this.aboutOpen = true;
            }
            else {
                document.body.removeChild(aboutDialogWrapper);
                $(document).off('click', _this.closeAboutDialog);
                $(document).off('keyup', _this.closeAboutDialog);
                _this.aboutOpen = false;
            }
        };
        aboutDialog.appendChild(aboutDialogIcon);
        return aboutDialog;
    };
    return VSRibbon;
}(events.EventEmitter));
exports.VSRibbon = VSRibbon;
var target;
var ribbonExpandables;
var ribbonDropdowns;
var tabs = [];
var startTab;
var documentTab;
var viewTab;
var meausurementTab;
var analyseTab;
var transformTab;
var toolTab;
var modelTab;
var techDocTab;
var activeTab;
var context;
function isDescendant(parent, child) {
    var node = child.parentNode;
    while (node != null) {
        if (node == parent) {
            return true;
        }
        node = node.parentNode;
    }
    return false;
}


/***/ })
/******/ ]);
//# sourceMappingURL=webviewer-bundle.js.map